<!DOCTYPE html><script type="text/javascript" src="wgo/wgo.min.js"></script> <script type="text/javascript" src="wgo/wgo.player.min.js"></script> <link type="text/css" href="wgo/wgo.player.css" rel="stylesheet"><html lang="zh-TW" data-astro-cid-sckkx6r4> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="author" content="Lightman Chang"><link rel="icon" href="favicon.png" id="favicon"><title>å°ç£å¥½æ£‹å¯¶å¯¶å”æœƒï½œåœæ£‹å”æœƒæ¨è–¦ï½œå…’ç«¥åœæ£‹èˆ‡è¦ªå­åœæ£‹çš„æ–‡åŒ–èˆ‡ç”Ÿæ´»ç¾å­¸</title><meta name="keywords" content="åœæ£‹"><meta name="description" content="å°ç£å¥½æ£‹å¯¶å¯¶å”æœƒï½œåœæ£‹å”æœƒæ¨è–¦ï½œå…’ç«¥åœæ£‹èˆ‡è¦ªå­åœæ£‹çš„æ–‡åŒ–èˆ‡ç”Ÿæ´»ç¾å­¸"><meta name="author" content="Lightman Chang"><!-- Open Graphï¼ˆOG æ¨™ç±¤ï¼‰--><meta property="og:title" content="å°ç£å¥½æ£‹å¯¶å¯¶å”æœƒï½œåœæ£‹å”æœƒæ¨è–¦ï½œå…’ç«¥åœæ£‹èˆ‡è¦ªå­åœæ£‹çš„æ–‡åŒ–èˆ‡ç”Ÿæ´»ç¾å­¸"><meta property="og:description" content="å°ç£å¥½æ£‹å¯¶å¯¶å”æœƒï½œåœæ£‹å”æœƒæ¨è–¦ï½œå…’ç«¥åœæ£‹èˆ‡è¦ªå­åœæ£‹çš„æ–‡åŒ–èˆ‡ç”Ÿæ´»ç¾å­¸"><meta property="og:url" content="https://www.weiqi.kids/"><meta property="og:type" content="website"><meta property="og:image" content="favicon.png"><!-- Twitter Card æ¨™ç±¤ --><meta name="twitter:title" content="å°ç£å¥½æ£‹å¯¶å¯¶å”æœƒï½œåœæ£‹å”æœƒæ¨è–¦ï½œå…’ç«¥åœæ£‹èˆ‡è¦ªå­åœæ£‹çš„æ–‡åŒ–èˆ‡ç”Ÿæ´»ç¾å­¸"><meta name="twitter:description" content="å°ç£å¥½æ£‹å¯¶å¯¶å”æœƒï½œåœæ£‹å”æœƒæ¨è–¦ï½œå…’ç«¥åœæ£‹èˆ‡è¦ªå­åœæ£‹çš„æ–‡åŒ–èˆ‡ç”Ÿæ´»ç¾å­¸"><meta name="twitter:card" content="favicon.png"><meta name="twitter:image" content="favicon.png"><!-- ç¢ºä¿æœå°‹å¼•æ“å°‡æ­¤ URL è¦–ç‚ºä¸»è¦ç‰ˆæœ¬ã€‚ --><link rel="canonical" href="https://www.weiqi.kids/"><!-- çµæ§‹åŒ–æ•¸æ“šï¼ˆJSON-LDï¼ŒJavaScript Object Notation for Linked Dataï¼‰--><script type="application/ld+json">
			{JSON.stringify(structuredData)}
		</script><!-- shoelace.style --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.19.1/cdn/themes/light.css"><script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.19.1/cdn/shoelace-autoloader.js"></script><script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.19.1/cdn/components/progress-bar/progress-bar.js"></script><!-- pretty-print-json --><script src="https://cdn.jsdelivr.net/npm/pretty-print-json@3.0.3/dist/pretty-print-json.min.js" integrity="sha256-urY8XWgRVQWTceuugYbedV0e2VOUPYTiyXTuG6DVdsA=" crossorigin="anonymous"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretty-print-json@3.0.3/dist/css/pretty-print-json.min.css" integrity="sha256-mrFZOJCcv6gj0AmmYIqZKJd5ZtR7oATQJSGH1PDmAks=" crossorigin="anonymous"><!-- axios --><script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.7.8/axios.min.js" referrerpolicy="no-referrer"></script><link rel="stylesheet" href="/_astro/index.Bj92vnvE.css"></head> <body data-astro-cid-sckkx6r4> <div id="app" class="grid grid-cols-[200px_1fr]" data-astro-cid-sckkx6r4> <div class="w-[200px] h-screen bg-gray-100 p-4" data-astro-cid-sckkx6r4> <sl-menu class="w-full" data-astro-cid-sckkx6r4="true"> <!--sl-menu-label>æœ€æ–°æ¶ˆæ¯</sl-menu-label>
					<sl-menu-item>ä¹è·¯å°å±€æ’­æ”¾</sl-menu-item>
					<sl-divider></sl-divider--> <sl-menu-label data-astro-cid-sckkx6r4="true">æœƒå“¡ä»‹ç´¹</sl-menu-label> <sl-menu-item data-astro-cid-sckkx6r4="true">(è³‡æ–™æ•´ç†ä¸­...)</sl-menu-item> <!--sl-menu-item>å°šå‰</sl-menu-item>
					<sl-menu-item>éƒè±</sl-menu-item>
					<sl-menu-item>éƒ­å°šè«º</sl-menu-item>
					<sl-menu-item>å‘¨æ€å‚‘å¾‹å¸«</sl-menu-item>
					<sl-menu-item>å‘¨æ•¬å½¥ç¶“ç†</sl-menu-item>
					<sl-menu-item>å¤©å¥</sl-menu-item>
					<sl-menu-item>åšé™½</sl-menu-item>
					<sl-divider></sl-divider--> <sl-menu-label data-astro-cid-sckkx6r4="true">éå»å¼</sl-menu-label> <sl-menu-item data-astro-cid-sckkx6r4="true">WordPressæ™‚æœŸ</sl-menu-item> </sl-menu> </div> <div class="p-4" data-astro-cid-sckkx6r4> <sl-breadcrumb><sl-breadcrumb-item><sl-icon slot="prefix" name="house"></sl-icon><h1>å¥½æ£‹å¯¶å¯¶</h1></sl-breadcrumb-item></sl-breadcrumb><div id="board" style="height: 90%;"></div><script type="text/javascript">

    const GAME_ID_ASK = new URLSearchParams(window.location.search).get("id");  // console.log("ğŸ¯ æ£‹å±€ ID:", GAME_ID_ASK);
    let GAME_ID;  
    let socket;
    const board = document.getElementById("board");
    const player = new WGo.BasicPlayer(board, {
      board: {
        size: 9,
        background: "wgo/wood_1024.jpg"
      },
      layout: {
          bottom: ['Control'],
      },
      sgf: "(;SZ[9])"
    });
    async function connectWebSocket() {
      const response = await fetch(`http://questgames.net:3002/socket.io/1/?t=${Date.now()}`);
      const text = await response.text();
      const SESSION_ID = text.split(":")[0];
      socket = new WebSocket(`ws://questgames.net:3002/socket.io/1/websocket/${SESSION_ID}`);
      socket.onopen = function () {// console.log("âœ… WebSocket é€£ç·šæˆåŠŸ");
         setInterval(() => {
          if (socket.readyState === WebSocket.OPEN) { socket.send("2::");}
        }, 25000);

        // æ­£å¼å®Œæˆé€£ç·šï¼Œå–å¾—ä¼ºæœå™¨è³‡è¨Š
        socket.send(`5:::{"name":"efa2bd1b","args":[{"env":"WEB","handicapV":"1","gtype":"go9"}]}`);
      };

      socket.onmessage = function (event) {
        if (event.data === "2::") { socket.send("3::"); return; }
        if (!event.data.startsWith('5:::')) { return ; }

        const jsonData = JSON.parse(event.data.slice(4));
        if (jsonData.name === "f19683a8") {
          // ä¼ºæœå™¨ç™¼é€ f19683a8 æŒ‡ä»¤
          // {connected: 1394, games: 283, solving: 4, run: 0, down: {}}

          // å·²æœ‰æˆåŠŸçš„æ£‹è­œè³‡æ–™æ™‚ï¼Œå‰‡ä¸éœ€è¦é‡æ–°ç™¼é€å–å¾—æ£‹è­œè³‡æ–™æŒ‡ä»¤ã€‚
          if (GAME_ID) { return; }
          console.log("ğŸ“© ä¼ºæœå™¨è³‡è¨Šæ¥æ”¶æˆåŠŸ", jsonData.args[0])

          // æœ‰æŒ‡å®šæ£‹å±€ï¼Œå‰‡è¼‰å…¥æŒ‡å®šæ£‹å±€ï¼›ç„¡å‰‡å¾æ­£åœ¨å°å±€çš„æ¸…å–®ä¸­æ‰¾æ£‹å±€è¼ªæ’­ã€‚
          if (GAME_ID_ASK) {
            socket.send(`5:::{"name":"ba276087","args":[{"id":"${GAME_ID_ASK}"}]}`);
          }
          else {
            socket.send(`5:::{"name":"c794948e","args":[{"gtype":"go9","page":"0"}]}`);
          }
        }
        else if (jsonData.name === "c794948e") {
          // å·²æœ‰æˆåŠŸçš„æ£‹è­œè³‡æ–™æ™‚ï¼Œå‰‡ä¸éœ€è¦é‡æ–°ç™¼é€å–å¾—æ£‹è­œè³‡æ–™æŒ‡ä»¤ã€‚
          if (GAME_ID) { return; }
          console.log("ğŸ“© å–å¾—æ­£åœ¨é€²è¡Œçš„æ£‹å±€åˆ—è¡¨"); // console.table(jsonData.args[0].games);

          GAME_ID = jsonData.args[0].games[0].id;
          socket.send(`5:::{"name":"ba276087","args":[{"id":"${GAME_ID}"}]}`);
        }
        else if (jsonData.name === "ba276087") { console.log("ğŸ“© æˆåŠŸè¼‰å…¥ GAME_ID æ£‹å±€", jsonData.args[0]);
          // {id: "rsxz8hmxa20f", gtype: "go9", started: "2025-03-12T10:21:01.684Z",â€¦}

          GAME_ID = jsonData.args[0].id;
          loadSGF(jsonData.args[0]);
          
          console.log("ğŸ“© æ˜¯å¦å·²ç¶“çµæŸå°å±€", !GAME_ID_ASK, jsonData.args[0].finished);
          if (!GAME_ID_ASK && jsonData.args[0].finished) {
            setTimeout(() => {
              socket.send(`5:::{"name":"c794948e","args":[{"gtype":"go9","page":"0"}]}`);
            }, 5000);
          }
        }
        else if (jsonData.name === "8d7a2124") { console.log("ğŸ“© æˆåŠŸæ¥æ”¶æ­£åœ¨é€²è¡Œçš„å°å±€è³‡æ–™", jsonData.args[0]);
          loadSGF(jsonData.args[0]);
        }
        else if (jsonData.name === "1f566a1a") { console.log("ğŸ“© æ”¶åˆ°å°å±€çµæŸæŒ‡ä»¤", jsonData.args[0]);
          GAME_ID = null;
          socket.send(`5:::{"name":"c794948e","args":[{"gtype":"go9","page":"0"}]}`);
        }
        else if (jsonData.name === "d40a7297") { // console.log("ğŸ“© æ”¶åˆ°æŒ‡ä»¤", jsonData.args[0]);
        }
        else {
          console.log("ğŸ“© æœªçŸ¥çš„ä¼ºæœå™¨å›æ‡‰:", jsonData);
        }
      };

      // ç•°å¸¸æ™‚ï¼Œå¦‚æœæ˜¯æ²’æœ‰æŒ‡å®šæ£‹å±€ IDï¼Œå‰‡é‡æ–°é€£ç·šã€‚
      const reconnect = () => { if (!GAME_ID) { connectWebSocket(); } }
      socket.addEventListener("error", reconnect);
      socket.addEventListener("close", reconnect);
    }

    function convertToSGF(gameData) {
      let sgf = `(;SZ[${gameData.position.size}];PB[${gameData.players[0].name}]PW[${gameData.players[1].name}]`;
      gameData.position.moves.forEach(move => {
          sgf += `;${move.m}`;
      });
      sgf += ")";
      return sgf;
    }

    function loadSGF(data) {
      player.loadSgf(convertToSGF(data));
      player.last();
    }
    
    // connectWebSocket();
    </script> </div> </div> </body></html>