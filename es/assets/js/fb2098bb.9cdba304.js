"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[6554],{81479(e,n,a){a.r(n),a.d(n,{assets:()=>o,contentTitle:()=>r,default:()=>u,frontMatter:()=>s,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"for-engineers/deep-dive/neural-network","title":"Arquitectura de redes neuronales en detalle","description":"An\xe1lisis profundo del dise\xf1o de red neuronal de KataGo, caracter\xedsticas de entrada y arquitectura de salida m\xfaltiple","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/for-engineers/deep-dive/neural-network.md","sourceDirName":"for-engineers/deep-dive","slug":"/for-engineers/deep-dive/neural-network","permalink":"/es/docs/for-engineers/deep-dive/neural-network","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/for-engineers/deep-dive/neural-network.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Arquitectura de redes neuronales en detalle","description":"An\xe1lisis profundo del dise\xf1o de red neuronal de KataGo, caracter\xedsticas de entrada y arquitectura de salida m\xfaltiple"},"sidebar":"tutorialSidebar","previous":{"title":"Participar en la comunidad de codigo abierto","permalink":"/es/docs/for-engineers/deep-dive/contributing"},"next":{"title":"Detalles de implementaci\xf3n de MCTS","permalink":"/es/docs/for-engineers/deep-dive/mcts-implementation"}}');var i=a(62615),d=a(30416);const s={sidebar_position:4,title:"Arquitectura de redes neuronales en detalle",description:"An\xe1lisis profundo del dise\xf1o de red neuronal de KataGo, caracter\xedsticas de entrada y arquitectura de salida m\xfaltiple"},r="Arquitectura de redes neuronales en detalle",o={},c=[{value:"Visi\xf3n general de la arquitectura",id:"visi\xf3n-general-de-la-arquitectura",level:2},{value:"Codificaci\xf3n de caracter\xedsticas de entrada",id:"codificaci\xf3n-de-caracter\xedsticas-de-entrada",level:2},{value:"Visi\xf3n general de planos de caracter\xedsticas",id:"visi\xf3n-general-de-planos-de-caracter\xedsticas",level:3},{value:"Apilamiento de estado hist\xf3rico",id:"apilamiento-de-estado-hist\xf3rico",level:3},{value:"Codificaci\xf3n de reglas",id:"codificaci\xf3n-de-reglas",level:3},{value:"Red troncal: Torre residual",id:"red-troncal-torre-residual",level:2},{value:"Estructura del bloque residual",id:"estructura-del-bloque-residual",level:3},{value:"Ejemplo de c\xf3digo",id:"ejemplo-de-c\xf3digo",level:3},{value:"Capa de pooling global",id:"capa-de-pooling-global",level:3},{value:"Dise\xf1o de cabezas de salida",id:"dise\xf1o-de-cabezas-de-salida",level:2},{value:"Policy Head (Cabeza de pol\xedtica)",id:"policy-head-cabeza-de-pol\xedtica",level:3},{value:"Value Head (Cabeza de valor)",id:"value-head-cabeza-de-valor",level:3},{value:"Score Head (Cabeza de puntuaci\xf3n)",id:"score-head-cabeza-de-puntuaci\xf3n",level:3},{value:"Ownership Head (Cabeza de propiedad)",id:"ownership-head-cabeza-de-propiedad",level:3},{value:"Diferencias con AlphaZero",id:"diferencias-con-alphazero",level:2},{value:"Escala del modelo",id:"escala-del-modelo",level:2},{value:"Implementaci\xf3n completa de la red",id:"implementaci\xf3n-completa-de-la-red",level:2},{value:"Lectura adicional",id:"lectura-adicional",level:2}];function t(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"arquitectura-de-redes-neuronales-en-detalle",children:"Arquitectura de redes neuronales en detalle"})}),"\n",(0,i.jsx)(n.p,{children:"Este art\xedculo analiza en profundidad la arquitectura completa de la red neuronal de KataGo, desde la codificaci\xf3n de caracter\xedsticas de entrada hasta el dise\xf1o de salida m\xfaltiple."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"visi\xf3n-general-de-la-arquitectura",children:"Visi\xf3n general de la arquitectura"}),"\n",(0,i.jsxs)(n.p,{children:["KataGo utiliza un dise\xf1o de ",(0,i.jsx)(n.strong,{children:"red neuronal \xfanica con salida m\xfaltiple"}),":"]}),"\n",(0,i.jsx)(n.mermaid,{value:'flowchart TB\n    Input["Caracter\xedsticas de entrada<br/>(19\xd719\xd722)"]\n    Conv["Capa de conv. inicial<br/>256 filtros"]\n    Trunk["Torre residual<br/>20-60 bloques residuales<br/>+ capa de pooling global"]\n    Policy["Policy Head"]\n    Value["Value Head"]\n    Score["Score Head"]\n    Ownership["Ownership Head"]\n    PolicyOut["362 prob.<br/>(incl. pass)"]\n    ValueOut["Tasa de victoria<br/>(-1~+1)"]\n    ScoreOut["Dif. de puntos<br/>(puntos)"]\n    OwnerOut["361 prop.<br/>(-1~+1)"]\n\n    Input --\x3e Conv --\x3e Trunk\n    Trunk --\x3e Policy --\x3e PolicyOut\n    Trunk --\x3e Value --\x3e ValueOut\n    Trunk --\x3e Score --\x3e ScoreOut\n    Trunk --\x3e Ownership --\x3e OwnerOut'}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"codificaci\xf3n-de-caracter\xedsticas-de-entrada",children:"Codificaci\xf3n de caracter\xedsticas de entrada"}),"\n",(0,i.jsx)(n.h3,{id:"visi\xf3n-general-de-planos-de-caracter\xedsticas",children:"Visi\xf3n general de planos de caracter\xedsticas"}),"\n",(0,i.jsxs)(n.p,{children:["KataGo utiliza ",(0,i.jsx)(n.strong,{children:"22 planos de caracter\xedsticas"})," (19\xd719\xd722), cada plano es una matriz de 19\xd719:"]}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Plano"}),(0,i.jsx)(n.th,{children:"Contenido"}),(0,i.jsx)(n.th,{children:"Descripci\xf3n"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"0"}),(0,i.jsx)(n.td,{children:"Piedras propias"}),(0,i.jsx)(n.td,{children:"1 = hay piedra propia, 0 = no"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"1"}),(0,i.jsx)(n.td,{children:"Piedras del oponente"}),(0,i.jsx)(n.td,{children:"1 = hay piedra del oponente, 0 = no"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"2"}),(0,i.jsx)(n.td,{children:"Puntos vac\xedos"}),(0,i.jsx)(n.td,{children:"1 = punto vac\xedo, 0 = hay piedra"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"3-10"}),(0,i.jsx)(n.td,{children:"Estado hist\xf3rico"}),(0,i.jsx)(n.td,{children:"Cambios del tablero en los \xfaltimos 8 movimientos"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"11"}),(0,i.jsx)(n.td,{children:"Punto de ko"}),(0,i.jsx)(n.td,{children:"1 = este punto es ko prohibido, 0 = jugable"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"12-17"}),(0,i.jsx)(n.td,{children:"Codificaci\xf3n de libertades"}),(0,i.jsx)(n.td,{children:"Cadenas con 1, 2, 3... libertades"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"18-21"}),(0,i.jsx)(n.td,{children:"Codificaci\xf3n de reglas"}),(0,i.jsx)(n.td,{children:"Reglas chinas/japonesas, komi, etc."})]})]})]}),"\n",(0,i.jsx)(n.h3,{id:"apilamiento-de-estado-hist\xf3rico",children:"Apilamiento de estado hist\xf3rico"}),"\n",(0,i.jsxs)(n.p,{children:["Para que la red neuronal entienda los ",(0,i.jsx)(n.strong,{children:"cambios din\xe1micos"})," de la posici\xf3n, KataGo apila los estados del tablero de los \xfaltimos 8 movimientos:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Codificaci\xf3n de estado hist\xf3rico (concepto)\ndef encode_history(game_history, current_player):\n    features = []\n\n    for t in range(8):  # \xdaltimos 8 movimientos\n        if t < len(game_history):\n            board = game_history[-(t+1)]\n            # Codificar piedras propias/oponente en ese momento\n            features.append(encode_board(board, current_player))\n        else:\n            # Historia insuficiente, rellenar con ceros\n            features.append(np.zeros((19, 19)))\n\n    return np.stack(features, axis=0)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"codificaci\xf3n-de-reglas",children:"Codificaci\xf3n de reglas"}),"\n",(0,i.jsx)(n.p,{children:"KataGo soporta m\xfaltiples reglas, comunic\xe1ndolas a la red neuronal a trav\xe9s de planos de caracter\xedsticas:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'# Codificaci\xf3n de reglas (concepto)\ndef encode_rules(rules, komi):\n    rule_features = np.zeros((4, 19, 19))\n\n    # Tipo de regla (one-hot)\n    if rules == "chinese":\n        rule_features[0] = 1.0\n    elif rules == "japanese":\n        rule_features[1] = 1.0\n\n    # Komi normalizado\n    normalized_komi = komi / 15.0  # Normalizado a [-1, 1]\n    rule_features[2] = normalized_komi\n\n    # Jugador actual\n    rule_features[3] = 1.0 if current_player == BLACK else 0.0\n\n    return rule_features\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"red-troncal-torre-residual",children:"Red troncal: Torre residual"}),"\n",(0,i.jsx)(n.h3,{id:"estructura-del-bloque-residual",children:"Estructura del bloque residual"}),"\n",(0,i.jsxs)(n.p,{children:["KataGo utiliza la estructura ",(0,i.jsx)(n.strong,{children:"Pre-activation ResNet"}),":"]}),"\n",(0,i.jsx)(n.mermaid,{value:'flowchart TB\n    Input["Entrada x"]\n    BN1["BatchNorm"]\n    ReLU1["ReLU"]\n    Conv1["Conv 3\xd73"]\n    BN2["BatchNorm"]\n    ReLU2["ReLU"]\n    Conv2["Conv 3\xd73"]\n    Add["+ (conexi\xf3n residual)"]\n    Output["Salida"]\n\n    Input --\x3e BN1 --\x3e ReLU1 --\x3e Conv1 --\x3e BN2 --\x3e ReLU2 --\x3e Conv2 --\x3e Add\n    Input -.-> Add\n    Add --\x3e Output'}),"\n",(0,i.jsx)(n.h3,{id:"ejemplo-de-c\xf3digo",children:"Ejemplo de c\xf3digo"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class ResidualBlock(nn.Module):\n    def __init__(self, channels):\n        super().__init__()\n        self.bn1 = nn.BatchNorm2d(channels)\n        self.conv1 = nn.Conv2d(channels, channels, 3, padding=1)\n        self.bn2 = nn.BatchNorm2d(channels)\n        self.conv2 = nn.Conv2d(channels, channels, 3, padding=1)\n\n    def forward(self, x):\n        residual = x\n\n        out = self.bn1(x)\n        out = F.relu(out)\n        out = self.conv1(out)\n\n        out = self.bn2(out)\n        out = F.relu(out)\n        out = self.conv2(out)\n\n        return out + residual  # Conexi\xf3n residual\n"})}),"\n",(0,i.jsx)(n.h3,{id:"capa-de-pooling-global",children:"Capa de pooling global"}),"\n",(0,i.jsxs)(n.p,{children:["Una de las innovaciones clave de KataGo: agregar ",(0,i.jsx)(n.strong,{children:"pooling global"})," en los bloques residuales, permitiendo que la red vea informaci\xf3n global:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class GlobalPoolingBlock(nn.Module):\n    def __init__(self, channels):\n        super().__init__()\n        self.conv = nn.Conv2d(channels, channels, 3, padding=1)\n        self.fc = nn.Linear(channels, channels)\n\n    def forward(self, x):\n        # Ruta local\n        local = self.conv(x)\n\n        # Ruta global\n        global_pool = x.mean(dim=[2, 3])  # Pooling promedio global\n        global_fc = self.fc(global_pool)\n        global_broadcast = global_fc.unsqueeze(2).unsqueeze(3)\n        global_broadcast = global_broadcast.expand(-1, -1, 19, 19)\n\n        # Fusi\xf3n\n        return local + global_broadcast\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\xbfPor qu\xe9 se necesita pooling global?"})}),"\n",(0,i.jsx)(n.p,{children:'Las convoluciones tradicionales solo ven localmente (campo receptivo 3\xd73), incluso apilando muchas capas, la percepci\xf3n de informaci\xf3n global sigue siendo limitada. El pooling global permite que la red "vea" directamente:'}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"La diferencia de cantidad de piedras en todo el tablero"}),"\n",(0,i.jsx)(n.li,{children:"La distribuci\xf3n global de influencia"}),"\n",(0,i.jsx)(n.li,{children:"El juicio general de la posici\xf3n"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"dise\xf1o-de-cabezas-de-salida",children:"Dise\xf1o de cabezas de salida"}),"\n",(0,i.jsx)(n.h3,{id:"policy-head-cabeza-de-pol\xedtica",children:"Policy Head (Cabeza de pol\xedtica)"}),"\n",(0,i.jsx)(n.p,{children:"Produce la probabilidad de jugar en cada posici\xf3n:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class PolicyHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv = nn.Conv2d(in_channels, 2, 1)  # Conv. 1\xd71\n        self.bn = nn.BatchNorm2d(2)\n        self.fc = nn.Linear(2 * 19 * 19, 362)  # 361 + pass\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv(x)))\n        out = out.view(out.size(0), -1)\n        out = self.fc(out)\n        return F.softmax(out, dim=1)  # Distribuci\xf3n de probabilidad\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Formato de salida"}),": Vector de 362 dimensiones"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\xcdndices 0-360: Probabilidad de jugar en las 361 posiciones del tablero"}),"\n",(0,i.jsx)(n.li,{children:"\xcdndice 361: Probabilidad de pasar"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"value-head-cabeza-de-valor",children:"Value Head (Cabeza de valor)"}),"\n",(0,i.jsx)(n.p,{children:"Produce la tasa de victoria de la posici\xf3n actual:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class ValueHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv = nn.Conv2d(in_channels, 1, 1)\n        self.bn = nn.BatchNorm2d(1)\n        self.fc1 = nn.Linear(19 * 19, 256)\n        self.fc2 = nn.Linear(256, 1)\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv(x)))\n        out = out.view(out.size(0), -1)\n        out = F.relu(self.fc1(out))\n        out = torch.tanh(self.fc2(out))  # Salida de -1 a +1\n        return out\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Formato de salida"}),": Valor \xfanico [-1, +1]"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"+1: Victoria segura propia"}),"\n",(0,i.jsx)(n.li,{children:"-1: Victoria segura del oponente"}),"\n",(0,i.jsx)(n.li,{children:"0: Posici\xf3n equilibrada"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"score-head-cabeza-de-puntuaci\xf3n",children:"Score Head (Cabeza de puntuaci\xf3n)"}),"\n",(0,i.jsx)(n.p,{children:"Exclusivo de KataGo, predice la diferencia final de puntos:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class ScoreHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv = nn.Conv2d(in_channels, 1, 1)\n        self.bn = nn.BatchNorm2d(1)\n        self.fc1 = nn.Linear(19 * 19, 256)\n        self.fc2 = nn.Linear(256, 1)\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv(x)))\n        out = out.view(out.size(0), -1)\n        out = F.relu(self.fc1(out))\n        out = self.fc2(out)  # Salida sin restricci\xf3n\n        return out\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Formato de salida"}),": Valor \xfanico (puntos)"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Positivo: Ventaja propia"}),"\n",(0,i.jsx)(n.li,{children:"Negativo: Ventaja del oponente"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"ownership-head-cabeza-de-propiedad",children:"Ownership Head (Cabeza de propiedad)"}),"\n",(0,i.jsx)(n.p,{children:"Predice la propiedad final de cada punto:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class OwnershipHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv1 = nn.Conv2d(in_channels, 32, 1)\n        self.bn = nn.BatchNorm2d(32)\n        self.conv2 = nn.Conv2d(32, 1, 1)\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv1(x)))\n        out = torch.tanh(self.conv2(out))  # Cada punto de -1 a +1\n        return out.view(out.size(0), -1)  # Aplanar a 361\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Formato de salida"}),": Vector de 361 dimensiones, cada valor en [-1, +1]"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"+1: Ese punto pertenece al territorio propio"}),"\n",(0,i.jsx)(n.li,{children:"-1: Ese punto pertenece al territorio del oponente"}),"\n",(0,i.jsx)(n.li,{children:"0: Zona neutral o disputada"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"diferencias-con-alphazero",children:"Diferencias con AlphaZero"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Aspecto"}),(0,i.jsx)(n.th,{children:"AlphaZero"}),(0,i.jsx)(n.th,{children:"KataGo"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Cabezas de salida"})}),(0,i.jsx)(n.td,{children:"2 (Policy + Value)"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"4"})," (+ Score + Ownership)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Pooling global"})}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"S\xed"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Caracter\xedsticas de entrada"})}),(0,i.jsx)(n.td,{children:"17 planos"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"22 planos"})," (con codificaci\xf3n de reglas)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Bloques residuales"})}),(0,i.jsx)(n.td,{children:"ResNet est\xe1ndar"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Pre-activation + pooling global"})})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Soporte multi-reglas"})}),(0,i.jsx)(n.td,{children:"No"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.strong,{children:"S\xed"})," (a trav\xe9s de codificaci\xf3n de caracter\xedsticas)"]})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"escala-del-modelo",children:"Escala del modelo"}),"\n",(0,i.jsx)(n.p,{children:"KataGo ofrece modelos de diferentes escalas:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Modelo"}),(0,i.jsx)(n.th,{children:"Bloques res."}),(0,i.jsx)(n.th,{children:"Canales"}),(0,i.jsx)(n.th,{children:"Par\xe1metros"}),(0,i.jsx)(n.th,{children:"Escenario de uso"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"b10c128"}),(0,i.jsx)(n.td,{children:"10"}),(0,i.jsx)(n.td,{children:"128"}),(0,i.jsx)(n.td,{children:"~5M"}),(0,i.jsx)(n.td,{children:"CPU, pruebas r\xe1pidas"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"b18c384"}),(0,i.jsx)(n.td,{children:"18"}),(0,i.jsx)(n.td,{children:"384"}),(0,i.jsx)(n.td,{children:"~75M"}),(0,i.jsx)(n.td,{children:"GPU general"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"b40c256"}),(0,i.jsx)(n.td,{children:"40"}),(0,i.jsx)(n.td,{children:"256"}),(0,i.jsx)(n.td,{children:"~95M"}),(0,i.jsx)(n.td,{children:"GPU de gama alta"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"b60c320"}),(0,i.jsx)(n.td,{children:"60"}),(0,i.jsx)(n.td,{children:"320"}),(0,i.jsx)(n.td,{children:"~200M"}),(0,i.jsx)(n.td,{children:"GPU de alta gama"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Convenci\xf3n de nomenclatura"}),": ",(0,i.jsx)(n.code,{children:"b{n\xfamero de bloques residuales}c{n\xfamero de canales}"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"implementaci\xf3n-completa-de-la-red",children:"Implementaci\xf3n completa de la red"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"class KataGoNetwork(nn.Module):\n    def __init__(self, num_blocks=18, channels=384):\n        super().__init__()\n\n        # Convoluci\xf3n inicial\n        self.initial_conv = nn.Conv2d(22, channels, 3, padding=1)\n        self.initial_bn = nn.BatchNorm2d(channels)\n\n        # Torre residual\n        self.residual_blocks = nn.ModuleList([\n            ResidualBlock(channels) for _ in range(num_blocks)\n        ])\n\n        # Bloques de pooling global (insertar uno cada varios bloques residuales)\n        self.global_pooling_blocks = nn.ModuleList([\n            GlobalPoolingBlock(channels) for _ in range(num_blocks // 6)\n        ])\n\n        # Cabezas de salida\n        self.policy_head = PolicyHead(channels)\n        self.value_head = ValueHead(channels)\n        self.score_head = ScoreHead(channels)\n        self.ownership_head = OwnershipHead(channels)\n\n    def forward(self, x):\n        # Convoluci\xf3n inicial\n        out = F.relu(self.initial_bn(self.initial_conv(x)))\n\n        # Torre residual\n        gp_idx = 0\n        for i, block in enumerate(self.residual_blocks):\n            out = block(out)\n\n            # Insertar pooling global despu\xe9s de cada 6 bloques residuales\n            if (i + 1) % 6 == 0 and gp_idx < len(self.global_pooling_blocks):\n                out = self.global_pooling_blocks[gp_idx](out)\n                gp_idx += 1\n\n        # Cabezas de salida\n        policy = self.policy_head(out)\n        value = self.value_head(out)\n        score = self.score_head(out)\n        ownership = self.ownership_head(out)\n\n        return {\n            'policy': policy,\n            'value': value,\n            'score': score,\n            'ownership': ownership\n        }\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"lectura-adicional",children:"Lectura adicional"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../mcts-implementation",children:"Detalles de implementaci\xf3n de MCTS"})," \u2014 Combinaci\xf3n de b\xfasqueda y red neuronal"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../training",children:"An\xe1lisis del mecanismo de entrenamiento de KataGo"})," \u2014 C\xf3mo se entrena la red"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../papers",children:"Gu\xeda de art\xedculos clave"})," \u2014 Derivaciones matem\xe1ticas de los art\xedculos originales"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(t,{...e})}):t(e)}},30416(e,n,a){a.d(n,{R:()=>s,x:()=>r});var l=a(59471);const i={},d=l.createContext(i);function s(e){const n=l.useContext(d);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),l.createElement(d.Provider,{value:n},e.children)}}}]);