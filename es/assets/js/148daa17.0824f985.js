"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[4366],{66762(e,n,a){a.r(n),a.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>h,frontMatter:()=>o,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"tech/deep-dive/training","title":"An\xe1lisis del mecanismo de entrenamiento de KataGo","description":"Comprender en profundidad el flujo de entrenamiento de auto-juego y las t\xe9cnicas centrales de KataGo","source":"@site/i18n/es/docusaurus-plugin-content-docs/current/tech/deep-dive/training.md","sourceDirName":"tech/deep-dive","slug":"/tech/deep-dive/training","permalink":"/es/docs/tech/deep-dive/training","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tech/deep-dive/training.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"An\xe1lisis del mecanismo de entrenamiento de KataGo","description":"Comprender en profundidad el flujo de entrenamiento de auto-juego y las t\xe9cnicas centrales de KataGo"},"sidebar":"tutorialSidebar","previous":{"title":"Guia del codigo fuente de KataGo","permalink":"/es/docs/tech/deep-dive/source-code"},"next":{"title":"Participar en la comunidad de codigo abierto","permalink":"/es/docs/tech/deep-dive/contributing"}}');var i=a(62615),d=a(30416);const o={sidebar_position:3,title:"An\xe1lisis del mecanismo de entrenamiento de KataGo",description:"Comprender en profundidad el flujo de entrenamiento de auto-juego y las t\xe9cnicas centrales de KataGo"},s="An\xe1lisis del mecanismo de entrenamiento de KataGo",l={},t=[{value:"Visi\xf3n general del entrenamiento",id:"visi\xf3n-general-del-entrenamiento",level:2},{value:"Ciclo de entrenamiento",id:"ciclo-de-entrenamiento",level:3},{value:"Requisitos de hardware",id:"requisitos-de-hardware",level:3},{value:"Configuraci\xf3n del entorno",id:"configuraci\xf3n-del-entorno",level:2},{value:"Instalar dependencias",id:"instalar-dependencias",level:3},{value:"Obtener el c\xf3digo de entrenamiento",id:"obtener-el-c\xf3digo-de-entrenamiento",level:3},{value:"Configuraci\xf3n de entrenamiento",id:"configuraci\xf3n-de-entrenamiento",level:2},{value:"Estructura del archivo de configuraci\xf3n",id:"estructura-del-archivo-de-configuraci\xf3n",level:3},{value:"Referencia de escalas de modelo",id:"referencia-de-escalas-de-modelo",level:3},{value:"Flujo de entrenamiento",id:"flujo-de-entrenamiento",level:2},{value:"Paso 1: Inicializar el modelo",id:"paso-1-inicializar-el-modelo",level:3},{value:"Paso 2: Generar datos con auto-juego",id:"paso-2-generar-datos-con-auto-juego",level:3},{value:"Paso 3: Entrenar la red neuronal",id:"paso-3-entrenar-la-red-neuronal",level:3},{value:"Paso 4: Evaluar e iterar",id:"paso-4-evaluar-e-iterar",level:3},{value:"Detalle de funciones de p\xe9rdida",id:"detalle-de-funciones-de-p\xe9rdida",level:2},{value:"Policy Loss",id:"policy-loss",level:3},{value:"Value Loss",id:"value-loss",level:3},{value:"Ownership Loss",id:"ownership-loss",level:3},{value:"T\xe9cnicas avanzadas",id:"t\xe9cnicas-avanzadas",level:2},{value:"1. Aumento de datos",id:"1-aumento-de-datos",level:3},{value:"2. Aprendizaje por curr\xedculum",id:"2-aprendizaje-por-curr\xedculum",level:3},{value:"3. Entrenamiento de precisi\xf3n mixta",id:"3-entrenamiento-de-precisi\xf3n-mixta",level:3},{value:"4. Entrenamiento multi-GPU",id:"4-entrenamiento-multi-gpu",level:3},{value:"Monitoreo y depuraci\xf3n",id:"monitoreo-y-depuraci\xf3n",level:2},{value:"Monitoreo con TensorBoard",id:"monitoreo-con-tensorboard",level:3},{value:"Problemas comunes",id:"problemas-comunes",level:3},{value:"Sugerencias para experimentos a peque\xf1a escala",id:"sugerencias-para-experimentos-a-peque\xf1a-escala",level:2},{value:"Lectura adicional",id:"lectura-adicional",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"an\xe1lisis-del-mecanismo-de-entrenamiento-de-katago",children:"An\xe1lisis del mecanismo de entrenamiento de KataGo"})}),"\n",(0,i.jsx)(n.p,{children:"Este art\xedculo analiza en profundidad el mecanismo de entrenamiento de KataGo, ayud\xe1ndote a comprender el principio de funcionamiento del entrenamiento por auto-juego."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"visi\xf3n-general-del-entrenamiento",children:"Visi\xf3n general del entrenamiento"}),"\n",(0,i.jsx)(n.h3,{id:"ciclo-de-entrenamiento",children:"Ciclo de entrenamiento"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"Modelo inicial \u2192 Auto-juego \u2192 Recopilar datos \u2192 Actualizar entrenamiento \u2192 Modelo m\xe1s fuerte \u2192 Repetir\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Correspondencia con animaciones"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"E5 Auto-juego \u2194 Convergencia al punto fijo"}),"\n",(0,i.jsx)(n.li,{children:"E6 Curva de fuerza \u2194 Crecimiento en curva S"}),"\n",(0,i.jsx)(n.li,{children:"H1 MDP \u2194 Cadena de Markov"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"requisitos-de-hardware",children:"Requisitos de hardware"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Escala del modelo"}),(0,i.jsx)(n.th,{children:"Memoria GPU"}),(0,i.jsx)(n.th,{children:"Tiempo de entrenamiento"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"b6c96"}),(0,i.jsx)(n.td,{children:"4 GB"}),(0,i.jsx)(n.td,{children:"Varias horas"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"b10c128"}),(0,i.jsx)(n.td,{children:"8 GB"}),(0,i.jsx)(n.td,{children:"1-2 d\xedas"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"b18c384"}),(0,i.jsx)(n.td,{children:"16 GB"}),(0,i.jsx)(n.td,{children:"1-2 semanas"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"b40c256"}),(0,i.jsx)(n.td,{children:"24 GB+"}),(0,i.jsx)(n.td,{children:"Varias semanas"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"configuraci\xf3n-del-entorno",children:"Configuraci\xf3n del entorno"}),"\n",(0,i.jsx)(n.h3,{id:"instalar-dependencias",children:"Instalar dependencias"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Entorno Python\nconda create -n katago python=3.10\nconda activate katago\n\n# PyTorch (versi\xf3n CUDA)\npip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118\n\n# Otras dependencias\npip install numpy h5py tqdm tensorboard\n"})}),"\n",(0,i.jsx)(n.h3,{id:"obtener-el-c\xf3digo-de-entrenamiento",children:"Obtener el c\xf3digo de entrenamiento"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/lightvector/KataGo.git\ncd KataGo/python\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"configuraci\xf3n-de-entrenamiento",children:"Configuraci\xf3n de entrenamiento"}),"\n",(0,i.jsx)(n.h3,{id:"estructura-del-archivo-de-configuraci\xf3n",children:"Estructura del archivo de configuraci\xf3n"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'# configs/train_config.yaml\n\n# Arquitectura del modelo\nmodel:\n  num_blocks: 10          # N\xfamero de bloques residuales\n  trunk_channels: 128     # N\xfamero de canales del tronco\n  policy_channels: 32     # Canales de la cabeza Policy\n  value_channels: 32      # Canales de la cabeza Value\n\n# Par\xe1metros de entrenamiento\ntraining:\n  batch_size: 256\n  learning_rate: 0.001\n  lr_schedule: "cosine"\n  weight_decay: 0.0001\n  epochs: 100\n\n# Par\xe1metros de auto-juego\nselfplay:\n  num_games_per_iteration: 1000\n  max_visits: 600\n  temperature: 1.0\n  temperature_drop_move: 20\n\n# Configuraci\xf3n de datos\ndata:\n  max_history_games: 500000\n  shuffle_buffer_size: 100000\n'})}),"\n",(0,i.jsx)(n.h3,{id:"referencia-de-escalas-de-modelo",children:"Referencia de escalas de modelo"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Nombre"}),(0,i.jsx)(n.th,{children:"num_blocks"}),(0,i.jsx)(n.th,{children:"trunk_channels"}),(0,i.jsx)(n.th,{children:"Par\xe1metros"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"b6c96"}),(0,i.jsx)(n.td,{children:"6"}),(0,i.jsx)(n.td,{children:"96"}),(0,i.jsx)(n.td,{children:"~1M"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"b10c128"}),(0,i.jsx)(n.td,{children:"10"}),(0,i.jsx)(n.td,{children:"128"}),(0,i.jsx)(n.td,{children:"~3M"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"b18c384"}),(0,i.jsx)(n.td,{children:"18"}),(0,i.jsx)(n.td,{children:"384"}),(0,i.jsx)(n.td,{children:"~20M"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"b40c256"}),(0,i.jsx)(n.td,{children:"40"}),(0,i.jsx)(n.td,{children:"256"}),(0,i.jsx)(n.td,{children:"~45M"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Correspondencia con animaciones"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"F2 Tama\xf1o de red vs fuerza: Escalado de capacidad"}),"\n",(0,i.jsx)(n.li,{children:"F6 Leyes de escalado neuronal: Relaci\xf3n log-log"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"flujo-de-entrenamiento",children:"Flujo de entrenamiento"}),"\n",(0,i.jsx)(n.h3,{id:"paso-1-inicializar-el-modelo",children:"Paso 1: Inicializar el modelo"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# init_model.py\nimport torch\nfrom model import KataGoModel\n\nconfig = {\n    'num_blocks': 10,\n    'trunk_channels': 128,\n    'input_features': 22,\n    'policy_size': 362,  # 361 + pass\n}\n\nmodel = KataGoModel(config)\ntorch.save(model.state_dict(), 'model_init.pt')\nprint(f\"Par\xe1metros del modelo: {sum(p.numel() for p in model.parameters()):,}\")\n"})}),"\n",(0,i.jsx)(n.h3,{id:"paso-2-generar-datos-con-auto-juego",children:"Paso 2: Generar datos con auto-juego"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Compilar el motor C++\ncd ../cpp\nmkdir build && cd build\ncmake .. -DUSE_BACKEND=CUDA\nmake -j$(nproc)\n\n# Ejecutar auto-juego\n./katago selfplay \\\n  -model ../python/model_init.pt \\\n  -output-dir ../python/selfplay_data \\\n  -config selfplay.cfg \\\n  -num-games 1000\n"})}),"\n",(0,i.jsx)(n.p,{children:"Configuraci\xf3n de auto-juego (selfplay.cfg):"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-ini",children:"maxVisits = 600\nnumSearchThreads = 4\n\n# Configuraci\xf3n de temperatura (aumentar exploraci\xf3n)\nchosenMoveTemperature = 1.0\nchosenMoveTemperatureEarly = 1.0\nchosenMoveTemperatureHalflife = 20\n\n# Ruido de Dirichlet (aumentar diversidad)\nrootNoiseEnabled = true\nrootDirichletNoiseTotalConcentration = 10.83\nrootDirichletNoiseWeight = 0.25\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Correspondencia con animaciones"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"C3 Exploraci\xf3n vs explotaci\xf3n: Par\xe1metro de temperatura"}),"\n",(0,i.jsx)(n.li,{children:"E10 Ruido de Dirichlet: Exploraci\xf3n del nodo ra\xedz"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"paso-3-entrenar-la-red-neuronal",children:"Paso 3: Entrenar la red neuronal"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# train.py\nimport torch\nfrom torch.utils.data import DataLoader\nfrom model import KataGoModel\nfrom dataset import SelfPlayDataset\n\n# Cargar datos\ndataset = SelfPlayDataset('selfplay_data/')\ndataloader = DataLoader(dataset, batch_size=256, shuffle=True)\n\n# Cargar modelo\nmodel = KataGoModel(config)\nmodel.load_state_dict(torch.load('model_init.pt'))\nmodel = model.cuda()\n\n# Optimizador\noptimizer = torch.optim.Adam(\n    model.parameters(),\n    lr=0.001,\n    weight_decay=0.0001\n)\n\n# Programador de tasa de aprendizaje\nscheduler = torch.optim.lr_scheduler.CosineAnnealingLR(\n    optimizer,\n    T_max=100,\n    eta_min=0.00001\n)\n\n# Ciclo de entrenamiento\nfor epoch in range(100):\n    model.train()\n    total_loss = 0\n\n    for batch in dataloader:\n        inputs = batch['inputs'].cuda()\n        policy_target = batch['policy'].cuda()\n        value_target = batch['value'].cuda()\n        ownership_target = batch['ownership'].cuda()\n\n        # Propagaci\xf3n hacia adelante\n        policy_pred, value_pred, ownership_pred = model(inputs)\n\n        # Calcular p\xe9rdida\n        policy_loss = torch.nn.functional.cross_entropy(\n            policy_pred, policy_target\n        )\n        value_loss = torch.nn.functional.mse_loss(\n            value_pred, value_target\n        )\n        ownership_loss = torch.nn.functional.mse_loss(\n            ownership_pred, ownership_target\n        )\n\n        loss = policy_loss + value_loss + 0.5 * ownership_loss\n\n        # Retropropagaci\xf3n\n        optimizer.zero_grad()\n        loss.backward()\n        torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)\n        optimizer.step()\n\n        total_loss += loss.item()\n\n    scheduler.step()\n    print(f\"Epoch {epoch}: Loss = {total_loss / len(dataloader):.4f}\")\n\n    # Guardar checkpoint\n    torch.save(model.state_dict(), f'model_epoch{epoch}.pt')\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Correspondencia con animaciones"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"D5 Descenso de gradiente: optimizer.step()"}),"\n",(0,i.jsx)(n.li,{children:"K2 Momentum: Optimizador Adam"}),"\n",(0,i.jsx)(n.li,{children:"K4 Decaimiento de tasa de aprendizaje: CosineAnnealingLR"}),"\n",(0,i.jsx)(n.li,{children:"K5 Recorte de gradiente: clip_grad_norm_"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"paso-4-evaluar-e-iterar",children:"Paso 4: Evaluar e iterar"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Evaluar nuevo modelo vs modelo anterior\n./katago match \\\n  -model1 model_epoch99.pt \\\n  -model2 model_init.pt \\\n  -num-games 100 \\\n  -output match_results.txt\n"})}),"\n",(0,i.jsx)(n.p,{children:"Si el nuevo modelo tiene una tasa de victoria > 55%, reemplaza al modelo anterior y pasa a la siguiente iteraci\xf3n."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"detalle-de-funciones-de-p\xe9rdida",children:"Detalle de funciones de p\xe9rdida"}),"\n",(0,i.jsx)(n.h3,{id:"policy-loss",children:"Policy Loss"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# P\xe9rdida de entrop\xeda cruzada\npolicy_loss = -sum(target * log(pred))\n"})}),"\n",(0,i.jsx)(n.p,{children:"Objetivo: Hacer que la distribuci\xf3n de probabilidad predicha se acerque al resultado de b\xfasqueda MCTS."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Correspondencia con animaciones"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"J1 Entrop\xeda de pol\xedtica: Entrop\xeda cruzada"}),"\n",(0,i.jsx)(n.li,{children:"J2 Divergencia KL: Distancia entre distribuciones"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"value-loss",children:"Value Loss"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Error cuadr\xe1tico medio\nvalue_loss = (pred - actual_result)^2\n"})}),"\n",(0,i.jsx)(n.p,{children:"Objetivo: Predecir el resultado final del juego (victoria/derrota/empate)."}),"\n",(0,i.jsx)(n.h3,{id:"ownership-loss",children:"Ownership Loss"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Predicci\xf3n de propiedad por punto\nownership_loss = mean((pred - actual_ownership)^2)\n"})}),"\n",(0,i.jsx)(n.p,{children:"Objetivo: Predecir la propiedad final de cada posici\xf3n."}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"t\xe9cnicas-avanzadas",children:"T\xe9cnicas avanzadas"}),"\n",(0,i.jsx)(n.h3,{id:"1-aumento-de-datos",children:"1. Aumento de datos"}),"\n",(0,i.jsx)(n.p,{children:"Aprovechar la simetr\xeda del tablero:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'def augment_data(board, policy, ownership):\n    """Aumento de datos para las 8 transformaciones del grupo D4"""\n    augmented = []\n\n    for rotation in range(4):\n        for flip in [False, True]:\n            # Rotaci\xf3n y volteo\n            aug_board = transform(board, rotation, flip)\n            aug_policy = transform(policy, rotation, flip)\n            aug_ownership = transform(ownership, rotation, flip)\n            augmented.append((aug_board, aug_policy, aug_ownership))\n\n    return augmented\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Correspondencia con animaciones"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"A9 Simetr\xeda del tablero: Grupo D4"}),"\n",(0,i.jsx)(n.li,{children:"L4 Aumento de datos: Uso de simetr\xeda"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"2-aprendizaje-por-curr\xedculum",children:"2. Aprendizaje por curr\xedculum"}),"\n",(0,i.jsx)(n.p,{children:"De simple a complejo:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Primero entrenar con menos b\xfasquedas\nschedule = [\n    (100, 10000),   # 100 visitas, 10000 partidas\n    (200, 20000),   # 200 visitas, 20000 partidas\n    (400, 50000),   # 400 visitas, 50000 partidas\n    (600, 100000),  # 600 visitas, 100000 partidas\n]\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Correspondencia con animaciones"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"E12 Curr\xedculum de entrenamiento: Aprendizaje por curr\xedculum"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"3-entrenamiento-de-precisi\xf3n-mixta",children:"3. Entrenamiento de precisi\xf3n mixta"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from torch.cuda.amp import autocast, GradScaler\n\nscaler = GradScaler()\n\nwith autocast():\n    policy_pred, value_pred, ownership_pred = model(inputs)\n    loss = compute_loss(...)\n\nscaler.scale(loss).backward()\nscaler.step(optimizer)\nscaler.update()\n"})}),"\n",(0,i.jsx)(n.h3,{id:"4-entrenamiento-multi-gpu",children:"4. Entrenamiento multi-GPU"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"import torch.distributed as dist\nfrom torch.nn.parallel import DistributedDataParallel\n\n# Inicializar distribuido\ndist.init_process_group(backend='nccl')\n\n# Envolver el modelo\nmodel = DistributedDataParallel(model)\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"monitoreo-y-depuraci\xf3n",children:"Monitoreo y depuraci\xf3n"}),"\n",(0,i.jsx)(n.h3,{id:"monitoreo-con-tensorboard",children:"Monitoreo con TensorBoard"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from torch.utils.tensorboard import SummaryWriter\n\nwriter = SummaryWriter('runs/training')\n\n# Registrar p\xe9rdida\nwriter.add_scalar('Loss/policy', policy_loss, step)\nwriter.add_scalar('Loss/value', value_loss, step)\nwriter.add_scalar('Loss/total', total_loss, step)\n\n# Registrar tasa de aprendizaje\nwriter.add_scalar('LR', scheduler.get_last_lr()[0], step)\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"tensorboard --logdir runs\n"})}),"\n",(0,i.jsx)(n.h3,{id:"problemas-comunes",children:"Problemas comunes"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Problema"}),(0,i.jsx)(n.th,{children:"Posible causa"}),(0,i.jsx)(n.th,{children:"Soluci\xf3n"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"La p\xe9rdida no baja"}),(0,i.jsx)(n.td,{children:"Tasa de aprendizaje muy baja/alta"}),(0,i.jsx)(n.td,{children:"Ajustar tasa de aprendizaje"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"La p\xe9rdida oscila"}),(0,i.jsx)(n.td,{children:"Tama\xf1o de lote muy peque\xf1o"}),(0,i.jsx)(n.td,{children:"Aumentar tama\xf1o de lote"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"Sobreajuste"}),(0,i.jsx)(n.td,{children:"Datos insuficientes"}),(0,i.jsx)(n.td,{children:"Generar m\xe1s datos de auto-juego"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:"La fuerza no aumenta"}),(0,i.jsx)(n.td,{children:"Muy pocas b\xfasquedas"}),(0,i.jsx)(n.td,{children:"Aumentar maxVisits"})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Correspondencia con animaciones"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"L1 Sobreajuste: Sobre-adaptaci\xf3n"}),"\n",(0,i.jsx)(n.li,{children:"L2 Regularizaci\xf3n: weight_decay"}),"\n",(0,i.jsx)(n.li,{children:"D6 Efecto de tasa de aprendizaje: Ajuste de par\xe1metros"}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"sugerencias-para-experimentos-a-peque\xf1a-escala",children:"Sugerencias para experimentos a peque\xf1a escala"}),"\n",(0,i.jsx)(n.p,{children:"Si solo quieres experimentar, se recomienda:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Usar tablero 9\xd79"}),": Reduce significativamente el c\xe1lculo"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Usar modelo peque\xf1o"}),": b6c96 es suficiente para experimentar"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Reducir n\xfamero de b\xfasquedas"}),": 100-200 visitas"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Ajustar modelo pre-entrenado"}),": M\xe1s r\xe1pido que empezar desde cero"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Configuraci\xf3n para tablero 9\xd79\nboardSize = 9\nmaxVisits = 100\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"lectura-adicional",children:"Lectura adicional"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../source-code",children:"Gu\xeda del c\xf3digo fuente"})," \u2014 Entender la estructura del c\xf3digo"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../contributing",children:"Participar en la comunidad de c\xf3digo abierto"})," \u2014 Unirse al entrenamiento distribuido"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.a,{href:"../../how-it-works/katago-innovations",children:"Innovaciones clave de KataGo"})," \u2014 El secreto de la eficiencia 50x"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},30416(e,n,a){a.d(n,{R:()=>o,x:()=>s});var r=a(59471);const i={},d=r.createContext(i);function o(e){const n=r.useContext(d);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),r.createElement(d.Provider,{value:n},e.children)}}}]);