<!doctype html>
<html lang="zh-hk" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-alphago/explained/policy-network" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Policy Network 詳解 | 好棋寶寶協會 | Weiqi.Kids</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.weiqi.kids/zh-hk/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://www.weiqi.kids/zh-hk/img/social-card.png"><meta data-rh="true" property="og:url" content="https://www.weiqi.kids/zh-hk/docs/alphago/explained/policy-network/"><meta data-rh="true" property="og:locale" content="zh_hk"><meta data-rh="true" property="og:locale:alternate" content="zh_tw"><meta data-rh="true" property="og:locale:alternate" content="zh_cn"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" property="og:locale:alternate" content="ja"><meta data-rh="true" property="og:locale:alternate" content="ko"><meta data-rh="true" property="og:locale:alternate" content="es"><meta data-rh="true" property="og:locale:alternate" content="pt"><meta data-rh="true" property="og:locale:alternate" content="hi"><meta data-rh="true" property="og:locale:alternate" content="id"><meta data-rh="true" property="og:locale:alternate" content="ar"><meta data-rh="true" name="docusaurus_locale" content="zh-hk"><meta data-rh="true" name="docsearch:language" content="zh-hk"><meta data-rh="true" name="keywords" content="圍棋, Go, 好棋寶寶, AI, KataGo, AlphaGo, 圍棋教學, 圍棋入門"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Policy Network 詳解 | 好棋寶寶協會 | Weiqi.Kids"><meta data-rh="true" name="description" content="深入理解 AlphaGo 嘅策略網絡架構、訓練方法同實際應用，由 13 層卷積到 Softmax 輸出"><meta data-rh="true" property="og:description" content="深入理解 AlphaGo 嘅策略網絡架構、訓練方法同實際應用，由 13 層卷積到 Softmax 輸出"><link data-rh="true" rel="icon" href="/zh-hk/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.weiqi.kids/zh-hk/docs/alphago/explained/policy-network/"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/docs/alphago/explained/policy-network/" hreflang="zh-tw"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/zh-cn/docs/alphago/explained/policy-network/" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/zh-hk/docs/alphago/explained/policy-network/" hreflang="zh-hk"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/en/docs/alphago/explained/policy-network/" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/ja/docs/alphago/explained/policy-network/" hreflang="ja"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/ko/docs/alphago/explained/policy-network/" hreflang="ko"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/es/docs/alphago/explained/policy-network/" hreflang="es"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/pt/docs/alphago/explained/policy-network/" hreflang="pt"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/hi/docs/alphago/explained/policy-network/" hreflang="hi"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/id/docs/alphago/explained/policy-network/" hreflang="id"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/ar/docs/alphago/explained/policy-network/" hreflang="ar"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/docs/alphago/explained/policy-network/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://www.weiqi.kids#organization","name":"台灣好棋寶寶協會","alternateName":"Taiwan Good Go Baby Association","url":"https://www.weiqi.kids","logo":{"@type":"ImageObject","url":"https://www.weiqi.kids/img/logo.svg","width":200,"height":200},"sameAs":["https://mastodon.weiqi.kids/","https://peertube.weiqi.kids/"],"contactPoint":{"@type":"ContactPoint","contactType":"customer service","url":"https://www.weiqi.kids/docs/aboutus"},"description":"推動圍棋文化與 AI 研究的台灣非營利組織"},{"@type":"WebSite","@id":"https://www.weiqi.kids#website","name":"好棋寶寶協會官網","url":"https://www.weiqi.kids","publisher":{"@id":"https://www.weiqi.kids#organization"},"inLanguage":["zh-TW","zh-CN","zh-HK","en","ja","ko","es","pt","hi","id","ar"],"potentialAction":{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.weiqi.kids/search?q={search_term_string}"},"query-input":"required name=search_term_string"}}]}</script><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"AlphaGo","item":"https://www.weiqi.kids/zh-hk/docs/alphago/"},{"@type":"ListItem","position":2,"name":"完整解析","item":"https://www.weiqi.kids/zh-hk/docs/alphago/explained/"},{"@type":"ListItem","position":3,"name":"Policy Network 詳解","item":"https://www.weiqi.kids/zh-hk/docs/alphago/explained/policy-network"}]}</script><meta property="og:type" content="website">
<meta property="og:site_name" content="好棋寶寶協會">
<meta name="twitter:card" content="summary_large_image">
<meta name="robots" content="index, follow">
<meta name="author" content="台灣好棋寶寶協會">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/zh-hk/assets/css/styles.f23bf74b.css">
<script src="/zh-hk/assets/js/runtime~main.e18e6d10.js" defer="defer"></script>
<script src="/zh-hk/assets/js/main.1906dfd9.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/zh-hk/img/logo.svg"><div role="region" aria-label="跳至主要内容"><a class="skipToContent_WWLT" href="#__docusaurus_skipToContent_fallback">跳至主要内容</a></div><nav aria-label="主導航" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="切換導覽列" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-hk/"><div class="navbar__logo"><img src="/zh-hk/img/logo.svg" alt="好棋寶寶協會標誌" class="themedComponent_rBb5 themedComponent--light_t3c2"><img src="/zh-hk/img/logo.svg" alt="好棋寶寶協會標誌" class="themedComponent_rBb5 themedComponent--dark_Z76H"></div><b class="navbar__title text--truncate">圍棋寶寶</b></a><a class="navbar__item navbar__link" href="/zh-hk/docs/learn/">學圍棋</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/zh-hk/docs/alphago/">AlphaGo</a><a class="navbar__item navbar__link" href="/zh-hk/docs/animations/">動畫教室</a><a class="navbar__item navbar__link" href="/zh-hk/docs/tech/">技術文件</a><a class="navbar__item navbar__link" href="/zh-hk/docs/about/">關於我哋</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link navbar__item--compact"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_LXmZ"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>粵語（香港）</a><ul class="dropdown__menu"><li><a href="/docs/alphago/explained/policy-network/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-tw">繁體中文</a></li><li><a href="/zh-cn/docs/alphago/explained/policy-network/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-cn">简体中文</a></li><li><a href="/zh-hk/docs/alphago/explained/policy-network/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="zh-hk">粵語（香港）</a></li><li><a href="/en/docs/alphago/explained/policy-network/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/ja/docs/alphago/explained/policy-network/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li><li><a href="/ko/docs/alphago/explained/policy-network/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ko">한국어</a></li><li><a href="/es/docs/alphago/explained/policy-network/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="/pt/docs/alphago/explained/policy-network/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">Português</a></li><li><a href="/hi/docs/alphago/explained/policy-network/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="hi">हिन्दी</a></li><li><a href="/id/docs/alphago/explained/policy-network/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="id">Bahasa Indonesia</a></li><li><a href="/ar/docs/alphago/explained/policy-network/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ar">العربية</a></li></ul></div><a href="https://github.com/weiqi-kids/www.weiqi.kids" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link navbar__item--compact" aria-label="GitHub"></a><div class="navbarSearchContainer_MDM0"><div class="navbar__search searchBarContainer_Qpyg" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_KBva" value=""><div class="loadingRing_riNO searchBarLoadingRing_XquT"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_SQvo"><div class="docsWrapper_HjTU"><button aria-label="回到頂部" class="clean-btn theme-back-to-top-button backToTopButton_91RE" type="button"></button><div class="docRoot_SzOB"><aside class="theme-doc-sidebar-container docSidebarContainer_Q0cb"><div class="sidebarViewport_TEb6"><div class="sidebar_LiQ3"><nav aria-label="文件側邊欄" class="menu thin-scrollbar menu_iDgU"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-hk/docs/intro/"><span title="使用指南" class="linkLabel_REp1">使用指南</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_nItb menu__link menu__link--sublist" href="/zh-hk/docs/learn/"><span title="學圍棋" class="categoryLinkLabel_ezQx">學圍棋</span></a><button aria-label="展開側邊欄分類 &#x27;學圍棋&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_nItb menu__link menu__link--sublist menu__link--active" href="/zh-hk/docs/alphago/"><span title="AlphaGo" class="categoryLinkLabel_ezQx">AlphaGo</span></a><button aria-label="收起側邊欄分類 &#x27;AlphaGo&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_nItb menu__link menu__link--sublist menu__link--active" tabindex="0" href="/zh-hk/docs/alphago/explained/"><span title="完整解析" class="categoryLinkLabel_ezQx">完整解析</span></a><button aria-label="收起側邊欄分類 &#x27;完整解析&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/birth-of-alphago/"><span title="AlphaGo 嘅誕生" class="linkLabel_REp1">AlphaGo 嘅誕生</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/key-matches/"><span title="關鍵對局回顧" class="linkLabel_REp1">關鍵對局回顧</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/move-37/"><span title="「神之一手」深度分析" class="linkLabel_REp1">「神之一手」深度分析</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/why-go-is-hard/"><span title="圍棋為甚麼難？" class="linkLabel_REp1">圍棋為甚麼難？</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/traditional-limits/"><span title="傳統方法的極限" class="linkLabel_REp1">傳統方法的極限</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/board-representation/"><span title="棋盤狀態表示" class="linkLabel_REp1">棋盤狀態表示</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-hk/docs/alphago/explained/policy-network/"><span title="Policy Network 詳解" class="linkLabel_REp1">Policy Network 詳解</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/value-network/"><span title="Value Network 詳解" class="linkLabel_REp1">Value Network 詳解</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/input-features/"><span title="輸入特徵設計" class="linkLabel_REp1">輸入特徵設計</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/cnn-and-go/"><span title="CNN 與圍棋嘅結合" class="linkLabel_REp1">CNN 與圍棋嘅結合</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/supervised-learning/"><span title="監督學習階段" class="linkLabel_REp1">監督學習階段</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/reinforcement-intro/"><span title="強化學習入門" class="linkLabel_REp1">強化學習入門</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/self-play/"><span title="自我對弈" class="linkLabel_REp1">自我對弈</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/mcts-neural-combo/"><span title="MCTS 與神經網絡嘅結合" class="linkLabel_REp1">MCTS 與神經網絡嘅結合</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/puct-formula/"><span title="PUCT 公式詳解" class="linkLabel_REp1">PUCT 公式詳解</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/alphago-zero/"><span title="AlphaGo Zero 概述" class="linkLabel_REp1">AlphaGo Zero 概述</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/dual-head-resnet/"><span title="雙頭網絡與殘差網絡" class="linkLabel_REp1">雙頭網絡與殘差網絡</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/training-from-scratch/"><span title="從零訓練嘅過程" class="linkLabel_REp1">從零訓練嘅過程</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/distributed-systems/"><span title="分散式系統與 TPU" class="linkLabel_REp1">分散式系統與 TPU</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-hk/docs/alphago/explained/legacy-and-impact/"><span title="AlphaGo 嘅遺產" class="linkLabel_REp1">AlphaGo 嘅遺產</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-hk/docs/animations/"><span title="動畫教室" class="linkLabel_REp1">動畫教室</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_nItb menu__link menu__link--sublist" href="/zh-hk/docs/tech/"><span title="技術文件" class="categoryLinkLabel_ezQx">技術文件</span></a><button aria-label="展開側邊欄分類 &#x27;技術文件&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_nItb menu__link menu__link--sublist" href="/zh-hk/docs/about/"><span title="關於我們" class="categoryLinkLabel_ezQx">關於我們</span></a><button aria-label="展開側邊欄分類 &#x27;關於我們&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_C0wL"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_txwF"><div class="docItemContainer_FUEM"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_DlgT" aria-label="頁面路徑"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="主頁面" class="breadcrumbs__link" href="/zh-hk/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_BMIH"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/zh-hk/docs/alphago/"><span>AlphaGo</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/zh-hk/docs/alphago/explained/"><span>完整解析</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Policy Network 詳解</span></li></ul></nav><div class="tocCollapsible_LBsY theme-doc-toc-mobile tocMobile_eMWB"><button type="button" class="clean-btn tocCollapsibleButton_fVBn">本頁導覽</button></div><div class="theme-doc-markdown markdown"><header><h1>Policy Network 詳解</h1></header>
<p>喺圍棋嘅任一局面，合法嘅下法平均有 250 種。如果畀電腦隨機揀，佢永遠都唔可能落出好棋。</p>
<p>AlphaGo 嘅突破在於：佢學識咗「望一眼棋盤，就知道邊啲位置值得考慮」。</p>
<p>呢個能力，嚟自 <strong>Policy Network（策略網絡）</strong>。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="咩係-policy-network">咩係 Policy Network？<a href="#咩係-policy-network" class="hash-link" aria-label="咩係 Policy Network？的直接連結" title="咩係 Policy Network？的直接連結" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="核心功能">核心功能<a href="#核心功能" class="hash-link" aria-label="核心功能的直接連結" title="核心功能的直接連結" translate="no">​</a></h3>
<p>Policy Network 係一個深度卷積神經網絡，佢嘅任務係：</p>
<blockquote>
<p><strong>俾定當前棋盤狀態，輸出每個位置嘅落子概率</strong></p>
</blockquote>
<p>用數學表示：</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">p = f_θ(s)</span><br></span></code></pre></div></div>
<p>其中：</p>
<ul>
<li class=""><code>s</code>：當前棋盤狀態（19×19 嘅棋盤 + 其他特徵）</li>
<li class=""><code>f_θ</code>：Policy Network（θ 係網絡參數）</li>
<li class=""><code>p</code>：361 個位置嘅概率分布（包含 pass）</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="直覺理解">直覺理解<a href="#直覺理解" class="hash-link" aria-label="直覺理解的直接連結" title="直覺理解的直接連結" translate="no">​</a></h3>
<p>想像你係一位職業棋手。當你睇到一個局面，你嘅大腦會自動「亮起」幾個重要嘅位置——呢啲係你直覺認為值得考慮嘅點。</p>
<p>Policy Network 就係喺模擬呢個過程。</p>
<div>載入中...</div>
<p>上面嘅熱力圖顯示咗 Policy Network 嘅輸出。顏色越光嘅位置，模型認為越值得落子。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="點解需要-policy-network">點解需要 Policy Network？<a href="#點解需要-policy-network" class="hash-link" aria-label="點解需要 Policy Network？的直接連結" title="點解需要 Policy Network？的直接連結" translate="no">​</a></h3>
<p>圍棋嘅搜索空間太大喇。如果唔加篩選咁搜索所有可能嘅走法：</p>
<table><thead><tr><th>策略</th><th>每步考慮嘅着法</th><th>搜索 10 步嘅節點數</th></tr></thead><tbody><tr><td>全部考慮</td><td>361</td><td>361^10 ≈ 10^25</td></tr><tr><td>Policy Network 篩選</td><td>~20</td><td>20^10 ≈ 10^13</td></tr></tbody></table>
<p>Policy Network 將搜索空間縮細咗 <strong>10^12 倍</strong>（一萬億倍）。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="網絡架構">網絡架構<a href="#網絡架構" class="hash-link" aria-label="網絡架構的直接連結" title="網絡架構的直接連結" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="整體結構">整體結構<a href="#整體結構" class="hash-link" aria-label="整體結構的直接連結" title="整體結構的直接連結" translate="no">​</a></h3>
<p>AlphaGo 嘅 Policy Network 採用深度卷積神經網絡（CNN）架構：</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">輸入層 → 卷積層 ×12 → 輸出卷積層 → Softmax</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   ↓         ↓            ↓           ↓</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">19×19×48   19×19×192   19×19×1     362 個概率</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="輸入層">輸入層<a href="#輸入層" class="hash-link" aria-label="輸入層的直接連結" title="輸入層的直接連結" translate="no">​</a></h3>
<p>輸入係 <strong>19×19×48</strong> 嘅特徵張量：</p>
<ul>
<li class=""><strong>19×19</strong>：棋盤大小</li>
<li class=""><strong>48</strong>：48 個特徵平面（詳見 <a class="" href="/zh-hk/docs/alphago/explained/input-features/">輸入特徵設計</a>）</li>
</ul>
<p>呢 48 個平面包含：</p>
<ul>
<li class="">黑子位置、白子位置</li>
<li class="">近 8 手嘅歷史</li>
<li class="">氣數、叫吃、征子等特徵</li>
<li class="">合法性（邊啲位置可以落子）</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="卷積層">卷積層<a href="#卷積層" class="hash-link" aria-label="卷積層的直接連結" title="卷積層的直接連結" translate="no">​</a></h3>
<p>網絡包含 <strong>12 層卷積層</strong>，每層嘅配置：</p>
<table><thead><tr><th>參數</th><th>數值</th><th>說明</th></tr></thead><tbody><tr><td>濾波器數量</td><td>192</td><td>每層輸出 192 個特徵圖</td></tr><tr><td>卷積核大小</td><td>3×3（第一層 5×5）</td><td>每次睇 3×3 嘅區域</td></tr><tr><td>填充方式</td><td>same</td><td>保持 19×19 嘅尺寸</td></tr><tr><td>激活函數</td><td>ReLU</td><td>max(0, x)</td></tr></tbody></table>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="點解係-192-個濾波器">點解係 192 個濾波器？<a href="#點解係-192-個濾波器" class="hash-link" aria-label="點解係 192 個濾波器？的直接連結" title="點解係 192 個濾波器？的直接連結" translate="no">​</a></h4>
<p>呢個係一個經驗值。太少會限制模型容量，太多會增加計算量同過擬合風險。DeepMind 團隊通過實驗確定 192 係一個好嘅平衡點。</p>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="點解係-33-卷積核">點解係 3×3 卷積核？<a href="#點解係-33-卷積核" class="hash-link" aria-label="點解係 3×3 卷積核？的直接連結" title="點解係 3×3 卷積核？的直接連結" translate="no">​</a></h4>
<p>3×3 係卷積神經網絡入面最常用嘅尺寸，原因：</p>
<ol>
<li class=""><strong>足夠捕捉局部模式</strong>：圍棋入面嘅眼位、接、斷等都喺 3×3 範圍內</li>
<li class=""><strong>計算效率高</strong>：相比大卷積核，3×3 參數更少</li>
<li class=""><strong>可堆疊</strong>：多層 3×3 卷積可以達到大感受野嘅效果</li>
</ol>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="第一層點解用-55">第一層點解用 5×5？<a href="#第一層點解用-55" class="hash-link" aria-label="第一層點解用 5×5？的直接連結" title="第一層點解用 5×5？的直接連結" translate="no">​</a></h4>
<p>第一層使用較大嘅 5×5 卷積核，係為咗喺輸入層就捕捉稍大範圍嘅模式（如小飛、跳）。呢個係一個設計選擇，之後嘅 AlphaGo Zero 統一使用 3×3。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="relu-激活函數">ReLU 激活函數<a href="#relu-激活函數" class="hash-link" aria-label="ReLU 激活函數的直接連結" title="ReLU 激活函數的直接連結" translate="no">​</a></h3>
<p>每個卷積層後接 ReLU（Rectified Linear Unit）激活函數：</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">ReLU(x) = max(0, x)</span><br></span></code></pre></div></div>
<p>點解用 ReLU？</p>
<ol>
<li class=""><strong>計算簡單</strong>：只係攞最大值，比 sigmoid 快好多</li>
<li class=""><strong>緩解梯度消失</strong>：正區間梯度恆為 1</li>
<li class=""><strong>稀疏激活</strong>：負值被歸零，產生稀疏表示</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="輸出層">輸出層<a href="#輸出層" class="hash-link" aria-label="輸出層的直接連結" title="輸出層的直接連結" translate="no">​</a></h3>
<p>最後一層係特殊嘅卷積層：</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">19×19×192 → 卷積(1×1, 1個濾波器) → 19×19×1 → 展平 → 362維向量 → Softmax</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="11-卷積">1×1 卷積<a href="#11-卷積" class="hash-link" aria-label="1×1 卷積的直接連結" title="1×1 卷積的直接連結" translate="no">​</a></h4>
<p>輸出層使用 1×1 卷積，將 192 個通道壓縮為 1 個。呢個等價於對每個位置嘅 192 維特徵做線性組合。</p>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="softmax-輸出">Softmax 輸出<a href="#softmax-輸出" class="hash-link" aria-label="Softmax 輸出的直接連結" title="Softmax 輸出的直接連結" translate="no">​</a></h4>
<p>362 維向量（361 個棋盤位置 + 1 個 pass）經過 Softmax 函數：</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">Softmax(z_i) = exp(z_i) / Σ_j exp(z_j)</span><br></span></code></pre></div></div>
<p>Softmax 確保輸出係合法嘅概率分布：</p>
<ul>
<li class="">所有值喺 0 到 1 之間</li>
<li class="">所有值嘅和為 1</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="參數數量">參數數量<a href="#參數數量" class="hash-link" aria-label="參數數量的直接連結" title="參數數量的直接連結" translate="no">​</a></h3>
<p>等我哋計算網絡嘅總參數量：</p>
<table><thead><tr><th>層</th><th>計算</th><th>參數數量</th></tr></thead><tbody><tr><td>第一卷積層</td><td>5×5×48×192 + 192</td><td>230,592</td></tr><tr><td>中間卷積層 ×11</td><td>(3×3×192×192 + 192) × 11</td><td>3,633,792</td></tr><tr><td>輸出卷積層</td><td>1×1×192×1 + 1</td><td>193</td></tr><tr><td><strong>總計</strong></td><td></td><td><strong>~3.9M</strong></td></tr></tbody></table>
<p>大約 <strong>390 萬個參數</strong>，以今日嘅標準嚟睇係一個細型網絡。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="訓練目標同方法">訓練目標同方法<a href="#訓練目標同方法" class="hash-link" aria-label="訓練目標同方法的直接連結" title="訓練目標同方法的直接連結" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="訓練資料">訓練資料<a href="#訓練資料" class="hash-link" aria-label="訓練資料的直接連結" title="訓練資料的直接連結" translate="no">​</a></h3>
<p>Policy Network 使用<strong>監督學習</strong>，由人類棋譜入面學習。</p>
<p>資料來源：</p>
<ul>
<li class=""><strong>KGS Go Server</strong>：業餘同職業棋手嘅對局</li>
<li class=""><strong>大約 3000 萬局面</strong>：由 16 萬局對局入面取樣</li>
<li class=""><strong>標籤</strong>：每個局面對應嘅人類下一步</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="交叉熵損失函數">交叉熵損失函數<a href="#交叉熵損失函數" class="hash-link" aria-label="交叉熵損失函數的直接連結" title="交叉熵損失函數的直接連結" translate="no">​</a></h3>
<p>訓練目標係最大化預測人類着法嘅概率。用交叉熵損失函數：</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">L(θ) = -Σ log p_θ(a | s)</span><br></span></code></pre></div></div>
<p>其中：</p>
<ul>
<li class=""><code>s</code>：棋盤狀態</li>
<li class=""><code>a</code>：人類實際落子嘅位置</li>
<li class=""><code>p_θ(a | s)</code>：模型預測該位置嘅概率</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="直覺理解-1">直覺理解<a href="#直覺理解-1" class="hash-link" aria-label="直覺理解的直接連結" title="直覺理解的直接連結" translate="no">​</a></h4>
<p>交叉熵損失有一個簡單嘅含義：</p>
<blockquote>
<p><strong>當模型預測正確位置嘅概率越高，損失越低</strong></p>
</blockquote>
<p>如果人類落喺 K10，而模型俾 K10 嘅概率係：</p>
<ul>
<li class="">0.9 → 損失 = -log(0.9) ≈ 0.1（好低，正）</li>
<li class="">0.1 → 損失 = -log(0.1) ≈ 2.3（好高，差）</li>
<li class="">0.01 → 損失 = -log(0.01) ≈ 4.6（非常高，好差）</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="訓練過程">訓練過程<a href="#訓練過程" class="hash-link" aria-label="訓練過程的直接連結" title="訓練過程的直接連結" translate="no">​</a></h3>
<div class="language-python codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-python codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 偽代碼</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> epoch </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_epochs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> batch </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> dataloader</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        states</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> batch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 前向傳播</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        policy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> network</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">states</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 361 維概率向量</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 計算損失（交叉熵）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        loss </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cross_entropy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">policy</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 反向傳播</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        loss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">backward</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        optimizer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">step</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<p>訓練細節：</p>
<ul>
<li class=""><strong>優化器</strong>：SGD with momentum</li>
<li class=""><strong>學習率</strong>：初始 0.003，逐步衰減</li>
<li class=""><strong>批次大小</strong>：16</li>
<li class=""><strong>訓練時間</strong>：大約 3 星期（50 GPUs）</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="資料增強">資料增強<a href="#資料增強" class="hash-link" aria-label="資料增強的直接連結" title="資料增強的直接連結" translate="no">​</a></h3>
<p>圍棋棋盤有 8 重對稱性（4 個旋轉 × 2 個鏡像）。每個訓練樣本可以變換為 8 個等價樣本：</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">原始 → 旋轉90° → 旋轉180° → 旋轉270°</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ↓       ↓         ↓          ↓</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">水平翻轉 → ...</span><br></span></code></pre></div></div>
<p>咁樣有效訓練資料增加 8 倍，並確保模型學到嘅模式唔依賴方向。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="訓練結果">訓練結果<a href="#訓練結果" class="hash-link" aria-label="訓練結果的直接連結" title="訓練結果的直接連結" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="57-準確率">57% 準確率<a href="#57-準確率" class="hash-link" aria-label="57% 準確率的直接連結" title="57% 準確率的直接連結" translate="no">​</a></h3>
<p>經過訓練，Policy Network 達到咗 <strong>57% 嘅 top-1 準確率</strong>。</p>
<p>呢個意味住：俾定任意局面，模型有 57% 嘅機會預測出人類專家實際落嘅嗰一步。</p>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="呢個準確率高咩">呢個準確率高咩？<a href="#呢個準確率高咩" class="hash-link" aria-label="呢個準確率高咩？的直接連結" title="呢個準確率高咩？的直接連結" translate="no">​</a></h4>
<p>考慮到每個局面平均有 250 個合法着法，隨機估嘅準確率只有 0.4%。</p>
<table><thead><tr><th>方法</th><th>Top-1 準確率</th></tr></thead><tbody><tr><td>隨機估</td><td>0.4%</td></tr><tr><td>之前最強嘅電腦圍棋</td><td>~44%</td></tr><tr><td>AlphaGo Policy Network</td><td><strong>57%</strong></td></tr></tbody></table>
<p>提升 13 個百分點，睇落唔多，但意義重大。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="棋力提升">棋力提升<a href="#棋力提升" class="hash-link" aria-label="棋力提升的直接連結" title="棋力提升的直接連結" translate="no">​</a></h3>
<p>純粹使用 Policy Network（唔加搜索）落棋，可以達到咩棋力？</p>
<table><thead><tr><th>配置</th><th>Elo 評分</th><th>大約等級</th></tr></thead><tbody><tr><td>之前最強程式（Pachi）</td><td>2,500</td><td>業餘 4-5 段</td></tr><tr><td>Policy Network alone</td><td>2,800</td><td>業餘 6-7 段</td></tr><tr><td>+ MCTS 1600 simulations</td><td>3,200+</td><td>職業水平</td></tr></tbody></table>
<p>單獨嘅 Policy Network 已經係業餘高段，加上 MCTS 之後更加躍升到職業水平。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="點解只有-57">點解只有 57%？<a href="#點解只有-57" class="hash-link" aria-label="點解只有 57%？的直接連結" title="點解只有 57%？的直接連結" translate="no">​</a></h3>
<p>人類棋譜存在以下特性，限制咗準確率：</p>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="1-多個好棋">1. 多個好棋<a href="#1-多個好棋" class="hash-link" aria-label="1. 多個好棋的直接連結" title="1. 多個好棋的直接連結" translate="no">​</a></h4>
<p>好多局面有多步都係好棋。例如「掛角」同「守角」可能都係正確選擇。模型揀咗另一步好棋，會被算作「錯誤」。</p>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="2-風格差異">2. 風格差異<a href="#2-風格差異" class="hash-link" aria-label="2. 風格差異的直接連結" title="2. 風格差異的直接連結" translate="no">​</a></h4>
<p>唔同棋手有唔同風格。激進型棋手同穩健型棋手喺同一局面可能落唔同嘅棋。模型學到嘅係「平均」嘅風格。</p>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="3-人類都會出錯">3. 人類都會出錯<a href="#3-人類都會出錯" class="hash-link" aria-label="3. 人類都會出錯的直接連結" title="3. 人類都會出錯的直接連結" translate="no">​</a></h4>
<p>KGS 資料包含業餘棋手嘅對局，佢哋嘅選擇唔一定係最佳嘅。模型學到一啲「錯誤」係正常嘅。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="喺-mcts-入面嘅作用">喺 MCTS 入面嘅作用<a href="#喺-mcts-入面嘅作用" class="hash-link" aria-label="喺 MCTS 入面嘅作用的直接連結" title="喺 MCTS 入面嘅作用的直接連結" translate="no">​</a></h2>
<p>Policy Network 喺 AlphaGo 嘅 MCTS 入面扮演兩個關鍵角色：</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="1-引導搜索方向">1. 引導搜索方向<a href="#1-引導搜索方向" class="hash-link" aria-label="1. 引導搜索方向的直接連結" title="1. 引導搜索方向的直接連結" translate="no">​</a></h3>
<p>喺 MCTS 嘅 <strong>Selection</strong> 階段，Policy Network 嘅輸出用嚟計算 UCB（Upper Confidence Bound）：</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">UCB(s, a) = Q(s, a) + c_puct × P(s, a) × √(N(s)) / (1 + N(s, a))</span><br></span></code></pre></div></div>
<p>其中 <code>P(s, a)</code> 就係 Policy Network 俾出嘅概率。</p>
<p>呢個意味住：</p>
<ul>
<li class=""><strong>高概率嘅着法會被優先探索</strong></li>
<li class=""><strong>低概率嘅着法都有機會被探索</strong>（因為有探索項）</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="2-擴展節點嘅先驗">2. 擴展節點嘅先驗<a href="#2-擴展節點嘅先驗" class="hash-link" aria-label="2. 擴展節點嘅先驗的直接連結" title="2. 擴展節點嘅先驗的直接連結" translate="no">​</a></h3>
<p>當 MCTS 擴展一個新節點嘅時候，Policy Network 提供所有子節點嘅<strong>先驗概率</strong>。</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">展開節點 s：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  for each action a:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    child = Node()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    child.prior = policy_network(s)[a]  # 先驗概率</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    child.value = 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    child.visits = 0</span><br></span></code></pre></div></div>
<p>呢啲先驗概率令 MCTS 「知道」邊啲子節點更值得探索，即使佢哋仲未被訪問過。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="輕量版-vs-完整版">輕量版 vs 完整版<a href="#輕量版-vs-完整版" class="hash-link" aria-label="輕量版 vs 完整版的直接連結" title="輕量版 vs 完整版的直接連結" translate="no">​</a></h2>
<p>AlphaGo 實際上有兩個 Policy Network：</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="完整版sl-policy-network">完整版（SL Policy Network）<a href="#完整版sl-policy-network" class="hash-link" aria-label="完整版（SL Policy Network）的直接連結" title="完整版（SL Policy Network）的直接連結" translate="no">​</a></h3>
<ul>
<li class=""><strong>架構</strong>：13 層 CNN，192 filters</li>
<li class=""><strong>準確率</strong>：57%</li>
<li class=""><strong>推理時間</strong>：大約 3 毫秒/局面</li>
<li class=""><strong>用途</strong>：MCTS 入面嘅 Selection 同 Expansion</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="輕量版rollout-policy-network">輕量版（Rollout Policy Network）<a href="#輕量版rollout-policy-network" class="hash-link" aria-label="輕量版（Rollout Policy Network）的直接連結" title="輕量版（Rollout Policy Network）的直接連結" translate="no">​</a></h3>
<ul>
<li class=""><strong>架構</strong>：線性模型 + 手工特徵</li>
<li class=""><strong>準確率</strong>：24%</li>
<li class=""><strong>推理時間</strong>：大約 2 微秒/局面（快 1500 倍）</li>
<li class=""><strong>用途</strong>：快速模擬（rollout）</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="點解需要輕量版">點解需要輕量版？<a href="#點解需要輕量版" class="hash-link" aria-label="點解需要輕量版？的直接連結" title="點解需要輕量版？的直接連結" translate="no">​</a></h3>
<p>喺 MCTS 嘅 <strong>Simulation</strong> 階段，需要由當前節點一直落到遊戲結束，可能需要落 100+ 步。如果每步都用完整版 Policy Network，太慢喇。</p>
<p>輕量版雖然準確率只有 24%，但速度快 1500 倍。喺 rollout 入面，速度比精度更重要。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="輕量版嘅特徵">輕量版嘅特徵<a href="#輕量版嘅特徵" class="hash-link" aria-label="輕量版嘅特徵的直接連結" title="輕量版嘅特徵的直接連結" translate="no">​</a></h3>
<p>輕量版使用手工設計嘅特徵，包括：</p>
<table><thead><tr><th>特徵類型</th><th>範例</th></tr></thead><tbody><tr><td>局部模式</td><td>3×3 區域嘅棋子配置</td></tr><tr><td>全局特徵</td><td>係咪喺邊角、大場</td></tr><tr><td>戰術特徵</td><td>叫吃、征子、接應</td></tr></tbody></table>
<p>呢啲特徵被輸入一個線性模型（冇隱藏層），計算速度極快。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="alphago-zero-嘅改進">AlphaGo Zero 嘅改進<a href="#alphago-zero-嘅改進" class="hash-link" aria-label="AlphaGo Zero 嘅改進的直接連結" title="AlphaGo Zero 嘅改進的直接連結" translate="no">​</a></h3>
<p>之後嘅 AlphaGo Zero 完全棄用咗輕量版同 rollout。佢直接用 Value Network 評估葉節點，唔需要快速模擬。呢個係一個重大嘅簡化。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="強化學習微調rl-policy-network">強化學習微調（RL Policy Network）<a href="#強化學習微調rl-policy-network" class="hash-link" aria-label="強化學習微調（RL Policy Network）的直接連結" title="強化學習微調（RL Policy Network）的直接連結" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="監督學習嘅局限">監督學習嘅局限<a href="#監督學習嘅局限" class="hash-link" aria-label="監督學習嘅局限的直接連結" title="監督學習嘅局限的直接連結" translate="no">​</a></h3>
<p>監督學習訓練嘅 Policy Network 有一個根本問題：</p>
<blockquote>
<p><strong>佢學嘅係「模仿人類」，而唔係「贏棋」</strong></p>
</blockquote>
<p>呢個意味住佢會學到人類嘅壞習慣，亦會喺人類從未遇過嘅局面表現唔好。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="自我對弈強化">自我對弈強化<a href="#自我對弈強化" class="hash-link" aria-label="自我對弈強化的直接連結" title="自我對弈強化的直接連結" translate="no">​</a></h3>
<p>DeepMind 嘅解決方案係用<strong>策略梯度</strong>（Policy Gradient）方法進行強化學習：</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">1. 令 Policy Network 自我對弈</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2. 記錄每盤棋嘅所有着法</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3. 根據勝負調整參數：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 贏咗 → 增加呢啲着法嘅概率</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   - 輸咗 → 減少呢啲着法嘅概率</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="reinforce-演算法">REINFORCE 演算法<a href="#reinforce-演算法" class="hash-link" aria-label="REINFORCE 演算法的直接連結" title="REINFORCE 演算法的直接連結" translate="no">​</a></h3>
<p>具體使用 REINFORCE 演算法：</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">∇J(θ) = E[Σ_t ∇log π_θ(a_t | s_t) × z]</span><br></span></code></pre></div></div>
<p>其中：</p>
<ul>
<li class=""><code>z</code>：呢盤棋嘅結果（+1 贏，-1 輸）</li>
<li class=""><code>π_θ(a_t | s_t)</code>：喺狀態 <code>s_t</code> 選擇動作 <code>a_t</code> 嘅概率</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="結果">結果<a href="#結果" class="hash-link" aria-label="結果的直接連結" title="結果的直接連結" translate="no">​</a></h3>
<p>經過大約 1 日嘅自我對弈訓練（128 萬盤），RL Policy Network：</p>
<table><thead><tr><th>指標</th><th>SL Policy</th><th>RL Policy</th></tr></thead><tbody><tr><td>對戰 SL Policy</td><td>50%</td><td><strong>80%</strong></td></tr><tr><td>Elo 提升</td><td>-</td><td>+100</td></tr></tbody></table>
<p>準確率可能略有下降（因為佢唔再完全模仿人類），但實際對戰勝率大幅提升。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="由模仿到創新">由「模仿」到「創新」<a href="#由模仿到創新" class="hash-link" aria-label="由「模仿」到「創新」的直接連結" title="由「模仿」到「創新」的直接連結" translate="no">​</a></h3>
<p>強化學習令 Policy Network 學識咗一啲人類未曾諗過嘅着法。呢啲着法喺訓練資料入面從未出現，但佢哋係有效嘅。</p>
<p>呢個就係點解 AlphaGo 能夠落出「神之一手」——佢唔受人類經驗嘅限制。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="視覺化分析">視覺化分析<a href="#視覺化分析" class="hash-link" aria-label="視覺化分析的直接連結" title="視覺化分析的直接連結" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="唔同局面嘅概率分布">唔同局面嘅概率分布<a href="#唔同局面嘅概率分布" class="hash-link" aria-label="唔同局面嘅概率分布的直接連結" title="唔同局面嘅概率分布的直接連結" translate="no">​</a></h3>
<p>等我哋睇吓 Policy Network 喺唔同局面下嘅輸出：</p>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="開局佈局階段">開局（佈局階段）<a href="#開局佈局階段" class="hash-link" aria-label="開局（佈局階段）的直接連結" title="開局（佈局階段）的直接連結" translate="no">​</a></h4>
<div>載入中...</div>
<p>開局時，概率主要集中喺：</p>
<ul>
<li class="">角部（佔角）</li>
<li class="">邊上（掛角、守角）</li>
<li class="">「大場」位置</li>
</ul>
<p>呢個符合圍棋嘅基本原理：金角銀邊草肚皮。</p>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="戰鬥中嘅局面">戰鬥中嘅局面<a href="#戰鬥中嘅局面" class="hash-link" aria-label="戰鬥中嘅局面的直接連結" title="戰鬥中嘅局面的直接連結" translate="no">​</a></h4>
<div>載入中...</div>
<p>戰鬥時，概率集中喺：</p>
<ul>
<li class="">關鍵嘅切斷點</li>
<li class="">叫吃、接應</li>
<li class="">做眼、破眼</li>
</ul>
<p>呢個顯示模型學識咗局部戰術。</p>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="收官階段">收官階段<a href="#收官階段" class="hash-link" aria-label="收官階段的直接連結" title="收官階段的直接連結" translate="no">​</a></h4>
<div>載入中...</div>
<p>收官時，概率分散喺各個官子點，需要精確計算目數。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="隱藏層學到咩">隱藏層學到咩？<a href="#隱藏層學到咩" class="hash-link" aria-label="隱藏層學到咩？的直接連結" title="隱藏層學到咩？的直接連結" translate="no">​</a></h3>
<p>通過視覺化卷積層嘅輸出，我哋可以睇到模型學到嘅「特徵」：</p>
<ul>
<li class=""><strong>低層</strong>：基本形狀（眼、斷點）</li>
<li class=""><strong>中層</strong>：戰術模式（叫吃、征子）</li>
<li class=""><strong>高層</strong>：全局概念（勢力、厚薄）</li>
</ul>
<p>呢個同人類認知圍棋嘅層次結構非常相似。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="實作要點">實作要點<a href="#實作要點" class="hash-link" aria-label="實作要點的直接連結" title="實作要點的直接連結" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="pytorch-實現">PyTorch 實現<a href="#pytorch-實現" class="hash-link" aria-label="PyTorch 實現的直接連結" title="PyTorch 實現的直接連結" translate="no">​</a></h3>
<p>以下係一個簡化嘅 Policy Network 實現：</p>
<div class="language-python codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-python codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> torch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nn </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> nn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">functional </span><span class="token keyword" style="color:#00009f">as</span><span class="token plain"> F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">PolicyNetwork</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> input_channels</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">48</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_filters</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">192</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_layers</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">12</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 第一卷積層（5×5）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">conv1 </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Conv2d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">input_channels</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_filters</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                               kernel_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> padding</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 中間卷積層（3×3）×11</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">conv_layers </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Conv2d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_filters</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> num_filters</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                     kernel_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> padding</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> _ </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_layers </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 輸出卷積層（1×1）</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">conv_out </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Conv2d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_filters</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> kernel_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">forward</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># x: (batch, 48, 19, 19)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 第一層</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> F</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">relu</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">conv1</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 中間層</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> conv </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">conv_layers</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> F</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">relu</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">conv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 輸出層</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">conv_out</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># (batch, 1, 19, 19)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 展平 + Softmax</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">view</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">size</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># (batch, 361)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> F</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">softmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> dim</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> x</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="訓練循環">訓練循環<a href="#訓練循環" class="hash-link" aria-label="訓練循環的直接連結" title="訓練循環的直接連結" translate="no">​</a></h3>
<div class="language-python codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-python codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">train_step</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> optimizer</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> states</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    states: (batch, 48, 19, 19) - 棋盤特徵</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    actions: (batch,) - 人類落子嘅位置 (0-360)</span><br></span><span class="token-line" style="color:#393A34"><span class="token triple-quoted-string string" style="color:#e3116c">    &quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 前向傳播</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    policy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">states</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># (batch, 361)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 交叉熵損失</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loss </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> F</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cross_entropy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">policy </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1e-8</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># 防止 log(0)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        actions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 反向傳播</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    optimizer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">zero_grad</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    loss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">backward</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    optimizer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">step</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 計算準確率</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    predictions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> policy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">argmax</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">dim</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    accuracy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">predictions </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> actions</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">float</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">mean</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> loss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> accuracy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">item</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="推理時嘅注意事項">推理時嘅注意事項<a href="#推理時嘅注意事項" class="hash-link" aria-label="推理時嘅注意事項的直接連結" title="推理時嘅注意事項的直接連結" translate="no">​</a></h3>
<p>喺實際對弈嘅時候，需要注意：</p>
<ol>
<li class=""><strong>過濾非法着法</strong>：將非法位置嘅概率設為 0，然後重新歸一化</li>
<li class=""><strong>溫度調節</strong>：可以用溫度參數控制概率分布嘅「銳利度」</li>
<li class=""><strong>批次推理</strong>：喺 MCTS 入面可以批次處理多個局面</li>
</ol>
<div class="language-python codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-python codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_move_probabilities</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> state</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> legal_moves</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> temperature</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token triple-quoted-string string" style="color:#e3116c">&quot;&quot;&quot;獲取合法着法嘅概率分布&quot;&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    policy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># (361,)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 只保留合法着法</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mask </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">zeros</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">361</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mask</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">legal_moves</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    policy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> policy </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> mask</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 溫度調節</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> temperature </span><span class="token operator" style="color:#393A34">!=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1.0</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        policy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> policy </span><span class="token operator" style="color:#393A34">**</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> temperature</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 重新歸一化</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    policy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> policy </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> policy</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">sum</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> policy</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="動畫對應">動畫對應<a href="#動畫對應" class="hash-link" aria-label="動畫對應的直接連結" title="動畫對應的直接連結" translate="no">​</a></h2>
<p>本文涉及嘅核心概念同動畫編號：</p>
<table><thead><tr><th>編號</th><th>概念</th><th>物理/數學對應</th></tr></thead><tbody><tr><td>E1</td><td>Policy Network</td><td>概率場</td></tr><tr><td>D9</td><td>CNN 特徵提取</td><td>濾波器響應</td></tr><tr><td>D3</td><td>監督學習</td><td>極大似然估計</td></tr><tr><td>H4</td><td>策略梯度</td><td>隨機優化</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="延伸閱讀">延伸閱讀<a href="#延伸閱讀" class="hash-link" aria-label="延伸閱讀的直接連結" title="延伸閱讀的直接連結" translate="no">​</a></h2>
<ul>
<li class=""><strong>下一篇</strong>：<a class="" href="/zh-hk/docs/alphago/explained/value-network/">Value Network 詳解</a> — AlphaGo 點樣評估局面</li>
<li class=""><strong>相關主題</strong>：<a class="" href="/zh-hk/docs/alphago/explained/input-features/">輸入特徵設計</a> — 48 個特徵平面詳解</li>
<li class=""><strong>深入原理</strong>：<a class="" href="/zh-hk/docs/alphago/explained/cnn-and-go/">CNN 與圍棋的結合</a> — 點解卷積神經網絡適合棋盤</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="關鍵要點">關鍵要點<a href="#關鍵要點" class="hash-link" aria-label="關鍵要點的直接連結" title="關鍵要點的直接連結" translate="no">​</a></h2>
<ol>
<li class=""><strong>Policy Network 係概率分布生成器</strong>：輸入棋盤，輸出 361 個位置嘅概率</li>
<li class=""><strong>13 層 CNN + Softmax</strong>：深度卷積提取特徵，Softmax 輸出概率</li>
<li class=""><strong>57% 準確率</strong>：遠超之前嘅電腦圍棋程式</li>
<li class=""><strong>兩個版本</strong>：完整版用於 MCTS 決策，輕量版用於快速模擬</li>
<li class=""><strong>強化學習微調</strong>：由「模仿人類」進化到「追求勝利」</li>
</ol>
<p>Policy Network 係 AlphaGo 嘅「直覺」——佢令 AI 能夠好似人類咁，快速識別出值得考慮嘅着法。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="參考資料">參考資料<a href="#參考資料" class="hash-link" aria-label="參考資料的直接連結" title="參考資料的直接連結" translate="no">​</a></h2>
<ol>
<li class="">Silver, D., et al. (2016). &quot;Mastering the game of Go with deep neural networks and tree search.&quot; <em>Nature</em>, 529, 484-489.</li>
<li class="">Maddison, C. J., et al. (2014). &quot;Move Evaluation in Go Using Deep Convolutional Neural Networks.&quot; <em>arXiv:1412.6564</em>.</li>
<li class="">Sutton, R. S., &amp; Barto, A. G. (2018). <em>Reinforcement Learning: An Introduction</em>. MIT Press.</li>
<li class="">LeCun, Y., Bengio, Y., &amp; Hinton, G. (2015). &quot;Deep learning.&quot; <em>Nature</em>, 521, 436-444.</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_YM8j"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/alphago/explained/07-policy-network.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_hRvp" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>編輯此頁</a></div><div class="col lastUpdated_LNbR"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="文件選項卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/zh-hk/docs/alphago/explained/board-representation/"><div class="pagination-nav__sublabel">上一頁</div><div class="pagination-nav__label">棋盤狀態表示</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/zh-hk/docs/alphago/explained/value-network/"><div class="pagination-nav__sublabel">下一頁</div><div class="pagination-nav__label">Value Network 詳解</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_VU0O thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#咩係-policy-network" class="table-of-contents__link toc-highlight">咩係 Policy Network？</a><ul><li><a href="#核心功能" class="table-of-contents__link toc-highlight">核心功能</a></li><li><a href="#直覺理解" class="table-of-contents__link toc-highlight">直覺理解</a></li><li><a href="#點解需要-policy-network" class="table-of-contents__link toc-highlight">點解需要 Policy Network？</a></li></ul></li><li><a href="#網絡架構" class="table-of-contents__link toc-highlight">網絡架構</a><ul><li><a href="#整體結構" class="table-of-contents__link toc-highlight">整體結構</a></li><li><a href="#輸入層" class="table-of-contents__link toc-highlight">輸入層</a></li><li><a href="#卷積層" class="table-of-contents__link toc-highlight">卷積層</a></li><li><a href="#relu-激活函數" class="table-of-contents__link toc-highlight">ReLU 激活函數</a></li><li><a href="#輸出層" class="table-of-contents__link toc-highlight">輸出層</a></li><li><a href="#參數數量" class="table-of-contents__link toc-highlight">參數數量</a></li></ul></li><li><a href="#訓練目標同方法" class="table-of-contents__link toc-highlight">訓練目標同方法</a><ul><li><a href="#訓練資料" class="table-of-contents__link toc-highlight">訓練資料</a></li><li><a href="#交叉熵損失函數" class="table-of-contents__link toc-highlight">交叉熵損失函數</a></li><li><a href="#訓練過程" class="table-of-contents__link toc-highlight">訓練過程</a></li><li><a href="#資料增強" class="table-of-contents__link toc-highlight">資料增強</a></li></ul></li><li><a href="#訓練結果" class="table-of-contents__link toc-highlight">訓練結果</a><ul><li><a href="#57-準確率" class="table-of-contents__link toc-highlight">57% 準確率</a></li><li><a href="#棋力提升" class="table-of-contents__link toc-highlight">棋力提升</a></li><li><a href="#點解只有-57" class="table-of-contents__link toc-highlight">點解只有 57%？</a></li></ul></li><li><a href="#喺-mcts-入面嘅作用" class="table-of-contents__link toc-highlight">喺 MCTS 入面嘅作用</a><ul><li><a href="#1-引導搜索方向" class="table-of-contents__link toc-highlight">1. 引導搜索方向</a></li><li><a href="#2-擴展節點嘅先驗" class="table-of-contents__link toc-highlight">2. 擴展節點嘅先驗</a></li></ul></li><li><a href="#輕量版-vs-完整版" class="table-of-contents__link toc-highlight">輕量版 vs 完整版</a><ul><li><a href="#完整版sl-policy-network" class="table-of-contents__link toc-highlight">完整版（SL Policy Network）</a></li><li><a href="#輕量版rollout-policy-network" class="table-of-contents__link toc-highlight">輕量版（Rollout Policy Network）</a></li><li><a href="#點解需要輕量版" class="table-of-contents__link toc-highlight">點解需要輕量版？</a></li><li><a href="#輕量版嘅特徵" class="table-of-contents__link toc-highlight">輕量版嘅特徵</a></li><li><a href="#alphago-zero-嘅改進" class="table-of-contents__link toc-highlight">AlphaGo Zero 嘅改進</a></li></ul></li><li><a href="#強化學習微調rl-policy-network" class="table-of-contents__link toc-highlight">強化學習微調（RL Policy Network）</a><ul><li><a href="#監督學習嘅局限" class="table-of-contents__link toc-highlight">監督學習嘅局限</a></li><li><a href="#自我對弈強化" class="table-of-contents__link toc-highlight">自我對弈強化</a></li><li><a href="#reinforce-演算法" class="table-of-contents__link toc-highlight">REINFORCE 演算法</a></li><li><a href="#結果" class="table-of-contents__link toc-highlight">結果</a></li><li><a href="#由模仿到創新" class="table-of-contents__link toc-highlight">由「模仿」到「創新」</a></li></ul></li><li><a href="#視覺化分析" class="table-of-contents__link toc-highlight">視覺化分析</a><ul><li><a href="#唔同局面嘅概率分布" class="table-of-contents__link toc-highlight">唔同局面嘅概率分布</a></li><li><a href="#隱藏層學到咩" class="table-of-contents__link toc-highlight">隱藏層學到咩？</a></li></ul></li><li><a href="#實作要點" class="table-of-contents__link toc-highlight">實作要點</a><ul><li><a href="#pytorch-實現" class="table-of-contents__link toc-highlight">PyTorch 實現</a></li><li><a href="#訓練循環" class="table-of-contents__link toc-highlight">訓練循環</a></li><li><a href="#推理時嘅注意事項" class="table-of-contents__link toc-highlight">推理時嘅注意事項</a></li></ul></li><li><a href="#動畫對應" class="table-of-contents__link toc-highlight">動畫對應</a></li><li><a href="#延伸閱讀" class="table-of-contents__link toc-highlight">延伸閱讀</a></li><li><a href="#關鍵要點" class="table-of-contents__link toc-highlight">關鍵要點</a></li><li><a href="#參考資料" class="table-of-contents__link toc-highlight">參考資料</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Weiqi.Kids. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>