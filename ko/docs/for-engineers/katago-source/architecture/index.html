<!doctype html>
<html lang="ko" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-for-engineers/katago-source/architecture" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">소스코드 아키텍처 | 好棋寶寶協會 | Weiqi.Kids</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.weiqi.kids/ko/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://www.weiqi.kids/ko/img/social-card.png"><meta data-rh="true" property="og:url" content="https://www.weiqi.kids/ko/docs/for-engineers/katago-source/architecture/"><meta data-rh="true" property="og:locale" content="ko"><meta data-rh="true" property="og:locale:alternate" content="zh_tw"><meta data-rh="true" property="og:locale:alternate" content="zh_cn"><meta data-rh="true" property="og:locale:alternate" content="zh_hk"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" property="og:locale:alternate" content="ja"><meta data-rh="true" property="og:locale:alternate" content="es"><meta data-rh="true" property="og:locale:alternate" content="pt"><meta data-rh="true" property="og:locale:alternate" content="hi"><meta data-rh="true" property="og:locale:alternate" content="id"><meta data-rh="true" property="og:locale:alternate" content="ar"><meta data-rh="true" name="docusaurus_locale" content="ko"><meta data-rh="true" name="docsearch:language" content="ko"><meta data-rh="true" name="keywords" content="圍棋, Go, 好棋寶寶, AI, KataGo, AlphaGo, 圍棋教學, 圍棋入門"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="소스코드 아키텍처 | 好棋寶寶協會 | Weiqi.Kids"><meta data-rh="true" name="description" content="본문에서는 KataGo의 소스코드 구조를 심층 해석하여 내부 구현을 이해하는 데 도움을 드립니다. 코드 기여, 기능 수정, 또는 기술을 자체 프로젝트에 적용하려는 분께 필수 참고 자료입니다."><meta data-rh="true" property="og:description" content="본문에서는 KataGo의 소스코드 구조를 심층 해석하여 내부 구현을 이해하는 데 도움을 드립니다. 코드 기여, 기능 수정, 또는 기술을 자체 프로젝트에 적용하려는 분께 필수 참고 자료입니다."><link data-rh="true" rel="icon" href="/ko/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.weiqi.kids/ko/docs/for-engineers/katago-source/architecture/"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/docs/for-engineers/katago-source/architecture/" hreflang="zh-tw"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/zh-cn/docs/for-engineers/katago-source/architecture/" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/zh-hk/docs/for-engineers/katago-source/architecture/" hreflang="zh-hk"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/en/docs/for-engineers/katago-source/architecture/" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/ja/docs/for-engineers/katago-source/architecture/" hreflang="ja"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/ko/docs/for-engineers/katago-source/architecture/" hreflang="ko"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/es/docs/for-engineers/katago-source/architecture/" hreflang="es"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/pt/docs/for-engineers/katago-source/architecture/" hreflang="pt"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/hi/docs/for-engineers/katago-source/architecture/" hreflang="hi"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/id/docs/for-engineers/katago-source/architecture/" hreflang="id"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/ar/docs/for-engineers/katago-source/architecture/" hreflang="ar"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/docs/for-engineers/katago-source/architecture/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://www.weiqi.kids#organization","name":"台灣好棋寶寶協會","alternateName":"Taiwan Good Go Baby Association","url":"https://www.weiqi.kids","logo":{"@type":"ImageObject","url":"https://www.weiqi.kids/img/logo.svg","width":200,"height":200},"sameAs":["https://mastodon.weiqi.kids/","https://peertube.weiqi.kids/"],"contactPoint":{"@type":"ContactPoint","contactType":"customer service","url":"https://www.weiqi.kids/docs/aboutus"},"description":"推動圍棋文化與 AI 研究的台灣非營利組織"},{"@type":"WebSite","@id":"https://www.weiqi.kids#website","name":"好棋寶寶協會官網","url":"https://www.weiqi.kids","publisher":{"@id":"https://www.weiqi.kids#organization"},"inLanguage":["zh-TW","zh-CN","zh-HK","en","ja","ko","es","pt","hi","id","ar"],"potentialAction":{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.weiqi.kids/search?q={search_term_string}"},"query-input":"required name=search_term_string"}}]}</script><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"엔지니어를 위한 바둑 AI 가이드","item":"https://www.weiqi.kids/ko/docs/for-engineers/"},{"@type":"ListItem","position":2,"name":"KataGo 실전 입문","item":"https://www.weiqi.kids/ko/docs/for-engineers/katago-source/"},{"@type":"ListItem","position":3,"name":"소스코드 아키텍처","item":"https://www.weiqi.kids/ko/docs/for-engineers/katago-source/architecture"}]}</script><meta property="og:type" content="website">
<meta property="og:site_name" content="好棋寶寶協會">
<meta name="twitter:card" content="summary_large_image">
<meta name="robots" content="index, follow">
<meta name="author" content="台灣好棋寶寶協會"><link rel="stylesheet" href="/ko/assets/css/styles.c6458d7f.css">
<script src="/ko/assets/js/runtime~main.d7869339.js" defer="defer"></script>
<script src="/ko/assets/js/main.4dd66cc2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/ko/img/logo.svg"><div role="region" aria-label="본문으로 건너뛰기"><a class="skipToContent_bFSG" href="#__docusaurus_skipToContent_fallback">본문으로 건너뛰기</a></div><nav aria-label="메인" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="사이드바 펼치거나 접기" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ko/"><div class="navbar__logo"><img src="/ko/img/logo.svg" alt="호기보보협회 로고" class="themedComponent_Wuuq themedComponent--light_w2On"><img src="/ko/img/logo.svg" alt="호기보보협회 로고" class="themedComponent_Wuuq themedComponent--dark_zC0W"></div><b class="navbar__title text--truncate">바둑 키즈</b></a><a class="navbar__item navbar__link" href="/ko/docs/for-players/">바둑 플레이어</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ko/docs/for-engineers/">엔지니어</a><a class="navbar__item navbar__link" href="/ko/docs/about/">협회 소개</a><a class="navbar__item navbar__link" href="/ko/docs/activities/">활동 실적</a><a class="navbar__item navbar__link" href="/ko/docs/references/">참고 자료</a><a class="navbar__item navbar__link" href="/ko/docs/sop/">표준 운영 절차</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link navbar__item--compact"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_Zh_g"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>한국어</a><ul class="dropdown__menu"><li><a href="/docs/for-engineers/katago-source/architecture/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-tw">繁體中文</a></li><li><a href="/zh-cn/docs/for-engineers/katago-source/architecture/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-cn">简体中文</a></li><li><a href="/zh-hk/docs/for-engineers/katago-source/architecture/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-hk">粵語（香港）</a></li><li><a href="/en/docs/for-engineers/katago-source/architecture/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/ja/docs/for-engineers/katago-source/architecture/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ja">日本語</a></li><li><a href="/ko/docs/for-engineers/katago-source/architecture/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ko">한국어</a></li><li><a href="/es/docs/for-engineers/katago-source/architecture/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="/pt/docs/for-engineers/katago-source/architecture/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">Português</a></li><li><a href="/hi/docs/for-engineers/katago-source/architecture/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="hi">हिन्दी</a></li><li><a href="/id/docs/for-engineers/katago-source/architecture/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="id">Bahasa Indonesia</a></li><li><a href="/ar/docs/for-engineers/katago-source/architecture/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ar">العربية</a></li></ul></div><a href="https://github.com/weiqi-kids/www.weiqi.kids" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link navbar__item--compact" aria-label="GitHub"></a><div class="navbarSearchContainer_pmRL"><div class="navbar__search searchBarContainer_nNQu" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input searchInput_jmZR" value=""><div class="loadingRing_zZTX searchBarLoadingRing_JhV3"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_WlJ3"><div class="docsWrapper_ramL"><button aria-label="맨 위로 스크롤하기" class="clean-btn theme-back-to-top-button backToTopButton_MqxJ" type="button"></button><div class="docRoot_UZ1h"><aside class="theme-doc-sidebar-container docSidebarContainer_y0QC"><div class="sidebarViewport_jAkm"><div class="sidebar_HjkB"><nav aria-label="문서 사이드바" class="menu thin-scrollbar menu_jqYH"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ko/docs/intro/">이용 안내</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ko/docs/about/">關於協會</a><button aria-label="사이드바 분류 &#x27;關於協會&#x27; 펼치기" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ko/docs/activities/">活動實績</a><button aria-label="사이드바 분류 &#x27;活動實績&#x27; 펼치기" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ko/docs/for-players/">바둑 기사를 위한 자료</a><button aria-label="사이드바 분류 &#x27;바둑 기사를 위한 자료&#x27; 펼치기" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ko/docs/references/">參考資料</a><button aria-label="사이드바 분류 &#x27;參考資料&#x27; 펼치기" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/ko/docs/sop/">標準作業流程</a><button aria-label="사이드바 분류 &#x27;標準作業流程&#x27; 펼치기" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/ko/docs/for-engineers/">엔지니어를 위한 바둑 AI 가이드</a><button aria-label="사이드바 분류 &#x27;엔지니어를 위한 바둑 AI 가이드&#x27; 접기" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/ko/docs/for-engineers/background-info/">배경 지식</a><button aria-label="사이드바 분류 &#x27;배경 지식&#x27; 펼치기" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/ko/docs/for-engineers/katago-source/">KataGo 실전 입문</a><button aria-label="사이드바 분류 &#x27;KataGo 실전 입문&#x27; 접기" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ko/docs/for-engineers/katago-source/setup/">설치 및 설정</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ko/docs/for-engineers/katago-source/commands/">자주 사용하는 명령어</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ko/docs/for-engineers/katago-source/architecture/">소스코드 아키텍처</a></li></ul></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_qMQS"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_Wlt9"><div class="docItemContainer_oLHG"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_M4ek" aria-label="탐색 경로"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="홈" class="breadcrumbs__link" href="/ko/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_pL7f"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/ko/docs/for-engineers/"><span>엔지니어를 위한 바둑 AI 가이드</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/ko/docs/for-engineers/katago-source/"><span>KataGo 실전 입문</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">소스코드 아키텍처</span></li></ul></nav><div class="tocCollapsible_K0FP theme-doc-toc-mobile tocMobile_PzQu"><button type="button" class="clean-btn tocCollapsibleButton_E0oR">이 페이지에서</button></div><div class="theme-doc-markdown markdown"><header><h1>KataGo 소스코드 아키텍처</h1></header>
<p>본문에서는 KataGo의 소스코드 구조를 심층 해석하여 내부 구현을 이해하는 데 도움을 드립니다. 코드 기여, 기능 수정, 또는 기술을 자체 프로젝트에 적용하려는 분께 필수 참고 자료입니다.</p>
<h2 class="anchor anchorWithStickyNavbar_BVHq" id="프로젝트-디렉토리-구조">프로젝트 디렉토리 구조<a href="#프로젝트-디렉토리-구조" class="hash-link" aria-label="프로젝트 디렉토리 구조에 대한 직접 링크" title="프로젝트 디렉토리 구조에 대한 직접 링크">​</a></h2>
<div class="language-text codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-text codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token plain">KataGo/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── cpp/                    # C++ 핵심 코드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── main.cpp           # 메인 프로그램 진입점</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── command/           # 각종 실행 모드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── core/              # 핵심 유틸리티 클래스</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── game/              # 바둑 규칙 및 바둑판</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── search/            # MCTS 탐색 엔진</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── neuralnet/         # 신경망 인터페이스</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── dataio/            # 데이터 I/O</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── configs/           # 설정 파일 예제</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── tests/             # 유닛 테스트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── python/                 # Python 훈련 코드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── train.py           # 훈련 메인 프로그램</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── model.py           # 모델 정의</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── data_processing_pytorch.py</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── configs/           # 훈련 설정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── docs/                   # 문서</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── scripts/               # 보조 스크립트</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="cpp-디렉토리-상세">cpp/ 디렉토리 상세<a href="#cpp-디렉토리-상세" class="hash-link" aria-label="cpp/ 디렉토리 상세에 대한 직접 링크" title="cpp/ 디렉토리 상세에 대한 직접 링크">​</a></h3>
<div class="language-text codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-text codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token plain">cpp/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── main.cpp                # 프로그램 진입점, 명령줄 인자 파싱</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── command/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── gtp.cpp            # GTP 프로토콜 구현</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── analysis.cpp       # Analysis Engine 구현</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── benchmark.cpp      # 벤치마크 테스트</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── genconfig.cpp      # 설정 파일 생성</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── selfplay.cpp       # 자가대국</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── core/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── global.h           # 전역 상수 및 설정</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── hash.h             # Zobrist 해시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── rand.h             # 난수 생성</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── logger.h           # 로깅 시스템</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── config_parser.h    # 설정 파일 파싱</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── threadsafe*.h      # 스레드 안전 도구</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── game/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── board.h/cpp        # 바둑판 표현 및 기본 조작</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── rules.h/cpp        # 바둑 규칙</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── boardhistory.h/cpp # 대국 히스토리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── graphhash.h/cpp    # 국면 해시</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── search/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── search.h/cpp       # 탐색 엔진 메인 클래스</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── searchnode.h/cpp   # 탐색 트리 노드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── searchparams.h     # 탐색 파라미터</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── mutexpool.h        # 락 풀</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── searchresults.h    # 탐색 결과</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── asyncbot.h/cpp     # 비동기 봇</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├── neuralnet/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── nninputs.h/cpp     # 신경망 입력 특징</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── nneval.h/cpp       # 신경망 평가</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── nninterface.h      # 백엔드 추상 인터페이스</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── cudabackend.cpp    # CUDA 백엔드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── openclbackend.cpp  # OpenCL 백엔드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   ├── eigenbackend.cpp   # Eigen(CPU) 백엔드</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│   └── modelversion.h     # 모델 버전 관리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── dataio/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── sgf.h/cpp          # SGF 파일 처리</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── numpywrite.h/cpp   # NumPy 형식 출력</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── trainingwrite.h/cpp # 훈련 데이터 기록</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_BVHq" id="신경망-아키텍처">신경망 아키텍처<a href="#신경망-아키텍처" class="hash-link" aria-label="신경망 아키텍처에 대한 직접 링크" title="신경망 아키텍처에 대한 직접 링크">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="네트워크-구조-개요">네트워크 구조 개요<a href="#네트워크-구조-개요" class="hash-link" aria-label="네트워크 구조 개요에 대한 직접 링크" title="네트워크 구조 개요에 대한 직접 링크">​</a></h3>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="입력-특징nninputscpp">입력 특징(nninputs.cpp)<a href="#입력-특징nninputscpp" class="hash-link" aria-label="입력 특징(nninputs.cpp)에 대한 직접 링크" title="입력 특징(nninputs.cpp)에 대한 직접 링크">​</a></h3>
<p>KataGo는 22개 특징 평면을 입력으로 사용합니다:</p>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 주요 입력 특징 카테고리</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">enum</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 바둑판 상태</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  INPUT_FEATURE_STONE_OUR</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// 우리 돌</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  INPUT_FEATURE_STONE_OPP</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// 상대 돌</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 활로 관련(1-8활로)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  INPUT_FEATURE_LIBERTIES_1</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  INPUT_FEATURE_LIBERTIES_2</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  INPUT_FEATURE_LIBERTIES_8_OR_MORE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 히스토리 상태</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  INPUT_FEATURE_LAST_MOVE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">      </span><span class="token comment" style="color:#999988;font-style:italic">// 이전 수 위치</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  INPUT_FEATURE_SECOND_LAST_MOVE</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 규칙 관련</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  INPUT_FEATURE_KOMI</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// 덤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  INPUT_FEATURE_RULES</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// 규칙 인코딩</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="전역-풀링-분기">전역 풀링 분기<a href="#전역-풀링-분기" class="hash-link" aria-label="전역 풀링 분기에 대한 직접 링크" title="전역 풀링 분기에 대한 직접 링크">​</a></h3>
<p>KataGo의 혁신 중 하나는 잔차 블록에 전역 풀링 추가:</p>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 간소화된 전역 풀링 구현 개념</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">GlobalPoolingResBlock</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">forward</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Tensor</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 표준 잔차 경로</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Tensor regular_out </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">regular_conv_path</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 전역 풀링 경로</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Tensor global_mean </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">global_avg_pool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// [batch, C]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Tensor global_max </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">global_max_pool</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// [batch, C]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Tensor global_features </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">concat</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">global_mean</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> global_max</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 전역 특징 처리</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    global_features </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">dense_layer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">global_features</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// [batch, C]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 공간 차원으로 브로드캐스트하여 일반 경로와 결합</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Tensor global_broadcast </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">broadcast_to_spatial</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">global_features</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> regular_out </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> global_broadcast</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="출력-헤드">출력 헤드<a href="#출력-헤드" class="hash-link" aria-label="출력 헤드에 대한 직접 링크" title="출력 헤드에 대한 직접 링크">​</a></h3>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Policy Head: 착점 확률 예측</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">PolicyHead</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 출력: 19×19+1(pass 포함)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// softmax 정규화 사용</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Value Head: 승패 예측</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ValueHead</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 출력: 3(승/패/무 확률)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// softmax 정규화 사용</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Score Head: 집수 예측</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">ScoreHead</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 출력: 연속값(예상 집수 차)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// Ownership Head: 영역 예측</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">OwnershipHead</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 출력: 19×19(각 점 귀속, tanh)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_BVHq" id="탐색-엔진-구현">탐색 엔진 구현<a href="#탐색-엔진-구현" class="hash-link" aria-label="탐색 엔진 구현에 대한 직접 링크" title="탐색 엔진 구현에 대한 직접 링크">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="mcts-핵심-클래스">MCTS 핵심 클래스<a href="#mcts-핵심-클래스" class="hash-link" aria-label="MCTS 핵심 클래스에 대한 직접 링크" title="MCTS 핵심 클래스에 대한 직접 링크">​</a></h3>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// search/search.h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Search</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 탐색 실행</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">runWholeSearch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Player pla</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 최선수 가져오기</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Loc </span><span class="token function" style="color:#d73a49">getBestMove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 분석 결과 가져오기</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AnalysisData </span><span class="token function" style="color:#d73a49">getAnalysisData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">private</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SearchParams params</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// 탐색 파라미터</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SearchNode</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> rootNode</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// 루트 노드</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  NNEvaluator</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> nnEval</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// 신경망 평가기</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">mutex</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> mutexPool</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// 락 풀</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="탐색-노드-구조">탐색 노드 구조<a href="#탐색-노드-구조" class="hash-link" aria-label="탐색 노드 구조에 대한 직접 링크" title="탐색 노드 구조에 대한 직접 링크">​</a></h3>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// search/searchnode.h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">SearchNode</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 노드 통계</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">int64_t</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> visits</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">           </span><span class="token comment" style="color:#999988;font-style:italic">// 방문 횟수</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">double</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> valueSumWeight</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 가치 누적 가중치</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">double</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> valueSum</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// 가치 누적 합</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 자식 노드</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">int</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> numChildren</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  SearchChildPointer</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> children</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">          </span><span class="token comment" style="color:#999988;font-style:italic">// 자식 노드 포인터 배열</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 신경망 출력 캐시</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">shared_ptr</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">NNOutput</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> nnOutput</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">SearchChildPointer</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Loc moveLoc</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                           </span><span class="token comment" style="color:#999988;font-style:italic">// 착점</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">SearchNode</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// 자식 노드 포인터</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">atomic</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token keyword" style="color:#00009f">int64_t</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> edgeVisits</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// 엣지 방문 횟수</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="puct-선택-알고리즘">PUCT 선택 알고리즘<a href="#puct-선택-알고리즘" class="hash-link" aria-label="PUCT 선택 알고리즘에 대한 직접 링크" title="PUCT 선택 알고리즘에 대한 직접 링크">​</a></h3>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 탐색할 자식 노드 선택</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token class-name">Search</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">selectChildToDescend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SearchNode</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Player pla</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> bestIdx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> bestValue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1e100</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> node</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">numChildren</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SearchChildPointer</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> child </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> node</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">children</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">i</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// Q값 계산(exploitation)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> q </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getChildQ</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">child</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// U값 계산(exploration)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> prior </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getPrior</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">node</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> child</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">moveLoc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> parentVisits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> node</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">visits</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> childVisits </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> child</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">edgeVisits</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">load</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> u </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> params</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">cpuctExploration </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> prior </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">               </span><span class="token function" style="color:#d73a49">sqrt</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">parentVisits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1.0</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> childVisits</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// PUCT 공식</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">double</span><span class="token plain"> value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> q </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> u</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> bestValue</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      bestValue </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      bestIdx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> i</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> bestIdx</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="병렬-탐색-구현">병렬 탐색 구현<a href="#병렬-탐색-구현" class="hash-link" aria-label="병렬 탐색 구현에 대한 직접 링크" title="병렬 탐색 구현에 대한 직접 링크">​</a></h3>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">Search</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">runWholeSearch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Player pla</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 여러 탐색 스레드 시작</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">thread</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> threads</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> params</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">numSearchThreads</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> i</span><span class="token operator" style="color:#393A34">++</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    threads</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">emplace_back</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> pla</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">runSingleSearchThread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">pla</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 모든 스레드 완료 대기</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">auto</span><span class="token operator" style="color:#393A34">&amp;</span><span class="token plain"> t </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> threads</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    t</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">join</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">Search</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">runSingleSearchThread</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Player pla</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token function" style="color:#d73a49">shouldStop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 경로 선택</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">SearchNode</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SearchNode</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> leaf </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">selectAndDescend</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">rootNode</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> path</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 노드 확장</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">expandNode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">leaf</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 신경망 평가</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    NNOutput output </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nnEval</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token function" style="color:#d73a49">evaluate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">leaf</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">board</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 역전파 업데이트</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">backpropagateValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">path</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> output</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="가상-손실virtual-loss">가상 손실(Virtual Loss)<a href="#가상-손실virtual-loss" class="hash-link" aria-label="가상 손실(Virtual Loss)에 대한 직접 링크" title="가상 손실(Virtual Loss)에 대한 직접 링크">​</a></h3>
<p>병렬 탐색 시 여러 스레드가 같은 경로를 선택하지 않도록:</p>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">Search</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">applyVirtualLoss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SearchNode</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 이 노드의 평가값을 일시적으로 낮춤</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 다른 스레드가 다른 경로를 선택하도록 함</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  node</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">virtualLoss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">fetch_add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token class-name">Search</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">removeVirtualLoss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">SearchNode</span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> node</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  node</span><span class="token operator" style="color:#393A34">-&gt;</span><span class="token plain">virtualLoss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">fetch_sub</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_BVHq" id="훈련-프로세스-개요">훈련 프로세스 개요<a href="#훈련-프로세스-개요" class="hash-link" aria-label="훈련 프로세스 개요에 대한 직접 링크" title="훈련 프로세스 개요에 대한 직접 링크">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="훈련-데이터-생성">훈련 데이터 생성<a href="#훈련-데이터-생성" class="hash-link" aria-label="훈련 데이터 생성에 대한 직접 링크" title="훈련 데이터 생성에 대한 직접 링크">​</a></h3>
<!-- -->
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="자가대국cppcommandselfplaycpp">자가대국(cpp/command/selfplay.cpp)<a href="#자가대국cppcommandselfplaycpp" class="hash-link" aria-label="자가대국(cpp/command/selfplay.cpp)에 대한 직접 링크" title="자가대국(cpp/command/selfplay.cpp)에 대한 직접 링크">​</a></h3>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Self-play 메인 루프</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">runSelfPlayLoop</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 최신 모델 로드</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">loadLatestModel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 한 대국 진행</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    GameData gameData </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">playSingleGame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 훈련 데이터 저장</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">writeTrainingData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">gameData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">GameData </span><span class="token function" style="color:#d73a49">playSingleGame</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Board board</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BoardHistory history</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  GameData gameData</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">history</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isGameOver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// MCTS로 수 선택</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Search </span><span class="token function" style="color:#d73a49">search</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">board</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> history</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    search</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">runWholeSearch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">history</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">currentPla</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// MCTS 결과를 훈련 목표로 사용</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    MoveData moveData</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    moveData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">policyTarget </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> search</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getPolicyDistribution</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    moveData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">valueTarget </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> search</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">getValue</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 수 실행</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Loc move </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> search</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">sampleMove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    board</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">playMove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">move</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> history</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">currentPla</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    gameData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">moves</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">push_back</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">moveData</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 최종 결과 역충전</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  gameData</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">finalScore </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> history</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">finalScore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> gameData</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="훈련-데이터-형식">훈련 데이터 형식<a href="#훈련-데이터-형식" class="hash-link" aria-label="훈련 데이터 형식에 대한 직접 링크" title="훈련 데이터 형식에 대한 직접 링크">​</a></h3>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// dataio/trainingwrite.h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">TrainingRow</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 입력 특징</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> inputFeatures</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">NUM_FEATURES</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">BOARD_SIZE</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">BOARD_SIZE</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 훈련 목표</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> policyTarget</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">BOARD_SIZE </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> BOARD_SIZE </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// pass 포함</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> valueTarget</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                              </span><span class="token comment" style="color:#999988;font-style:italic">// 승/패/무</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> scoreTarget</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                                 </span><span class="token comment" style="color:#999988;font-style:italic">// 집수</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> ownershipTarget</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">BOARD_SIZE</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">BOARD_SIZE</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 영역</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 메타데이터</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> turn</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> rules</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> komi</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="python-훈련-프로그램pythontrainpy">Python 훈련 프로그램(python/train.py)<a href="#python-훈련-프로그램pythontrainpy" class="hash-link" aria-label="Python 훈련 프로그램(python/train.py)에 대한 직접 링크" title="Python 훈련 프로그램(python/train.py)에 대한 직접 링크">​</a></h3>
<div class="language-python codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-python codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic"># 훈련 메인 루프(간소화)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">train</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    model </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> KataGoModel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    optimizer </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> torch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">optim</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">SGD</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">parameters</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> lr</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">lr</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> epoch </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">num_epochs</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> batch </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> data_loader</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 순전파</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            policy_pred</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value_pred</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> score_pred</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ownership_pred </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token builtin">input</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 손실 계산</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            policy_loss </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cross_entropy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">policy_pred</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">policy_target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            value_loss </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cross_entropy</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value_pred</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value_target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            score_loss </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mse_loss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">score_pred</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">score_target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ownership_loss </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mse_loss</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ownership_pred</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> batch</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ownership_target</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 총 손실(가중합)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            total_loss </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                policy_loss </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value_weight </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> value_loss </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">score_weight </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> score_loss </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ownership_weight </span><span class="token operator" style="color:#393A34">*</span><span class="token plain"> ownership_loss</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 역전파</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            optimizer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">zero_grad</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            total_loss</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">backward</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            optimizer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">step</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 체크포인트 저장</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        save_checkpoint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">model</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> epoch</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="모델-정의pythonmodelpy">모델 정의(python/model.py)<a href="#모델-정의pythonmodelpy" class="hash-link" aria-label="모델 정의(python/model.py)에 대한 직접 링크" title="모델 정의(python/model.py)에 대한 직접 링크">​</a></h3>
<div class="language-python codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-python codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">KataGoModel</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Module</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token builtin">super</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">__init__</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 초기 합성곱</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">initial_conv </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">Conv2d</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">input_channels</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">trunk_channels</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            kernel_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> padding</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 잔차 블록</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">blocks </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> nn</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ModuleList</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ResBlock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">trunk_channels</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> use_global_pooling</span><span class="token operator" style="color:#393A34">=</span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> _ </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">num_blocks</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 출력 헤드</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">policy_head </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> PolicyHead</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value_head </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ValueHead</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">score_head </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ScoreHead</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ownership_head </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> OwnershipHead</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">def</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">forward</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">self</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 주간 네트워크</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">initial_conv</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> block </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">blocks</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            x </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> block</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 각 출력 헤드</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        policy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">policy_head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        value </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">value_head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        score </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">score_head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ownership </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> self</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ownership_head</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> policy</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> score</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> ownership</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_BVHq" id="핵심-데이터-구조">핵심 데이터 구조<a href="#핵심-데이터-구조" class="hash-link" aria-label="핵심 데이터 구조에 대한 직접 링크" title="핵심 데이터 구조에 대한 직접 링크">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="boardgameboardh">Board(game/board.h)<a href="#boardgameboardh" class="hash-link" aria-label="Board(game/board.h)에 대한 직접 링크" title="Board(game/board.h)에 대한 직접 링크">​</a></h3>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Board</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 바둑판 상태</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Color stones</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">MAX_BOARD_AREA</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 각 점의 색상</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Chain chains</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">MAX_BOARD_AREA</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// 돌덩어리 정보</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 패</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Loc koLoc</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 수 실행</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">void</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">playMove</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Loc loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Color pla</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 합법성 검사</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">bool</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isLegal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Loc loc</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> Color pla</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 활로 계산</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">getLiberties</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">Loc loc</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">Chain</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> liberties</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic">// 활로 수</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">int</span><span class="token plain"> numStones</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                   </span><span class="token comment" style="color:#999988;font-style:italic">// 돌 수</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Loc head</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                        </span><span class="token comment" style="color:#999988;font-style:italic">// 연결 리스트 헤드</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="boardhistorygameboardhistoryh">BoardHistory(game/boardhistory.h)<a href="#boardhistorygameboardhistoryh" class="hash-link" aria-label="BoardHistory(game/boardhistory.h)에 대한 직접 링크" title="BoardHistory(game/boardhistory.h)에 대한 직접 링크">​</a></h3>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">BoardHistory</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">public</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Board</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> boards</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">       </span><span class="token comment" style="color:#999988;font-style:italic">// 히스토리 바둑판 상태</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  std</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token plain">vector</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">Move</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> moves</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic">// 수 히스토리</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Rules rules</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">                     </span><span class="token comment" style="color:#999988;font-style:italic">// 규칙</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Player currentPla</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">               </span><span class="token comment" style="color:#999988;font-style:italic">// 현재 차례</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// 게임 상태</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">bool</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">isGameOver</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">finalScore</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">const</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="nnoutputneuralnetnnevalh">NNOutput(neuralnet/nneval.h)<a href="#nnoutputneuralnetnnevalh" class="hash-link" aria-label="NNOutput(neuralnet/nneval.h)에 대한 직접 링크" title="NNOutput(neuralnet/nneval.h)에 대한 직접 링크">​</a></h3>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">struct</span><span class="token plain"> </span><span class="token class-name">NNOutput</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Policy</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> policyProbs</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">MAX_BOARD_AREA </span><span class="token operator" style="color:#393A34">+</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// pass 포함</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> whiteWinProb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> whiteLossProb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> noResultProb</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Score</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> whiteScoreMean</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> whiteScoreStdev</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// Ownership</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">float</span><span class="token plain"> ownership</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">MAX_BOARD_AREA</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic">// -1에서 1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_BVHq" id="개발-및-디버깅">개발 및 디버깅<a href="#개발-및-디버깅" class="hash-link" aria-label="개발 및 디버깅에 대한 직접 링크" title="개발 및 디버깅에 대한 직접 링크">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="디버그-버전-컴파일">디버그 버전 컴파일<a href="#디버그-버전-컴파일" class="hash-link" aria-label="디버그 버전 컴파일에 대한 직접 링크" title="디버그 버전 컴파일에 대한 직접 링크">​</a></h3>
<div class="language-bash codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-bash codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token plain">cd cpp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir build_debug &amp;&amp; cd build_debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmake .. -DCMAKE_BUILD_TYPE=Debug -DUSE_BACKEND=OPENCL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">make -j$(nproc)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="유닛-테스트-실행">유닛 테스트 실행<a href="#유닛-테스트-실행" class="hash-link" aria-label="유닛 테스트 실행에 대한 직접 링크" title="유닛 테스트 실행에 대한 직접 링크">​</a></h3>
<div class="language-bash codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-bash codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token plain">./katago runtests</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="흔한-디버깅-방법">흔한 디버깅 방법<a href="#흔한-디버깅-방법" class="hash-link" aria-label="흔한 디버깅 방법에 대한 직접 링크" title="흔한 디버깅 방법에 대한 직접 링크">​</a></h3>
<div class="language-cpp codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-cpp codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// 1. 로깅 사용</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token macro property directive-hash" style="color:#36acaa">#</span><span class="token macro property directive keyword" style="color:#00009f">include</span><span class="token macro property" style="color:#36acaa"> </span><span class="token macro property string" style="color:#e3116c">&quot;core/logger.h&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token class-name">Logger</span><span class="token double-colon punctuation" style="color:#393A34">::</span><span class="token function" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&quot;Debug message&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 2. kata-debug-print GTP 명령어 사용</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 상세 탐색 정보 출력</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 3. 컴파일 시 sanitizers 활성화</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">cmake </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">DCMAKE_CXX_FLAGS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;-fsanitize=address&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_BVHq" id="성능-분석">성능 분석<a href="#성능-분석" class="hash-link" aria-label="성능 분석에 대한 직접 링크" title="성능 분석에 대한 직접 링크">​</a></h3>
<div class="language-bash codeBlockContainer_WV0T theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_GRu9"><pre tabindex="0" class="prism-code language-bash codeBlock_md1K thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_L4YE"><span class="token-line" style="color:#393A34"><span class="token plain"># perf 사용(Linux)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">perf record ./katago benchmark -model model.bin.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">perf report</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Instruments 사용(macOS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">instruments -t &quot;Time Profiler&quot; ./katago benchmark -model model.bin.gz</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_BVHq" id="추가-읽기">추가 읽기<a href="#추가-읽기" class="hash-link" aria-label="추가 읽기에 대한 직접 링크" title="추가 읽기에 대한 직접 링크">​</a></h2>
<ul>
<li><a href="https://github.com/lightvector/KataGo" target="_blank" rel="noopener noreferrer">KataGo GitHub</a></li>
<li><a href="https://arxiv.org/abs/1902.10565" target="_blank" rel="noopener noreferrer">KataGo 논문</a></li>
<li><a href="https://discord.gg/bqkZAz3" target="_blank" rel="noopener noreferrer">KataGo Discord</a> - 개발자와 교류</li>
<li><a href="https://katagotraining.org/" target="_blank" rel="noopener noreferrer">KataGo Training</a> - 훈련 진행 확인</li>
</ul>
<p>KataGo의 소스코드 아키텍처를 이해했다면, 심층 연구나 오픈소스 프로젝트 기여 능력을 갖추게 됩니다. 더 깊이 알고 싶다면 KataGo의 GitHub 소스코드를 직접 읽고 커뮤니티 토론에 참여하시길 권장합니다.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/for-engineers/katago-source/architecture.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_O1mQ" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>페이지 편집</a></div><div class="col lastUpdated_hyfO"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="문서 페이지"><a class="pagination-nav__link pagination-nav__link--prev" href="/ko/docs/for-engineers/katago-source/commands/"><div class="pagination-nav__sublabel">이전</div><div class="pagination-nav__label">자주 사용하는 명령어</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_tqik thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#프로젝트-디렉토리-구조" class="table-of-contents__link toc-highlight">프로젝트 디렉토리 구조</a><ul><li><a href="#cpp-디렉토리-상세" class="table-of-contents__link toc-highlight">cpp/ 디렉토리 상세</a></li></ul></li><li><a href="#신경망-아키텍처" class="table-of-contents__link toc-highlight">신경망 아키텍처</a><ul><li><a href="#네트워크-구조-개요" class="table-of-contents__link toc-highlight">네트워크 구조 개요</a></li><li><a href="#입력-특징nninputscpp" class="table-of-contents__link toc-highlight">입력 특징(nninputs.cpp)</a></li><li><a href="#전역-풀링-분기" class="table-of-contents__link toc-highlight">전역 풀링 분기</a></li><li><a href="#출력-헤드" class="table-of-contents__link toc-highlight">출력 헤드</a></li></ul></li><li><a href="#탐색-엔진-구현" class="table-of-contents__link toc-highlight">탐색 엔진 구현</a><ul><li><a href="#mcts-핵심-클래스" class="table-of-contents__link toc-highlight">MCTS 핵심 클래스</a></li><li><a href="#탐색-노드-구조" class="table-of-contents__link toc-highlight">탐색 노드 구조</a></li><li><a href="#puct-선택-알고리즘" class="table-of-contents__link toc-highlight">PUCT 선택 알고리즘</a></li><li><a href="#병렬-탐색-구현" class="table-of-contents__link toc-highlight">병렬 탐색 구현</a></li><li><a href="#가상-손실virtual-loss" class="table-of-contents__link toc-highlight">가상 손실(Virtual Loss)</a></li></ul></li><li><a href="#훈련-프로세스-개요" class="table-of-contents__link toc-highlight">훈련 프로세스 개요</a><ul><li><a href="#훈련-데이터-생성" class="table-of-contents__link toc-highlight">훈련 데이터 생성</a></li><li><a href="#자가대국cppcommandselfplaycpp" class="table-of-contents__link toc-highlight">자가대국(cpp/command/selfplay.cpp)</a></li><li><a href="#훈련-데이터-형식" class="table-of-contents__link toc-highlight">훈련 데이터 형식</a></li><li><a href="#python-훈련-프로그램pythontrainpy" class="table-of-contents__link toc-highlight">Python 훈련 프로그램(python/train.py)</a></li><li><a href="#모델-정의pythonmodelpy" class="table-of-contents__link toc-highlight">모델 정의(python/model.py)</a></li></ul></li><li><a href="#핵심-데이터-구조" class="table-of-contents__link toc-highlight">핵심 데이터 구조</a><ul><li><a href="#boardgameboardh" class="table-of-contents__link toc-highlight">Board(game/board.h)</a></li><li><a href="#boardhistorygameboardhistoryh" class="table-of-contents__link toc-highlight">BoardHistory(game/boardhistory.h)</a></li><li><a href="#nnoutputneuralnetnnevalh" class="table-of-contents__link toc-highlight">NNOutput(neuralnet/nneval.h)</a></li></ul></li><li><a href="#개발-및-디버깅" class="table-of-contents__link toc-highlight">개발 및 디버깅</a><ul><li><a href="#디버그-버전-컴파일" class="table-of-contents__link toc-highlight">디버그 버전 컴파일</a></li><li><a href="#유닛-테스트-실행" class="table-of-contents__link toc-highlight">유닛 테스트 실행</a></li><li><a href="#흔한-디버깅-방법" class="table-of-contents__link toc-highlight">흔한 디버깅 방법</a></li><li><a href="#성능-분석" class="table-of-contents__link toc-highlight">성능 분석</a></li></ul></li><li><a href="#추가-읽기" class="table-of-contents__link toc-highlight">추가 읽기</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Weiqi.Kids. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>