"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[3949],{39159(n,e,s){s.r(e),s.d(e,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>l,toc:()=>c});const l=JSON.parse('{"id":"tech/deep-dive/training","title":"KataGo \ud559\uc2b5 \uba54\ucee4\ub2c8\uc998 \ubd84\uc11d","description":"KataGo\uc758 \uc790\uac00 \ub300\uad6d \ud559\uc2b5 \uacfc\uc815\uacfc \ud575\uc2ec \uae30\uc220\uc5d0 \ub300\ud55c \uc2ec\uce35 \uc774\ud574","source":"@site/i18n/ko/docusaurus-plugin-content-docs/current/tech/deep-dive/training.md","sourceDirName":"tech/deep-dive","slug":"/tech/deep-dive/training","permalink":"/ko/docs/tech/deep-dive/training","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tech/deep-dive/training.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"KataGo \ud559\uc2b5 \uba54\ucee4\ub2c8\uc998 \ubd84\uc11d","description":"KataGo\uc758 \uc790\uac00 \ub300\uad6d \ud559\uc2b5 \uacfc\uc815\uacfc \ud575\uc2ec \uae30\uc220\uc5d0 \ub300\ud55c \uc2ec\uce35 \uc774\ud574"},"sidebar":"tutorialSidebar","previous":{"title":"KataGo \uc18c\uc2a4 \ucf54\ub4dc \uac00\uc774\ub4dc","permalink":"/ko/docs/tech/deep-dive/source-code"},"next":{"title":"\uc624\ud508\uc18c\uc2a4 \ucee4\ubba4\ub2c8\ud2f0 \ucc38\uc5ec","permalink":"/ko/docs/tech/deep-dive/contributing"}}');var r=s(62615),i=s(30416);const d={sidebar_position:3,title:"KataGo \ud559\uc2b5 \uba54\ucee4\ub2c8\uc998 \ubd84\uc11d",description:"KataGo\uc758 \uc790\uac00 \ub300\uad6d \ud559\uc2b5 \uacfc\uc815\uacfc \ud575\uc2ec \uae30\uc220\uc5d0 \ub300\ud55c \uc2ec\uce35 \uc774\ud574"},t="KataGo \ud559\uc2b5 \uba54\ucee4\ub2c8\uc998 \ubd84\uc11d",a={},c=[{value:"\ud559\uc2b5 \uac1c\uc694",id:"\ud559\uc2b5-\uac1c\uc694",level:2},{value:"\ud559\uc2b5 \ub8e8\ud504",id:"\ud559\uc2b5-\ub8e8\ud504",level:3},{value:"\ud558\ub4dc\uc6e8\uc5b4 \uc694\uad6c\uc0ac\ud56d",id:"\ud558\ub4dc\uc6e8\uc5b4-\uc694\uad6c\uc0ac\ud56d",level:3},{value:"\ud658\uacbd \uc124\uc815",id:"\ud658\uacbd-\uc124\uc815",level:2},{value:"\uc758\uc874\uc131 \uc124\uce58",id:"\uc758\uc874\uc131-\uc124\uce58",level:3},{value:"\ud559\uc2b5 \ucf54\ub4dc \uac00\uc838\uc624\uae30",id:"\ud559\uc2b5-\ucf54\ub4dc-\uac00\uc838\uc624\uae30",level:3},{value:"\ud559\uc2b5 \uc124\uc815",id:"\ud559\uc2b5-\uc124\uc815",level:2},{value:"\uc124\uc815 \ud30c\uc77c \uad6c\uc870",id:"\uc124\uc815-\ud30c\uc77c-\uad6c\uc870",level:3},{value:"\ubaa8\ub378 \uaddc\ubaa8 \ub300\uc870\ud45c",id:"\ubaa8\ub378-\uaddc\ubaa8-\ub300\uc870\ud45c",level:3},{value:"\ud559\uc2b5 \ud504\ub85c\uc138\uc2a4",id:"\ud559\uc2b5-\ud504\ub85c\uc138\uc2a4",level:2},{value:"\ub2e8\uacc4 1: \ubaa8\ub378 \ucd08\uae30\ud654",id:"\ub2e8\uacc4-1-\ubaa8\ub378-\ucd08\uae30\ud654",level:3},{value:"\ub2e8\uacc4 2: \uc790\uac00 \ub300\uad6d\uc73c\ub85c \ub370\uc774\ud130 \uc0dd\uc131",id:"\ub2e8\uacc4-2-\uc790\uac00-\ub300\uad6d\uc73c\ub85c-\ub370\uc774\ud130-\uc0dd\uc131",level:3},{value:"\ub2e8\uacc4 3: \uc2e0\uacbd\ub9dd \ud559\uc2b5",id:"\ub2e8\uacc4-3-\uc2e0\uacbd\ub9dd-\ud559\uc2b5",level:3},{value:"\ub2e8\uacc4 4: \ud3c9\uac00 \ubc0f \ubc18\ubcf5",id:"\ub2e8\uacc4-4-\ud3c9\uac00-\ubc0f-\ubc18\ubcf5",level:3},{value:"\uc190\uc2e4 \ud568\uc218 \uc0c1\uc138",id:"\uc190\uc2e4-\ud568\uc218-\uc0c1\uc138",level:2},{value:"Policy Loss",id:"policy-loss",level:3},{value:"Value Loss",id:"value-loss",level:3},{value:"Ownership Loss",id:"ownership-loss",level:3},{value:"\uace0\uae09 \uae30\ubc95",id:"\uace0\uae09-\uae30\ubc95",level:2},{value:"1. \ub370\uc774\ud130 \uc99d\uac15",id:"1-\ub370\uc774\ud130-\uc99d\uac15",level:3},{value:"2. \ucee4\ub9ac\ud058\ub7fc \ud559\uc2b5",id:"2-\ucee4\ub9ac\ud058\ub7fc-\ud559\uc2b5",level:3},{value:"3. \ud63c\ud569 \uc815\ubc00\ub3c4 \ud559\uc2b5",id:"3-\ud63c\ud569-\uc815\ubc00\ub3c4-\ud559\uc2b5",level:3},{value:"4. \ub2e4\uc911 GPU \ud559\uc2b5",id:"4-\ub2e4\uc911-gpu-\ud559\uc2b5",level:3},{value:"\ubaa8\ub2c8\ud130\ub9c1\uacfc \ub514\ubc84\uae45",id:"\ubaa8\ub2c8\ud130\ub9c1\uacfc-\ub514\ubc84\uae45",level:2},{value:"TensorBoard \ubaa8\ub2c8\ud130\ub9c1",id:"tensorboard-\ubaa8\ub2c8\ud130\ub9c1",level:3},{value:"\uc77c\ubc18\uc801\uc778 \ubb38\uc81c",id:"\uc77c\ubc18\uc801\uc778-\ubb38\uc81c",level:3},{value:"\uc18c\uaddc\ubaa8 \uc2e4\ud5d8 \uc81c\uc548",id:"\uc18c\uaddc\ubaa8-\uc2e4\ud5d8-\uc81c\uc548",level:2},{value:"\ucd94\uac00 \uc77d\uae30",id:"\ucd94\uac00-\uc77d\uae30",level:2}];function o(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"katago-\ud559\uc2b5-\uba54\ucee4\ub2c8\uc998-\ubd84\uc11d",children:"KataGo \ud559\uc2b5 \uba54\ucee4\ub2c8\uc998 \ubd84\uc11d"})}),"\n",(0,r.jsx)(e.p,{children:"\uc774 \ubb38\uc11c\ub294 KataGo\uc758 \ud559\uc2b5 \uba54\ucee4\ub2c8\uc998\uc744 \uc2ec\uce35\uc801\uc73c\ub85c \ubd84\uc11d\ud558\uc5ec \uc790\uac00 \ub300\uad6d \ud559\uc2b5\uc758 \uc791\ub3d9 \uc6d0\ub9ac\ub97c \uc774\ud574\ud558\ub294 \ub370 \ub3c4\uc6c0\uc744 \uc90d\ub2c8\ub2e4."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ud559\uc2b5-\uac1c\uc694",children:"\ud559\uc2b5 \uac1c\uc694"}),"\n",(0,r.jsx)(e.h3,{id:"\ud559\uc2b5-\ub8e8\ud504",children:"\ud559\uc2b5 \ub8e8\ud504"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"\ucd08\uae30 \ubaa8\ub378 \u2192 \uc790\uac00 \ub300\uad6d \u2192 \ub370\uc774\ud130 \uc218\uc9d1 \u2192 \ud559\uc2b5 \uc5c5\ub370\uc774\ud2b8 \u2192 \ub354 \uac15\ud55c \ubaa8\ub378 \u2192 \ubc18\ubcf5\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"E5 \uc790\uac00 \ub300\uad6d \u2194 \uace0\uc815\uc810 \uc218\ub834"}),"\n",(0,r.jsx)(e.li,{children:"E6 \uae30\ub825 \uace1\uc120 \u2194 S \uace1\uc120 \uc131\uc7a5"}),"\n",(0,r.jsx)(e.li,{children:"H1 MDP \u2194 \ub9c8\ub974\ucf54\ud504 \uccb4\uc778"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\ud558\ub4dc\uc6e8\uc5b4-\uc694\uad6c\uc0ac\ud56d",children:"\ud558\ub4dc\uc6e8\uc5b4 \uc694\uad6c\uc0ac\ud56d"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\ubaa8\ub378 \uaddc\ubaa8"}),(0,r.jsx)(e.th,{children:"GPU \uba54\ubaa8\ub9ac"}),(0,r.jsx)(e.th,{children:"\ud559\uc2b5 \uc2dc\uac04"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"b6c96"}),(0,r.jsx)(e.td,{children:"4 GB"}),(0,r.jsx)(e.td,{children:"\uc218 \uc2dc\uac04"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"b10c128"}),(0,r.jsx)(e.td,{children:"8 GB"}),(0,r.jsx)(e.td,{children:"1-2\uc77c"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"b18c384"}),(0,r.jsx)(e.td,{children:"16 GB"}),(0,r.jsx)(e.td,{children:"1-2\uc8fc"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"b40c256"}),(0,r.jsx)(e.td,{children:"24 GB+"}),(0,r.jsx)(e.td,{children:"\uc218 \uc8fc"})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ud658\uacbd-\uc124\uc815",children:"\ud658\uacbd \uc124\uc815"}),"\n",(0,r.jsx)(e.h3,{id:"\uc758\uc874\uc131-\uc124\uce58",children:"\uc758\uc874\uc131 \uc124\uce58"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# Python \ud658\uacbd\nconda create -n katago python=3.10\nconda activate katago\n\n# PyTorch (CUDA \ubc84\uc804)\npip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118\n\n# \uae30\ud0c0 \uc758\uc874\uc131\npip install numpy h5py tqdm tensorboard\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\ud559\uc2b5-\ucf54\ub4dc-\uac00\uc838\uc624\uae30",children:"\ud559\uc2b5 \ucf54\ub4dc \uac00\uc838\uc624\uae30"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"git clone https://github.com/lightvector/KataGo.git\ncd KataGo/python\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ud559\uc2b5-\uc124\uc815",children:"\ud559\uc2b5 \uc124\uc815"}),"\n",(0,r.jsx)(e.h3,{id:"\uc124\uc815-\ud30c\uc77c-\uad6c\uc870",children:"\uc124\uc815 \ud30c\uc77c \uad6c\uc870"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-yaml",children:'# configs/train_config.yaml\n\n# \ubaa8\ub378 \uc544\ud0a4\ud14d\ucc98\nmodel:\n  num_blocks: 10          # \uc794\ucc28 \ube14\ub85d \uc218\n  trunk_channels: 128     # \ubc31\ubcf8 \ucc44\ub110 \uc218\n  policy_channels: 32     # Policy \ud5e4\ub4dc \ucc44\ub110 \uc218\n  value_channels: 32      # Value \ud5e4\ub4dc \ucc44\ub110 \uc218\n\n# \ud559\uc2b5 \ud30c\ub77c\ubbf8\ud130\ntraining:\n  batch_size: 256\n  learning_rate: 0.001\n  lr_schedule: "cosine"\n  weight_decay: 0.0001\n  epochs: 100\n\n# \uc790\uac00 \ub300\uad6d \ud30c\ub77c\ubbf8\ud130\nselfplay:\n  num_games_per_iteration: 1000\n  max_visits: 600\n  temperature: 1.0\n  temperature_drop_move: 20\n\n# \ub370\uc774\ud130 \uc124\uc815\ndata:\n  max_history_games: 500000\n  shuffle_buffer_size: 100000\n'})}),"\n",(0,r.jsx)(e.h3,{id:"\ubaa8\ub378-\uaddc\ubaa8-\ub300\uc870\ud45c",children:"\ubaa8\ub378 \uaddc\ubaa8 \ub300\uc870\ud45c"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\uc774\ub984"}),(0,r.jsx)(e.th,{children:"num_blocks"}),(0,r.jsx)(e.th,{children:"trunk_channels"}),(0,r.jsx)(e.th,{children:"\ud30c\ub77c\ubbf8\ud130 \uc218"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"b6c96"}),(0,r.jsx)(e.td,{children:"6"}),(0,r.jsx)(e.td,{children:"96"}),(0,r.jsx)(e.td,{children:"~1M"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"b10c128"}),(0,r.jsx)(e.td,{children:"10"}),(0,r.jsx)(e.td,{children:"128"}),(0,r.jsx)(e.td,{children:"~3M"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"b18c384"}),(0,r.jsx)(e.td,{children:"18"}),(0,r.jsx)(e.td,{children:"384"}),(0,r.jsx)(e.td,{children:"~20M"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"b40c256"}),(0,r.jsx)(e.td,{children:"40"}),(0,r.jsx)(e.td,{children:"256"}),(0,r.jsx)(e.td,{children:"~45M"})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"F2 \ub124\ud2b8\uc6cc\ud06c \ud06c\uae30 vs \uae30\ub825: \uc6a9\ub7c9 \uc2a4\ucf00\uc77c\ub9c1"}),"\n",(0,r.jsx)(e.li,{children:"F6 \uc2e0\uacbd \uc2a4\ucf00\uc77c\ub9c1 \ubc95\uce59: \uc774\uc911 \ub85c\uadf8 \uad00\uacc4"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ud559\uc2b5-\ud504\ub85c\uc138\uc2a4",children:"\ud559\uc2b5 \ud504\ub85c\uc138\uc2a4"}),"\n",(0,r.jsx)(e.h3,{id:"\ub2e8\uacc4-1-\ubaa8\ub378-\ucd08\uae30\ud654",children:"\ub2e8\uacc4 1: \ubaa8\ub378 \ucd08\uae30\ud654"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"# init_model.py\nimport torch\nfrom model import KataGoModel\n\nconfig = {\n    'num_blocks': 10,\n    'trunk_channels': 128,\n    'input_features': 22,\n    'policy_size': 362,  # 361 + pass\n}\n\nmodel = KataGoModel(config)\ntorch.save(model.state_dict(), 'model_init.pt')\nprint(f\"\ubaa8\ub378 \ud30c\ub77c\ubbf8\ud130 \uc218: {sum(p.numel() for p in model.parameters()):,}\")\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\ub2e8\uacc4-2-\uc790\uac00-\ub300\uad6d\uc73c\ub85c-\ub370\uc774\ud130-\uc0dd\uc131",children:"\ub2e8\uacc4 2: \uc790\uac00 \ub300\uad6d\uc73c\ub85c \ub370\uc774\ud130 \uc0dd\uc131"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# C++ \uc5d4\uc9c4 \ucef4\ud30c\uc77c\ncd ../cpp\nmkdir build && cd build\ncmake .. -DUSE_BACKEND=CUDA\nmake -j$(nproc)\n\n# \uc790\uac00 \ub300\uad6d \uc2e4\ud589\n./katago selfplay \\\n  -model ../python/model_init.pt \\\n  -output-dir ../python/selfplay_data \\\n  -config selfplay.cfg \\\n  -num-games 1000\n"})}),"\n",(0,r.jsx)(e.p,{children:"\uc790\uac00 \ub300\uad6d \uc124\uc815 (selfplay.cfg):"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-ini",children:"maxVisits = 600\nnumSearchThreads = 4\n\n# \uc628\ub3c4 \uc124\uc815 (\ud0d0\uc0c9 \uc99d\uac00)\nchosenMoveTemperature = 1.0\nchosenMoveTemperatureEarly = 1.0\nchosenMoveTemperatureHalflife = 20\n\n# Dirichlet \ub178\uc774\uc988 (\ub2e4\uc591\uc131 \uc99d\uac00)\nrootNoiseEnabled = true\nrootDirichletNoiseTotalConcentration = 10.83\nrootDirichletNoiseWeight = 0.25\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"C3 \ud0d0\uc0c9 vs \ud65c\uc6a9: \uc628\ub3c4 \ud30c\ub77c\ubbf8\ud130"}),"\n",(0,r.jsx)(e.li,{children:"E10 Dirichlet \ub178\uc774\uc988: \ub8e8\ud2b8 \ub178\ub4dc \ud0d0\uc0c9"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\ub2e8\uacc4-3-\uc2e0\uacbd\ub9dd-\ud559\uc2b5",children:"\ub2e8\uacc4 3: \uc2e0\uacbd\ub9dd \ud559\uc2b5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"# train.py\nimport torch\nfrom torch.utils.data import DataLoader\nfrom model import KataGoModel\nfrom dataset import SelfPlayDataset\n\n# \ub370\uc774\ud130 \ub85c\ub4dc\ndataset = SelfPlayDataset('selfplay_data/')\ndataloader = DataLoader(dataset, batch_size=256, shuffle=True)\n\n# \ubaa8\ub378 \ub85c\ub4dc\nmodel = KataGoModel(config)\nmodel.load_state_dict(torch.load('model_init.pt'))\nmodel = model.cuda()\n\n# \uc635\ud2f0\ub9c8\uc774\uc800\noptimizer = torch.optim.Adam(\n    model.parameters(),\n    lr=0.001,\n    weight_decay=0.0001\n)\n\n# \ud559\uc2b5\ub960 \uc2a4\ucf00\uc904\ub7ec\nscheduler = torch.optim.lr_scheduler.CosineAnnealingLR(\n    optimizer,\n    T_max=100,\n    eta_min=0.00001\n)\n\n# \ud559\uc2b5 \ub8e8\ud504\nfor epoch in range(100):\n    model.train()\n    total_loss = 0\n\n    for batch in dataloader:\n        inputs = batch['inputs'].cuda()\n        policy_target = batch['policy'].cuda()\n        value_target = batch['value'].cuda()\n        ownership_target = batch['ownership'].cuda()\n\n        # \uc21c\uc804\ud30c\n        policy_pred, value_pred, ownership_pred = model(inputs)\n\n        # \uc190\uc2e4 \uacc4\uc0b0\n        policy_loss = torch.nn.functional.cross_entropy(\n            policy_pred, policy_target\n        )\n        value_loss = torch.nn.functional.mse_loss(\n            value_pred, value_target\n        )\n        ownership_loss = torch.nn.functional.mse_loss(\n            ownership_pred, ownership_target\n        )\n\n        loss = policy_loss + value_loss + 0.5 * ownership_loss\n\n        # \uc5ed\uc804\ud30c\n        optimizer.zero_grad()\n        loss.backward()\n        torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)\n        optimizer.step()\n\n        total_loss += loss.item()\n\n    scheduler.step()\n    print(f\"Epoch {epoch}: Loss = {total_loss / len(dataloader):.4f}\")\n\n    # \uccb4\ud06c\ud3ec\uc778\ud2b8 \uc800\uc7a5\n    torch.save(model.state_dict(), f'model_epoch{epoch}.pt')\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"D5 \uacbd\uc0ac \ud558\uac15: optimizer.step()"}),"\n",(0,r.jsx)(e.li,{children:"K2 \ubaa8\uba58\ud140: Adam \uc635\ud2f0\ub9c8\uc774\uc800"}),"\n",(0,r.jsx)(e.li,{children:"K4 \ud559\uc2b5\ub960 \uac10\uc18c: CosineAnnealingLR"}),"\n",(0,r.jsx)(e.li,{children:"K5 \uadf8\ub798\ub514\uc5b8\ud2b8 \ud074\ub9ac\ud551: clip_grad_norm_"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"\ub2e8\uacc4-4-\ud3c9\uac00-\ubc0f-\ubc18\ubcf5",children:"\ub2e8\uacc4 4: \ud3c9\uac00 \ubc0f \ubc18\ubcf5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# \uc0c8 \ubaa8\ub378 vs \uc774\uc804 \ubaa8\ub378 \ud3c9\uac00\n./katago match \\\n  -model1 model_epoch99.pt \\\n  -model2 model_init.pt \\\n  -num-games 100 \\\n  -output match_results.txt\n"})}),"\n",(0,r.jsx)(e.p,{children:"\uc0c8 \ubaa8\ub378 \uc2b9\ub960 > 55%\uc774\uba74 \uc774\uc804 \ubaa8\ub378\uc744 \ub300\uccb4\ud558\uace0 \ub2e4\uc74c \ubc18\ubcf5 \uc9c4\ud589."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\uc190\uc2e4-\ud568\uc218-\uc0c1\uc138",children:"\uc190\uc2e4 \ud568\uc218 \uc0c1\uc138"}),"\n",(0,r.jsx)(e.h3,{id:"policy-loss",children:"Policy Loss"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"# \uad50\ucc28 \uc5d4\ud2b8\ub85c\ud53c \uc190\uc2e4\npolicy_loss = -sum(target * log(pred))\n"})}),"\n",(0,r.jsx)(e.p,{children:"\ubaa9\ud45c: \uc608\uce21 \ud655\ub960 \ubd84\ud3ec\uac00 MCTS \ud0d0\uc0c9 \uacb0\uacfc\uc5d0 \uac00\uae5d\ub3c4\ub85d."}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"J1 \uc815\ucc45 \uc5d4\ud2b8\ub85c\ud53c: \uad50\ucc28 \uc5d4\ud2b8\ub85c\ud53c"}),"\n",(0,r.jsx)(e.li,{children:"J2 KL \ubc1c\uc0b0: \ubd84\ud3ec \uac70\ub9ac"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"value-loss",children:"Value Loss"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"# \ud3c9\uade0 \uc81c\uacf1 \uc624\ucc28\nvalue_loss = (pred - actual_result)^2\n"})}),"\n",(0,r.jsx)(e.p,{children:"\ubaa9\ud45c: \ub300\uad6d \ucd5c\uc885 \uacb0\uacfc(\uc2b9/\ud328/\ubb34) \uc608\uce21."}),"\n",(0,r.jsx)(e.h3,{id:"ownership-loss",children:"Ownership Loss"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"# \uac01 \uc810 \uc18c\uc720\uad8c \uc608\uce21\nownership_loss = mean((pred - actual_ownership)^2)\n"})}),"\n",(0,r.jsx)(e.p,{children:"\ubaa9\ud45c: \uac01 \uc704\uce58\uc758 \ucd5c\uc885 \uc18c\uc720\uad8c \uc608\uce21."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\uace0\uae09-\uae30\ubc95",children:"\uace0\uae09 \uae30\ubc95"}),"\n",(0,r.jsx)(e.h3,{id:"1-\ub370\uc774\ud130-\uc99d\uac15",children:"1. \ub370\uc774\ud130 \uc99d\uac15"}),"\n",(0,r.jsx)(e.p,{children:"\ubc14\ub451\ud310\uc758 \ub300\uce6d\uc131 \ud65c\uc6a9:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'def augment_data(board, policy, ownership):\n    """D4 \uad70\uc758 8\uac00\uc9c0 \ubcc0\ud658\uc73c\ub85c \ub370\uc774\ud130 \uc99d\uac15"""\n    augmented = []\n\n    for rotation in range(4):\n        for flip in [False, True]:\n            # \ud68c\uc804 \ubc0f \ub4a4\uc9d1\uae30\n            aug_board = transform(board, rotation, flip)\n            aug_policy = transform(policy, rotation, flip)\n            aug_ownership = transform(ownership, rotation, flip)\n            augmented.append((aug_board, aug_policy, aug_ownership))\n\n    return augmented\n'})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"A9 \ubc14\ub451\ud310 \ub300\uce6d\uc131: D4 \uad70"}),"\n",(0,r.jsx)(e.li,{children:"L4 \ub370\uc774\ud130 \uc99d\uac15: \ub300\uce6d\uc131 \ud65c\uc6a9"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"2-\ucee4\ub9ac\ud058\ub7fc-\ud559\uc2b5",children:"2. \ucee4\ub9ac\ud058\ub7fc \ud559\uc2b5"}),"\n",(0,r.jsx)(e.p,{children:"\uc26c\uc6b4 \uac83\ubd80\ud130 \ubcf5\uc7a1\ud55c \uac83\uc73c\ub85c:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"# \uba3c\uc800 \uc801\uc740 \ud0d0\uc0c9 \ud69f\uc218\ub85c \ud559\uc2b5\nschedule = [\n    (100, 10000),   # 100 visits, 10000 games\n    (200, 20000),   # 200 visits, 20000 games\n    (400, 50000),   # 400 visits, 50000 games\n    (600, 100000),  # 600 visits, 100000 games\n]\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"E12 \ud559\uc2b5 \ucee4\ub9ac\ud058\ub7fc: \ucee4\ub9ac\ud058\ub7fc \ud559\uc2b5"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"3-\ud63c\ud569-\uc815\ubc00\ub3c4-\ud559\uc2b5",children:"3. \ud63c\ud569 \uc815\ubc00\ub3c4 \ud559\uc2b5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"from torch.cuda.amp import autocast, GradScaler\n\nscaler = GradScaler()\n\nwith autocast():\n    policy_pred, value_pred, ownership_pred = model(inputs)\n    loss = compute_loss(...)\n\nscaler.scale(loss).backward()\nscaler.step(optimizer)\nscaler.update()\n"})}),"\n",(0,r.jsx)(e.h3,{id:"4-\ub2e4\uc911-gpu-\ud559\uc2b5",children:"4. \ub2e4\uc911 GPU \ud559\uc2b5"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"import torch.distributed as dist\nfrom torch.nn.parallel import DistributedDataParallel\n\n# \ubd84\uc0b0 \ucd08\uae30\ud654\ndist.init_process_group(backend='nccl')\n\n# \ubaa8\ub378 \ub798\ud551\nmodel = DistributedDataParallel(model)\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ubaa8\ub2c8\ud130\ub9c1\uacfc-\ub514\ubc84\uae45",children:"\ubaa8\ub2c8\ud130\ub9c1\uacfc \ub514\ubc84\uae45"}),"\n",(0,r.jsx)(e.h3,{id:"tensorboard-\ubaa8\ub2c8\ud130\ub9c1",children:"TensorBoard \ubaa8\ub2c8\ud130\ub9c1"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"from torch.utils.tensorboard import SummaryWriter\n\nwriter = SummaryWriter('runs/training')\n\n# \uc190\uc2e4 \uae30\ub85d\nwriter.add_scalar('Loss/policy', policy_loss, step)\nwriter.add_scalar('Loss/value', value_loss, step)\nwriter.add_scalar('Loss/total', total_loss, step)\n\n# \ud559\uc2b5\ub960 \uae30\ub85d\nwriter.add_scalar('LR', scheduler.get_last_lr()[0], step)\n"})}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"tensorboard --logdir runs\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\uc77c\ubc18\uc801\uc778-\ubb38\uc81c",children:"\uc77c\ubc18\uc801\uc778 \ubb38\uc81c"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\ubb38\uc81c"}),(0,r.jsx)(e.th,{children:"\uac00\ub2a5\ud55c \uc6d0\uc778"}),(0,r.jsx)(e.th,{children:"\ud574\uacb0 \ubc29\ubc95"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\uc190\uc2e4\uc774 \uc904\uc9c0 \uc54a\uc74c"}),(0,r.jsx)(e.td,{children:"\ud559\uc2b5\ub960\uc774 \ub108\ubb34 \ub0ae\uac70\ub098 \ub192\uc74c"}),(0,r.jsx)(e.td,{children:"\ud559\uc2b5\ub960 \uc870\uc815"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\uc190\uc2e4 \uc9c4\ub3d9"}),(0,r.jsx)(e.td,{children:"\ubc30\uce58 \ud06c\uae30\uac00 \ub108\ubb34 \uc791\uc74c"}),(0,r.jsx)(e.td,{children:"\ubc30\uce58 \ud06c\uae30 \uc99d\uac00"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\uacfc\uc801\ud569"}),(0,r.jsx)(e.td,{children:"\ub370\uc774\ud130 \ubd80\uc871"}),(0,r.jsx)(e.td,{children:"\ub354 \ub9ce\uc740 \uc790\uac00 \ub300\uad6d \ub370\uc774\ud130 \uc0dd\uc131"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"\uae30\ub825 \ud5a5\uc0c1 \uc5c6\uc74c"}),(0,r.jsx)(e.td,{children:"\ud0d0\uc0c9 \ud69f\uc218 \ubd80\uc871"}),(0,r.jsx)(e.td,{children:"maxVisits \uc99d\uac00"})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"L1 \uacfc\uc801\ud569: \uacfc\uc789 \uc801\uc751"}),"\n",(0,r.jsx)(e.li,{children:"L2 \uc815\uaddc\ud654: weight_decay"}),"\n",(0,r.jsx)(e.li,{children:"D6 \ud559\uc2b5\ub960 \ud6a8\uacfc: \ud29c\ub2dd"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\uc18c\uaddc\ubaa8-\uc2e4\ud5d8-\uc81c\uc548",children:"\uc18c\uaddc\ubaa8 \uc2e4\ud5d8 \uc81c\uc548"}),"\n",(0,r.jsx)(e.p,{children:"\uc2e4\ud5d8\ub9cc \ud558\ub824\uba74 \ub2e4\uc74c\uc744 \uad8c\uc7a5\ud569\ub2c8\ub2e4:"}),"\n",(0,r.jsxs)(e.ol,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"9\xd79 \ubc14\ub451\ud310 \uc0ac\uc6a9"}),": \uacc4\uc0b0\ub7c9 \ub300\ud3ed \uac10\uc18c"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\uc18c\ud615 \ubaa8\ub378 \uc0ac\uc6a9"}),": b6c96\ub85c \ucda9\ubd84"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\ud0d0\uc0c9 \ud69f\uc218 \uac10\uc18c"}),": 100-200 visits"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.strong,{children:"\uc0ac\uc804 \ud559\uc2b5 \ubaa8\ub378 \ubbf8\uc138 \uc870\uc815"}),": \ucc98\uc74c\ubd80\ud130 \uc2dc\uc791\ud558\ub294 \uac83\ubcf4\ub2e4 \ube60\ub984"]}),"\n"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-bash",children:"# 9\xd79 \ubc14\ub451\ud310 \uc124\uc815\nboardSize = 9\nmaxVisits = 100\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ucd94\uac00-\uc77d\uae30",children:"\ucd94\uac00 \uc77d\uae30"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"../source-code",children:"\uc18c\uc2a4 \ucf54\ub4dc \uac00\uc774\ub4dc"})," \u2014 \ucf54\ub4dc \uad6c\uc870 \uc774\ud574"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"../contributing",children:"\uc624\ud508\uc18c\uc2a4 \ucee4\ubba4\ub2c8\ud2f0 \ucc38\uc5ec"})," \u2014 \ubd84\uc0b0 \ud559\uc2b5 \ucc38\uc5ec"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"../../how-it-works/katago-innovations",children:"KataGo\uc758 \ud575\uc2ec \ud601\uc2e0"})," \u2014 50\ubc30 \ud6a8\uc728\uc758 \ube44\ubc00"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(o,{...n})}):o(n)}},30416(n,e,s){s.d(e,{R:()=>d,x:()=>t});var l=s(59471);const r={},i=l.createContext(r);function d(n){const e=l.useContext(i);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:d(n.components),l.createElement(i.Provider,{value:e},n.children)}}}]);