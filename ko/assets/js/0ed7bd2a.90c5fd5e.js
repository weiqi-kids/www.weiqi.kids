"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[9484],{38389(n,e,s){s.r(e),s.d(e,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>l,toc:()=>o});const l=JSON.parse('{"id":"tech/deep-dive/source-code","title":"KataGo \uc18c\uc2a4 \ucf54\ub4dc \uac00\uc774\ub4dc","description":"KataGo \ucf54\ub4dc \uad6c\uc870, \ud575\uc2ec \ubaa8\ub4c8 \ubc0f \uc544\ud0a4\ud14d\ucc98 \uc124\uacc4","source":"@site/i18n/ko/docusaurus-plugin-content-docs/current/tech/deep-dive/source-code.md","sourceDirName":"tech/deep-dive","slug":"/tech/deep-dive/source-code","permalink":"/ko/docs/tech/deep-dive/source-code","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tech/deep-dive/source-code.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"title":"KataGo \uc18c\uc2a4 \ucf54\ub4dc \uac00\uc774\ub4dc","description":"KataGo \ucf54\ub4dc \uad6c\uc870, \ud575\uc2ec \ubaa8\ub4c8 \ubc0f \uc544\ud0a4\ud14d\ucc98 \uc124\uacc4"},"sidebar":"tutorialSidebar","previous":{"title":"\uc2ec\uce35 \uc5f0\uad6c\ub97c \uc6d0\ud558\ub294 \ubd84\ub4e4\uc744 \uc704\ud574","permalink":"/ko/docs/tech/deep-dive/"},"next":{"title":"KataGo \ud559\uc2b5 \uba54\ucee4\ub2c8\uc998 \ubd84\uc11d","permalink":"/ko/docs/tech/deep-dive/training"}}');var i=s(62615),r=s(30416);const c={sidebar_position:2,title:"KataGo \uc18c\uc2a4 \ucf54\ub4dc \uac00\uc774\ub4dc",description:"KataGo \ucf54\ub4dc \uad6c\uc870, \ud575\uc2ec \ubaa8\ub4c8 \ubc0f \uc544\ud0a4\ud14d\ucc98 \uc124\uacc4"},a="KataGo \uc18c\uc2a4 \ucf54\ub4dc \uac00\uc774\ub4dc",d={},o=[{value:"\uc18c\uc2a4 \ucf54\ub4dc \uac00\uc838\uc624\uae30",id:"\uc18c\uc2a4-\ucf54\ub4dc-\uac00\uc838\uc624\uae30",level:2},{value:"\ub514\ub809\ud1a0\ub9ac \uad6c\uc870",id:"\ub514\ub809\ud1a0\ub9ac-\uad6c\uc870",level:2},{value:"\ud575\uc2ec \ubaa8\ub4c8 \ubd84\uc11d",id:"\ud575\uc2ec-\ubaa8\ub4c8-\ubd84\uc11d",level:2},{value:"1. game/ \u2014 \ubc14\ub451 \uaddc\uce59",id:"1-game--\ubc14\ub451-\uaddc\uce59",level:3},{value:"board.h / board.cpp",id:"boardh--boardcpp",level:4},{value:"rules.h / rules.cpp",id:"rulesh--rulescpp",level:4},{value:"2. search/ \u2014 MCTS \ud0d0\uc0c9",id:"2-search--mcts-\ud0d0\uc0c9",level:3},{value:"search.h / search.cpp",id:"searchh--searchcpp",level:4},{value:"searchparams.h",id:"searchparamsh",level:4},{value:"3. neuralnet/ \u2014 \uc2e0\uacbd\ub9dd \ucd94\ub860",id:"3-neuralnet--\uc2e0\uacbd\ub9dd-\ucd94\ub860",level:3},{value:"nninputs.h / nninputs.cpp",id:"nninputsh--nninputscpp",level:4},{value:"nneval.h / nneval.cpp",id:"nnevalh--nnevalcpp",level:4},{value:"4. command/ \u2014 \uba85\ub839\uc5b4 \ucc98\ub9ac",id:"4-command--\uba85\ub839\uc5b4-\ucc98\ub9ac",level:3},{value:"gtp.cpp",id:"gtpcpp",level:4},{value:"analysis.cpp",id:"analysiscpp",level:4},{value:"Python \ud559\uc2b5 \ucf54\ub4dc",id:"python-\ud559\uc2b5-\ucf54\ub4dc",level:2},{value:"model.py \u2014 \ub124\ud2b8\uc6cc\ud06c \uc544\ud0a4\ud14d\ucc98",id:"modelpy--\ub124\ud2b8\uc6cc\ud06c-\uc544\ud0a4\ud14d\ucc98",level:3},{value:"train.py \u2014 \ud559\uc2b5 \ub8e8\ud504",id:"trainpy--\ud559\uc2b5-\ub8e8\ud504",level:3},{value:"\ud575\uc2ec \uc54c\uace0\ub9ac\uc998 \uad6c\ud604",id:"\ud575\uc2ec-\uc54c\uace0\ub9ac\uc998-\uad6c\ud604",level:2},{value:"PUCT \uc120\ud0dd \uacf5\uc2dd",id:"puct-\uc120\ud0dd-\uacf5\uc2dd",level:3},{value:"\uac00\uc0c1 \uc190\uc2e4",id:"\uac00\uc0c1-\uc190\uc2e4",level:3},{value:"\ucef4\ud30c\uc77c\uacfc \ub514\ubc84\uae45",id:"\ucef4\ud30c\uc77c\uacfc-\ub514\ubc84\uae45",level:2},{value:"\ucef4\ud30c\uc77c (Debug \ubaa8\ub4dc)",id:"\ucef4\ud30c\uc77c-debug-\ubaa8\ub4dc",level:3},{value:"\ub2e8\uc704 \ud14c\uc2a4\ud2b8",id:"\ub2e8\uc704-\ud14c\uc2a4\ud2b8",level:3},{value:"\ub514\ubc84\uae45 \ud301",id:"\ub514\ubc84\uae45-\ud301",level:3},{value:"\ucd94\uac00 \uc77d\uae30",id:"\ucd94\uac00-\uc77d\uae30",level:2}];function t(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...n.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(e.header,{children:(0,i.jsx)(e.h1,{id:"katago-\uc18c\uc2a4-\ucf54\ub4dc-\uac00\uc774\ub4dc",children:"KataGo \uc18c\uc2a4 \ucf54\ub4dc \uac00\uc774\ub4dc"})}),"\n",(0,i.jsx)(e.p,{children:"\uc774 \ubb38\uc11c\ub294 KataGo\uc758 \ucf54\ub4dc \uad6c\uc870\ub97c \uc548\ub0b4\ud558\uba70, \uae4a\uc774 \uc5f0\uad6c\ud558\uac70\ub098 \ucf54\ub4dc\uc5d0 \uae30\uc5ec\ud558\uace0\uc790 \ud558\ub294 \uc5d4\uc9c0\ub2c8\uc5b4\uc5d0\uac8c \uc801\ud569\ud569\ub2c8\ub2e4."}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\uc18c\uc2a4-\ucf54\ub4dc-\uac00\uc838\uc624\uae30",children:"\uc18c\uc2a4 \ucf54\ub4dc \uac00\uc838\uc624\uae30"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"git clone https://github.com/lightvector/KataGo.git\ncd KataGo\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\ub514\ub809\ud1a0\ub9ac-\uad6c\uc870",children:"\ub514\ub809\ud1a0\ub9ac \uad6c\uc870"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{children:"KataGo/\n\u251c\u2500\u2500 cpp/                    # C++ \ud575\uc2ec \uc5d4\uc9c4\n\u2502   \u251c\u2500\u2500 main.cpp            # \uba54\uc778 \ud504\ub85c\uadf8\ub7a8 \uc9c4\uc785\uc810\n\u2502   \u251c\u2500\u2500 command/            # \uba85\ub839\uc5b4 \ucc98\ub9ac\n\u2502   \u251c\u2500\u2500 core/               # \ud575\uc2ec \uc720\ud2f8\ub9ac\ud2f0\n\u2502   \u251c\u2500\u2500 game/               # \ubc14\ub451 \uaddc\uce59\n\u2502   \u251c\u2500\u2500 search/             # MCTS \ud0d0\uc0c9\n\u2502   \u251c\u2500\u2500 neuralnet/          # \uc2e0\uacbd\ub9dd \ucd94\ub860\n\u2502   \u251c\u2500\u2500 dataio/             # \ub370\uc774\ud130 I/O\n\u2502   \u2514\u2500\u2500 tests/              # \ub2e8\uc704 \ud14c\uc2a4\ud2b8\n\u2502\n\u251c\u2500\u2500 python/                 # Python \ud559\uc2b5 \ucf54\ub4dc\n\u2502   \u251c\u2500\u2500 train.py            # \ud559\uc2b5 \uba54\uc778 \ud504\ub85c\uadf8\ub7a8\n\u2502   \u251c\u2500\u2500 model.py            # \ub124\ud2b8\uc6cc\ud06c \uc544\ud0a4\ud14d\ucc98 \uc815\uc758\n\u2502   \u251c\u2500\u2500 data/               # \ub370\uc774\ud130 \ucc98\ub9ac\n\u2502   \u2514\u2500\u2500 configs/            # \ud559\uc2b5 \uc124\uc815\n\u2502\n\u2514\u2500\u2500 docs/                   # \ubb38\uc11c\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\ud575\uc2ec-\ubaa8\ub4c8-\ubd84\uc11d",children:"\ud575\uc2ec \ubaa8\ub4c8 \ubd84\uc11d"}),"\n",(0,i.jsx)(e.h3,{id:"1-game--\ubc14\ub451-\uaddc\uce59",children:"1. game/ \u2014 \ubc14\ub451 \uaddc\uce59"}),"\n",(0,i.jsx)(e.p,{children:"\ubc14\ub451 \uaddc\uce59\uc758 \uc644\uc804\ud55c \uad6c\ud604."}),"\n",(0,i.jsx)(e.h4,{id:"boardh--boardcpp",children:"board.h / board.cpp"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"// \ubc14\ub451\ud310 \uc0c1\ud0dc \ud45c\ud604\nclass Board {\npublic:\n    static constexpr int MAX_BOARD_SIZE = 19;\n\n    // \ubc14\ub451\ud310 \uc0c1\ud0dc\n    Color colors[MAX_ARR_SIZE];  // \uac01 \uc704\uce58\uc758 \uc0c9\uc0c1\n    Chain chains[MAX_ARR_SIZE];  // \ub3cc \uadf8\ub8f9 \uc815\ubcf4\n\n    // \ud575\uc2ec \uc5f0\uc0b0\n    bool playMove(Loc loc, Player pla);  // \ud55c \uc218 \ucc29\uc218\n    bool isLegal(Loc loc, Player pla);   // \ud569\ubc95\uc131 \ud310\ub2e8\n    void calculateArea(Color* area);      // \uc601\uc5ed \uacc4\uc0b0\n};\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"A2 \uaca9\uc790 \ubaa8\ub378: \ubc14\ub451\ud310\uc758 \ub370\uc774\ud130 \uad6c\uc870"}),"\n",(0,i.jsx)(e.li,{children:"A6 \uc5f0\uacb0 \uc601\uc5ed: \ub3cc \uadf8\ub8f9(Chain) \ud45c\ud604"}),"\n",(0,i.jsx)(e.li,{children:"A7 \ud65c\ub85c \uacc4\uc0b0: liberty \ucd94\uc801"}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"rulesh--rulescpp",children:"rules.h / rules.cpp"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"// \ub2e4\uc911 \uaddc\uce59 \uc9c0\uc6d0\nstruct Rules {\n    enum KoRule { SIMPLE_KO, POSITIONAL_KO, SITUATIONAL_KO };\n    enum ScoringRule { TERRITORY_SCORING, AREA_SCORING };\n    enum TaxRule { NO_TAX, TAX_SEKI, TAX_ALL };\n\n    KoRule koRule;\n    ScoringRule scoringRule;\n    TaxRule taxRule;\n    float komi;\n\n    // \uaddc\uce59 \uc774\ub984 \ub9e4\ud551\n    static Rules parseRules(const std::string& name);\n};\n"})}),"\n",(0,i.jsx)(e.p,{children:"\uc9c0\uc6d0\ud558\ub294 \uaddc\uce59:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"chinese"}),": \uc911\uad6d \uaddc\uce59 (\uacc4\uc790)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"japanese"}),": \uc77c\ubcf8 \uaddc\uce59 (\uacc4\ubaa9)"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"korean"}),": \ud55c\uad6d \uaddc\uce59"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"aga"}),": \ubbf8\uad6d \uaddc\uce59"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.code,{children:"tromp-taylor"}),": Tromp-Taylor \uaddc\uce59"]}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"2-search--mcts-\ud0d0\uc0c9",children:"2. search/ \u2014 MCTS \ud0d0\uc0c9"}),"\n",(0,i.jsx)(e.p,{children:"\ubaac\ud14c\uce74\ub97c\ub85c \ud2b8\ub9ac \ud0d0\uc0c9 \uad6c\ud604."}),"\n",(0,i.jsx)(e.h4,{id:"searchh--searchcpp",children:"search.h / search.cpp"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"class Search {\npublic:\n    // \ud575\uc2ec \ud0d0\uc0c9\n    void runWholeSearch(Player pla);\n\n    // MCTS \ub2e8\uacc4\n    void selectNode();           // \ub178\ub4dc \uc120\ud0dd\n    void expandNode();           // \ub178\ub4dc \ud655\uc7a5\n    void evaluateNode();         // \uc2e0\uacbd\ub9dd \ud3c9\uac00\n    void backpropValue();        // \uc5ed\uc804\ud30c \uc5c5\ub370\uc774\ud2b8\n\n    // \uacb0\uacfc \uac00\uc838\uc624\uae30\n    Loc getChosenMove();\n    std::vector<MoveInfo> getSortedMoveInfos();\n};\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"C5 MCTS 4\ub2e8\uacc4: select \u2192 expand \u2192 evaluate \u2192 backprop\uc5d0 \ub300\uc751"}),"\n",(0,i.jsxs)(e.li,{children:["E4 PUCT \uacf5\uc2dd: ",(0,i.jsx)(e.code,{children:"selectNode()"}),"\uc5d0\uc11c \uad6c\ud604"]}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"searchparamsh",children:"searchparams.h"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"struct SearchParams {\n    // \ud0d0\uc0c9 \uc81c\uc5b4\n    int64_t maxVisits;          // \ucd5c\ub300 \ubc29\ubb38 \ud69f\uc218\n    double maxTime;             // \ucd5c\ub300 \uc2dc\uac04\n\n    // PUCT \ud30c\ub77c\ubbf8\ud130\n    double cpuctExploration;    // \ud0d0\uc0c9 \uc0c1\uc218\n    double cpuctBase;\n\n    // \uac00\uc0c1 \uc190\uc2e4\n    int virtualLoss;\n\n    // \ub8e8\ud2b8 \ub178\ub4dc \ub178\uc774\uc988\n    double rootNoiseEnabled;\n    double rootDirichletAlpha;\n};\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"3-neuralnet--\uc2e0\uacbd\ub9dd-\ucd94\ub860",children:"3. neuralnet/ \u2014 \uc2e0\uacbd\ub9dd \ucd94\ub860"}),"\n",(0,i.jsx)(e.p,{children:"\uc2e0\uacbd\ub9dd \ucd94\ub860 \uc5d4\uc9c4."}),"\n",(0,i.jsx)(e.h4,{id:"nninputsh--nninputscpp",children:"nninputs.h / nninputs.cpp"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"// \uc2e0\uacbd\ub9dd \uc785\ub825 \ud2b9\uc131\nclass NNInputs {\npublic:\n    // \ud2b9\uc131 \ud3c9\uba74\n    static constexpr int NUM_FEATURES = 22;\n\n    // \ud2b9\uc131 \ucc44\uc6b0\uae30\n    static void fillFeatures(\n        const Board& board,\n        const BoardHistory& hist,\n        float* features\n    );\n};\n"})}),"\n",(0,i.jsx)(e.p,{children:"\uc785\ub825 \ud2b9\uc131 \ud3ec\ud568:"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"\ud751\ub3cc \uc704\uce58, \ubc31\ub3cc \uc704\uce58"}),"\n",(0,i.jsx)(e.li,{children:"\ud65c\ub85c \uc218 (1, 2, 3+)"}),"\n",(0,i.jsx)(e.li,{children:"\ud788\uc2a4\ud1a0\ub9ac \ucc29\uc218"}),"\n",(0,i.jsx)(e.li,{children:"\uaddc\uce59 \uc778\ucf54\ub529"}),"\n"]}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"A10 \ud788\uc2a4\ud1a0\ub9ac \uc2a4\ud0dd: \ub2e4\uc911 \ud504\ub808\uc784 \uc785\ub825"}),"\n",(0,i.jsx)(e.li,{children:"A11 \ud569\ubc95 \ucc29\uc218 \ub9c8\uc2a4\ud06c: \uae08\uc218 \ud544\ud130\ub9c1"}),"\n"]}),"\n",(0,i.jsx)(e.h4,{id:"nnevalh--nnevalcpp",children:"nneval.h / nneval.cpp"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"// \uc2e0\uacbd\ub9dd \ud3c9\uac00 \uacb0\uacfc\nstruct NNOutput {\n    // Policy \ucd9c\ub825 (362\uac1c \uc704\uce58, pass \ud3ec\ud568)\n    float policyProbs[NNPos::MAX_NN_POLICY_SIZE];\n\n    // Value \ucd9c\ub825\n    float winProb;       // \uc2b9\ub960\n    float lossProb;      // \ud328\ub960\n    float noResultProb;  // \ubb34\uc2b9\ubd80\uc728\n\n    // \ubcf4\uc870 \ucd9c\ub825\n    float scoreMean;     // \uc9d1\uc218 \uc608\uce21\n    float scoreStdev;    // \uc9d1\uc218 \ud45c\uc900\ud3b8\ucc28\n    float lead;          // \ub9ac\ub4dc \uc9d1\uc218\n\n    // \uc601\uc5ed \uc608\uce21\n    float ownership[NNPos::MAX_BOARD_AREA];\n};\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"E1 \uc815\ucc45 \ub124\ud2b8\uc6cc\ud06c: policyProbs"}),"\n",(0,i.jsx)(e.li,{children:"E2 \uac00\uce58 \ub124\ud2b8\uc6cc\ud06c: winProb, scoreMean"}),"\n",(0,i.jsx)(e.li,{children:"E3 \ub4c0\uc5bc \ud5e4\ub4dc \ub124\ud2b8\uc6cc\ud06c: \ub2e4\uc911 \ucd9c\ub825 \ud5e4\ub4dc \uc124\uacc4"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h3,{id:"4-command--\uba85\ub839\uc5b4-\ucc98\ub9ac",children:"4. command/ \u2014 \uba85\ub839\uc5b4 \ucc98\ub9ac"}),"\n",(0,i.jsx)(e.p,{children:"\ub2e4\uc591\ud55c \uc2e4\ud589 \ubaa8\ub4dc \uad6c\ud604."}),"\n",(0,i.jsx)(e.h4,{id:"gtpcpp",children:"gtp.cpp"}),"\n",(0,i.jsx)(e.p,{children:"GTP(Go Text Protocol) \ubaa8\ub4dc \uad6c\ud604:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:'void MainCmds::gtp(const std::vector<std::string>& args) {\n    // \uba85\ub839\uc5b4 \ud30c\uc2f1 \ubc0f \uc2e4\ud589\n    while(true) {\n        std::string line;\n        std::getline(std::cin, line);\n\n        if(line == "name") {\n            respond("KataGo");\n        }\n        else if(line.find("play") == 0) {\n            // \ucc29\uc218 \uba85\ub839 \ucc98\ub9ac\n        }\n        else if(line.find("genmove") == 0) {\n            // \ud0d0\uc0c9 \uc2e4\ud589 \ubc0f \ucd5c\uc120\uc758 \ucc29\uc218 \ubc18\ud658\n        }\n        // ... \uae30\ud0c0 \uba85\ub839\uc5b4\n    }\n}\n'})}),"\n",(0,i.jsx)(e.h4,{id:"analysiscpp",children:"analysis.cpp"}),"\n",(0,i.jsx)(e.p,{children:"Analysis Engine \uad6c\ud604:"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"void MainCmds::analysis(const std::vector<std::string>& args) {\n    while(true) {\n        // JSON \uc694\uccad \uc77d\uae30\n        std::string line;\n        std::getline(std::cin, line);\n        json query = json::parse(line);\n\n        // \ubc14\ub451\ud310 \uc0c1\ud0dc \uc124\uc815\n        Board board = setupBoard(query);\n\n        // \ubd84\uc11d \uc2e4\ud589\n        Search search(...);\n        search.runWholeSearch();\n\n        // JSON \uc751\ub2f5 \ucd9c\ub825\n        json response = formatResponse(search);\n        std::cout << response.dump() << std::endl;\n    }\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"python-\ud559\uc2b5-\ucf54\ub4dc",children:"Python \ud559\uc2b5 \ucf54\ub4dc"}),"\n",(0,i.jsx)(e.h3,{id:"modelpy--\ub124\ud2b8\uc6cc\ud06c-\uc544\ud0a4\ud14d\ucc98",children:"model.py \u2014 \ub124\ud2b8\uc6cc\ud06c \uc544\ud0a4\ud14d\ucc98"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"class Model(nn.Module):\n    def __init__(self, config):\n        super().__init__()\n\n        # \ucd08\uae30 \ud569\uc131\uacf1\n        self.initial_conv = nn.Conv2d(\n            in_channels=config.input_features,\n            out_channels=config.trunk_channels,\n            kernel_size=3, padding=1\n        )\n\n        # \uc794\ucc28 \ud0c0\uc6cc\n        self.trunk = nn.ModuleList([\n            ResidualBlock(config.trunk_channels)\n            for _ in range(config.num_blocks)\n        ])\n\n        # \ucd9c\ub825 \ud5e4\ub4dc\n        self.policy_head = PolicyHead(config)\n        self.value_head = ValueHead(config)\n        self.ownership_head = OwnershipHead(config)\n\n    def forward(self, x):\n        # \ucd08\uae30 \ud569\uc131\uacf1\n        x = self.initial_conv(x)\n\n        # \uc794\ucc28 \ud0c0\uc6cc\n        for block in self.trunk:\n            x = block(x)\n\n        # \ub2e4\uc911 \ud5e4\ub4dc \ucd9c\ub825\n        policy = self.policy_head(x)\n        value = self.value_head(x)\n        ownership = self.ownership_head(x)\n\n        return policy, value, ownership\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"D9 \ud569\uc131\uacf1 \uc5f0\uc0b0: Conv2d"}),"\n",(0,i.jsx)(e.li,{children:"D12 \uc794\ucc28 \uc5f0\uacb0: ResidualBlock"}),"\n",(0,i.jsx)(e.li,{children:"E11 \uc794\ucc28 \ud0c0\uc6cc: trunk \uad6c\uc870"}),"\n"]}),"\n",(0,i.jsx)(e.h3,{id:"trainpy--\ud559\uc2b5-\ub8e8\ud504",children:"train.py \u2014 \ud559\uc2b5 \ub8e8\ud504"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-python",children:"def train_step(model, optimizer, batch):\n    # \uc21c\uc804\ud30c\n    policy_pred, value_pred, ownership_pred = model(batch.inputs)\n\n    # \uc190\uc2e4 \uacc4\uc0b0\n    policy_loss = cross_entropy(policy_pred, batch.policy_target)\n    value_loss = mse_loss(value_pred, batch.value_target)\n    ownership_loss = mse_loss(ownership_pred, batch.ownership_target)\n\n    total_loss = policy_loss + value_loss + ownership_loss\n\n    # \uc5ed\uc804\ud30c\n    optimizer.zero_grad()\n    total_loss.backward()\n    optimizer.step()\n\n    return total_loss.item()\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"D3 \uc21c\uc804\ud30c: model(batch.inputs)"}),"\n",(0,i.jsx)(e.li,{children:"D13 \uc5ed\uc804\ud30c: total_loss.backward()"}),"\n",(0,i.jsx)(e.li,{children:"K3 Adam: optimizer.step()"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\ud575\uc2ec-\uc54c\uace0\ub9ac\uc998-\uad6c\ud604",children:"\ud575\uc2ec \uc54c\uace0\ub9ac\uc998 \uad6c\ud604"}),"\n",(0,i.jsx)(e.h3,{id:"puct-\uc120\ud0dd-\uacf5\uc2dd",children:"PUCT \uc120\ud0dd \uacf5\uc2dd"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"// search.cpp\ndouble Search::getPUCTScore(const SearchNode* node, int moveIdx) {\n    double Q = node->getChildValue(moveIdx);\n    double P = node->getChildPolicy(moveIdx);\n    double N_parent = node->visits;\n    double N_child = node->getChildVisits(moveIdx);\n\n    double exploration = params.cpuctExploration;\n    double cpuct = exploration * sqrt(N_parent) / (1.0 + N_child);\n\n    return Q + cpuct * P;\n}\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\uac00\uc0c1-\uc190\uc2e4",children:"\uac00\uc0c1 \uc190\uc2e4"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"// \ub2e4\uc911 \uc2a4\ub808\ub4dc\uac00 \uac19\uc740 \ub178\ub4dc\ub97c \uc120\ud0dd\ud558\ub294 \uac83\uc744 \ubc29\uc9c0\nvoid Search::applyVirtualLoss(SearchNode* node) {\n    node->virtualLoss += params.virtualLoss;\n}\n\nvoid Search::removeVirtualLoss(SearchNode* node) {\n    node->virtualLoss -= params.virtualLoss;\n}\n"})}),"\n",(0,i.jsxs)(e.p,{children:[(0,i.jsx)(e.strong,{children:"\uc560\ub2c8\uba54\uc774\uc158 \ub300\uc751"}),":"]}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsx)(e.li,{children:"C9 \uac00\uc0c1 \uc190\uc2e4: \ubcd1\ub82c \ud0d0\uc0c9 \uae30\ubc95"}),"\n"]}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\ucef4\ud30c\uc77c\uacfc-\ub514\ubc84\uae45",children:"\ucef4\ud30c\uc77c\uacfc \ub514\ubc84\uae45"}),"\n",(0,i.jsx)(e.h3,{id:"\ucef4\ud30c\uc77c-debug-\ubaa8\ub4dc",children:"\ucef4\ud30c\uc77c (Debug \ubaa8\ub4dc)"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"cd cpp\nmkdir build && cd build\ncmake .. -DUSE_BACKEND=OPENCL -DCMAKE_BUILD_TYPE=Debug\nmake -j$(nproc)\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\ub2e8\uc704-\ud14c\uc2a4\ud2b8",children:"\ub2e8\uc704 \ud14c\uc2a4\ud2b8"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-bash",children:"./katago runtests\n"})}),"\n",(0,i.jsx)(e.h3,{id:"\ub514\ubc84\uae45-\ud301",children:"\ub514\ubc84\uae45 \ud301"}),"\n",(0,i.jsx)(e.pre,{children:(0,i.jsx)(e.code,{className:"language-cpp",children:"// \uc0c1\uc138 \ub85c\uadf8 \ud65c\uc131\ud654\n#define SEARCH_DEBUG 1\n\n// \ud0d0\uc0c9 \uc911 \ube0c\ub808\uc774\ud06c\ud3ec\uc778\ud2b8 \ucd94\uac00\nif(node->visits > 1000) {\n    // \ud0d0\uc0c9 \uc0c1\ud0dc \uac80\uc0ac\uc6a9 \ube0c\ub808\uc774\ud06c\ud3ec\uc778\ud2b8 \uc124\uc815\n}\n"})}),"\n",(0,i.jsx)(e.hr,{}),"\n",(0,i.jsx)(e.h2,{id:"\ucd94\uac00-\uc77d\uae30",children:"\ucd94\uac00 \uc77d\uae30"}),"\n",(0,i.jsxs)(e.ul,{children:["\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"../training",children:"KataGo \ud559\uc2b5 \uba54\ucee4\ub2c8\uc998 \ubd84\uc11d"})," \u2014 \uc804\uccb4 \ud559\uc2b5 \ud504\ub85c\uc138\uc2a4"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"../contributing",children:"\uc624\ud508\uc18c\uc2a4 \ucee4\ubba4\ub2c8\ud2f0 \ucc38\uc5ec"})," \u2014 \uae30\uc5ec \uac00\uc774\ub4dc"]}),"\n",(0,i.jsxs)(e.li,{children:[(0,i.jsx)(e.a,{href:"/docs/animations/",children:"\uac1c\ub150 \ube60\ub978 \ucc38\uc870\ud45c"})," \u2014 109\uac1c \uac1c\ub150 \ub300\uc870"]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,r.R)(),...n.components};return e?(0,i.jsx)(e,{...n,children:(0,i.jsx)(t,{...n})}):t(n)}},30416(n,e,s){s.d(e,{R:()=>c,x:()=>a});var l=s(59471);const i={},r=l.createContext(i);function c(n){const e=l.useContext(r);return l.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function a(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(i):n.components||i:c(n.components),l.createElement(r.Provider,{value:e},n.children)}}}]);