"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[4194],{21036(n,e,l){l.r(e),l.d(e,{assets:()=>t,contentTitle:()=>c,default:()=>a,frontMatter:()=>i,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"for-engineers/deep-dive/neural-network","title":"\uc2e0\uacbd\ub9dd \uc544\ud0a4\ud14d\ucc98 \uc0c1\uc138 \ubd84\uc11d","description":"KataGo\uc758 \uc2e0\uacbd\ub9dd \uc124\uacc4, \uc785\ub825 \ud2b9\uc131 \ubc0f \ub2e4\uc911 \ud5e4\ub4dc \ucd9c\ub825 \uc544\ud0a4\ud14d\ucc98 \uc2ec\uce35 \ubd84\uc11d","source":"@site/i18n/ko/docusaurus-plugin-content-docs/current/for-engineers/deep-dive/neural-network.md","sourceDirName":"for-engineers/deep-dive","slug":"/for-engineers/deep-dive/neural-network","permalink":"/ko/docs/for-engineers/deep-dive/neural-network","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/for-engineers/deep-dive/neural-network.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"\uc2e0\uacbd\ub9dd \uc544\ud0a4\ud14d\ucc98 \uc0c1\uc138 \ubd84\uc11d","description":"KataGo\uc758 \uc2e0\uacbd\ub9dd \uc124\uacc4, \uc785\ub825 \ud2b9\uc131 \ubc0f \ub2e4\uc911 \ud5e4\ub4dc \ucd9c\ub825 \uc544\ud0a4\ud14d\ucc98 \uc2ec\uce35 \ubd84\uc11d"},"sidebar":"tutorialSidebar","previous":{"title":"\uc624\ud508\uc18c\uc2a4 \ucee4\ubba4\ub2c8\ud2f0 \ucc38\uc5ec","permalink":"/ko/docs/for-engineers/deep-dive/contributing"},"next":{"title":"MCTS \uad6c\ud604 \uc138\ubd80\uc0ac\ud56d","permalink":"/ko/docs/for-engineers/deep-dive/mcts-implementation"}}');var r=l(62615),d=l(30416);const i={sidebar_position:4,title:"\uc2e0\uacbd\ub9dd \uc544\ud0a4\ud14d\ucc98 \uc0c1\uc138 \ubd84\uc11d",description:"KataGo\uc758 \uc2e0\uacbd\ub9dd \uc124\uacc4, \uc785\ub825 \ud2b9\uc131 \ubc0f \ub2e4\uc911 \ud5e4\ub4dc \ucd9c\ub825 \uc544\ud0a4\ud14d\ucc98 \uc2ec\uce35 \ubd84\uc11d"},c="\uc2e0\uacbd\ub9dd \uc544\ud0a4\ud14d\ucc98 \uc0c1\uc138 \ubd84\uc11d",t={},o=[{value:"\uc544\ud0a4\ud14d\ucc98 \uac1c\uc694",id:"\uc544\ud0a4\ud14d\ucc98-\uac1c\uc694",level:2},{value:"\uc785\ub825 \ud2b9\uc131 \uc778\ucf54\ub529",id:"\uc785\ub825-\ud2b9\uc131-\uc778\ucf54\ub529",level:2},{value:"\ud2b9\uc131 \ud3c9\uba74 \uac1c\uc694",id:"\ud2b9\uc131-\ud3c9\uba74-\uac1c\uc694",level:3},{value:"\ud788\uc2a4\ud1a0\ub9ac \uc0c1\ud0dc \uc2a4\ud0dd",id:"\ud788\uc2a4\ud1a0\ub9ac-\uc0c1\ud0dc-\uc2a4\ud0dd",level:3},{value:"\uaddc\uce59 \uc778\ucf54\ub529",id:"\uaddc\uce59-\uc778\ucf54\ub529",level:3},{value:"\ubc31\ubcf8 \ub124\ud2b8\uc6cc\ud06c: \uc794\ucc28 \ud0c0\uc6cc",id:"\ubc31\ubcf8-\ub124\ud2b8\uc6cc\ud06c-\uc794\ucc28-\ud0c0\uc6cc",level:2},{value:"\uc794\ucc28 \ube14\ub85d \uad6c\uc870",id:"\uc794\ucc28-\ube14\ub85d-\uad6c\uc870",level:3},{value:"\ucf54\ub4dc \uc608\uc81c",id:"\ucf54\ub4dc-\uc608\uc81c",level:3},{value:"\uae00\ub85c\ubc8c \ud480\ub9c1\uce35",id:"\uae00\ub85c\ubc8c-\ud480\ub9c1\uce35",level:3},{value:"\ucd9c\ub825 \ud5e4\ub4dc \uc124\uacc4",id:"\ucd9c\ub825-\ud5e4\ub4dc-\uc124\uacc4",level:2},{value:"Policy Head (\uc815\ucc45 \ud5e4\ub4dc)",id:"policy-head-\uc815\ucc45-\ud5e4\ub4dc",level:3},{value:"Value Head (\uac00\uce58 \ud5e4\ub4dc)",id:"value-head-\uac00\uce58-\ud5e4\ub4dc",level:3},{value:"Score Head (\uc9d1\uc218 \ud5e4\ub4dc)",id:"score-head-\uc9d1\uc218-\ud5e4\ub4dc",level:3},{value:"Ownership Head (\uc601\uc5ed \ud5e4\ub4dc)",id:"ownership-head-\uc601\uc5ed-\ud5e4\ub4dc",level:3},{value:"AlphaZero\uc640\uc758 \ucc28\uc774\uc810",id:"alphazero\uc640\uc758-\ucc28\uc774\uc810",level:2},{value:"\ubaa8\ub378 \uaddc\ubaa8",id:"\ubaa8\ub378-\uaddc\ubaa8",level:2},{value:"\uc804\uccb4 \ub124\ud2b8\uc6cc\ud06c \uad6c\ud604",id:"\uc804\uccb4-\ub124\ud2b8\uc6cc\ud06c-\uad6c\ud604",level:2},{value:"\ucd94\uac00 \uc77d\uae30",id:"\ucd94\uac00-\uc77d\uae30",level:2}];function h(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"\uc2e0\uacbd\ub9dd-\uc544\ud0a4\ud14d\ucc98-\uc0c1\uc138-\ubd84\uc11d",children:"\uc2e0\uacbd\ub9dd \uc544\ud0a4\ud14d\ucc98 \uc0c1\uc138 \ubd84\uc11d"})}),"\n",(0,r.jsx)(e.p,{children:"\uc774 \ubb38\uc11c\ub294 KataGo \uc2e0\uacbd\ub9dd\uc758 \uc804\uccb4 \uc544\ud0a4\ud14d\ucc98\ub97c \uc785\ub825 \ud2b9\uc131 \uc778\ucf54\ub529\ubd80\ud130 \ub2e4\uc911 \ud5e4\ub4dc \ucd9c\ub825 \uc124\uacc4\uae4c\uc9c0 \uc2ec\uce35\uc801\uc73c\ub85c \ubd84\uc11d\ud569\ub2c8\ub2e4."}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\uc544\ud0a4\ud14d\ucc98-\uac1c\uc694",children:"\uc544\ud0a4\ud14d\ucc98 \uac1c\uc694"}),"\n",(0,r.jsxs)(e.p,{children:["KataGo\ub294 ",(0,r.jsx)(e.strong,{children:"\ub2e8\uc77c \uc2e0\uacbd\ub9dd, \ub2e4\uc911 \ud5e4\ub4dc \ucd9c\ub825"})," \uc124\uacc4\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4:"]}),"\n",(0,r.jsx)(e.mermaid,{value:'flowchart TB\n    Input["\uc785\ub825 \ud2b9\uc131 (19\xd719\xd722)"]\n    Input --\x3e InitConv["\ucd08\uae30 \ud569\uc131\uacf1\uce35<br/>256 filters"]\n    InitConv --\x3e ResNet["\uc794\ucc28 \ud0c0\uc6cc<br/>20-60\uac1c \uc794\ucc28 \ube14\ub85d<br/>+ \uae00\ub85c\ubc8c \ud480\ub9c1\uce35"]\n    ResNet --\x3e Policy["Policy Head"]\n    ResNet --\x3e Value["Value Head"]\n    ResNet --\x3e Score["Score Head"]\n    ResNet --\x3e Ownership["Ownership Head"]\n    Policy --\x3e PolicyOut["362 \ud655\ub960<br/>(pass \ud3ec\ud568)"]\n    Value --\x3e ValueOut["\uc2b9\ub960<br/>(-1~+1)"]\n    Score --\x3e ScoreOut["\uc9d1 \ucc28\uc774<br/>(\uc9d1)"]\n    Ownership --\x3e OwnerOut["361 \uc18c\uc720\uad8c<br/>(-1~+1)"]'}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\uc785\ub825-\ud2b9\uc131-\uc778\ucf54\ub529",children:"\uc785\ub825 \ud2b9\uc131 \uc778\ucf54\ub529"}),"\n",(0,r.jsx)(e.h3,{id:"\ud2b9\uc131-\ud3c9\uba74-\uac1c\uc694",children:"\ud2b9\uc131 \ud3c9\uba74 \uac1c\uc694"}),"\n",(0,r.jsxs)(e.p,{children:["KataGo\ub294 ",(0,r.jsx)(e.strong,{children:"22\uac1c\uc758 \ud2b9\uc131 \ud3c9\uba74"})," (19\xd719\xd722)\uc744 \uc0ac\uc6a9\ud558\uba70, \uac01 \ud3c9\uba74\uc740 19\xd719 \ud589\ub82c\uc785\ub2c8\ub2e4:"]}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\ud3c9\uba74"}),(0,r.jsx)(e.th,{children:"\ub0b4\uc6a9"}),(0,r.jsx)(e.th,{children:"\uc124\uba85"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"0"}),(0,r.jsx)(e.td,{children:"\ub0b4 \ub3cc"}),(0,r.jsx)(e.td,{children:"1 = \ub0b4 \ub3cc \uc788\uc74c, 0 = \uc5c6\uc74c"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"1"}),(0,r.jsx)(e.td,{children:"\uc0c1\ub300 \ub3cc"}),(0,r.jsx)(e.td,{children:"1 = \uc0c1\ub300 \ub3cc \uc788\uc74c, 0 = \uc5c6\uc74c"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"2"}),(0,r.jsx)(e.td,{children:"\ube48 \uc810"}),(0,r.jsx)(e.td,{children:"1 = \ube48 \uc810, 0 = \ub3cc \uc788\uc74c"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"3-10"}),(0,r.jsx)(e.td,{children:"\ud788\uc2a4\ud1a0\ub9ac \uc0c1\ud0dc"}),(0,r.jsx)(e.td,{children:"\uacfc\uac70 8\uc218\uc758 \ubc14\ub451\ud310 \ubcc0\ud654"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"11"}),(0,r.jsx)(e.td,{children:"\ud328 \uae08\uc9c0\uc810"}),(0,r.jsx)(e.td,{children:"1 = \ud328 \uae08\uc9c0, 0 = \ub458 \uc218 \uc788\uc74c"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"12-17"}),(0,r.jsx)(e.td,{children:"\ud65c\ub85c \uc778\ucf54\ub529"}),(0,r.jsx)(e.td,{children:"1\ud65c, 2\ud65c, 3\ud65c... \ub3cc \uadf8\ub8f9"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"18-21"}),(0,r.jsx)(e.td,{children:"\uaddc\uce59 \uc778\ucf54\ub529"}),(0,r.jsx)(e.td,{children:"\uc911\uad6d/\uc77c\ubcf8 \uaddc\uce59, \ub364 \ub4f1"})]})]})]}),"\n",(0,r.jsx)(e.h3,{id:"\ud788\uc2a4\ud1a0\ub9ac-\uc0c1\ud0dc-\uc2a4\ud0dd",children:"\ud788\uc2a4\ud1a0\ub9ac \uc0c1\ud0dc \uc2a4\ud0dd"}),"\n",(0,r.jsxs)(e.p,{children:["\uc2e0\uacbd\ub9dd\uc774 \uad6d\uba74\uc758 ",(0,r.jsx)(e.strong,{children:"\ub3d9\uc801 \ubcc0\ud654"}),"\ub97c \uc774\ud574\ud560 \uc218 \uc788\ub3c4\ub85d KataGo\ub294 \uacfc\uac70 8\uc218\uc758 \ubc14\ub451\ud310 \uc0c1\ud0dc\ub97c \uc2a4\ud0dd\ud569\ub2c8\ub2e4:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"# \ud788\uc2a4\ud1a0\ub9ac \uc0c1\ud0dc \uc778\ucf54\ub529 (\uac1c\ub150)\ndef encode_history(game_history, current_player):\n    features = []\n\n    for t in range(8):  # \uacfc\uac70 8\uc218\n        if t < len(game_history):\n            board = game_history[-(t+1)]\n            # \ud574\ub2f9 \uc2dc\uc810\uc758 \ub0b4 \ub3cc/\uc0c1\ub300 \ub3cc \uc778\ucf54\ub529\n            features.append(encode_board(board, current_player))\n        else:\n            # \ud788\uc2a4\ud1a0\ub9ac \ubd80\uc871, 0\uc73c\ub85c \ucc44\uc6c0\n            features.append(np.zeros((19, 19)))\n\n    return np.stack(features, axis=0)\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\uaddc\uce59-\uc778\ucf54\ub529",children:"\uaddc\uce59 \uc778\ucf54\ub529"}),"\n",(0,r.jsx)(e.p,{children:"KataGo\ub294 \ub2e4\uc591\ud55c \uaddc\uce59\uc744 \uc9c0\uc6d0\ud558\uba70, \ud2b9\uc131 \ud3c9\uba74\uc744 \ud1b5\ud574 \uc2e0\uacbd\ub9dd\uc5d0 \uc54c\ub9bd\ub2c8\ub2e4:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:'# \uaddc\uce59 \uc778\ucf54\ub529 (\uac1c\ub150)\ndef encode_rules(rules, komi):\n    rule_features = np.zeros((4, 19, 19))\n\n    # \uaddc\uce59 \uc720\ud615 (one-hot)\n    if rules == "chinese":\n        rule_features[0] = 1.0\n    elif rules == "japanese":\n        rule_features[1] = 1.0\n\n    # Komi \uc815\uaddc\ud654\n    normalized_komi = komi / 15.0  # [-1, 1]\ub85c \uc815\uaddc\ud654\n    rule_features[2] = normalized_komi\n\n    # \ud604\uc7ac \ud50c\ub808\uc774\uc5b4\n    rule_features[3] = 1.0 if current_player == BLACK else 0.0\n\n    return rule_features\n'})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ubc31\ubcf8-\ub124\ud2b8\uc6cc\ud06c-\uc794\ucc28-\ud0c0\uc6cc",children:"\ubc31\ubcf8 \ub124\ud2b8\uc6cc\ud06c: \uc794\ucc28 \ud0c0\uc6cc"}),"\n",(0,r.jsx)(e.h3,{id:"\uc794\ucc28-\ube14\ub85d-\uad6c\uc870",children:"\uc794\ucc28 \ube14\ub85d \uad6c\uc870"}),"\n",(0,r.jsxs)(e.p,{children:["KataGo\ub294 ",(0,r.jsx)(e.strong,{children:"Pre-activation ResNet"})," \uad6c\uc870\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4:"]}),"\n",(0,r.jsx)(e.mermaid,{value:'flowchart TB\n    X["\uc785\ub825 x"] --\x3e BN1["BatchNorm"]\n    X --\x3e Skip["\uc794\ucc28 \uc5f0\uacb0"]\n    BN1 --\x3e ReLU1["ReLU"]\n    ReLU1 --\x3e Conv1["Conv 3\xd73"]\n    Conv1 --\x3e BN2["BatchNorm"]\n    BN2 --\x3e ReLU2["ReLU"]\n    ReLU2 --\x3e Conv2["Conv 3\xd73"]\n    Conv2 --\x3e Add(("+"))\n    Skip --\x3e Add\n    Add --\x3e Out["\ucd9c\ub825"]'}),"\n",(0,r.jsx)(e.h3,{id:"\ucf54\ub4dc-\uc608\uc81c",children:"\ucf54\ub4dc \uc608\uc81c"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"class ResidualBlock(nn.Module):\n    def __init__(self, channels):\n        super().__init__()\n        self.bn1 = nn.BatchNorm2d(channels)\n        self.conv1 = nn.Conv2d(channels, channels, 3, padding=1)\n        self.bn2 = nn.BatchNorm2d(channels)\n        self.conv2 = nn.Conv2d(channels, channels, 3, padding=1)\n\n    def forward(self, x):\n        residual = x\n\n        out = self.bn1(x)\n        out = F.relu(out)\n        out = self.conv1(out)\n\n        out = self.bn2(out)\n        out = F.relu(out)\n        out = self.conv2(out)\n\n        return out + residual  # \uc794\ucc28 \uc5f0\uacb0\n"})}),"\n",(0,r.jsx)(e.h3,{id:"\uae00\ub85c\ubc8c-\ud480\ub9c1\uce35",children:"\uae00\ub85c\ubc8c \ud480\ub9c1\uce35"}),"\n",(0,r.jsxs)(e.p,{children:["KataGo\uc758 \ud575\uc2ec \ud601\uc2e0 \uc911 \ud558\ub098: \uc794\ucc28 \ube14\ub85d\uc5d0 ",(0,r.jsx)(e.strong,{children:"\uae00\ub85c\ubc8c \ud480\ub9c1"}),"\uc744 \ucd94\uac00\ud558\uc5ec \ub124\ud2b8\uc6cc\ud06c\uac00 \uc804\uc5ed \uc815\ubcf4\ub97c \ubcfc \uc218 \uc788\uac8c \ud569\ub2c8\ub2e4:"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"class GlobalPoolingBlock(nn.Module):\n    def __init__(self, channels):\n        super().__init__()\n        self.conv = nn.Conv2d(channels, channels, 3, padding=1)\n        self.fc = nn.Linear(channels, channels)\n\n    def forward(self, x):\n        # \ub85c\uceec \uacbd\ub85c\n        local = self.conv(x)\n\n        # \uae00\ub85c\ubc8c \uacbd\ub85c\n        global_pool = x.mean(dim=[2, 3])  # \uae00\ub85c\ubc8c \ud3c9\uade0 \ud480\ub9c1\n        global_fc = self.fc(global_pool)\n        global_broadcast = global_fc.unsqueeze(2).unsqueeze(3)\n        global_broadcast = global_broadcast.expand(-1, -1, 19, 19)\n\n        # \uc735\ud569\n        return local + global_broadcast\n"})}),"\n",(0,r.jsx)(e.p,{children:(0,r.jsx)(e.strong,{children:"\uc65c \uae00\ub85c\ubc8c \ud480\ub9c1\uc774 \ud544\uc694\ud55c\uac00?"})}),"\n",(0,r.jsx)(e.p,{children:'\uc804\ud1b5\uc801\uc778 \ud569\uc131\uacf1\uc740 \ub85c\uceec\ub9cc \ubd05\ub2c8\ub2e4 (3\xd73 \uc218\uc6a9 \uc601\uc5ed), \ub9ce\uc740 \uce35\uc744 \uc313\uc544\ub3c4 \uc804\uc5ed \uc815\ubcf4\uc5d0 \ub300\ud55c \uc778\uc2dd\uc740 \uc81c\ud55c\uc801\uc785\ub2c8\ub2e4. \uae00\ub85c\ubc8c \ud480\ub9c1\uc740 \ub124\ud2b8\uc6cc\ud06c\uac00 \uc9c1\uc811 "\ubcfc \uc218 \uc788\uac8c" \ud569\ub2c8\ub2e4:'}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\uc804\uccb4 \ubc14\ub451\ud310\uc758 \ub3cc \uc218 \ucc28\uc774"}),"\n",(0,r.jsx)(e.li,{children:"\uc804\uc5ed\uc801 \uc138\ub825 \ubd84\ud3ec"}),"\n",(0,r.jsx)(e.li,{children:"\uc804\uccb4\uc801\uc778 \ud615\uc138 \ud310\ub2e8"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ucd9c\ub825-\ud5e4\ub4dc-\uc124\uacc4",children:"\ucd9c\ub825 \ud5e4\ub4dc \uc124\uacc4"}),"\n",(0,r.jsx)(e.h3,{id:"policy-head-\uc815\ucc45-\ud5e4\ub4dc",children:"Policy Head (\uc815\ucc45 \ud5e4\ub4dc)"}),"\n",(0,r.jsx)(e.p,{children:"\uac01 \uc704\uce58\uc758 \ucc29\uc218 \ud655\ub960\uc744 \ucd9c\ub825\ud569\ub2c8\ub2e4:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"class PolicyHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv = nn.Conv2d(in_channels, 2, 1)  # 1\xd71 \ud569\uc131\uacf1\n        self.bn = nn.BatchNorm2d(2)\n        self.fc = nn.Linear(2 * 19 * 19, 362)  # 361 + pass\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv(x)))\n        out = out.view(out.size(0), -1)\n        out = self.fc(out)\n        return F.softmax(out, dim=1)  # \ud655\ub960 \ubd84\ud3ec\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ucd9c\ub825 \ud615\uc2dd"}),": 362\ucc28\uc6d0 \ubca1\ud130"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\uc778\ub371\uc2a4 0-360: \ubc14\ub451\ud310 361\uac1c \uc704\uce58\uc758 \ucc29\uc218 \ud655\ub960"}),"\n",(0,r.jsx)(e.li,{children:"\uc778\ub371\uc2a4 361: \ud328\uc2a4 \ud655\ub960"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"value-head-\uac00\uce58-\ud5e4\ub4dc",children:"Value Head (\uac00\uce58 \ud5e4\ub4dc)"}),"\n",(0,r.jsx)(e.p,{children:"\ud604\uc7ac \uad6d\uba74\uc758 \uc2b9\ub960\uc744 \ucd9c\ub825\ud569\ub2c8\ub2e4:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"class ValueHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv = nn.Conv2d(in_channels, 1, 1)\n        self.bn = nn.BatchNorm2d(1)\n        self.fc1 = nn.Linear(19 * 19, 256)\n        self.fc2 = nn.Linear(256, 1)\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv(x)))\n        out = out.view(out.size(0), -1)\n        out = F.relu(self.fc1(out))\n        out = torch.tanh(self.fc2(out))  # -1\uc5d0\uc11c +1 \ucd9c\ub825\n        return out\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ucd9c\ub825 \ud615\uc2dd"}),": \ub2e8\uc77c \uac12 [-1, +1]"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"+1: \ub0b4\uac00 \ud544\uc2b9"}),"\n",(0,r.jsx)(e.li,{children:"-1: \uc0c1\ub300 \ud544\uc2b9"}),"\n",(0,r.jsx)(e.li,{children:"0: \uade0\ud615"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"score-head-\uc9d1\uc218-\ud5e4\ub4dc",children:"Score Head (\uc9d1\uc218 \ud5e4\ub4dc)"}),"\n",(0,r.jsx)(e.p,{children:"KataGo \uace0\uc720\uc758 \ucd5c\uc885 \uc9d1\uc218 \ucc28\uc774 \uc608\uce21:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"class ScoreHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv = nn.Conv2d(in_channels, 1, 1)\n        self.bn = nn.BatchNorm2d(1)\n        self.fc1 = nn.Linear(19 * 19, 256)\n        self.fc2 = nn.Linear(256, 1)\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv(x)))\n        out = out.view(out.size(0), -1)\n        out = F.relu(self.fc1(out))\n        out = self.fc2(out)  # \uc81c\ud55c \uc5c6\ub294 \ucd9c\ub825\n        return out\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ucd9c\ub825 \ud615\uc2dd"}),": \ub2e8\uc77c \uac12 (\uc9d1\uc218)"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"\uc591\uc218: \ub0b4\uac00 \uc55e\uc12c"}),"\n",(0,r.jsx)(e.li,{children:"\uc74c\uc218: \uc0c1\ub300\uac00 \uc55e\uc12c"}),"\n"]}),"\n",(0,r.jsx)(e.h3,{id:"ownership-head-\uc601\uc5ed-\ud5e4\ub4dc",children:"Ownership Head (\uc601\uc5ed \ud5e4\ub4dc)"}),"\n",(0,r.jsx)(e.p,{children:"\uac01 \uc810\uc758 \ucd5c\uc885 \uc18c\uc720\uad8c\uc744 \uc608\uce21\ud569\ub2c8\ub2e4:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"class OwnershipHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv1 = nn.Conv2d(in_channels, 32, 1)\n        self.bn = nn.BatchNorm2d(32)\n        self.conv2 = nn.Conv2d(32, 1, 1)\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv1(x)))\n        out = torch.tanh(self.conv2(out))  # \uac01 \uc810 -1\uc5d0\uc11c +1\n        return out.view(out.size(0), -1)  # 361\ub85c \ud3c9\ud0c4\ud654\n"})}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\ucd9c\ub825 \ud615\uc2dd"}),": 361\ucc28\uc6d0 \ubca1\ud130, \uac01 \uac12\uc740 [-1, +1]"]}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsx)(e.li,{children:"+1: \ud574\ub2f9 \uc810\uc740 \ub0b4 \uc601\uc5ed"}),"\n",(0,r.jsx)(e.li,{children:"-1: \ud574\ub2f9 \uc810\uc740 \uc0c1\ub300 \uc601\uc5ed"}),"\n",(0,r.jsx)(e.li,{children:"0: \uc911\ub9bd \ub610\ub294 \ubd84\uc7c1 \uc9c0\uc5ed"}),"\n"]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"alphazero\uc640\uc758-\ucc28\uc774\uc810",children:"AlphaZero\uc640\uc758 \ucc28\uc774\uc810"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\uce21\uba74"}),(0,r.jsx)(e.th,{children:"AlphaZero"}),(0,r.jsx)(e.th,{children:"KataGo"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\ucd9c\ub825 \ud5e4\ub4dc"})}),(0,r.jsx)(e.td,{children:"2\uac1c (Policy + Value)"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.strong,{children:"4\uac1c"})," (+ Score + Ownership)"]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\uae00\ub85c\ubc8c \ud480\ub9c1"})}),(0,r.jsx)(e.td,{children:"\uc5c6\uc74c"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\uc788\uc74c"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\uc785\ub825 \ud2b9\uc131"})}),(0,r.jsx)(e.td,{children:"17 \ud3c9\uba74"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.strong,{children:"22 \ud3c9\uba74"})," (\uaddc\uce59 \uc778\ucf54\ub529 \ud3ec\ud568)"]})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\uc794\ucc28 \ube14\ub85d"})}),(0,r.jsx)(e.td,{children:"\ud45c\uc900 ResNet"}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"Pre-activation + \uae00\ub85c\ubc8c \ud480\ub9c1"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.strong,{children:"\ub2e4\uc911 \uaddc\uce59 \uc9c0\uc6d0"})}),(0,r.jsx)(e.td,{children:"\uc5c6\uc74c"}),(0,r.jsxs)(e.td,{children:[(0,r.jsx)(e.strong,{children:"\uc788\uc74c"})," (\ud2b9\uc131 \uc778\ucf54\ub529 \ud1b5\ud574)"]})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ubaa8\ub378-\uaddc\ubaa8",children:"\ubaa8\ub378 \uaddc\ubaa8"}),"\n",(0,r.jsx)(e.p,{children:"KataGo\ub294 \ub2e4\uc591\ud55c \uaddc\ubaa8\uc758 \ubaa8\ub378\uc744 \uc81c\uacf5\ud569\ub2c8\ub2e4:"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"\ubaa8\ub378"}),(0,r.jsx)(e.th,{children:"\uc794\ucc28 \ube14\ub85d \uc218"}),(0,r.jsx)(e.th,{children:"\ucc44\ub110 \uc218"}),(0,r.jsx)(e.th,{children:"\ud30c\ub77c\ubbf8\ud130 \uc218"}),(0,r.jsx)(e.th,{children:"\uc801\uc6a9 \uc2dc\ub098\ub9ac\uc624"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"b10c128"}),(0,r.jsx)(e.td,{children:"10"}),(0,r.jsx)(e.td,{children:"128"}),(0,r.jsx)(e.td,{children:"~5M"}),(0,r.jsx)(e.td,{children:"CPU, \ube60\ub978 \ud14c\uc2a4\ud2b8"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"b18c384"}),(0,r.jsx)(e.td,{children:"18"}),(0,r.jsx)(e.td,{children:"384"}),(0,r.jsx)(e.td,{children:"~75M"}),(0,r.jsx)(e.td,{children:"\uc77c\ubc18 GPU"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"b40c256"}),(0,r.jsx)(e.td,{children:"40"}),(0,r.jsx)(e.td,{children:"256"}),(0,r.jsx)(e.td,{children:"~95M"}),(0,r.jsx)(e.td,{children:"\uace0\uae09 GPU"})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:"b60c320"}),(0,r.jsx)(e.td,{children:"60"}),(0,r.jsx)(e.td,{children:"320"}),(0,r.jsx)(e.td,{children:"~200M"}),(0,r.jsx)(e.td,{children:"\ucd5c\uace0\uae09 GPU"})]})]})]}),"\n",(0,r.jsxs)(e.p,{children:[(0,r.jsx)(e.strong,{children:"\uba85\uba85 \uaddc\uce59"}),": ",(0,r.jsx)(e.code,{children:"b{\uc794\ucc28\ube14\ub85d\uc218}c{\ucc44\ub110\uc218}"})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\uc804\uccb4-\ub124\ud2b8\uc6cc\ud06c-\uad6c\ud604",children:"\uc804\uccb4 \ub124\ud2b8\uc6cc\ud06c \uad6c\ud604"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-python",children:"class KataGoNetwork(nn.Module):\n    def __init__(self, num_blocks=18, channels=384):\n        super().__init__()\n\n        # \ucd08\uae30 \ud569\uc131\uacf1\n        self.initial_conv = nn.Conv2d(22, channels, 3, padding=1)\n        self.initial_bn = nn.BatchNorm2d(channels)\n\n        # \uc794\ucc28 \ud0c0\uc6cc\n        self.residual_blocks = nn.ModuleList([\n            ResidualBlock(channels) for _ in range(num_blocks)\n        ])\n\n        # \uae00\ub85c\ubc8c \ud480\ub9c1 \ube14\ub85d (\ub9e4 \uba87 \uac1c \uc794\ucc28 \ube14\ub85d\ub9c8\ub2e4 \ud558\ub098 \uc0bd\uc785)\n        self.global_pooling_blocks = nn.ModuleList([\n            GlobalPoolingBlock(channels) for _ in range(num_blocks // 6)\n        ])\n\n        # \ucd9c\ub825 \ud5e4\ub4dc\n        self.policy_head = PolicyHead(channels)\n        self.value_head = ValueHead(channels)\n        self.score_head = ScoreHead(channels)\n        self.ownership_head = OwnershipHead(channels)\n\n    def forward(self, x):\n        # \ucd08\uae30 \ud569\uc131\uacf1\n        out = F.relu(self.initial_bn(self.initial_conv(x)))\n\n        # \uc794\ucc28 \ud0c0\uc6cc\n        gp_idx = 0\n        for i, block in enumerate(self.residual_blocks):\n            out = block(out)\n\n            # \ub9e4 6\uac1c \uc794\ucc28 \ube14\ub85d \ud6c4 \uae00\ub85c\ubc8c \ud480\ub9c1 \uc0bd\uc785\n            if (i + 1) % 6 == 0 and gp_idx < len(self.global_pooling_blocks):\n                out = self.global_pooling_blocks[gp_idx](out)\n                gp_idx += 1\n\n        # \ucd9c\ub825 \ud5e4\ub4dc\n        policy = self.policy_head(out)\n        value = self.value_head(out)\n        score = self.score_head(out)\n        ownership = self.ownership_head(out)\n\n        return {\n            'policy': policy,\n            'value': value,\n            'score': score,\n            'ownership': ownership\n        }\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ucd94\uac00-\uc77d\uae30",children:"\ucd94\uac00 \uc77d\uae30"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"../mcts-implementation",children:"MCTS \uad6c\ud604 \uc138\ubd80\uc0ac\ud56d"})," \u2014 \ud0d0\uc0c9\uacfc \uc2e0\uacbd\ub9dd\uc758 \uacb0\ud569"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"../training",children:"KataGo \ud559\uc2b5 \uba54\ucee4\ub2c8\uc998 \ubd84\uc11d"})," \u2014 \ub124\ud2b8\uc6cc\ud06c \ud559\uc2b5 \ubc29\ubc95"]}),"\n",(0,r.jsxs)(e.li,{children:[(0,r.jsx)(e.a,{href:"../papers",children:"\ud575\uc2ec \ub17c\ubb38 \uac00\uc774\ub4dc"})," \u2014 \uc6d0\ubcf8 \ub17c\ubb38\uc758 \uc218\ud559\uc801 \uc720\ub3c4"]}),"\n"]})]})}function a(n={}){const{wrapper:e}={...(0,d.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(h,{...n})}):h(n)}},30416(n,e,l){l.d(e,{R:()=>i,x:()=>c});var s=l(59471);const r={},d=s.createContext(r);function i(n){const e=s.useContext(d);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:i(n.components),s.createElement(d.Provider,{value:e},n.children)}}}]);