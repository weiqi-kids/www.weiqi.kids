"use strict";(self.webpackChunktemp_docusaurus=self.webpackChunktemp_docusaurus||[]).push([[8527],{5521:(n,e,a)=>{a.d(e,{R:()=>s,x:()=>i});var r=a(6672);const o={},l=r.createContext(o);function s(n){const e=r.useContext(l);return r.useMemo((function(){return"function"==typeof n?n(e):{...e,...n}}),[e,n])}function i(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(o):n.components||o:s(n.components),r.createElement(l.Provider,{value:e},n.children)}},5931:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>c,contentTitle:()=>i,default:()=>h,frontMatter:()=>s,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"for-engineers/katago-source/architecture","title":"\u0938\u094b\u0930\u094d\u0938 \u0915\u094b\u0921 \u0906\u0930\u094d\u0915\u093f\u091f\u0947\u0915\u094d\u091a\u0930","description":"\u092f\u0939 \u0932\u0947\u0916 KataGo \u0915\u0947 \u0938\u094b\u0930\u094d\u0938 \u0915\u094b\u0921 \u0938\u0902\u0930\u091a\u0928\u093e \u0915\u093e \u0917\u0939\u0928 \u0935\u093f\u0936\u094d\u0932\u0947\u0937\u0923 \u0915\u0930\u0924\u093e \u0939\u0948, \u0906\u0902\u0924\u0930\u093f\u0915 \u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928 \u0938\u092e\u091d\u0928\u0947 \u092e\u0947\u0902 \u092e\u0926\u0926 \u0915\u0930\u0924\u093e \u0939\u0948\u0964 \u091a\u093e\u0939\u0947 \u0906\u092a \u0915\u094b\u0921 \u092f\u094b\u0917\u0926\u093e\u0928 \u0915\u0930\u0928\u093e \u091a\u093e\u0939\u0924\u0947 \u0939\u094b\u0902, \u0938\u0941\u0935\u093f\u0927\u093e\u090f\u0902 \u0938\u0902\u0936\u094b\u0927\u093f\u0924 \u0915\u0930\u0928\u093e \u091a\u093e\u0939\u0924\u0947 \u0939\u094b\u0902, \u092f\u093e \u0907\u0938\u0915\u0940 \u0924\u0915\u0928\u0940\u0915 \u0905\u092a\u0928\u0947 \u092a\u094d\u0930\u094b\u091c\u0947\u0915\u094d\u091f \u092e\u0947\u0902 \u0932\u093e\u0917\u0942 \u0915\u0930\u0928\u093e \u091a\u093e\u0939\u0924\u0947 \u0939\u094b\u0902, \u092f\u0939 \u0906\u0935\u0936\u094d\u092f\u0915 \u0938\u0902\u0926\u0930\u094d\u092d \u0938\u093e\u092e\u0917\u094d\u0930\u0940 \u0939\u0948\u0964","source":"@site/i18n/hi/docusaurus-plugin-content-docs/current/for-engineers/katago-source/architecture.md","sourceDirName":"for-engineers/katago-source","slug":"/for-engineers/katago-source/architecture","permalink":"/hi/docs/for-engineers/katago-source/architecture","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/for-engineers/katago-source/architecture.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"\u0938\u094b\u0930\u094d\u0938 \u0915\u094b\u0921 \u0906\u0930\u094d\u0915\u093f\u091f\u0947\u0915\u094d\u091a\u0930"},"sidebar":"tutorialSidebar","previous":{"title":"\u0938\u093e\u092e\u093e\u0928\u094d\u092f \u0915\u092e\u093e\u0902\u0921","permalink":"/hi/docs/for-engineers/katago-source/commands"}}');var o=a(3420),l=a(5521);const s={sidebar_position:3,title:"\u0938\u094b\u0930\u094d\u0938 \u0915\u094b\u0921 \u0906\u0930\u094d\u0915\u093f\u091f\u0947\u0915\u094d\u091a\u0930"},i="KataGo \u0938\u094b\u0930\u094d\u0938 \u0915\u094b\u0921 \u0906\u0930\u094d\u0915\u093f\u091f\u0947\u0915\u094d\u091a\u0930",c={},t=[{value:"\u092a\u094d\u0930\u094b\u091c\u0947\u0915\u094d\u091f \u0921\u093e\u092f\u0930\u0947\u0915\u094d\u091f\u0930\u0940 \u0938\u0902\u0930\u091a\u0928\u093e",id:"\u092a\u094d\u0930\u094b\u091c\u0947\u0915\u094d\u091f-\u0921\u093e\u092f\u0930\u0947\u0915\u094d\u091f\u0930\u0940-\u0938\u0902\u0930\u091a\u0928\u093e",level:2},{value:"cpp/ \u0921\u093e\u092f\u0930\u0947\u0915\u094d\u091f\u0930\u0940 \u0935\u093f\u0938\u094d\u0924\u093e\u0930",id:"cpp-\u0921\u093e\u092f\u0930\u0947\u0915\u094d\u091f\u0930\u0940-\u0935\u093f\u0938\u094d\u0924\u093e\u0930",level:3},{value:"\u0928\u094d\u092f\u0942\u0930\u0932 \u0928\u0947\u091f\u0935\u0930\u094d\u0915 \u0906\u0930\u094d\u0915\u093f\u091f\u0947\u0915\u094d\u091a\u0930",id:"\u0928\u094d\u092f\u0942\u0930\u0932-\u0928\u0947\u091f\u0935\u0930\u094d\u0915-\u0906\u0930\u094d\u0915\u093f\u091f\u0947\u0915\u094d\u091a\u0930",level:2},{value:"\u0928\u0947\u091f\u0935\u0930\u094d\u0915 \u0938\u0902\u0930\u091a\u0928\u093e \u0905\u0935\u0932\u094b\u0915\u0928",id:"\u0928\u0947\u091f\u0935\u0930\u094d\u0915-\u0938\u0902\u0930\u091a\u0928\u093e-\u0905\u0935\u0932\u094b\u0915\u0928",level:3},{value:"\u0907\u0928\u092a\u0941\u091f \u092b\u0940\u091a\u0930 (nninputs.cpp)",id:"\u0907\u0928\u092a\u0941\u091f-\u092b\u0940\u091a\u0930-nninputscpp",level:3},{value:"\u0917\u094d\u0932\u094b\u092c\u0932 \u092a\u0942\u0932\u093f\u0902\u0917 \u092c\u094d\u0930\u093e\u0902\u091a",id:"\u0917\u094d\u0932\u094b\u092c\u0932-\u092a\u0942\u0932\u093f\u0902\u0917-\u092c\u094d\u0930\u093e\u0902\u091a",level:3},{value:"\u0906\u0909\u091f\u092a\u0941\u091f \u0939\u0947\u0921",id:"\u0906\u0909\u091f\u092a\u0941\u091f-\u0939\u0947\u0921",level:3},{value:"\u0938\u0930\u094d\u091a \u0907\u0902\u091c\u0928 \u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928",id:"\u0938\u0930\u094d\u091a-\u0907\u0902\u091c\u0928-\u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928",level:2},{value:"MCTS \u0915\u094b\u0930 \u0915\u094d\u0932\u093e\u0938",id:"mcts-\u0915\u094b\u0930-\u0915\u094d\u0932\u093e\u0938",level:3},{value:"\u0938\u0930\u094d\u091a \u0928\u094b\u0921 \u0938\u0902\u0930\u091a\u0928\u093e",id:"\u0938\u0930\u094d\u091a-\u0928\u094b\u0921-\u0938\u0902\u0930\u091a\u0928\u093e",level:3},{value:"PUCT \u091a\u092f\u0928 \u090f\u0932\u094d\u0917\u094b\u0930\u093f\u0926\u092e",id:"puct-\u091a\u092f\u0928-\u090f\u0932\u094d\u0917\u094b\u0930\u093f\u0926\u092e",level:3},{value:"\u092a\u0948\u0930\u0932\u0932 \u0938\u0930\u094d\u091a \u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928",id:"\u092a\u0948\u0930\u0932\u0932-\u0938\u0930\u094d\u091a-\u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928",level:3},{value:"\u0935\u0930\u094d\u091a\u0941\u0905\u0932 \u0932\u0949\u0938",id:"\u0935\u0930\u094d\u091a\u0941\u0905\u0932-\u0932\u0949\u0938",level:3},{value:"\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u092a\u094d\u0930\u0915\u094d\u0930\u093f\u092f\u093e \u0905\u0935\u0932\u094b\u0915\u0928",id:"\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923-\u092a\u094d\u0930\u0915\u094d\u0930\u093f\u092f\u093e-\u0905\u0935\u0932\u094b\u0915\u0928",level:2},{value:"\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u0921\u0947\u091f\u093e \u091c\u0928\u0930\u0947\u0936\u0928",id:"\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923-\u0921\u0947\u091f\u093e-\u091c\u0928\u0930\u0947\u0936\u0928",level:3},{value:"\u0938\u094d\u0935-\u0916\u0947\u0932 (cpp/command/selfplay.cpp)",id:"\u0938\u094d\u0935-\u0916\u0947\u0932-cppcommandselfplaycpp",level:3},{value:"\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u0921\u0947\u091f\u093e \u092b\u0949\u0930\u094d\u092e\u0947\u091f",id:"\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923-\u0921\u0947\u091f\u093e-\u092b\u0949\u0930\u094d\u092e\u0947\u091f",level:3},{value:"Python \u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u092a\u094d\u0930\u094b\u0917\u094d\u0930\u093e\u092e (python/train.py)",id:"python-\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923-\u092a\u094d\u0930\u094b\u0917\u094d\u0930\u093e\u092e-pythontrainpy",level:3},{value:"\u092e\u0949\u0921\u0932 \u092a\u0930\u093f\u092d\u093e\u0937\u093e (python/model.py)",id:"\u092e\u0949\u0921\u0932-\u092a\u0930\u093f\u092d\u093e\u0937\u093e-pythonmodelpy",level:3},{value:"\u092e\u0941\u0916\u094d\u092f \u0921\u0947\u091f\u093e \u0938\u0902\u0930\u091a\u0928\u093e\u090f\u0902",id:"\u092e\u0941\u0916\u094d\u092f-\u0921\u0947\u091f\u093e-\u0938\u0902\u0930\u091a\u0928\u093e\u090f\u0902",level:2},{value:"Board (game/board.h)",id:"board-gameboardh",level:3},{value:"BoardHistory (game/boardhistory.h)",id:"boardhistory-gameboardhistoryh",level:3},{value:"NNOutput (neuralnet/nneval.h)",id:"nnoutput-neuralnetnnevalh",level:3},{value:"\u0935\u093f\u0915\u093e\u0938 \u0914\u0930 \u0921\u0940\u092c\u0917\u093f\u0902\u0917",id:"\u0935\u093f\u0915\u093e\u0938-\u0914\u0930-\u0921\u0940\u092c\u0917\u093f\u0902\u0917",level:2},{value:"\u0921\u0940\u092c\u0917 \u0938\u0902\u0938\u094d\u0915\u0930\u0923 \u0915\u0902\u092a\u093e\u0907\u0932",id:"\u0921\u0940\u092c\u0917-\u0938\u0902\u0938\u094d\u0915\u0930\u0923-\u0915\u0902\u092a\u093e\u0907\u0932",level:3},{value:"\u092f\u0942\u0928\u093f\u091f \u091f\u0947\u0938\u094d\u091f \u091a\u0932\u093e\u090f\u0902",id:"\u092f\u0942\u0928\u093f\u091f-\u091f\u0947\u0938\u094d\u091f-\u091a\u0932\u093e\u090f\u0902",level:3},{value:"\u0938\u093e\u092e\u093e\u0928\u094d\u092f \u0921\u0940\u092c\u0917\u093f\u0902\u0917 \u0935\u093f\u0927\u093f\u092f\u093e\u0902",id:"\u0938\u093e\u092e\u093e\u0928\u094d\u092f-\u0921\u0940\u092c\u0917\u093f\u0902\u0917-\u0935\u093f\u0927\u093f\u092f\u093e\u0902",level:3},{value:"\u092a\u094d\u0930\u0926\u0930\u094d\u0936\u0928 \u0935\u093f\u0936\u094d\u0932\u0947\u0937\u0923",id:"\u092a\u094d\u0930\u0926\u0930\u094d\u0936\u0928-\u0935\u093f\u0936\u094d\u0932\u0947\u0937\u0923",level:3},{value:"\u0906\u0917\u0947 \u092a\u0922\u093c\u0947\u0902",id:"\u0906\u0917\u0947-\u092a\u0922\u093c\u0947\u0902",level:2}];function d(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...n.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(e.header,{children:(0,o.jsx)(e.h1,{id:"katago-\u0938\u094b\u0930\u094d\u0938-\u0915\u094b\u0921-\u0906\u0930\u094d\u0915\u093f\u091f\u0947\u0915\u094d\u091a\u0930",children:"KataGo \u0938\u094b\u0930\u094d\u0938 \u0915\u094b\u0921 \u0906\u0930\u094d\u0915\u093f\u091f\u0947\u0915\u094d\u091a\u0930"})}),"\n",(0,o.jsx)(e.p,{children:"\u092f\u0939 \u0932\u0947\u0916 KataGo \u0915\u0947 \u0938\u094b\u0930\u094d\u0938 \u0915\u094b\u0921 \u0938\u0902\u0930\u091a\u0928\u093e \u0915\u093e \u0917\u0939\u0928 \u0935\u093f\u0936\u094d\u0932\u0947\u0937\u0923 \u0915\u0930\u0924\u093e \u0939\u0948, \u0906\u0902\u0924\u0930\u093f\u0915 \u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928 \u0938\u092e\u091d\u0928\u0947 \u092e\u0947\u0902 \u092e\u0926\u0926 \u0915\u0930\u0924\u093e \u0939\u0948\u0964 \u091a\u093e\u0939\u0947 \u0906\u092a \u0915\u094b\u0921 \u092f\u094b\u0917\u0926\u093e\u0928 \u0915\u0930\u0928\u093e \u091a\u093e\u0939\u0924\u0947 \u0939\u094b\u0902, \u0938\u0941\u0935\u093f\u0927\u093e\u090f\u0902 \u0938\u0902\u0936\u094b\u0927\u093f\u0924 \u0915\u0930\u0928\u093e \u091a\u093e\u0939\u0924\u0947 \u0939\u094b\u0902, \u092f\u093e \u0907\u0938\u0915\u0940 \u0924\u0915\u0928\u0940\u0915 \u0905\u092a\u0928\u0947 \u092a\u094d\u0930\u094b\u091c\u0947\u0915\u094d\u091f \u092e\u0947\u0902 \u0932\u093e\u0917\u0942 \u0915\u0930\u0928\u093e \u091a\u093e\u0939\u0924\u0947 \u0939\u094b\u0902, \u092f\u0939 \u0906\u0935\u0936\u094d\u092f\u0915 \u0938\u0902\u0926\u0930\u094d\u092d \u0938\u093e\u092e\u0917\u094d\u0930\u0940 \u0939\u0948\u0964"}),"\n",(0,o.jsx)(e.h2,{id:"\u092a\u094d\u0930\u094b\u091c\u0947\u0915\u094d\u091f-\u0921\u093e\u092f\u0930\u0947\u0915\u094d\u091f\u0930\u0940-\u0938\u0902\u0930\u091a\u0928\u093e",children:"\u092a\u094d\u0930\u094b\u091c\u0947\u0915\u094d\u091f \u0921\u093e\u092f\u0930\u0947\u0915\u094d\u091f\u0930\u0940 \u0938\u0902\u0930\u091a\u0928\u093e"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"KataGo/\n\u251c\u2500\u2500 cpp/                    # C++ \u0915\u094b\u0930 \u0915\u094b\u0921\n\u2502   \u251c\u2500\u2500 main.cpp           # \u092e\u0941\u0916\u094d\u092f \u092a\u094d\u0930\u094b\u0917\u094d\u0930\u093e\u092e \u090f\u0902\u091f\u094d\u0930\u0940\n\u2502   \u251c\u2500\u2500 command/           # \u0935\u093f\u092d\u093f\u0928\u094d\u0928 \u090f\u0915\u094d\u091c\u093c\u0940\u0915\u094d\u092f\u0942\u0936\u0928 \u092e\u094b\u0921\n\u2502   \u251c\u2500\u2500 core/              # \u0915\u094b\u0930 \u092f\u0942\u091f\u093f\u0932\u093f\u091f\u0940 \u0915\u094d\u0932\u093e\u0938\n\u2502   \u251c\u2500\u2500 game/              # \u0917\u094b \u0928\u093f\u092f\u092e \u0914\u0930 \u092c\u094b\u0930\u094d\u0921\n\u2502   \u251c\u2500\u2500 search/            # MCTS \u0938\u0930\u094d\u091a \u0907\u0902\u091c\u0928\n\u2502   \u251c\u2500\u2500 neuralnet/         # \u0928\u094d\u092f\u0942\u0930\u0932 \u0928\u0947\u091f\u0935\u0930\u094d\u0915 \u0907\u0902\u091f\u0930\u092b\u0947\u0938\n\u2502   \u251c\u2500\u2500 dataio/            # \u0921\u0947\u091f\u093e I/O\n\u2502   \u251c\u2500\u2500 configs/           # \u0915\u0949\u0928\u094d\u092b\u093c\u093f\u0917 \u0909\u0926\u093e\u0939\u0930\u0923\n\u2502   \u2514\u2500\u2500 tests/             # \u092f\u0942\u0928\u093f\u091f \u091f\u0947\u0938\u094d\u091f\n\u251c\u2500\u2500 python/                 # Python \u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u0915\u094b\u0921\n\u2502   \u251c\u2500\u2500 train.py           # \u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u092e\u0941\u0916\u094d\u092f \u092a\u094d\u0930\u094b\u0917\u094d\u0930\u093e\u092e\n\u2502   \u251c\u2500\u2500 model.py           # \u092e\u0949\u0921\u0932 \u092a\u0930\u093f\u092d\u093e\u0937\u093e\n\u2502   \u251c\u2500\u2500 data_processing_pytorch.py\n\u2502   \u2514\u2500\u2500 configs/           # \u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u0915\u0949\u0928\u094d\u092b\u093c\u093f\u0917\n\u251c\u2500\u2500 docs/                   # \u0926\u0938\u094d\u0924\u093e\u0935\u0947\u091c\u093c\n\u2514\u2500\u2500 scripts/               # \u0938\u0939\u093e\u092f\u0915 \u0938\u094d\u0915\u094d\u0930\u093f\u092a\u094d\u091f\n"})}),"\n",(0,o.jsx)(e.h3,{id:"cpp-\u0921\u093e\u092f\u0930\u0947\u0915\u094d\u091f\u0930\u0940-\u0935\u093f\u0938\u094d\u0924\u093e\u0930",children:"cpp/ \u0921\u093e\u092f\u0930\u0947\u0915\u094d\u091f\u0930\u0940 \u0935\u093f\u0938\u094d\u0924\u093e\u0930"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{children:"cpp/\n\u251c\u2500\u2500 main.cpp                # \u092a\u094d\u0930\u094b\u0917\u094d\u0930\u093e\u092e \u090f\u0902\u091f\u094d\u0930\u0940, \u0915\u092e\u093e\u0902\u0921 \u0932\u093e\u0907\u0928 \u092a\u093e\u0930\u094d\u0938\u093f\u0902\u0917\n\u251c\u2500\u2500 command/\n\u2502   \u251c\u2500\u2500 gtp.cpp            # GTP \u092a\u094d\u0930\u094b\u091f\u094b\u0915\u0949\u0932 \u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928\n\u2502   \u251c\u2500\u2500 analysis.cpp       # Analysis Engine \u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928\n\u2502   \u251c\u2500\u2500 benchmark.cpp      # \u092c\u0947\u0902\u091a\u092e\u093e\u0930\u094d\u0915\n\u2502   \u251c\u2500\u2500 genconfig.cpp      # \u0915\u0949\u0928\u094d\u092b\u093c\u093f\u0917 \u091c\u0928\u0930\u0947\u0936\u0928\n\u2502   \u2514\u2500\u2500 selfplay.cpp       # \u0938\u094d\u0935-\u0916\u0947\u0932\n\u251c\u2500\u2500 core/\n\u2502   \u251c\u2500\u2500 global.h           # \u0917\u094d\u0932\u094b\u092c\u0932 \u0915\u0949\u0928\u094d\u0938\u094d\u091f\u0947\u0902\u091f \u0914\u0930 \u0938\u0947\u091f\u093f\u0902\u0917\n\u2502   \u251c\u2500\u2500 hash.h             # Zobrist \u0939\u0948\u0936\n\u2502   \u251c\u2500\u2500 rand.h             # \u0930\u0948\u0902\u0921\u092e \u0928\u0902\u092c\u0930 \u091c\u0928\u0930\u0947\u0936\u0928\n\u2502   \u251c\u2500\u2500 logger.h           # \u0932\u0949\u0917\u093f\u0902\u0917 \u0938\u093f\u0938\u094d\u091f\u092e\n\u2502   \u251c\u2500\u2500 config_parser.h    # \u0915\u0949\u0928\u094d\u092b\u093c\u093f\u0917 \u092a\u093e\u0930\u094d\u0938\u093f\u0902\u0917\n\u2502   \u2514\u2500\u2500 threadsafe*.h      # \u0925\u094d\u0930\u0947\u0921-\u0938\u0947\u092b \u092f\u0942\u091f\u093f\u0932\u093f\u091f\u0940\n\u251c\u2500\u2500 game/\n\u2502   \u251c\u2500\u2500 board.h/cpp        # \u092c\u094b\u0930\u094d\u0921 \u0930\u093f\u092a\u094d\u0930\u0947\u091c\u0947\u0902\u091f\u0947\u0936\u0928 \u0914\u0930 \u092c\u0941\u0928\u093f\u092f\u093e\u0926\u0940 \u0911\u092a\u0930\u0947\u0936\u0928\n\u2502   \u251c\u2500\u2500 rules.h/cpp        # \u0917\u094b \u0928\u093f\u092f\u092e\n\u2502   \u251c\u2500\u2500 boardhistory.h/cpp # \u0917\u0947\u092e \u0939\u093f\u0938\u094d\u091f\u094d\u0930\u0940\n\u2502   \u2514\u2500\u2500 graphhash.h/cpp    # \u092a\u094b\u091c\u0940\u0936\u0928 \u0939\u0948\u0936\n\u251c\u2500\u2500 search/\n\u2502   \u251c\u2500\u2500 search.h/cpp       # \u0938\u0930\u094d\u091a \u0907\u0902\u091c\u0928 \u092e\u0941\u0916\u094d\u092f \u0915\u094d\u0932\u093e\u0938\n\u2502   \u251c\u2500\u2500 searchnode.h/cpp   # \u0938\u0930\u094d\u091a \u091f\u094d\u0930\u0940 \u0928\u094b\u0921\n\u2502   \u251c\u2500\u2500 searchparams.h     # \u0938\u0930\u094d\u091a \u092a\u0948\u0930\u093e\u092e\u0940\u091f\u0930\n\u2502   \u251c\u2500\u2500 mutexpool.h        # \u0932\u0949\u0915 \u092a\u0942\u0932\n\u2502   \u251c\u2500\u2500 searchresults.h    # \u0938\u0930\u094d\u091a \u092a\u0930\u093f\u0923\u093e\u092e\n\u2502   \u2514\u2500\u2500 asyncbot.h/cpp     # \u090f\u0938\u093f\u0902\u0915\u094d\u0930\u094b\u0928\u0938 \u092c\u0949\u091f\n\u251c\u2500\u2500 neuralnet/\n\u2502   \u251c\u2500\u2500 nninputs.h/cpp     # \u0928\u094d\u092f\u0942\u0930\u0932 \u0928\u0947\u091f\u0935\u0930\u094d\u0915 \u0907\u0928\u092a\u0941\u091f \u092b\u0940\u091a\u0930\n\u2502   \u251c\u2500\u2500 nneval.h/cpp       # \u0928\u094d\u092f\u0942\u0930\u0932 \u0928\u0947\u091f\u0935\u0930\u094d\u0915 \u0907\u0935\u0948\u0932\u094d\u092f\u0942\u090f\u0936\u0928\n\u2502   \u251c\u2500\u2500 nninterface.h      # \u092c\u0948\u0915\u090f\u0902\u0921 \u090f\u092c\u094d\u0938\u094d\u091f\u094d\u0930\u0948\u0915\u094d\u091f \u0907\u0902\u091f\u0930\u092b\u0947\u0938\n\u2502   \u251c\u2500\u2500 cudabackend.cpp    # CUDA \u092c\u0948\u0915\u090f\u0902\u0921\n\u2502   \u251c\u2500\u2500 openclbackend.cpp  # OpenCL \u092c\u0948\u0915\u090f\u0902\u0921\n\u2502   \u251c\u2500\u2500 eigenbackend.cpp   # Eigen(CPU) \u092c\u0948\u0915\u090f\u0902\u0921\n\u2502   \u2514\u2500\u2500 modelversion.h     # \u092e\u0949\u0921\u0932 \u0935\u0930\u094d\u091c\u0928 \u092e\u0948\u0928\u0947\u091c\u092e\u0947\u0902\u091f\n\u2514\u2500\u2500 dataio/\n    \u251c\u2500\u2500 sgf.h/cpp          # SGF \u092b\u093c\u093e\u0907\u0932 \u092a\u094d\u0930\u094b\u0938\u0947\u0938\u093f\u0902\u0917\n    \u251c\u2500\u2500 numpywrite.h/cpp   # NumPy \u092b\u0949\u0930\u094d\u092e\u0947\u091f \u0906\u0909\u091f\u092a\u0941\u091f\n    \u2514\u2500\u2500 trainingwrite.h/cpp # \u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u0921\u0947\u091f\u093e \u0932\u0947\u0916\u0928\n"})}),"\n",(0,o.jsx)(e.h2,{id:"\u0928\u094d\u092f\u0942\u0930\u0932-\u0928\u0947\u091f\u0935\u0930\u094d\u0915-\u0906\u0930\u094d\u0915\u093f\u091f\u0947\u0915\u094d\u091a\u0930",children:"\u0928\u094d\u092f\u0942\u0930\u0932 \u0928\u0947\u091f\u0935\u0930\u094d\u0915 \u0906\u0930\u094d\u0915\u093f\u091f\u0947\u0915\u094d\u091a\u0930"}),"\n",(0,o.jsx)(e.h3,{id:"\u0928\u0947\u091f\u0935\u0930\u094d\u0915-\u0938\u0902\u0930\u091a\u0928\u093e-\u0905\u0935\u0932\u094b\u0915\u0928",children:"\u0928\u0947\u091f\u0935\u0930\u094d\u0915 \u0938\u0902\u0930\u091a\u0928\u093e \u0905\u0935\u0932\u094b\u0915\u0928"}),"\n",(0,o.jsx)(e.mermaid,{value:'graph TD\n    subgraph KataGoNN["KataGo \u0928\u094d\u092f\u0942\u0930\u0932 \u0928\u0947\u091f\u0935\u0930\u094d\u0915 \u0906\u0930\u094d\u0915\u093f\u091f\u0947\u0915\u094d\u091a\u0930"]\n        Input["\u0907\u0928\u092a\u0941\u091f \u0932\u0947\u092f\u0930<br/>(22 \u092b\u0940\u091a\u0930 \u092a\u094d\u0932\u0947\u0928 \xd7 19 \xd7 19)"]\n        InitConv["\u0907\u0928\u093f\u0936\u093f\u092f\u0932 \u0915\u0949\u0928\u094d\u0935<br/>3\xd73, C channels"]\n\n        subgraph ResBlocks["\u0930\u0947\u0938\u093f\u0921\u0941\u0905\u0932 \u092c\u094d\u0932\u0949\u0915 \xd7 N"]\n            ResBlock["BatchNorm \u2192 ReLU \u2192 Conv 3\xd73<br/>BatchNorm \u2192 ReLU \u2192 Conv 3\xd73<br/>+ Global Pooling Branch<br/>+ Skip Connection"]\n        end\n\n        PolicyHead["Policy Head"]\n        ValueHead["Value Head"]\n        OtherHeads["Other Heads"]\n\n        Input --\x3e InitConv\n        InitConv --\x3e ResBlocks\n        ResBlocks --\x3e PolicyHead\n        ResBlocks --\x3e ValueHead\n        ResBlocks --\x3e OtherHeads\n    end'}),"\n",(0,o.jsx)(e.h3,{id:"\u0907\u0928\u092a\u0941\u091f-\u092b\u0940\u091a\u0930-nninputscpp",children:"\u0907\u0928\u092a\u0941\u091f \u092b\u0940\u091a\u0930 (nninputs.cpp)"}),"\n",(0,o.jsx)(e.p,{children:"KataGo 22 \u092b\u0940\u091a\u0930 \u092a\u094d\u0932\u0947\u0928 \u0907\u0928\u092a\u0941\u091f \u0915\u0947 \u0930\u0942\u092a \u092e\u0947\u0902 \u0909\u092a\u092f\u094b\u0917 \u0915\u0930\u0924\u093e \u0939\u0948:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"// \u092e\u0941\u0916\u094d\u092f \u0907\u0928\u092a\u0941\u091f \u092b\u0940\u091a\u0930 \u0936\u094d\u0930\u0947\u0923\u093f\u092f\u093e\u0902\nenum {\n  // \u092c\u094b\u0930\u094d\u0921 \u0938\u094d\u0925\u093f\u0924\u093f\n  INPUT_FEATURE_STONE_OUR,      // \u0939\u092e\u093e\u0930\u0947 \u092a\u0924\u094d\u0925\u0930\n  INPUT_FEATURE_STONE_OPP,      // \u092a\u094d\u0930\u0924\u093f\u0926\u094d\u0935\u0902\u0926\u094d\u0935\u0940 \u0915\u0947 \u092a\u0924\u094d\u0925\u0930\n\n  // \u0932\u093f\u092c\u0930\u094d\u091f\u0940 \u0938\u0902\u092c\u0902\u0927\u093f\u0924 (1-8 \u0932\u093f\u092c\u0930\u094d\u091f\u0940)\n  INPUT_FEATURE_LIBERTIES_1,\n  INPUT_FEATURE_LIBERTIES_2,\n  // ...\n  INPUT_FEATURE_LIBERTIES_8_OR_MORE,\n\n  // \u0939\u093f\u0938\u094d\u091f\u094d\u0930\u0940 \u0938\u094d\u0925\u093f\u0924\u093f\n  INPUT_FEATURE_LAST_MOVE,      // \u092a\u093f\u091b\u0932\u0940 \u091a\u093e\u0932 \u0938\u094d\u0925\u093f\u0924\u093f\n  INPUT_FEATURE_SECOND_LAST_MOVE,\n\n  // \u0928\u093f\u092f\u092e \u0938\u0902\u092c\u0902\u0927\u093f\u0924\n  INPUT_FEATURE_KOMI,           // \u0915\u094b\u092e\u0940\n  INPUT_FEATURE_RULES,          // \u0928\u093f\u092f\u092e \u090f\u0928\u0915\u094b\u0921\u093f\u0902\u0917\n  // ...\n};\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u0917\u094d\u0932\u094b\u092c\u0932-\u092a\u0942\u0932\u093f\u0902\u0917-\u092c\u094d\u0930\u093e\u0902\u091a",children:"\u0917\u094d\u0932\u094b\u092c\u0932 \u092a\u0942\u0932\u093f\u0902\u0917 \u092c\u094d\u0930\u093e\u0902\u091a"}),"\n",(0,o.jsx)(e.p,{children:"KataGo \u0915\u093e \u090f\u0915 \u0928\u0935\u093e\u091a\u093e\u0930 \u0930\u0947\u0938\u093f\u0921\u0941\u0905\u0932 \u092c\u094d\u0932\u0949\u0915 \u092e\u0947\u0902 \u0917\u094d\u0932\u094b\u092c\u0932 \u092a\u0942\u0932\u093f\u0902\u0917 \u091c\u094b\u0921\u093c\u0928\u093e \u0939\u0948:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"// \u0938\u0930\u0932\u0940\u0915\u0943\u0924 \u0917\u094d\u0932\u094b\u092c\u0932 \u092a\u0942\u0932\u093f\u0902\u0917 \u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928 \u0905\u0935\u0927\u093e\u0930\u0923\u093e\nclass GlobalPoolingResBlock {\npublic:\n  void forward(Tensor& x) {\n    // \u092e\u093e\u0928\u0915 \u0930\u0947\u0938\u093f\u0921\u0941\u0905\u0932 \u092a\u0925\n    Tensor regular_out = regular_conv_path(x);\n\n    // \u0917\u094d\u0932\u094b\u092c\u0932 \u092a\u0942\u0932\u093f\u0902\u0917 \u092a\u0925\n    Tensor global_mean = global_avg_pool(x);  // [batch, C]\n    Tensor global_max = global_max_pool(x);    // [batch, C]\n    Tensor global_features = concat(global_mean, global_max);\n\n    // \u0917\u094d\u0932\u094b\u092c\u0932 \u092b\u0940\u091a\u0930 \u092a\u094d\u0930\u094b\u0938\u0947\u0938\n    global_features = dense_layer(global_features);  // [batch, C]\n\n    // \u0938\u094d\u092a\u0947\u0936\u0932 \u0921\u093e\u092f\u092e\u0947\u0902\u0936\u0928 \u092e\u0947\u0902 \u092c\u094d\u0930\u0949\u0921\u0915\u093e\u0938\u094d\u091f \u0914\u0930 \u0930\u0947\u0917\u0941\u0932\u0930 \u092a\u0925 \u0915\u0947 \u0938\u093e\u0925 \u092e\u0930\u094d\u091c\n    Tensor global_broadcast = broadcast_to_spatial(global_features);\n    x = regular_out + global_broadcast;\n  }\n};\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u0906\u0909\u091f\u092a\u0941\u091f-\u0939\u0947\u0921",children:"\u0906\u0909\u091f\u092a\u0941\u091f \u0939\u0947\u0921"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"// Policy Head: \u091a\u093e\u0932 \u092a\u094d\u0930\u094b\u092c\u0947\u092c\u093f\u0932\u093f\u091f\u0940 \u092d\u0935\u093f\u0937\u094d\u092f\u0935\u093e\u0923\u0940\nclass PolicyHead {\n  // \u0906\u0909\u091f\u092a\u0941\u091f: 19\xd719+1 (pass \u0938\u0939\u093f\u0924)\n  // softmax \u0928\u0949\u0930\u094d\u092e\u0932\u093e\u0907\u091c\u0947\u0936\u0928 \u0909\u092a\u092f\u094b\u0917\n};\n\n// Value Head: \u091c\u0940\u0924/\u0939\u093e\u0930 \u092d\u0935\u093f\u0937\u094d\u092f\u0935\u093e\u0923\u0940\nclass ValueHead {\n  // \u0906\u0909\u091f\u092a\u0941\u091f: 3 (\u091c\u0940\u0924/\u0939\u093e\u0930/\u0921\u094d\u0930\u0949 \u092a\u094d\u0930\u094b\u092c\u0947\u092c\u093f\u0932\u093f\u091f\u0940)\n  // softmax \u0928\u0949\u0930\u094d\u092e\u0932\u093e\u0907\u091c\u0947\u0936\u0928 \u0909\u092a\u092f\u094b\u0917\n};\n\n// Score Head: \u0905\u0902\u0915 \u092d\u0935\u093f\u0937\u094d\u092f\u0935\u093e\u0923\u0940\nclass ScoreHead {\n  // \u0906\u0909\u091f\u092a\u0941\u091f: \u0938\u0924\u0924 \u092e\u093e\u0928 (\u0905\u092a\u0947\u0915\u094d\u0937\u093f\u0924 \u0905\u0902\u0915 \u0905\u0902\u0924\u0930)\n};\n\n// Ownership Head: \u0915\u094d\u0937\u0947\u0924\u094d\u0930 \u092d\u0935\u093f\u0937\u094d\u092f\u0935\u093e\u0923\u0940\nclass OwnershipHead {\n  // \u0906\u0909\u091f\u092a\u0941\u091f: 19\xd719 (\u092a\u094d\u0930\u0924\u094d\u092f\u0947\u0915 \u092c\u093f\u0902\u0926\u0941 \u0938\u094d\u0935\u093e\u092e\u093f\u0924\u094d\u0935, tanh)\n};\n"})}),"\n",(0,o.jsx)(e.h2,{id:"\u0938\u0930\u094d\u091a-\u0907\u0902\u091c\u0928-\u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928",children:"\u0938\u0930\u094d\u091a \u0907\u0902\u091c\u0928 \u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928"}),"\n",(0,o.jsx)(e.h3,{id:"mcts-\u0915\u094b\u0930-\u0915\u094d\u0932\u093e\u0938",children:"MCTS \u0915\u094b\u0930 \u0915\u094d\u0932\u093e\u0938"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"// search/search.h\nclass Search {\npublic:\n  // \u0916\u094b\u091c \u0928\u093f\u0937\u094d\u092a\u093e\u0926\u093f\u0924 \u0915\u0930\u0947\u0902\n  void runWholeSearch(Player pla);\n\n  // \u0938\u0930\u094d\u0935\u094b\u0924\u094d\u0924\u092e \u091a\u093e\u0932 \u092a\u094d\u0930\u093e\u092a\u094d\u0924 \u0915\u0930\u0947\u0902\n  Loc getBestMove();\n\n  // \u0935\u093f\u0936\u094d\u0932\u0947\u0937\u0923 \u092a\u0930\u093f\u0923\u093e\u092e \u092a\u094d\u0930\u093e\u092a\u094d\u0924 \u0915\u0930\u0947\u0902\n  AnalysisData getAnalysisData();\n\nprivate:\n  SearchParams params;          // \u0938\u0930\u094d\u091a \u092a\u0948\u0930\u093e\u092e\u0940\u091f\u0930\n  SearchNode* rootNode;         // \u0930\u0942\u091f \u0928\u094b\u0921\n  NNEvaluator* nnEval;         // \u0928\u094d\u092f\u0942\u0930\u0932 \u0928\u0947\u091f\u0935\u0930\u094d\u0915 \u0907\u0935\u0948\u0932\u094d\u092f\u0942\u090f\u091f\u0930\n  std::mutex* mutexPool;       // \u0932\u0949\u0915 \u092a\u0942\u0932\n};\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u0938\u0930\u094d\u091a-\u0928\u094b\u0921-\u0938\u0902\u0930\u091a\u0928\u093e",children:"\u0938\u0930\u094d\u091a \u0928\u094b\u0921 \u0938\u0902\u0930\u091a\u0928\u093e"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"// search/searchnode.h\nstruct SearchNode {\n  // \u0928\u094b\u0921 \u0938\u094d\u091f\u0948\u091f\u093f\u0938\u094d\u091f\u093f\u0915\u094d\u0938\n  std::atomic<int64_t> visits;           // \u0935\u093f\u091c\u093c\u093f\u091f \u0938\u0902\u0916\u094d\u092f\u093e\n  std::atomic<double> valueSumWeight;    // \u0935\u0948\u0932\u094d\u092f\u0942 \u0938\u0902\u091a\u092f\u0940 \u0935\u0947\u091f\n  std::atomic<double> valueSum;          // \u0935\u0948\u0932\u094d\u092f\u0942 \u0938\u0902\u091a\u092f\u0940 \u092f\u094b\u0917\n\n  // \u091a\u093e\u0907\u0932\u094d\u0921 \u0928\u094b\u0921\n  std::atomic<int> numChildren;\n  SearchChildPointer* children;          // \u091a\u093e\u0907\u0932\u094d\u0921 \u0928\u094b\u0921 \u092a\u0949\u0907\u0902\u091f\u0930 \u090f\u0930\u0947\n\n  // \u0928\u094d\u092f\u0942\u0930\u0932 \u0928\u0947\u091f\u0935\u0930\u094d\u0915 \u0906\u0909\u091f\u092a\u0941\u091f \u0915\u0948\u0936\n  std::shared_ptr<NNOutput> nnOutput;\n};\n\nstruct SearchChildPointer {\n  Loc moveLoc;                           // \u091a\u093e\u0932 \u0938\u094d\u0925\u093f\u0924\u093f\n  std::atomic<SearchNode*> node;         // \u091a\u093e\u0907\u0932\u094d\u0921 \u0928\u094b\u0921 \u092a\u0949\u0907\u0902\u091f\u0930\n  std::atomic<int64_t> edgeVisits;       // \u090f\u091c \u0935\u093f\u091c\u093c\u093f\u091f \u0938\u0902\u0916\u094d\u092f\u093e\n};\n"})}),"\n",(0,o.jsx)(e.h3,{id:"puct-\u091a\u092f\u0928-\u090f\u0932\u094d\u0917\u094b\u0930\u093f\u0926\u092e",children:"PUCT \u091a\u092f\u0928 \u090f\u0932\u094d\u0917\u094b\u0930\u093f\u0926\u092e"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"// \u090f\u0915\u094d\u0938\u092a\u094d\u0932\u094b\u0930 \u0915\u0930\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f \u091a\u093e\u0907\u0932\u094d\u0921 \u0928\u094b\u0921 \u091a\u0941\u0928\u0947\u0902\nint Search::selectChildToDescend(SearchNode* node, Player pla) {\n  int bestIdx = -1;\n  double bestValue = -1e100;\n\n  for (int i = 0; i < node->numChildren; i++) {\n    SearchChildPointer& child = node->children[i];\n\n    // Q \u092e\u093e\u0928 \u0917\u0923\u0928\u093e (exploitation)\n    double q = getChildQ(child);\n\n    // U \u092e\u093e\u0928 \u0917\u0923\u0928\u093e (exploration)\n    double prior = getPrior(node, child.moveLoc);\n    double parentVisits = node->visits.load();\n    double childVisits = child.edgeVisits.load();\n\n    double u = params.cpuctExploration * prior *\n               sqrt(parentVisits) / (1.0 + childVisits);\n\n    // PUCT \u0938\u0942\u0924\u094d\u0930\n    double value = q + u;\n\n    if (value > bestValue) {\n      bestValue = value;\n      bestIdx = i;\n    }\n  }\n\n  return bestIdx;\n}\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u092a\u0948\u0930\u0932\u0932-\u0938\u0930\u094d\u091a-\u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928",children:"\u092a\u0948\u0930\u0932\u0932 \u0938\u0930\u094d\u091a \u0915\u093e\u0930\u094d\u092f\u093e\u0928\u094d\u0935\u092f\u0928"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"void Search::runWholeSearch(Player pla) {\n  // \u092e\u0932\u094d\u091f\u0940\u092a\u0932 \u0938\u0930\u094d\u091a \u0925\u094d\u0930\u0947\u0921 \u0936\u0941\u0930\u0942 \u0915\u0930\u0947\u0902\n  std::vector<std::thread> threads;\n  for (int i = 0; i < params.numSearchThreads; i++) {\n    threads.emplace_back([this, pla]() {\n      runSingleSearchThread(pla);\n    });\n  }\n\n  // \u0938\u092d\u0940 \u0925\u094d\u0930\u0947\u0921 \u092a\u0942\u0930\u093e \u0939\u094b\u0928\u0947 \u0915\u0940 \u092a\u094d\u0930\u0924\u0940\u0915\u094d\u0937\u093e\n  for (auto& t : threads) {\n    t.join();\n  }\n}\n\nvoid Search::runSingleSearchThread(Player pla) {\n  while (!shouldStop()) {\n    // \u092a\u0925 \u091a\u0941\u0928\u0947\u0902\n    std::vector<SearchNode*> path;\n    SearchNode* leaf = selectAndDescend(rootNode, path);\n\n    // \u0928\u094b\u0921 \u090f\u0915\u094d\u0938\u092a\u0948\u0902\u0921 \u0915\u0930\u0947\u0902\n    expandNode(leaf);\n\n    // \u0928\u094d\u092f\u0942\u0930\u0932 \u0928\u0947\u091f\u0935\u0930\u094d\u0915 \u0907\u0935\u0948\u0932\u094d\u092f\u0942\u090f\u0936\u0928\n    NNOutput output = nnEval->evaluate(leaf->board);\n\n    // \u0935\u0948\u0932\u094d\u092f\u0942 \u0935\u093e\u092a\u0938 \u092a\u094d\u0930\u0938\u093e\u0930\u093f\u0924 \u0915\u0930\u0947\u0902\n    backpropagateValue(path, output.value);\n  }\n}\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u0935\u0930\u094d\u091a\u0941\u0905\u0932-\u0932\u0949\u0938",children:"\u0935\u0930\u094d\u091a\u0941\u0905\u0932 \u0932\u0949\u0938"}),"\n",(0,o.jsx)(e.p,{children:"\u092a\u0948\u0930\u0932\u0932 \u0938\u0930\u094d\u091a \u092e\u0947\u0902 \u092e\u0932\u094d\u091f\u0940-\u0925\u094d\u0930\u0947\u0921 \u0938\u092e\u093e\u0928 \u092a\u0925 \u091a\u0941\u0928\u0928\u0947 \u0938\u0947 \u092c\u091a\u0928\u0947 \u0915\u0947 \u0932\u093f\u090f:"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"void Search::applyVirtualLoss(SearchNode* node) {\n  // \u0907\u0938 \u0928\u094b\u0921 \u0915\u0947 \u092e\u0942\u0932\u094d\u092f\u093e\u0902\u0915\u0928 \u092e\u093e\u0928 \u0915\u094b \u0905\u0938\u094d\u0925\u093e\u092f\u0940 \u0930\u0942\u092a \u0938\u0947 \u0915\u092e \u0915\u0930\u0947\u0902\n  // \u0924\u093e\u0915\u093f \u0905\u0928\u094d\u092f \u0925\u094d\u0930\u0947\u0921 \u0905\u0932\u0917 \u092a\u0925 \u091a\u0941\u0928\u0947\u0902\n  node->virtualLoss.fetch_add(1);\n}\n\nvoid Search::removeVirtualLoss(SearchNode* node) {\n  node->virtualLoss.fetch_sub(1);\n}\n"})}),"\n",(0,o.jsx)(e.h2,{id:"\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923-\u092a\u094d\u0930\u0915\u094d\u0930\u093f\u092f\u093e-\u0905\u0935\u0932\u094b\u0915\u0928",children:"\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u092a\u094d\u0930\u0915\u094d\u0930\u093f\u092f\u093e \u0905\u0935\u0932\u094b\u0915\u0928"}),"\n",(0,o.jsx)(e.h3,{id:"\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923-\u0921\u0947\u091f\u093e-\u091c\u0928\u0930\u0947\u0936\u0928",children:"\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u0921\u0947\u091f\u093e \u091c\u0928\u0930\u0947\u0936\u0928"}),"\n",(0,o.jsx)(e.mermaid,{value:'graph LR\n    subgraph TrainingLoop["\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u092a\u094d\u0930\u0915\u094d\u0930\u093f\u092f\u093e \u0905\u0935\u0932\u094b\u0915\u0928"]\n        SelfPlay["Self-play<br/>Worker"]\n        DataBuffer["\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u0921\u0947\u091f\u093e<br/>Buffer"]\n        Trainer["\u091f\u094d\u0930\u0947\u0928\u0930<br/>(PyTorch)"]\n        NewModel["\u0928\u092f\u093e \u092e\u0949\u0921\u0932"]\n\n        SelfPlay --\x3e DataBuffer\n        DataBuffer --\x3e Trainer\n        Trainer --\x3e NewModel\n        NewModel --\x3e SelfPlay\n    end'}),"\n",(0,o.jsx)(e.h3,{id:"\u0938\u094d\u0935-\u0916\u0947\u0932-cppcommandselfplaycpp",children:"\u0938\u094d\u0935-\u0916\u0947\u0932 (cpp/command/selfplay.cpp)"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"// Self-play \u092e\u0941\u0916\u094d\u092f \u0932\u0942\u092a\nvoid runSelfPlayLoop() {\n  while (true) {\n    // \u0928\u0935\u0940\u0928\u0924\u092e \u092e\u0949\u0921\u0932 \u0932\u094b\u0921 \u0915\u0930\u0947\u0902\n    loadLatestModel();\n\n    // \u090f\u0915 \u0917\u0947\u092e \u0916\u0947\u0932\u0947\u0902\n    GameData gameData = playSingleGame();\n\n    // \u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u0921\u0947\u091f\u093e \u0938\u0947\u0935 \u0915\u0930\u0947\u0902\n    writeTrainingData(gameData);\n  }\n}\n\nGameData playSingleGame() {\n  Board board;\n  BoardHistory history;\n  GameData gameData;\n\n  while (!history.isGameOver()) {\n    // MCTS \u0938\u0947 \u091a\u093e\u0932 \u091a\u0941\u0928\u0947\u0902\n    Search search(board, history, params);\n    search.runWholeSearch(history.currentPla);\n\n    // MCTS \u092a\u0930\u093f\u0923\u093e\u092e \u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u0932\u0915\u094d\u0937\u094d\u092f \u0915\u0947 \u0930\u0942\u092a \u092e\u0947\u0902\n    MoveData moveData;\n    moveData.policyTarget = search.getPolicyDistribution();\n    moveData.valueTarget = search.getValue();\n\n    // \u091a\u093e\u0932 \u0928\u093f\u0937\u094d\u092a\u093e\u0926\u093f\u0924 \u0915\u0930\u0947\u0902\n    Loc move = search.sampleMove();\n    board.playMove(move, history.currentPla);\n\n    gameData.moves.push_back(moveData);\n  }\n\n  // \u0905\u0902\u0924\u093f\u092e \u092a\u0930\u093f\u0923\u093e\u092e \u092d\u0930\u0947\u0902\n  gameData.finalScore = history.finalScore();\n  return gameData;\n}\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923-\u0921\u0947\u091f\u093e-\u092b\u0949\u0930\u094d\u092e\u0947\u091f",children:"\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u0921\u0947\u091f\u093e \u092b\u0949\u0930\u094d\u092e\u0947\u091f"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"// dataio/trainingwrite.h\nstruct TrainingRow {\n  // \u0907\u0928\u092a\u0941\u091f \u092b\u0940\u091a\u0930\n  float inputFeatures[NUM_FEATURES][BOARD_SIZE][BOARD_SIZE];\n\n  // \u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u0932\u0915\u094d\u0937\u094d\u092f\n  float policyTarget[BOARD_SIZE * BOARD_SIZE + 1];  // pass \u0938\u0939\u093f\u0924\n  float valueTarget[3];                              // \u091c\u0940\u0924/\u0939\u093e\u0930/\u0921\u094d\u0930\u0949\n  float scoreTarget;                                 // \u0905\u0902\u0915\n  float ownershipTarget[BOARD_SIZE][BOARD_SIZE];    // \u0915\u094d\u0937\u0947\u0924\u094d\u0930\n\n  // \u092e\u0947\u091f\u093e\u0921\u0947\u091f\u093e\n  int turn;\n  int rules;\n  float komi;\n};\n"})}),"\n",(0,o.jsx)(e.h3,{id:"python-\u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923-\u092a\u094d\u0930\u094b\u0917\u094d\u0930\u093e\u092e-pythontrainpy",children:"Python \u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u092a\u094d\u0930\u094b\u0917\u094d\u0930\u093e\u092e (python/train.py)"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:"# \u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u092e\u0941\u0916\u094d\u092f \u0932\u0942\u092a (\u0938\u0930\u0932\u0940\u0915\u0943\u0924)\ndef train():\n    model = KataGoModel(config)\n    optimizer = torch.optim.SGD(model.parameters(), lr=config.lr)\n\n    for epoch in range(config.num_epochs):\n        for batch in data_loader:\n            # \u092b\u0949\u0930\u0935\u0930\u094d\u0921 \u092a\u093e\u0938\n            policy_pred, value_pred, score_pred, ownership_pred = model(batch.input)\n\n            # \u0932\u0949\u0938 \u0917\u0923\u0928\u093e\n            policy_loss = cross_entropy(policy_pred, batch.policy_target)\n            value_loss = cross_entropy(value_pred, batch.value_target)\n            score_loss = mse_loss(score_pred, batch.score_target)\n            ownership_loss = mse_loss(ownership_pred, batch.ownership_target)\n\n            # \u0915\u0941\u0932 \u0932\u0949\u0938 (\u092d\u093e\u0930\u093f\u0924 \u092f\u094b\u0917)\n            total_loss = (\n                policy_loss +\n                config.value_weight * value_loss +\n                config.score_weight * score_loss +\n                config.ownership_weight * ownership_loss\n            )\n\n            # \u092c\u0948\u0915\u0935\u0930\u094d\u0921 \u092a\u093e\u0938\n            optimizer.zero_grad()\n            total_loss.backward()\n            optimizer.step()\n\n        # \u091a\u0947\u0915\u092a\u0949\u0907\u0902\u091f \u0938\u0947\u0935 \u0915\u0930\u0947\u0902\n        save_checkpoint(model, epoch)\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u092e\u0949\u0921\u0932-\u092a\u0930\u093f\u092d\u093e\u0937\u093e-pythonmodelpy",children:"\u092e\u0949\u0921\u0932 \u092a\u0930\u093f\u092d\u093e\u0937\u093e (python/model.py)"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-python",children:"class KataGoModel(nn.Module):\n    def __init__(self, config):\n        super().__init__()\n\n        # \u0907\u0928\u093f\u0936\u093f\u092f\u0932 \u0915\u0949\u0928\u094d\u0935\u094b\u0932\u094d\u092f\u0942\u0936\u0928\n        self.initial_conv = nn.Conv2d(\n            config.input_channels,\n            config.trunk_channels,\n            kernel_size=3, padding=1\n        )\n\n        # \u0930\u0947\u0938\u093f\u0921\u0941\u0905\u0932 \u092c\u094d\u0932\u0949\u0915\n        self.blocks = nn.ModuleList([\n            ResBlock(config.trunk_channels, use_global_pooling=True)\n            for _ in range(config.num_blocks)\n        ])\n\n        # \u0906\u0909\u091f\u092a\u0941\u091f \u0939\u0947\u0921\n        self.policy_head = PolicyHead(config)\n        self.value_head = ValueHead(config)\n        self.score_head = ScoreHead(config)\n        self.ownership_head = OwnershipHead(config)\n\n    def forward(self, x):\n        # \u091f\u094d\u0930\u0902\u0915 \u0928\u0947\u091f\u0935\u0930\u094d\u0915\n        x = self.initial_conv(x)\n        for block in self.blocks:\n            x = block(x)\n\n        # \u0906\u0909\u091f\u092a\u0941\u091f \u0939\u0947\u0921\n        policy = self.policy_head(x)\n        value = self.value_head(x)\n        score = self.score_head(x)\n        ownership = self.ownership_head(x)\n\n        return policy, value, score, ownership\n"})}),"\n",(0,o.jsx)(e.h2,{id:"\u092e\u0941\u0916\u094d\u092f-\u0921\u0947\u091f\u093e-\u0938\u0902\u0930\u091a\u0928\u093e\u090f\u0902",children:"\u092e\u0941\u0916\u094d\u092f \u0921\u0947\u091f\u093e \u0938\u0902\u0930\u091a\u0928\u093e\u090f\u0902"}),"\n",(0,o.jsx)(e.h3,{id:"board-gameboardh",children:"Board (game/board.h)"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"class Board {\npublic:\n  // \u092c\u094b\u0930\u094d\u0921 \u0938\u094d\u0925\u093f\u0924\u093f\n  Color stones[MAX_BOARD_AREA];    // \u092a\u094d\u0930\u0924\u094d\u092f\u0947\u0915 \u092c\u093f\u0902\u0926\u0941 \u0915\u093e \u0930\u0902\u0917\n  Chain chains[MAX_BOARD_AREA];    // \u091a\u0947\u0928 \u091c\u093e\u0928\u0915\u093e\u0930\u0940\n\n  // \u0915\u094b\n  Loc koLoc;\n\n  // \u091a\u093e\u0932 \u0928\u093f\u0937\u094d\u092a\u093e\u0926\u093f\u0924 \u0915\u0930\u0947\u0902\n  void playMove(Loc loc, Color pla);\n\n  // \u0935\u0948\u0927\u0924\u093e \u091c\u093e\u0902\u091a\n  bool isLegal(Loc loc, Color pla) const;\n\n  // \u0932\u093f\u092c\u0930\u094d\u091f\u0940 \u0917\u0923\u0928\u093e\n  int getLiberties(Loc loc) const;\n};\n\nstruct Chain {\n  int liberties;                   // \u0932\u093f\u092c\u0930\u094d\u091f\u0940 \u0938\u0902\u0916\u094d\u092f\u093e\n  int numStones;                   // \u092a\u0924\u094d\u0925\u0930 \u0938\u0902\u0916\u094d\u092f\u093e\n  Loc head;                        // \u0932\u093f\u0902\u0915\u094d\u0921 \u0932\u093f\u0938\u094d\u091f \u0939\u0947\u0921\n};\n"})}),"\n",(0,o.jsx)(e.h3,{id:"boardhistory-gameboardhistoryh",children:"BoardHistory (game/boardhistory.h)"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"class BoardHistory {\npublic:\n  std::vector<Board> boards;       // \u0939\u093f\u0938\u094d\u091f\u094d\u0930\u0940 \u092c\u094b\u0930\u094d\u0921 \u0938\u094d\u0925\u093f\u0924\u093f\n  std::vector<Move> moves;         // \u091a\u093e\u0932 \u0939\u093f\u0938\u094d\u091f\u094d\u0930\u0940\n  Rules rules;                     // \u0928\u093f\u092f\u092e\n  Player currentPla;               // \u0935\u0930\u094d\u0924\u092e\u093e\u0928 \u0916\u093f\u0932\u093e\u0921\u093c\u0940\n\n  // \u0917\u0947\u092e \u0938\u094d\u0925\u093f\u0924\u093f\n  bool isGameOver() const;\n  float finalScore() const;\n};\n"})}),"\n",(0,o.jsx)(e.h3,{id:"nnoutput-neuralnetnnevalh",children:"NNOutput (neuralnet/nneval.h)"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:"struct NNOutput {\n  // Policy\n  float policyProbs[MAX_BOARD_AREA + 1];  // pass \u0938\u0939\u093f\u0924\n\n  // Value\n  float whiteWinProb;\n  float whiteLossProb;\n  float noResultProb;\n\n  // Score\n  float whiteScoreMean;\n  float whiteScoreStdev;\n\n  // Ownership\n  float ownership[MAX_BOARD_AREA];  // -1 \u0938\u0947 1\n};\n"})}),"\n",(0,o.jsx)(e.h2,{id:"\u0935\u093f\u0915\u093e\u0938-\u0914\u0930-\u0921\u0940\u092c\u0917\u093f\u0902\u0917",children:"\u0935\u093f\u0915\u093e\u0938 \u0914\u0930 \u0921\u0940\u092c\u0917\u093f\u0902\u0917"}),"\n",(0,o.jsx)(e.h3,{id:"\u0921\u0940\u092c\u0917-\u0938\u0902\u0938\u094d\u0915\u0930\u0923-\u0915\u0902\u092a\u093e\u0907\u0932",children:"\u0921\u0940\u092c\u0917 \u0938\u0902\u0938\u094d\u0915\u0930\u0923 \u0915\u0902\u092a\u093e\u0907\u0932"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"cd cpp\nmkdir build_debug && cd build_debug\ncmake .. -DCMAKE_BUILD_TYPE=Debug -DUSE_BACKEND=OPENCL\nmake -j$(nproc)\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u092f\u0942\u0928\u093f\u091f-\u091f\u0947\u0938\u094d\u091f-\u091a\u0932\u093e\u090f\u0902",children:"\u092f\u0942\u0928\u093f\u091f \u091f\u0947\u0938\u094d\u091f \u091a\u0932\u093e\u090f\u0902"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:"./katago runtests\n"})}),"\n",(0,o.jsx)(e.h3,{id:"\u0938\u093e\u092e\u093e\u0928\u094d\u092f-\u0921\u0940\u092c\u0917\u093f\u0902\u0917-\u0935\u093f\u0927\u093f\u092f\u093e\u0902",children:"\u0938\u093e\u092e\u093e\u0928\u094d\u092f \u0921\u0940\u092c\u0917\u093f\u0902\u0917 \u0935\u093f\u0927\u093f\u092f\u093e\u0902"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-cpp",children:'// 1. \u0932\u0949\u0917\u093f\u0902\u0917 \u0909\u092a\u092f\u094b\u0917 \u0915\u0930\u0947\u0902\n#include "core/logger.h"\nLogger::log("Debug message", value);\n\n// 2. kata-debug-print GTP \u0915\u092e\u093e\u0902\u0921 \u0909\u092a\u092f\u094b\u0917 \u0915\u0930\u0947\u0902\n// \u0935\u093f\u0938\u094d\u0924\u0943\u0924 \u0938\u0930\u094d\u091a \u091c\u093e\u0928\u0915\u093e\u0930\u0940 \u0906\u0909\u091f\u092a\u0941\u091f\n\n// 3. \u0915\u0902\u092a\u093e\u0907\u0932 \u0938\u092e\u092f sanitizers \u0938\u0915\u094d\u0937\u092e \u0915\u0930\u0947\u0902\ncmake .. -DCMAKE_CXX_FLAGS="-fsanitize=address"\n'})}),"\n",(0,o.jsx)(e.h3,{id:"\u092a\u094d\u0930\u0926\u0930\u094d\u0936\u0928-\u0935\u093f\u0936\u094d\u0932\u0947\u0937\u0923",children:"\u092a\u094d\u0930\u0926\u0930\u094d\u0936\u0928 \u0935\u093f\u0936\u094d\u0932\u0947\u0937\u0923"}),"\n",(0,o.jsx)(e.pre,{children:(0,o.jsx)(e.code,{className:"language-bash",children:'# perf \u0909\u092a\u092f\u094b\u0917 \u0915\u0930\u0947\u0902 (Linux)\nperf record ./katago benchmark -model model.bin.gz\nperf report\n\n# Instruments \u0909\u092a\u092f\u094b\u0917 \u0915\u0930\u0947\u0902 (macOS)\ninstruments -t "Time Profiler" ./katago benchmark -model model.bin.gz\n'})}),"\n",(0,o.jsx)(e.h2,{id:"\u0906\u0917\u0947-\u092a\u0922\u093c\u0947\u0902",children:"\u0906\u0917\u0947 \u092a\u0922\u093c\u0947\u0902"}),"\n",(0,o.jsxs)(e.ul,{children:["\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"https://github.com/lightvector/KataGo",children:"KataGo GitHub"})}),"\n",(0,o.jsx)(e.li,{children:(0,o.jsx)(e.a,{href:"https://arxiv.org/abs/1902.10565",children:"KataGo \u092a\u0947\u092a\u0930"})}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.a,{href:"https://discord.gg/bqkZAz3",children:"KataGo Discord"})," - \u0921\u0947\u0935\u0932\u092a\u0930\u094d\u0938 \u0938\u0947 \u092c\u093e\u0924\u091a\u0940\u0924"]}),"\n",(0,o.jsxs)(e.li,{children:[(0,o.jsx)(e.a,{href:"https://katagotraining.org/",children:"KataGo Training"})," - \u092a\u094d\u0930\u0936\u093f\u0915\u094d\u0937\u0923 \u092a\u094d\u0930\u0917\u0924\u093f \u0926\u0947\u0916\u0947\u0902"]}),"\n"]}),"\n",(0,o.jsx)(e.p,{children:"KataGo \u0915\u0947 \u0938\u094b\u0930\u094d\u0938 \u0915\u094b\u0921 \u0906\u0930\u094d\u0915\u093f\u091f\u0947\u0915\u094d\u091a\u0930 \u0938\u092e\u091d\u0928\u0947 \u0915\u0947 \u092c\u093e\u0926, \u0906\u092a\u0915\u0947 \u092a\u093e\u0938 \u0917\u0939\u0928 \u0905\u0928\u0941\u0938\u0902\u0927\u093e\u0928 \u092f\u093e \u0913\u092a\u0928-\u0938\u094b\u0930\u094d\u0938 \u092a\u094d\u0930\u094b\u091c\u0947\u0915\u094d\u091f \u092e\u0947\u0902 \u092f\u094b\u0917\u0926\u093e\u0928 \u0915\u0940 \u0915\u094d\u0937\u092e\u0924\u093e \u0939\u0948\u0964 \u092f\u0926\u093f \u0906\u092a \u0906\u0917\u0947 \u091c\u093e\u0928\u0928\u093e \u091a\u093e\u0939\u0924\u0947 \u0939\u0948\u0902, KataGo \u0915\u093e GitHub \u0938\u094b\u0930\u094d\u0938 \u0915\u094b\u0921 \u0938\u0940\u0927\u0947 \u092a\u0922\u093c\u0928\u0947 \u0914\u0930 \u0938\u092e\u0941\u0926\u093e\u092f \u091a\u0930\u094d\u091a\u093e \u092e\u0947\u0902 \u092d\u093e\u0917 \u0932\u0947\u0928\u0947 \u0915\u0940 \u0938\u093f\u092b\u093e\u0930\u093f\u0936 \u0939\u0948\u0964"})]})}function h(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,o.jsx)(e,{...n,children:(0,o.jsx)(d,{...n})}):d(n)}}}]);