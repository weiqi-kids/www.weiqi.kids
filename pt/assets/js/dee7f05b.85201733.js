"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[1637],{52510(e,a,d){d.r(a),d.d(a,{assets:()=>l,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>t});const i=JSON.parse('{"id":"for-engineers/how-it-works/alphago-explained/dual-head-resnet","title":"Rede de Cabe\xe7a Dupla e Rede Residual","description":"An\xe1lise aprofundada da arquitetura de rede neural do AlphaGo Zero - Backbone compartilhado, Policy Head, Value Head e ResNet de 40 camadas","source":"@site/i18n/pt/docusaurus-plugin-content-docs/current/for-engineers/how-it-works/alphago-explained/17-dual-head-resnet.mdx","sourceDirName":"for-engineers/how-it-works/alphago-explained","slug":"/for-engineers/how-it-works/alphago-explained/dual-head-resnet","permalink":"/pt/docs/for-engineers/how-it-works/alphago-explained/dual-head-resnet","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/for-engineers/how-it-works/alphago-explained/17-dual-head-resnet.mdx","tags":[],"version":"current","sidebarPosition":18,"frontMatter":{"sidebar_position":18,"title":"Rede de Cabe\xe7a Dupla e Rede Residual","description":"An\xe1lise aprofundada da arquitetura de rede neural do AlphaGo Zero - Backbone compartilhado, Policy Head, Value Head e ResNet de 40 camadas","keywords":["rede de cabe\xe7a dupla","rede residual","ResNet","Policy Head","Value Head","aprendizado profundo","arquitetura de rede neural"]},"sidebar":"tutorialSidebar","previous":{"title":"Vis\xe3o Geral do AlphaGo Zero","permalink":"/pt/docs/for-engineers/how-it-works/alphago-explained/alphago-zero"},"next":{"title":"O Processo de Treinamento do Zero","permalink":"/pt/docs/for-engineers/how-it-works/alphago-explained/training-from-scratch"}}');var r=d(62615),n=d(30416);const s={sidebar_position:18,title:"Rede de Cabe\xe7a Dupla e Rede Residual",description:"An\xe1lise aprofundada da arquitetura de rede neural do AlphaGo Zero - Backbone compartilhado, Policy Head, Value Head e ResNet de 40 camadas",keywords:["rede de cabe\xe7a dupla","rede residual","ResNet","Policy Head","Value Head","aprendizado profundo","arquitetura de rede neural"]},o="Rede de Cabe\xe7a Dupla e Rede Residual",l={},t=[{value:"Design da Rede de Cabe\xe7a Dupla",id:"design-da-rede-de-cabe\xe7a-dupla",level:2},{value:"Arquitetura Geral",id:"arquitetura-geral",level:3},{value:"Backbone Compartilhado (Shared Backbone)",id:"backbone-compartilhado-shared-backbone",level:3},{value:"Detalhes da Arquitetura",id:"detalhes-da-arquitetura",level:4},{value:"Representa\xe7\xe3o Matem\xe1tica",id:"representa\xe7\xe3o-matem\xe1tica",level:4},{value:"Policy Head (Cabe\xe7a de Pol\xedtica)",id:"policy-head-cabe\xe7a-de-pol\xedtica",level:3},{value:"Detalhes da Arquitetura",id:"detalhes-da-arquitetura-1",level:4},{value:"Representa\xe7\xe3o Matem\xe1tica",id:"representa\xe7\xe3o-matem\xe1tica-1",level:4},{value:"Value Head (Cabe\xe7a de Valor)",id:"value-head-cabe\xe7a-de-valor",level:3},{value:"Detalhes da Arquitetura",id:"detalhes-da-arquitetura-2",level:4},{value:"Representa\xe7\xe3o Matem\xe1tica",id:"representa\xe7\xe3o-matem\xe1tica-2",level:4},{value:"Por que Compartilhar o Backbone?",id:"por-que-compartilhar-o-backbone",level:2},{value:"Compreens\xe3o Intuitiva",id:"compreens\xe3o-intuitiva",level:3},{value:"Perspectiva de Aprendizado Multi-tarefa",id:"perspectiva-de-aprendizado-multi-tarefa",level:3},{value:"1. Efeito de Regulariza\xe7\xe3o",id:"1-efeito-de-regulariza\xe7\xe3o",level:4},{value:"2. Efici\xeancia de Dados",id:"2-efici\xeancia-de-dados",level:4},{value:"3. Sinais de Gradiente Mais Ricos",id:"3-sinais-de-gradiente-mais-ricos",level:4},{value:"Evid\xeancia Experimental",id:"evid\xeancia-experimental",level:3},{value:"Princ\xedpios da Rede Residual",id:"princ\xedpios-da-rede-residual",level:2},{value:"O Dilema das Redes Profundas",id:"o-dilema-das-redes-profundas",level:3},{value:"Design do Bloco Residual",id:"design-do-bloco-residual",level:3},{value:"Representa\xe7\xe3o Matem\xe1tica",id:"representa\xe7\xe3o-matem\xe1tica-3",level:4},{value:"Por que a Conex\xe3o Residual Funciona?",id:"por-que-a-conex\xe3o-residual-funciona",level:3},{value:"1. Rodovia de Gradientes",id:"1-rodovia-de-gradientes",level:4},{value:"2. Mapeamento Identidade \xe9 Mais F\xe1cil de Aprender",id:"2-mapeamento-identidade-\xe9-mais-f\xe1cil-de-aprender",level:4},{value:"3. Efeito de Ensemble",id:"3-efeito-de-ensemble",level:4},{value:"O Avan\xe7o da ResNet no ImageNet",id:"o-avan\xe7o-da-resnet-no-imagenet",level:3},{value:"ResNet de 40 Camadas do AlphaGo Zero",id:"resnet-de-40-camadas-do-alphago-zero",level:2},{value:"Por que Escolher 40 Camadas?",id:"por-que-escolher-40-camadas",level:3},{value:"Configura\xe7\xe3o Espec\xedfica",id:"configura\xe7\xe3o-espec\xedfica",level:3},{value:"Estimativa de Par\xe2metros",id:"estimativa-de-par\xe2metros",level:4},{value:"O Papel do Batch Normalization",id:"o-papel-do-batch-normalization",level:3},{value:"1. Normaliza\xe7\xe3o de Ativa\xe7\xf5es",id:"1-normaliza\xe7\xe3o-de-ativa\xe7\xf5es",level:4},{value:"2. Mitiga\xe7\xe3o do Internal Covariate Shift",id:"2-mitiga\xe7\xe3o-do-internal-covariate-shift",level:4},{value:"3. Efeito de Regulariza\xe7\xe3o",id:"3-efeito-de-regulariza\xe7\xe3o",level:4},{value:"Compara\xe7\xe3o com Outras Arquiteturas",id:"compara\xe7\xe3o-com-outras-arquiteturas",level:2},{value:"vs. CNN do AlphaGo Original",id:"vs-cnn-do-alphago-original",level:3},{value:"vs. Rede Estilo VGG",id:"vs-rede-estilo-vgg",level:3},{value:"vs. Inception / GoogLeNet",id:"vs-inception--googlenet",level:3},{value:"vs. Transformer",id:"vs-transformer",level:3},{value:"An\xe1lise Aprofundada das Escolhas de Design",id:"an\xe1lise-aprofundada-das-escolhas-de-design",level:2},{value:"Por que usar convolu\xe7\xf5es 3\xd73?",id:"por-que-usar-convolu\xe7\xf5es-33",level:3},{value:"Por que usar 256 canais?",id:"por-que-usar-256-canais",level:3},{value:"Por que Policy Head usa Softmax e Value Head usa Tanh?",id:"por-que-policy-head-usa-softmax-e-value-head-usa-tanh",level:3},{value:"Policy Head: Softmax",id:"policy-head-softmax",level:4},{value:"Value Head: Tanh",id:"value-head-tanh",level:4},{value:"Detalhes de Treinamento",id:"detalhes-de-treinamento",level:2},{value:"Fun\xe7\xe3o de Perda",id:"fun\xe7\xe3o-de-perda",level:3},{value:"Policy Loss",id:"policy-loss",level:4},{value:"Value Loss",id:"value-loss",level:4},{value:"Regularization Loss",id:"regularization-loss",level:4},{value:"Configura\xe7\xe3o do Otimizador",id:"configura\xe7\xe3o-do-otimizador",level:3},{value:"Data Augmentation",id:"data-augmentation",level:3},{value:"Considera\xe7\xf5es de Implementa\xe7\xe3o",id:"considera\xe7\xf5es-de-implementa\xe7\xe3o",level:2},{value:"Otimiza\xe7\xe3o de Mem\xf3ria",id:"otimiza\xe7\xe3o-de-mem\xf3ria",level:3},{value:"Otimiza\xe7\xe3o de Infer\xeancia",id:"otimiza\xe7\xe3o-de-infer\xeancia",level:3},{value:"Quantiza\xe7\xe3o e Compress\xe3o",id:"quantiza\xe7\xe3o-e-compress\xe3o",level:3},{value:"Correspond\xeancia de Anima\xe7\xf5es",id:"correspond\xeancia-de-anima\xe7\xf5es",level:2},{value:"Leitura Adicional",id:"leitura-adicional",level:2},{value:"Refer\xeancias",id:"refer\xeancias",level:2}];function c(e){const a={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,n.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.header,{children:(0,r.jsx)(a.h1,{id:"rede-de-cabe\xe7a-dupla-e-rede-residual",children:"Rede de Cabe\xe7a Dupla e Rede Residual"})}),"\n",(0,r.jsxs)(a.p,{children:["Uma das inova\xe7\xf5es arquitet\xf4nicas mais importantes do AlphaGo Zero \xe9 o uso de uma ",(0,r.jsx)(a.strong,{children:"Rede de Cabe\xe7a Dupla (Dual-Head Network)"})," para substituir o design de rede dupla do AlphaGo original. Esta mudan\xe7a aparentemente simples trouxe melhorias significativas de desempenho e um processo de aprendizado mais elegante."]}),"\n",(0,r.jsx)(a.p,{children:"Este artigo analisar\xe1 em profundidade os princ\xedpios de design desta arquitetura, as bases matem\xe1ticas e por que ela \xe9 t\xe3o eficaz."}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"design-da-rede-de-cabe\xe7a-dupla",children:"Design da Rede de Cabe\xe7a Dupla"}),"\n",(0,r.jsx)(a.h3,{id:"arquitetura-geral",children:"Arquitetura Geral"}),"\n",(0,r.jsx)(a.p,{children:"A rede neural do AlphaGo Zero pode ser dividida em tr\xeas partes:"}),"\n",(0,r.jsx)(a.mermaid,{value:'flowchart TB\n    Input["Entrada (17 \xd7 19 \xd7 19)"]\n\n    subgraph Backbone["Backbone Compartilhado (ResNet)"]\n        BB["40 blocos residuais, 256 canais"]\n    end\n\n    Input --\x3e Backbone\n\n    Backbone --\x3e PH["Policy Head<br/>(Cabe\xe7a de Pol\xedtica)"]\n    Backbone --\x3e VH["Value Head<br/>(Cabe\xe7a de Valor)"]\n\n    PH --\x3e POut["Distribui\xe7\xe3o de probabilidade<br/>19\xd719 + 1 Pass"]\n    VH --\x3e VOut["Taxa de vit\xf3ria<br/>[-1, 1]"]'}),"\n",(0,r.jsx)(a.p,{children:"Vamos analisar cada parte uma a uma."}),"\n",(0,r.jsx)(a.h3,{id:"backbone-compartilhado-shared-backbone",children:"Backbone Compartilhado (Shared Backbone)"}),"\n",(0,r.jsxs)(a.p,{children:["O backbone compartilhado \xe9 uma ",(0,r.jsx)(a.strong,{children:"Rede Residual (ResNet)"})," profunda, respons\xe1vel por extrair caracter\xedsticas do estado do tabuleiro."]}),"\n",(0,r.jsx)(a.h4,{id:"detalhes-da-arquitetura",children:"Detalhes da Arquitetura"}),"\n",(0,r.jsxs)(a.table,{children:[(0,r.jsx)(a.thead,{children:(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.th,{children:"Componente"}),(0,r.jsx)(a.th,{children:"Especifica\xe7\xe3o"})]})}),(0,r.jsxs)(a.tbody,{children:[(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Camada de entrada"}),(0,r.jsx)(a.td,{children:"Convolu\xe7\xe3o 3\xd73, 256 canais"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Blocos residuais"}),(0,r.jsx)(a.td,{children:"40 (ou 20 na vers\xe3o compacta)"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Por bloco residual"}),(0,r.jsx)(a.td,{children:"2 camadas de convolu\xe7\xe3o 3\xd73, 256 canais"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Fun\xe7\xe3o de ativa\xe7\xe3o"}),(0,r.jsx)(a.td,{children:"ReLU"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Normaliza\xe7\xe3o"}),(0,r.jsx)(a.td,{children:"Batch Normalization"})]})]})]}),"\n",(0,r.jsx)(a.h4,{id:"representa\xe7\xe3o-matem\xe1tica",children:"Representa\xe7\xe3o Matem\xe1tica"}),"\n",(0,r.jsx)(a.p,{children:"Seja a entrada x (dimens\xe3o 17 x 19 x 19), a sa\xedda do backbone compartilhado \xe9:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"f(x) = ResNet_40(Conv_3x3(x))\n"})}),"\n",(0,r.jsx)(a.p,{children:"Onde f(x) (dimens\xe3o 256 x 19 x 19) \xe9 a representa\xe7\xe3o de caracter\xedsticas de alta dimens\xe3o."}),"\n",(0,r.jsx)(a.h3,{id:"policy-head-cabe\xe7a-de-pol\xedtica",children:"Policy Head (Cabe\xe7a de Pol\xedtica)"}),"\n",(0,r.jsx)(a.p,{children:"A Policy Head \xe9 respons\xe1vel por prever a probabilidade de jogada em cada posi\xe7\xe3o."}),"\n",(0,r.jsx)(a.h4,{id:"detalhes-da-arquitetura-1",children:"Detalhes da Arquitetura"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"Sa\xedda do backbone compartilhado (256 \xd7 19 \xd7 19)\n       \u2193\nConvolu\xe7\xe3o 1\xd71 (2 canais)\n       \u2193\nBatch Normalization\n       \u2193\nReLU\n       \u2193\nAchatamento (2 \xd7 19 \xd7 19 = 722)\n       \u2193\nCamada totalmente conectada (362)\n       \u2193\nSoftmax\n       \u2193\nSa\xedda: 362 probabilidades (361 posi\xe7\xf5es + Pass)\n"})}),"\n",(0,r.jsx)(a.h4,{id:"representa\xe7\xe3o-matem\xe1tica-1",children:"Representa\xe7\xe3o Matem\xe1tica"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"\u03c0 = Softmax(FC(Flatten(ReLU(BN(Conv_1x1(f(x)))))))\n"})}),"\n",(0,r.jsx)(a.p,{children:"A sa\xedda \u03c0 \xe9 um vetor de 362 dimens\xf5es, com todos os elementos n\xe3o negativos e soma igual a 1."}),"\n",(0,r.jsx)(a.h3,{id:"value-head-cabe\xe7a-de-valor",children:"Value Head (Cabe\xe7a de Valor)"}),"\n",(0,r.jsx)(a.p,{children:"A Value Head \xe9 respons\xe1vel por prever a taxa de vit\xf3ria da posi\xe7\xe3o atual."}),"\n",(0,r.jsx)(a.h4,{id:"detalhes-da-arquitetura-2",children:"Detalhes da Arquitetura"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"Sa\xedda do backbone compartilhado (256 \xd7 19 \xd7 19)\n       \u2193\nConvolu\xe7\xe3o 1\xd71 (1 canal)\n       \u2193\nBatch Normalization\n       \u2193\nReLU\n       \u2193\nAchatamento (1 \xd7 19 \xd7 19 = 361)\n       \u2193\nCamada totalmente conectada (256)\n       \u2193\nReLU\n       \u2193\nCamada totalmente conectada (1)\n       \u2193\nTanh\n       \u2193\nSa\xedda: Taxa de vit\xf3ria [-1, 1]\n"})}),"\n",(0,r.jsx)(a.h4,{id:"representa\xe7\xe3o-matem\xe1tica-2",children:"Representa\xe7\xe3o Matem\xe1tica"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"v = Tanh(FC_1(ReLU(FC_2(Flatten(ReLU(BN(Conv_1x1(f(x)))))))))\n"})}),"\n",(0,r.jsx)(a.p,{children:"A sa\xedda v est\xe1 no intervalo [-1, 1]:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"v = 1: O lado atual com certeza ganha"}),"\n",(0,r.jsx)(a.li,{children:"v = -1: O lado atual com certeza perde"}),"\n",(0,r.jsx)(a.li,{children:"v = 0: Equilibrado"}),"\n"]}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"por-que-compartilhar-o-backbone",children:"Por que Compartilhar o Backbone?"}),"\n",(0,r.jsx)(a.h3,{id:"compreens\xe3o-intuitiva",children:"Compreens\xe3o Intuitiva"}),"\n",(0,r.jsx)(a.p,{children:'"Onde devo jogar a seguir" (Policy) e "Quem vai ganhar" (Value) \u2014 estas duas perguntas na verdade precisam entender os mesmos padr\xf5es de tabuleiro:'}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Formas"}),": Quais formas s\xe3o boas, quais s\xe3o ruins"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Influ\xeancia"}),": Qual lado \xe9 maior, onde ainda h\xe1 espa\xe7o"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Vida e morte"}),": Quais pedras j\xe1 est\xe3o vivas, quais ainda est\xe3o em ko"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Combate"}),": Onde h\xe1 ataques e capturas, qual \xe9 o resultado local"]}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"Se usar duas redes independentes, estas caracter\xedsticas precisam ser aprendidas duas vezes. O backbone compartilhado permite que essas caracter\xedsticas de baixo n\xedvel sejam aprendidas apenas uma vez, e ambas as tarefas podem us\xe1-las."}),"\n",(0,r.jsx)(a.h3,{id:"perspectiva-de-aprendizado-multi-tarefa",children:"Perspectiva de Aprendizado Multi-tarefa"}),"\n",(0,r.jsxs)(a.p,{children:["Do ponto de vista de aprendizado de m\xe1quina, isto \xe9 uma forma de ",(0,r.jsx)(a.strong,{children:"Aprendizado Multi-tarefa (Multi-task Learning)"}),":"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"L = L_policy + L_value\n"})}),"\n",(0,r.jsx)(a.p,{children:"Duas tarefas compartilhando representa\xe7\xe3o de baixo n\xedvel traz v\xe1rias vantagens:"}),"\n",(0,r.jsx)(a.h4,{id:"1-efeito-de-regulariza\xe7\xe3o",children:"1. Efeito de Regulariza\xe7\xe3o"}),"\n",(0,r.jsx)(a.p,{children:"Par\xe2metros compartilhados equivalem a regulariza\xe7\xe3o impl\xedcita. Se uma caracter\xedstica \xe9 \xfatil apenas para Policy e n\xe3o para Value (ou vice-versa), \xe9 mais dif\xedcil ser amplificada excessivamente."}),"\n",(0,r.jsx)(a.p,{children:"O n\xfamero efetivo de par\xe2metros \xe9 menor que a soma dos par\xe2metros de duas redes independentes."}),"\n",(0,r.jsx)(a.h4,{id:"2-efici\xeancia-de-dados",children:"2. Efici\xeancia de Dados"}),"\n",(0,r.jsx)(a.p,{children:"Cada partida produz simultaneamente r\xf3tulos de Policy (probabilidades de busca MCTS) e r\xf3tulos de Value (resultado final). O backbone compartilhado permite que ambos os r\xf3tulos sejam usados para treinar caracter\xedsticas compartilhadas, aumentando a efici\xeancia de utiliza\xe7\xe3o de dados."}),"\n",(0,r.jsx)(a.h4,{id:"3-sinais-de-gradiente-mais-ricos",children:"3. Sinais de Gradiente Mais Ricos"}),"\n",(0,r.jsx)(a.p,{children:"Gradientes de ambas as tarefas fluem para o backbone compartilhado:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"\u2202L/\u2202\u03b8_shared = \u2202L_policy/\u2202\u03b8_shared + \u2202L_value/\u2202\u03b8_shared\n"})}),"\n",(0,r.jsx)(a.p,{children:"Isto fornece sinais de supervis\xe3o mais ricos, tornando as caracter\xedsticas compartilhadas mais robustas."}),"\n",(0,r.jsx)(a.h3,{id:"evid\xeancia-experimental",children:"Evid\xeancia Experimental"}),"\n",(0,r.jsx)(a.p,{children:"Experimentos de abla\xe7\xe3o da DeepMind mostram que a rede de cabe\xe7a dupla tem desempenho significativamente melhor que redes duplas separadas:"}),"\n",(0,r.jsxs)(a.table,{children:[(0,r.jsx)(a.thead,{children:(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.th,{children:"Configura\xe7\xe3o"}),(0,r.jsx)(a.th,{children:"Classifica\xe7\xe3o ELO"}),(0,r.jsx)(a.th,{children:"Diferen\xe7a Relativa"})]})}),(0,r.jsxs)(a.tbody,{children:[(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Redes Policy + Value separadas"}),(0,r.jsx)(a.td,{children:"Linha de base"}),(0,r.jsx)(a.td,{children:"-"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Rede de cabe\xe7a dupla (backbone compartilhado)"}),(0,r.jsx)(a.td,{children:"+300 ELO"}),(0,r.jsx)(a.td,{children:"~65% de diferen\xe7a de taxa de vit\xf3ria"})]})]})]}),"\n",(0,r.jsx)(a.p,{children:"Uma diferen\xe7a de 300 ELO significa que a rede de cabe\xe7a dupla tem aproximadamente 65% de taxa de vit\xf3ria contra redes separadas. Esta \xe9 uma melhoria significativa."}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"princ\xedpios-da-rede-residual",children:"Princ\xedpios da Rede Residual"}),"\n",(0,r.jsx)(a.h3,{id:"o-dilema-das-redes-profundas",children:"O Dilema das Redes Profundas"}),"\n",(0,r.jsx)(a.p,{children:"Antes da inven\xe7\xe3o da ResNet, redes neurais profundas enfrentavam um paradoxo:"}),"\n",(0,r.jsxs)(a.blockquote,{children:["\n",(0,r.jsx)(a.p,{children:"Teoricamente, redes mais profundas deveriam ser pelo menos t\xe3o boas quanto redes mais rasas (no pior caso, as camadas extras podem aprender o mapeamento identidade). Mas na pr\xe1tica, redes mais profundas frequentemente tinham desempenho pior."}),"\n"]}),"\n",(0,r.jsxs)(a.p,{children:["Este \xe9 o ",(0,r.jsx)(a.strong,{children:"Problema de Degrada\xe7\xe3o (Degradation Problem)"}),":"]}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"O erro de treinamento aumenta com a profundidade (n\xe3o \xe9 overfitting, \xe9 dificuldade de otimiza\xe7\xe3o)"}),"\n",(0,r.jsx)(a.li,{children:"Gradientes desaparecem gradualmente durante a retropropaga\xe7\xe3o (Vanishing Gradient)"}),"\n",(0,r.jsx)(a.li,{children:"Par\xe2metros de camadas profundas quase n\xe3o conseguem ser atualizados efetivamente"}),"\n"]}),"\n",(0,r.jsx)(a.h3,{id:"design-do-bloco-residual",children:"Design do Bloco Residual"}),"\n",(0,r.jsxs)(a.p,{children:["Kaiming He e colaboradores propuseram uma solu\xe7\xe3o elegante e simples em 2015: ",(0,r.jsx)(a.strong,{children:"Conex\xe3o Residual (Skip Connection)"}),"."]}),"\n",(0,r.jsx)(a.mermaid,{value:'flowchart TB\n    X["Entrada x"]\n    X --\x3e Conv["Camada conv<br/>BN + ReLU<br/>Camada conv<br/>BN"]\n    Conv --\x3e FX["F(x)"]\n\n    X --\x3e|"skip connection"| Add((" "))\n    FX --\x3e Add\n\n    Add --\x3e ReLU["ReLU"]\n    ReLU --\x3e Out["Sa\xedda x + F(x)"]'}),"\n",(0,r.jsx)(a.h4,{id:"representa\xe7\xe3o-matem\xe1tica-3",children:"Representa\xe7\xe3o Matem\xe1tica"}),"\n",(0,r.jsx)(a.p,{children:"Rede tradicional: Aprender mapeamento alvo H(x)"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"y = H(x)\n"})}),"\n",(0,r.jsxs)(a.p,{children:["Rede residual: Aprender ",(0,r.jsx)(a.strong,{children:"mapeamento residual"})," F(x) = H(x) - x"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"y = F(x) + x\n"})}),"\n",(0,r.jsx)(a.h3,{id:"por-que-a-conex\xe3o-residual-funciona",children:"Por que a Conex\xe3o Residual Funciona?"}),"\n",(0,r.jsx)(a.h4,{id:"1-rodovia-de-gradientes",children:"1. Rodovia de Gradientes"}),"\n",(0,r.jsx)(a.p,{children:"Considere o gradiente na retropropaga\xe7\xe3o:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"\u2202L/\u2202x = \u2202L/\u2202y \xd7 \u2202y/\u2202x = \u2202L/\u2202y \xd7 (1 + \u2202F(x)/\u2202x)\n"})}),"\n",(0,r.jsxs)(a.p,{children:["A chave est\xe1 no ",(0,r.jsx)(a.strong,{children:"+1"}),". Mesmo se \u2202F(x)/\u2202x for muito pequeno ou zero, o gradiente ainda pode ser passado de volta diretamente atrav\xe9s do +1."]}),"\n",(0,r.jsx)(a.p,{children:'\xc9 como construir uma "rodovia de gradientes", permitindo que gradientes fluam livremente da camada de sa\xedda de volta para a camada de entrada.'}),"\n",(0,r.jsx)(a.h4,{id:"2-mapeamento-identidade-\xe9-mais-f\xe1cil-de-aprender",children:"2. Mapeamento Identidade \xe9 Mais F\xe1cil de Aprender"}),"\n",(0,r.jsx)(a.p,{children:"Se a solu\xe7\xe3o \xf3tima est\xe1 pr\xf3xima do mapeamento identidade (H(x) aproximadamente igual a x), ent\xe3o:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Rede tradicional: Precisa aprender H(x) = x, pode ser dif\xedcil"}),"\n",(0,r.jsx)(a.li,{children:"Rede residual: S\xf3 precisa aprender F(x) aproximadamente igual a 0, relativamente f\xe1cil"}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"Inicializando pesos em zero ou pr\xf3ximo de zero, o bloco residual naturalmente tende ao mapeamento identidade."}),"\n",(0,r.jsx)(a.h4,{id:"3-efeito-de-ensemble",children:"3. Efeito de Ensemble"}),"\n",(0,r.jsxs)(a.p,{children:["Uma ResNet profunda pode ser vista como um ",(0,r.jsx)(a.strong,{children:"ensemble impl\xedcito"})," de muitas redes rasas. Se h\xe1 n blocos residuais, a informa\xe7\xe3o pode fluir por 2^n caminhos diferentes."]}),"\n",(0,r.jsx)(a.p,{children:"Este efeito de ensemble aumenta a robustez do modelo."}),"\n",(0,r.jsx)(a.h3,{id:"o-avan\xe7o-da-resnet-no-imagenet",children:"O Avan\xe7o da ResNet no ImageNet"}),"\n",(0,r.jsx)(a.p,{children:"A ResNet alcan\xe7ou resultados impressionantes na competi\xe7\xe3o ImageNet de 2015:"}),"\n",(0,r.jsxs)(a.table,{children:[(0,r.jsx)(a.thead,{children:(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.th,{children:"Profundidade"}),(0,r.jsx)(a.th,{children:"Taxa de erro Top-5"})]})}),(0,r.jsxs)(a.tbody,{children:[(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"VGG-19 (sem residual)"}),(0,r.jsx)(a.td,{children:"7.3%"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"ResNet-34"}),(0,r.jsx)(a.td,{children:"5.7%"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"ResNet-152"}),(0,r.jsx)(a.td,{children:"4.5%"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"N\xedvel humano"}),(0,r.jsx)(a.td,{children:"~5.1%"})]})]})]}),"\n",(0,r.jsxs)(a.p,{children:["Uma ResNet de ",(0,r.jsx)(a.strong,{children:"152 camadas"})," n\xe3o s\xf3 pode ser treinada, mas \xe9 muito melhor que a VGG de 19 camadas. Isto prova que a conex\xe3o residual realmente resolve o problema de treinamento de redes profundas."]}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"resnet-de-40-camadas-do-alphago-zero",children:"ResNet de 40 Camadas do AlphaGo Zero"}),"\n",(0,r.jsx)(a.h3,{id:"por-que-escolher-40-camadas",children:"Por que Escolher 40 Camadas?"}),"\n",(0,r.jsx)(a.p,{children:"A DeepMind testou ResNets de diferentes profundidades:"}),"\n",(0,r.jsxs)(a.table,{children:[(0,r.jsx)(a.thead,{children:(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.th,{children:"N\xfamero de Blocos Residuais"}),(0,r.jsx)(a.th,{children:"Total de Camadas"}),(0,r.jsx)(a.th,{children:"Classifica\xe7\xe3o ELO"})]})}),(0,r.jsxs)(a.tbody,{children:[(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"5"}),(0,r.jsx)(a.td,{children:"11"}),(0,r.jsx)(a.td,{children:"Linha de base"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"10"}),(0,r.jsx)(a.td,{children:"21"}),(0,r.jsx)(a.td,{children:"+200"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"20"}),(0,r.jsx)(a.td,{children:"41"}),(0,r.jsx)(a.td,{children:"+400"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"40"}),(0,r.jsx)(a.td,{children:"81"}),(0,r.jsx)(a.td,{children:"+500"})]})]})]}),"\n",(0,r.jsx)(a.p,{children:"Redes mais profundas s\xe3o de fato mais fortes, mas o benef\xedcio marginal diminui. O AlphaGo Zero usa 20 ou 40 blocos residuais:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"AlphaGo Zero (vers\xe3o do paper)"}),": 40 blocos residuais, 256 canais"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Vers\xe3o compacta"}),": 20 blocos residuais, 256 canais"]}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"A configura\xe7\xe3o de 40 camadas alcan\xe7a um bom equil\xedbrio entre for\xe7a de jogo e custo de treinamento."}),"\n",(0,r.jsx)(a.h3,{id:"configura\xe7\xe3o-espec\xedfica",children:"Configura\xe7\xe3o Espec\xedfica"}),"\n",(0,r.jsx)(a.p,{children:"A configura\xe7\xe3o da ResNet do AlphaGo Zero \xe9 a seguinte:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"Entrada: 17 \xd7 19 \xd7 19\n\u2193\nCamada conv: 3\xd73, 256 canais, BN, ReLU\n\u2193\nBloco residual \xd740:\n  \u251c\u2500 Camada conv: 3\xd73, 256 canais, BN, ReLU\n  \u251c\u2500 Camada conv: 3\xd73, 256 canais, BN\n  \u2514\u2500 Skip connection + ReLU\n\u2193\nPolicy Head / Value Head\n"})}),"\n",(0,r.jsx)(a.h4,{id:"estimativa-de-par\xe2metros",children:"Estimativa de Par\xe2metros"}),"\n",(0,r.jsxs)(a.table,{children:[(0,r.jsx)(a.thead,{children:(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.th,{children:"Componente"}),(0,r.jsx)(a.th,{children:"Par\xe2metros (aprox.)"})]})}),(0,r.jsxs)(a.tbody,{children:[(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Convolu\xe7\xe3o de entrada"}),(0,r.jsx)(a.td,{children:"17 \xd7 3 \xd7 3 \xd7 256 \u2248 39K"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Por bloco residual"}),(0,r.jsx)(a.td,{children:"2 \xd7 256 \xd7 3 \xd7 3 \xd7 256 \u2248 1.2M"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"40 blocos residuais"}),(0,r.jsx)(a.td,{children:"40 \xd7 1.2M \u2248 47M"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Policy Head"}),(0,r.jsx)(a.td,{children:"~1M"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Value Head"}),(0,r.jsx)(a.td,{children:"~0.2M"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:(0,r.jsx)(a.strong,{children:"Total"})}),(0,r.jsx)(a.td,{children:(0,r.jsx)(a.strong,{children:"~48M"})})]})]})]}),"\n",(0,r.jsx)(a.p,{children:"Aproximadamente 48 milh\xf5es de par\xe2metros, uma rede neural de tamanho m\xe9dio pelos padr\xf5es modernos."}),"\n",(0,r.jsx)(a.h3,{id:"o-papel-do-batch-normalization",children:"O Papel do Batch Normalization"}),"\n",(0,r.jsxs)(a.p,{children:["Cada camada convolucional \xe9 seguida por ",(0,r.jsx)(a.strong,{children:"Batch Normalization (BN)"}),", que \xe9 crucial para a estabilidade do treinamento:"]}),"\n",(0,r.jsx)(a.h4,{id:"1-normaliza\xe7\xe3o-de-ativa\xe7\xf5es",children:"1. Normaliza\xe7\xe3o de Ativa\xe7\xf5es"}),"\n",(0,r.jsx)(a.p,{children:"BN normaliza as ativa\xe7\xf5es de cada camada para m\xe9dia 0 e vari\xe2ncia 1:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"x_hat = (x - \u03bc_B) / sqrt(\u03c3_B\xb2 + \u03b5)\ny = \u03b3 \xd7 x_hat + \u03b2\n"})}),"\n",(0,r.jsx)(a.p,{children:"Onde \u03b3 e \u03b2 s\xe3o par\xe2metros aprend\xedveis."}),"\n",(0,r.jsx)(a.h4,{id:"2-mitiga\xe7\xe3o-do-internal-covariate-shift",children:"2. Mitiga\xe7\xe3o do Internal Covariate Shift"}),"\n",(0,r.jsx)(a.p,{children:"Em redes profundas, a distribui\xe7\xe3o de entrada de cada camada muda \xe0 medida que os par\xe2metros das camadas anteriores s\xe3o atualizados. BN mant\xe9m a distribui\xe7\xe3o de entrada de cada camada est\xe1vel, acelerando a converg\xeancia do treinamento."}),"\n",(0,r.jsx)(a.h4,{id:"3-efeito-de-regulariza\xe7\xe3o",children:"3. Efeito de Regulariza\xe7\xe3o"}),"\n",(0,r.jsx)(a.p,{children:"BN usa estat\xedsticas do mini-batch durante o treinamento, introduzindo aleatoriedade, tendo um leve efeito de regulariza\xe7\xe3o."}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"compara\xe7\xe3o-com-outras-arquiteturas",children:"Compara\xe7\xe3o com Outras Arquiteturas"}),"\n",(0,r.jsx)(a.h3,{id:"vs-cnn-do-alphago-original",children:"vs. CNN do AlphaGo Original"}),"\n",(0,r.jsxs)(a.table,{children:[(0,r.jsx)(a.thead,{children:(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.th,{children:"Caracter\xedstica"}),(0,r.jsx)(a.th,{children:"AlphaGo Original"}),(0,r.jsx)(a.th,{children:"AlphaGo Zero"})]})}),(0,r.jsxs)(a.tbody,{children:[(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Tipo de arquitetura"}),(0,r.jsx)(a.td,{children:"CNN padr\xe3o"}),(0,r.jsx)(a.td,{children:"ResNet"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Profundidade"}),(0,r.jsx)(a.td,{children:"13 camadas"}),(0,r.jsx)(a.td,{children:"41-81 camadas"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Conex\xe3o residual"}),(0,r.jsx)(a.td,{children:"N\xe3o"}),(0,r.jsx)(a.td,{children:"Sim"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"N\xfamero de redes"}),(0,r.jsx)(a.td,{children:"2 (separadas)"}),(0,r.jsx)(a.td,{children:"1 (compartilhada)"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"BN"}),(0,r.jsx)(a.td,{children:"N\xe3o"}),(0,r.jsx)(a.td,{children:"Sim"})]})]})]}),"\n",(0,r.jsx)(a.h3,{id:"vs-rede-estilo-vgg",children:"vs. Rede Estilo VGG"}),"\n",(0,r.jsx)(a.p,{children:"VGG foi a arquitetura vice-campe\xe3 do ImageNet 2014, usando convolu\xe7\xf5es 3\xd73 empilhadas:"}),"\n",(0,r.jsxs)(a.table,{children:[(0,r.jsx)(a.thead,{children:(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.th,{children:"Caracter\xedstica"}),(0,r.jsx)(a.th,{children:"VGG"}),(0,r.jsx)(a.th,{children:"ResNet"})]})}),(0,r.jsxs)(a.tbody,{children:[(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Profundidade m\xe1xima trein\xe1vel"}),(0,r.jsx)(a.td,{children:"~19 camadas"}),(0,r.jsx)(a.td,{children:"152+ camadas"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Fluxo de gradiente"}),(0,r.jsx)(a.td,{children:"Diminui por camada"}),(0,r.jsx)(a.td,{children:"Tem rodovia"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Dificuldade de treinamento"}),(0,r.jsx)(a.td,{children:"Dif\xedcil em profundidade"}),(0,r.jsx)(a.td,{children:"Profundo \xe9 trein\xe1vel"})]})]})]}),"\n",(0,r.jsx)(a.h3,{id:"vs-inception--googlenet",children:"vs. Inception / GoogLeNet"}),"\n",(0,r.jsx)(a.p,{children:"Inception usa convolu\xe7\xf5es multi-escala em paralelo:"}),"\n",(0,r.jsxs)(a.table,{children:[(0,r.jsx)(a.thead,{children:(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.th,{children:"Caracter\xedstica"}),(0,r.jsx)(a.th,{children:"Inception"}),(0,r.jsx)(a.th,{children:"ResNet"})]})}),(0,r.jsxs)(a.tbody,{children:[(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Destaques"}),(0,r.jsx)(a.td,{children:"Caracter\xedsticas multi-escala"}),(0,r.jsx)(a.td,{children:"Empilhamento profundo"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Complexidade"}),(0,r.jsx)(a.td,{children:"Maior"}),(0,r.jsx)(a.td,{children:"Simples"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Aplicabilidade ao Go"}),(0,r.jsx)(a.td,{children:"M\xe9dia"}),(0,r.jsx)(a.td,{children:"Excelente"})]})]})]}),"\n",(0,r.jsx)(a.p,{children:"O design simples da ResNet \xe9 mais adequado para Go, uma tarefa que requer racioc\xednio profundo."}),"\n",(0,r.jsx)(a.h3,{id:"vs-transformer",children:"vs. Transformer"}),"\n",(0,r.jsx)(a.p,{children:"A arquitetura Transformer proposta em 2017 teve grande sucesso em NLP. Alguns tentaram aplicar Transformers ao Go:"}),"\n",(0,r.jsxs)(a.table,{children:[(0,r.jsx)(a.thead,{children:(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.th,{children:"Caracter\xedstica"}),(0,r.jsx)(a.th,{children:"ResNet"}),(0,r.jsx)(a.th,{children:"Transformer"})]})}),(0,r.jsxs)(a.tbody,{children:[(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Vi\xe9s indutivo"}),(0,r.jsx)(a.td,{children:"Localidade (convolu\xe7\xe3o)"}),(0,r.jsx)(a.td,{children:"Aten\xe7\xe3o global"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Codifica\xe7\xe3o posicional"}),(0,r.jsx)(a.td,{children:"Impl\xedcita (convolu\xe7\xe3o)"}),(0,r.jsx)(a.td,{children:"Expl\xedcita"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Desempenho em Go"}),(0,r.jsx)(a.td,{children:"Excelente"}),(0,r.jsx)(a.td,{children:"Vi\xe1vel mas n\xe3o supera ResNet"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Efici\xeancia computacional"}),(0,r.jsx)(a.td,{children:"Maior"}),(0,r.jsx)(a.td,{children:"Menor (O(n\xb2))"})]})]})]}),"\n",(0,r.jsx)(a.p,{children:"Para problemas com estrutura espacial clara como Go, o vi\xe9s indutivo de CNN/ResNet \xe9 mais apropriado."}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"an\xe1lise-aprofundada-das-escolhas-de-design",children:"An\xe1lise Aprofundada das Escolhas de Design"}),"\n",(0,r.jsx)(a.h3,{id:"por-que-usar-convolu\xe7\xf5es-33",children:"Por que usar convolu\xe7\xf5es 3\xd73?"}),"\n",(0,r.jsx)(a.p,{children:"O AlphaGo Zero usa convolu\xe7\xf5es 3\xd73 em toda parte, em vez de kernels maiores:"}),"\n",(0,r.jsxs)(a.ol,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Efici\xeancia de par\xe2metros"}),": Duas convolu\xe7\xf5es 3\xd73 t\xeam campo receptivo igual a uma 5\xd75, mas menos par\xe2metros (18 vs 25)"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Rede mais profunda"}),": Com a mesma quantidade de par\xe2metros, pode empilhar mais camadas"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Mais n\xe3o-linearidade"}),": ReLU entre cada camada aumenta a expressividade"]}),"\n"]}),"\n",(0,r.jsx)(a.h3,{id:"por-que-usar-256-canais",children:"Por que usar 256 canais?"}),"\n",(0,r.jsx)(a.p,{children:"256 canais \xe9 uma escolha emp\xedrica:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Muito poucos"})," (como 64): Expressividade insuficiente, n\xe3o consegue capturar padr\xf5es complexos"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Muitos"})," (como 512): Par\xe2metros dobram, custo de treinamento aumenta muito, mas melhoria de for\xe7a \xe9 limitada"]}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"Experimentos posteriores do KataGo mostraram que o n\xfamero de canais pode ser ajustado de acordo com os recursos de treinamento:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Baixos recursos: 128 canais, 20 blocos"}),"\n",(0,r.jsx)(a.li,{children:"Altos recursos: 256 canais, 40 blocos"}),"\n",(0,r.jsx)(a.li,{children:"Recursos ainda maiores: 384 canais, 60 blocos"}),"\n"]}),"\n",(0,r.jsx)(a.h3,{id:"por-que-policy-head-usa-softmax-e-value-head-usa-tanh",children:"Por que Policy Head usa Softmax e Value Head usa Tanh?"}),"\n",(0,r.jsx)(a.h4,{id:"policy-head-softmax",children:"Policy Head: Softmax"}),"\n",(0,r.jsxs)(a.p,{children:["Jogar \xe9 um ",(0,r.jsx)(a.strong,{children:"problema de classifica\xe7\xe3o"})," \u2014 escolher uma entre 361 posi\xe7\xf5es (mais Pass). A sa\xedda Softmax satisfaz:"]}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Todas as probabilidades n\xe3o negativas: \u03c0_i >= 0"}),"\n",(0,r.jsx)(a.li,{children:"Soma das probabilidades igual a 1: \u03a3\u03c0_i = 1"}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"Isto \xe9 consistente com a defini\xe7\xe3o de distribui\xe7\xe3o de probabilidade."}),"\n",(0,r.jsx)(a.h4,{id:"value-head-tanh",children:"Value Head: Tanh"}),"\n",(0,r.jsxs)(a.p,{children:["A taxa de vit\xf3ria \xe9 um ",(0,r.jsx)(a.strong,{children:"problema de regress\xe3o"})," \u2014 prever um valor cont\xednuo. O intervalo de sa\xedda do Tanh \xe9 [-1, 1]:"]}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"Limitado: N\xe3o produz valores extremos"}),"\n",(0,r.jsx)(a.li,{children:"Sim\xe9trico: Vit\xf3ria e derrota tratadas simetricamente"}),"\n",(0,r.jsx)(a.li,{children:"Diferenci\xe1vel: Conveniente para c\xe1lculo de gradiente"}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"Usar Tanh em vez de sa\xedda ilimitada (como camada linear) pode prevenir instabilidade no treinamento."}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"detalhes-de-treinamento",children:"Detalhes de Treinamento"}),"\n",(0,r.jsx)(a.h3,{id:"fun\xe7\xe3o-de-perda",children:"Fun\xe7\xe3o de Perda"}),"\n",(0,r.jsx)(a.p,{children:"A perda total do AlphaGo Zero \xe9 a soma de tr\xeas termos:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"L = L_policy + L_value + L_reg\n"})}),"\n",(0,r.jsx)(a.h4,{id:"policy-loss",children:"Policy Loss"}),"\n",(0,r.jsxs)(a.p,{children:["Usa ",(0,r.jsx)(a.strong,{children:"perda de entropia cruzada"}),", fazendo a sa\xedda da rede se aproximar das probabilidades de busca MCTS:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"L_policy = -\u03a3 \u03c0_MCTS(a) \xd7 log(\u03c0_net(a))\n"})}),"\n",(0,r.jsx)(a.p,{children:"Onde:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"\u03c0_MCTS(a) \xe9 a probabilidade de busca MCTS para a a\xe7\xe3o a"}),"\n",(0,r.jsx)(a.li,{children:"\u03c0_net(a) \xe9 a probabilidade de sa\xedda da rede"}),"\n"]}),"\n",(0,r.jsx)(a.h4,{id:"value-loss",children:"Value Loss"}),"\n",(0,r.jsxs)(a.p,{children:["Usa ",(0,r.jsx)(a.strong,{children:"Erro Quadr\xe1tico M\xe9dio (MSE)"}),", fazendo a sa\xedda da rede se aproximar do resultado real:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"L_value = (v_net - z)\xb2\n"})}),"\n",(0,r.jsx)(a.p,{children:"Onde:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:"v_net \xe9 a taxa de vit\xf3ria prevista pela rede"}),"\n",(0,r.jsx)(a.li,{children:"z \xe9 o resultado real da partida (+1 ou -1)"}),"\n"]}),"\n",(0,r.jsx)(a.h4,{id:"regularization-loss",children:"Regularization Loss"}),"\n",(0,r.jsxs)(a.p,{children:["Usa ",(0,r.jsx)(a.strong,{children:"regulariza\xe7\xe3o L2"})," para prevenir overfitting:"]}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"L_reg = c \xd7 ||\u03b8||\xb2\n"})}),"\n",(0,r.jsx)(a.p,{children:"Onde c \xe9 o coeficiente de regulariza\xe7\xe3o e \u03b8 s\xe3o os par\xe2metros da rede."}),"\n",(0,r.jsx)(a.h3,{id:"configura\xe7\xe3o-do-otimizador",children:"Configura\xe7\xe3o do Otimizador"}),"\n",(0,r.jsxs)(a.table,{children:[(0,r.jsx)(a.thead,{children:(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.th,{children:"Par\xe2metro"}),(0,r.jsx)(a.th,{children:"Valor"})]})}),(0,r.jsxs)(a.tbody,{children:[(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Otimizador"}),(0,r.jsx)(a.td,{children:"SGD + Momentum"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Momentum"}),(0,r.jsx)(a.td,{children:"0.9"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Taxa de aprendizado inicial"}),(0,r.jsx)(a.td,{children:"0.01"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Decaimento da taxa de aprendizado"}),(0,r.jsx)(a.td,{children:"Pela metade a cada X passos"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Batch Size"}),(0,r.jsx)(a.td,{children:"32 \xd7 2048 = 64K (distribu\xeddo)"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"Coeficiente de regulariza\xe7\xe3o L2"}),(0,r.jsx)(a.td,{children:"1e-4"})]})]})]}),"\n",(0,r.jsx)(a.h3,{id:"data-augmentation",children:"Data Augmentation"}),"\n",(0,r.jsx)(a.p,{children:"O tabuleiro de Go tem 8 simetrias (4 rota\xe7\xf5es \xd7 2 reflex\xf5es). Durante o treinamento, cada posi\xe7\xe3o pode produzir 8 amostras de treinamento equivalentes."}),"\n",(0,r.jsx)(a.p,{children:"Isto aumenta os dados de treinamento efetivos em 8 vezes, sem necessidade de auto-jogo adicional."}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"considera\xe7\xf5es-de-implementa\xe7\xe3o",children:"Considera\xe7\xf5es de Implementa\xe7\xe3o"}),"\n",(0,r.jsx)(a.h3,{id:"otimiza\xe7\xe3o-de-mem\xf3ria",children:"Otimiza\xe7\xe3o de Mem\xf3ria"}),"\n",(0,r.jsx)(a.p,{children:"Treinar uma ResNet de 40 camadas requer muita mem\xf3ria:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Forward pass"}),": Precisa armazenar ativa\xe7\xf5es de cada camada (para backpropagation)"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Backward pass"}),": Precisa armazenar gradientes"]}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"Estrat\xe9gias de otimiza\xe7\xe3o:"}),"\n",(0,r.jsxs)(a.ol,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Gradient Checkpointing"}),": Armazenar apenas algumas ativa\xe7\xf5es, recalcular quando necess\xe1rio"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Treinamento de precis\xe3o mista"}),": Usar FP16 para reduzir uso de mem\xf3ria"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Treinamento distribu\xeddo"}),": Distribuir batch entre m\xfaltiplas GPUs/TPUs"]}),"\n"]}),"\n",(0,r.jsx)(a.h3,{id:"otimiza\xe7\xe3o-de-infer\xeancia",children:"Otimiza\xe7\xe3o de Infer\xeancia"}),"\n",(0,r.jsx)(a.p,{children:"Durante infer\xeancia, n\xe3o s\xe3o necess\xe1rias estat\xedsticas de mini-batch do BN, pode usar m\xe9dias m\xf3veis acumuladas durante o treinamento:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"x_hat = (x - \u03bc_moving) / sqrt(\u03c3_moving\xb2 + \u03b5)\n"})}),"\n",(0,r.jsx)(a.p,{children:"Isto torna a infer\xeancia mais r\xe1pida e os resultados determin\xedsticos."}),"\n",(0,r.jsx)(a.h3,{id:"quantiza\xe7\xe3o-e-compress\xe3o",children:"Quantiza\xe7\xe3o e Compress\xe3o"}),"\n",(0,r.jsx)(a.p,{children:"O deployment pode comprimir ainda mais a rede:"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Quantiza\xe7\xe3o de pesos"}),": FP32 \u2192 INT8, mem\xf3ria reduzida em 4\xd7"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Poda"}),": Remover conex\xf5es de pesos pequenos"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Destila\xe7\xe3o de conhecimento"}),": Usar rede grande para treinar rede pequena"]}),"\n"]}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"correspond\xeancia-de-anima\xe7\xf5es",children:"Correspond\xeancia de Anima\xe7\xf5es"}),"\n",(0,r.jsx)(a.p,{children:"Conceitos centrais discutidos neste artigo e n\xfameros de anima\xe7\xe3o:"}),"\n",(0,r.jsxs)(a.table,{children:[(0,r.jsx)(a.thead,{children:(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.th,{children:"N\xfamero"}),(0,r.jsx)(a.th,{children:"Conceito"}),(0,r.jsx)(a.th,{children:"Correspond\xeancia F\xedsica/Matem\xe1tica"})]})}),(0,r.jsxs)(a.tbody,{children:[(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"\ud83c\udfac E3"}),(0,r.jsx)(a.td,{children:"Rede de cabe\xe7a dupla"}),(0,r.jsx)(a.td,{children:"Aprendizado multi-tarefa"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"\ud83c\udfac D12"}),(0,r.jsx)(a.td,{children:"Conex\xe3o residual"}),(0,r.jsx)(a.td,{children:"Rodovia de gradientes"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"\ud83c\udfac D8"}),(0,r.jsx)(a.td,{children:"Rede neural convolucional"}),(0,r.jsx)(a.td,{children:"Campo receptivo local"})]}),(0,r.jsxs)(a.tr,{children:[(0,r.jsx)(a.td,{children:"\ud83c\udfac D10"}),(0,r.jsx)(a.td,{children:"Batch Normalization"}),(0,r.jsx)(a.td,{children:"Normaliza\xe7\xe3o de distribui\xe7\xe3o"})]})]})]}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"leitura-adicional",children:"Leitura Adicional"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Artigo anterior"}),": ",(0,r.jsx)(a.a,{href:"../alphago-zero",children:"Vis\xe3o Geral do AlphaGo Zero"})," \u2014 Por que n\xe3o precisa de registros de partidas humanas"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Pr\xf3ximo artigo"}),": ",(0,r.jsx)(a.a,{href:"../training-from-scratch",children:"O Processo de Treinamento do Zero"})," \u2014 Evolu\xe7\xe3o detalhada dos Dias 0-3"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.strong,{children:"Aprofundamento t\xe9cnico"}),": ",(0,r.jsx)(a.a,{href:"../cnn-and-go",children:"CNN e Go Combinados"})," \u2014 Por que CNN \xe9 adequada para tabuleiros"]}),"\n"]}),"\n",(0,r.jsx)(a.hr,{}),"\n",(0,r.jsx)(a.h2,{id:"refer\xeancias",children:"Refer\xeancias"}),"\n",(0,r.jsxs)(a.ol,{children:["\n",(0,r.jsxs)(a.li,{children:['Silver, D., et al. (2017). "Mastering the game of Go without human knowledge." ',(0,r.jsx)(a.em,{children:"Nature"}),", 550, 354-359."]}),"\n",(0,r.jsxs)(a.li,{children:['He, K., et al. (2016). "Deep Residual Learning for Image Recognition." ',(0,r.jsx)(a.em,{children:"CVPR 2016"}),"."]}),"\n",(0,r.jsxs)(a.li,{children:['Ioffe, S., & Szegedy, C. (2015). "Batch Normalization: Accelerating Deep Network Training by Reducing Internal Covariate Shift." ',(0,r.jsx)(a.em,{children:"ICML 2015"}),"."]}),"\n",(0,r.jsxs)(a.li,{children:['Caruana, R. (1997). "Multitask Learning." ',(0,r.jsx)(a.em,{children:"Machine Learning"}),", 28(1), 41-75."]}),"\n",(0,r.jsxs)(a.li,{children:['Veit, A., et al. (2016). "Residual Networks Behave Like Ensembles of Relatively Shallow Networks." ',(0,r.jsx)(a.em,{children:"NeurIPS 2016"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:a}={...(0,n.R)(),...e.components};return a?(0,r.jsx)(a,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},30416(e,a,d){d.d(a,{R:()=>s,x:()=>o});var i=d(59471);const r={},n=i.createContext(r);function s(e){const a=i.useContext(n);return i.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(n.Provider,{value:a},e.children)}}}]);