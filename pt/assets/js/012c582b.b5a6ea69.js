"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[5032],{88361(e,n,a){a.r(n),a.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"tech/deep-dive/training","title":"An\xe1lise do Mecanismo de Treinamento do KataGo","description":"Compreens\xe3o profunda do fluxo de treinamento por auto-jogo do KataGo e suas tecnologias principais","source":"@site/i18n/pt/docusaurus-plugin-content-docs/current/tech/deep-dive/training.md","sourceDirName":"tech/deep-dive","slug":"/tech/deep-dive/training","permalink":"/pt/docs/tech/deep-dive/training","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tech/deep-dive/training.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"An\xe1lise do Mecanismo de Treinamento do KataGo","description":"Compreens\xe3o profunda do fluxo de treinamento por auto-jogo do KataGo e suas tecnologias principais"},"sidebar":"tutorialSidebar","previous":{"title":"Guia do Codigo-fonte do KataGo","permalink":"/pt/docs/tech/deep-dive/source-code"},"next":{"title":"Participando da Comunidade Open Source","permalink":"/pt/docs/tech/deep-dive/contributing"}}');var r=a(62615),i=a(30416);const s={sidebar_position:3,title:"An\xe1lise do Mecanismo de Treinamento do KataGo",description:"Compreens\xe3o profunda do fluxo de treinamento por auto-jogo do KataGo e suas tecnologias principais"},d="An\xe1lise do Mecanismo de Treinamento do KataGo",t={},l=[{value:"Vis\xe3o Geral do Treinamento",id:"vis\xe3o-geral-do-treinamento",level:2},{value:"Ciclo de Treinamento",id:"ciclo-de-treinamento",level:3},{value:"Requisitos de Hardware",id:"requisitos-de-hardware",level:3},{value:"Configura\xe7\xe3o do Ambiente",id:"configura\xe7\xe3o-do-ambiente",level:2},{value:"Instala\xe7\xe3o de Depend\xeancias",id:"instala\xe7\xe3o-de-depend\xeancias",level:3},{value:"Obter C\xf3digo de Treinamento",id:"obter-c\xf3digo-de-treinamento",level:3},{value:"Configura\xe7\xe3o de Treinamento",id:"configura\xe7\xe3o-de-treinamento",level:2},{value:"Estrutura do Arquivo de Configura\xe7\xe3o",id:"estrutura-do-arquivo-de-configura\xe7\xe3o",level:3},{value:"Compara\xe7\xe3o de Escalas de Modelo",id:"compara\xe7\xe3o-de-escalas-de-modelo",level:3},{value:"Fluxo de Treinamento",id:"fluxo-de-treinamento",level:2},{value:"Passo 1: Inicializar Modelo",id:"passo-1-inicializar-modelo",level:3},{value:"Passo 2: Auto-jogo para Gerar Dados",id:"passo-2-auto-jogo-para-gerar-dados",level:3},{value:"Passo 3: Treinar a Rede Neural",id:"passo-3-treinar-a-rede-neural",level:3},{value:"Passo 4: Avaliar e Iterar",id:"passo-4-avaliar-e-iterar",level:3},{value:"Fun\xe7\xf5es de Perda Detalhadas",id:"fun\xe7\xf5es-de-perda-detalhadas",level:2},{value:"Policy Loss",id:"policy-loss",level:3},{value:"Value Loss",id:"value-loss",level:3},{value:"Ownership Loss",id:"ownership-loss",level:3},{value:"T\xe9cnicas Avan\xe7adas",id:"t\xe9cnicas-avan\xe7adas",level:2},{value:"1. Data Augmentation",id:"1-data-augmentation",level:3},{value:"2. Curriculum Learning",id:"2-curriculum-learning",level:3},{value:"3. Treinamento de Precis\xe3o Mista",id:"3-treinamento-de-precis\xe3o-mista",level:3},{value:"4. Treinamento Multi-GPU",id:"4-treinamento-multi-gpu",level:3},{value:"Monitoramento e Depura\xe7\xe3o",id:"monitoramento-e-depura\xe7\xe3o",level:2},{value:"Monitoramento com TensorBoard",id:"monitoramento-com-tensorboard",level:3},{value:"Problemas Comuns",id:"problemas-comuns",level:3},{value:"Sugest\xf5es para Experimentos de Pequena Escala",id:"sugest\xf5es-para-experimentos-de-pequena-escala",level:2},{value:"Leitura Adicional",id:"leitura-adicional",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"an\xe1lise-do-mecanismo-de-treinamento-do-katago",children:"An\xe1lise do Mecanismo de Treinamento do KataGo"})}),"\n",(0,r.jsx)(n.p,{children:"Este artigo analisa em profundidade o mecanismo de treinamento do KataGo, ajudando voc\xea a entender o princ\xedpio de funcionamento do treinamento por auto-jogo."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"vis\xe3o-geral-do-treinamento",children:"Vis\xe3o Geral do Treinamento"}),"\n",(0,r.jsx)(n.h3,{id:"ciclo-de-treinamento",children:"Ciclo de Treinamento"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Modelo inicial \u2192 Auto-jogo \u2192 Coleta de dados \u2192 Atualiza\xe7\xe3o de treinamento \u2192 Modelo mais forte \u2192 Repetir\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Correspond\xeancia com anima\xe7\xf5es"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"E5 Auto-jogo \u2194 Converg\xeancia de ponto fixo"}),"\n",(0,r.jsx)(n.li,{children:"E6 Curva de for\xe7a \u2194 Crescimento em curva S"}),"\n",(0,r.jsx)(n.li,{children:"H1 MDP \u2194 Cadeia de Markov"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"requisitos-de-hardware",children:"Requisitos de Hardware"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Escala do Modelo"}),(0,r.jsx)(n.th,{children:"Mem\xf3ria GPU"}),(0,r.jsx)(n.th,{children:"Tempo de Treinamento"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"b6c96"}),(0,r.jsx)(n.td,{children:"4 GB"}),(0,r.jsx)(n.td,{children:"Algumas horas"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"b10c128"}),(0,r.jsx)(n.td,{children:"8 GB"}),(0,r.jsx)(n.td,{children:"1-2 dias"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"b18c384"}),(0,r.jsx)(n.td,{children:"16 GB"}),(0,r.jsx)(n.td,{children:"1-2 semanas"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"b40c256"}),(0,r.jsx)(n.td,{children:"24 GB+"}),(0,r.jsx)(n.td,{children:"V\xe1rias semanas"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"configura\xe7\xe3o-do-ambiente",children:"Configura\xe7\xe3o do Ambiente"}),"\n",(0,r.jsx)(n.h3,{id:"instala\xe7\xe3o-de-depend\xeancias",children:"Instala\xe7\xe3o de Depend\xeancias"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Ambiente Python\nconda create -n katago python=3.10\nconda activate katago\n\n# PyTorch (vers\xe3o CUDA)\npip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118\n\n# Outras depend\xeancias\npip install numpy h5py tqdm tensorboard\n"})}),"\n",(0,r.jsx)(n.h3,{id:"obter-c\xf3digo-de-treinamento",children:"Obter C\xf3digo de Treinamento"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"git clone https://github.com/lightvector/KataGo.git\ncd KataGo/python\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"configura\xe7\xe3o-de-treinamento",children:"Configura\xe7\xe3o de Treinamento"}),"\n",(0,r.jsx)(n.h3,{id:"estrutura-do-arquivo-de-configura\xe7\xe3o",children:"Estrutura do Arquivo de Configura\xe7\xe3o"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'# configs/train_config.yaml\n\n# Arquitetura do modelo\nmodel:\n  num_blocks: 10          # N\xfamero de blocos residuais\n  trunk_channels: 128     # Canais do trunk\n  policy_channels: 32     # Canais do Policy head\n  value_channels: 32      # Canais do Value head\n\n# Par\xe2metros de treinamento\ntraining:\n  batch_size: 256\n  learning_rate: 0.001\n  lr_schedule: "cosine"\n  weight_decay: 0.0001\n  epochs: 100\n\n# Par\xe2metros de auto-jogo\nselfplay:\n  num_games_per_iteration: 1000\n  max_visits: 600\n  temperature: 1.0\n  temperature_drop_move: 20\n\n# Configura\xe7\xe3o de dados\ndata:\n  max_history_games: 500000\n  shuffle_buffer_size: 100000\n'})}),"\n",(0,r.jsx)(n.h3,{id:"compara\xe7\xe3o-de-escalas-de-modelo",children:"Compara\xe7\xe3o de Escalas de Modelo"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Nome"}),(0,r.jsx)(n.th,{children:"num_blocks"}),(0,r.jsx)(n.th,{children:"trunk_channels"}),(0,r.jsx)(n.th,{children:"Par\xe2metros"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"b6c96"}),(0,r.jsx)(n.td,{children:"6"}),(0,r.jsx)(n.td,{children:"96"}),(0,r.jsx)(n.td,{children:"~1M"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"b10c128"}),(0,r.jsx)(n.td,{children:"10"}),(0,r.jsx)(n.td,{children:"128"}),(0,r.jsx)(n.td,{children:"~3M"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"b18c384"}),(0,r.jsx)(n.td,{children:"18"}),(0,r.jsx)(n.td,{children:"384"}),(0,r.jsx)(n.td,{children:"~20M"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"b40c256"}),(0,r.jsx)(n.td,{children:"40"}),(0,r.jsx)(n.td,{children:"256"}),(0,r.jsx)(n.td,{children:"~45M"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Correspond\xeancia com anima\xe7\xf5es"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"F2 Tamanho da rede vs For\xe7a de jogo: Escalabilidade de capacidade"}),"\n",(0,r.jsx)(n.li,{children:"F6 Leis de escalabilidade neural: Rela\xe7\xe3o log-log"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"fluxo-de-treinamento",children:"Fluxo de Treinamento"}),"\n",(0,r.jsx)(n.h3,{id:"passo-1-inicializar-modelo",children:"Passo 1: Inicializar Modelo"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# init_model.py\nimport torch\nfrom model import KataGoModel\n\nconfig = {\n    'num_blocks': 10,\n    'trunk_channels': 128,\n    'input_features': 22,\n    'policy_size': 362,  # 361 + pass\n}\n\nmodel = KataGoModel(config)\ntorch.save(model.state_dict(), 'model_init.pt')\nprint(f\"Par\xe2metros do modelo: {sum(p.numel() for p in model.parameters()):,}\")\n"})}),"\n",(0,r.jsx)(n.h3,{id:"passo-2-auto-jogo-para-gerar-dados",children:"Passo 2: Auto-jogo para Gerar Dados"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Compilar engine C++\ncd ../cpp\nmkdir build && cd build\ncmake .. -DUSE_BACKEND=CUDA\nmake -j$(nproc)\n\n# Executar auto-jogo\n./katago selfplay \\\n  -model ../python/model_init.pt \\\n  -output-dir ../python/selfplay_data \\\n  -config selfplay.cfg \\\n  -num-games 1000\n"})}),"\n",(0,r.jsx)(n.p,{children:"Configura\xe7\xe3o de auto-jogo (selfplay.cfg):"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-ini",children:"maxVisits = 600\nnumSearchThreads = 4\n\n# Configura\xe7\xe3o de temperatura (aumenta explora\xe7\xe3o)\nchosenMoveTemperature = 1.0\nchosenMoveTemperatureEarly = 1.0\nchosenMoveTemperatureHalflife = 20\n\n# Ru\xeddo de Dirichlet (aumenta diversidade)\nrootNoiseEnabled = true\nrootDirichletNoiseTotalConcentration = 10.83\nrootDirichletNoiseWeight = 0.25\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Correspond\xeancia com anima\xe7\xf5es"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"C3 Explora\xe7\xe3o vs Aproveitamento: Par\xe2metro de temperatura"}),"\n",(0,r.jsx)(n.li,{children:"E10 Ru\xeddo de Dirichlet: Explora\xe7\xe3o no n\xf3 raiz"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"passo-3-treinar-a-rede-neural",children:"Passo 3: Treinar a Rede Neural"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# train.py\nimport torch\nfrom torch.utils.data import DataLoader\nfrom model import KataGoModel\nfrom dataset import SelfPlayDataset\n\n# Carregar dados\ndataset = SelfPlayDataset('selfplay_data/')\ndataloader = DataLoader(dataset, batch_size=256, shuffle=True)\n\n# Carregar modelo\nmodel = KataGoModel(config)\nmodel.load_state_dict(torch.load('model_init.pt'))\nmodel = model.cuda()\n\n# Otimizador\noptimizer = torch.optim.Adam(\n    model.parameters(),\n    lr=0.001,\n    weight_decay=0.0001\n)\n\n# Agendador de taxa de aprendizado\nscheduler = torch.optim.lr_scheduler.CosineAnnealingLR(\n    optimizer,\n    T_max=100,\n    eta_min=0.00001\n)\n\n# Loop de treinamento\nfor epoch in range(100):\n    model.train()\n    total_loss = 0\n\n    for batch in dataloader:\n        inputs = batch['inputs'].cuda()\n        policy_target = batch['policy'].cuda()\n        value_target = batch['value'].cuda()\n        ownership_target = batch['ownership'].cuda()\n\n        # Forward pass\n        policy_pred, value_pred, ownership_pred = model(inputs)\n\n        # Calcular perda\n        policy_loss = torch.nn.functional.cross_entropy(\n            policy_pred, policy_target\n        )\n        value_loss = torch.nn.functional.mse_loss(\n            value_pred, value_target\n        )\n        ownership_loss = torch.nn.functional.mse_loss(\n            ownership_pred, ownership_target\n        )\n\n        loss = policy_loss + value_loss + 0.5 * ownership_loss\n\n        # Backward pass\n        optimizer.zero_grad()\n        loss.backward()\n        torch.nn.utils.clip_grad_norm_(model.parameters(), 1.0)\n        optimizer.step()\n\n        total_loss += loss.item()\n\n    scheduler.step()\n    print(f\"Epoch {epoch}: Loss = {total_loss / len(dataloader):.4f}\")\n\n    # Salvar checkpoint\n    torch.save(model.state_dict(), f'model_epoch{epoch}.pt')\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Correspond\xeancia com anima\xe7\xf5es"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"D5 Descida de gradiente: optimizer.step()"}),"\n",(0,r.jsx)(n.li,{children:"K2 Momentum: Otimizador Adam"}),"\n",(0,r.jsx)(n.li,{children:"K4 Decaimento da taxa de aprendizado: CosineAnnealingLR"}),"\n",(0,r.jsx)(n.li,{children:"K5 Clipping de gradiente: clip_grad_norm_"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"passo-4-avaliar-e-iterar",children:"Passo 4: Avaliar e Iterar"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Avaliar novo modelo vs modelo antigo\n./katago match \\\n  -model1 model_epoch99.pt \\\n  -model2 model_init.pt \\\n  -num-games 100 \\\n  -output match_results.txt\n"})}),"\n",(0,r.jsx)(n.p,{children:"Se a taxa de vit\xf3ria do novo modelo > 55%, ele substitui o modelo antigo e entra na pr\xf3xima itera\xe7\xe3o."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"fun\xe7\xf5es-de-perda-detalhadas",children:"Fun\xe7\xf5es de Perda Detalhadas"}),"\n",(0,r.jsx)(n.h3,{id:"policy-loss",children:"Policy Loss"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Perda de entropia cruzada\npolicy_loss = -sum(target * log(pred))\n"})}),"\n",(0,r.jsx)(n.p,{children:"Objetivo: Fazer a distribui\xe7\xe3o de probabilidade prevista se aproximar do resultado da busca MCTS."}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Correspond\xeancia com anima\xe7\xf5es"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"J1 Entropia de pol\xedtica: Entropia cruzada"}),"\n",(0,r.jsx)(n.li,{children:"J2 Diverg\xeancia KL: Dist\xe2ncia entre distribui\xe7\xf5es"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"value-loss",children:"Value Loss"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Erro quadr\xe1tico m\xe9dio\nvalue_loss = (pred - actual_result)^2\n"})}),"\n",(0,r.jsx)(n.p,{children:"Objetivo: Prever o resultado final do jogo (vit\xf3ria/derrota/empate)."}),"\n",(0,r.jsx)(n.h3,{id:"ownership-loss",children:"Ownership Loss"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Previs\xe3o de pertencimento de cada ponto\nownership_loss = mean((pred - actual_ownership)^2)\n"})}),"\n",(0,r.jsx)(n.p,{children:"Objetivo: Prever o pertencimento final de cada posi\xe7\xe3o."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"t\xe9cnicas-avan\xe7adas",children:"T\xe9cnicas Avan\xe7adas"}),"\n",(0,r.jsx)(n.h3,{id:"1-data-augmentation",children:"1. Data Augmentation"}),"\n",(0,r.jsx)(n.p,{children:"Aproveitando a simetria do tabuleiro:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'def augment_data(board, policy, ownership):\n    """Aumenta\xe7\xe3o de dados para as 8 transforma\xe7\xf5es do grupo D4"""\n    augmented = []\n\n    for rotation in range(4):\n        for flip in [False, True]:\n            # Rota\xe7\xe3o e espelhamento\n            aug_board = transform(board, rotation, flip)\n            aug_policy = transform(policy, rotation, flip)\n            aug_ownership = transform(ownership, rotation, flip)\n            augmented.append((aug_board, aug_policy, aug_ownership))\n\n    return augmented\n'})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Correspond\xeancia com anima\xe7\xf5es"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"A9 Simetria do tabuleiro: Grupo D4"}),"\n",(0,r.jsx)(n.li,{children:"L4 Data augmentation: Aproveitamento de simetria"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"2-curriculum-learning",children:"2. Curriculum Learning"}),"\n",(0,r.jsx)(n.p,{children:"Do simples ao complexo:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Primeiro treina com menos simula\xe7\xf5es\nschedule = [\n    (100, 10000),   # 100 visitas, 10000 jogos\n    (200, 20000),   # 200 visitas, 20000 jogos\n    (400, 50000),   # 400 visitas, 50000 jogos\n    (600, 100000),  # 600 visitas, 100000 jogos\n]\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Correspond\xeancia com anima\xe7\xf5es"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"E12 Curr\xedculo de treinamento: Curriculum learning"}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"3-treinamento-de-precis\xe3o-mista",children:"3. Treinamento de Precis\xe3o Mista"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from torch.cuda.amp import autocast, GradScaler\n\nscaler = GradScaler()\n\nwith autocast():\n    policy_pred, value_pred, ownership_pred = model(inputs)\n    loss = compute_loss(...)\n\nscaler.scale(loss).backward()\nscaler.step(optimizer)\nscaler.update()\n"})}),"\n",(0,r.jsx)(n.h3,{id:"4-treinamento-multi-gpu",children:"4. Treinamento Multi-GPU"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"import torch.distributed as dist\nfrom torch.nn.parallel import DistributedDataParallel\n\n# Inicializar distribu\xeddo\ndist.init_process_group(backend='nccl')\n\n# Encapsular modelo\nmodel = DistributedDataParallel(model)\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"monitoramento-e-depura\xe7\xe3o",children:"Monitoramento e Depura\xe7\xe3o"}),"\n",(0,r.jsx)(n.h3,{id:"monitoramento-com-tensorboard",children:"Monitoramento com TensorBoard"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"from torch.utils.tensorboard import SummaryWriter\n\nwriter = SummaryWriter('runs/training')\n\n# Registrar perdas\nwriter.add_scalar('Loss/policy', policy_loss, step)\nwriter.add_scalar('Loss/value', value_loss, step)\nwriter.add_scalar('Loss/total', total_loss, step)\n\n# Registrar taxa de aprendizado\nwriter.add_scalar('LR', scheduler.get_last_lr()[0], step)\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"tensorboard --logdir runs\n"})}),"\n",(0,r.jsx)(n.h3,{id:"problemas-comuns",children:"Problemas Comuns"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Problema"}),(0,r.jsx)(n.th,{children:"Causa Poss\xedvel"}),(0,r.jsx)(n.th,{children:"Solu\xe7\xe3o"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Perda n\xe3o diminui"}),(0,r.jsx)(n.td,{children:"Taxa de aprendizado muito baixa/alta"}),(0,r.jsx)(n.td,{children:"Ajustar taxa de aprendizado"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Perda oscila"}),(0,r.jsx)(n.td,{children:"Tamanho de lote muito pequeno"}),(0,r.jsx)(n.td,{children:"Aumentar tamanho do lote"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Overfitting"}),(0,r.jsx)(n.td,{children:"Dados insuficientes"}),(0,r.jsx)(n.td,{children:"Gerar mais dados de auto-jogo"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"For\xe7a n\xe3o aumenta"}),(0,r.jsx)(n.td,{children:"Poucas simula\xe7\xf5es"}),(0,r.jsx)(n.td,{children:"Aumentar maxVisits"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Correspond\xeancia com anima\xe7\xf5es"}),":"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"L1 Overfitting: Super-adapta\xe7\xe3o"}),"\n",(0,r.jsx)(n.li,{children:"L2 Regulariza\xe7\xe3o: weight_decay"}),"\n",(0,r.jsx)(n.li,{children:"D6 Efeito da taxa de aprendizado: Ajuste de par\xe2metros"}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"sugest\xf5es-para-experimentos-de-pequena-escala",children:"Sugest\xf5es para Experimentos de Pequena Escala"}),"\n",(0,r.jsx)(n.p,{children:"Se voc\xea quer apenas experimentar, recomendamos:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Usar tabuleiro 9\xd79"}),": Reduz drasticamente a computa\xe7\xe3o"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Usar modelo pequeno"}),": b6c96 \xe9 suficiente para experimentos"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Reduzir n\xfamero de simula\xe7\xf5es"}),": 100-200 visitas"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Fazer fine-tuning de modelo pr\xe9-treinado"}),": Mais r\xe1pido que treinar do zero"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"# Configura\xe7\xe3o para tabuleiro 9\xd79\nboardSize = 9\nmaxVisits = 100\n"})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"leitura-adicional",children:"Leitura Adicional"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../source-code",children:"Guia do C\xf3digo-fonte"})," \u2014 Entender a estrutura do c\xf3digo"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../contributing",children:"Participando da Comunidade Open Source"})," \u2014 Participar do treinamento distribu\xeddo"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"../../how-it-works/katago-innovations",children:"Inova\xe7\xf5es do KataGo"})," \u2014 O segredo da efici\xeancia 50x"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},30416(e,n,a){a.d(n,{R:()=>s,x:()=>d});var o=a(59471);const r={},i=o.createContext(r);function s(e){const n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);