"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[2654],{52914(e,n,a){a.r(n),a.d(n,{assets:()=>i,contentTitle:()=>l,default:()=>h,frontMatter:()=>o,metadata:()=>d,toc:()=>t});const d=JSON.parse('{"id":"for-engineers/deep-dive/neural-network","title":"Arquitetura de Rede Neural Detalhada","description":"An\xe1lise aprofundada do design de rede neural do KataGo, recursos de entrada e arquitetura de m\xfaltiplas sa\xeddas","source":"@site/i18n/pt/docusaurus-plugin-content-docs/current/for-engineers/deep-dive/neural-network.md","sourceDirName":"for-engineers/deep-dive","slug":"/for-engineers/deep-dive/neural-network","permalink":"/pt/docs/for-engineers/deep-dive/neural-network","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/for-engineers/deep-dive/neural-network.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Arquitetura de Rede Neural Detalhada","description":"An\xe1lise aprofundada do design de rede neural do KataGo, recursos de entrada e arquitetura de m\xfaltiplas sa\xeddas"},"sidebar":"tutorialSidebar","previous":{"title":"Participando da Comunidade Open Source","permalink":"/pt/docs/for-engineers/deep-dive/contributing"},"next":{"title":"Detalhes de Implementa\xe7\xe3o do MCTS","permalink":"/pt/docs/for-engineers/deep-dive/mcts-implementation"}}');var s=a(62615),r=a(30416);const o={sidebar_position:4,title:"Arquitetura de Rede Neural Detalhada",description:"An\xe1lise aprofundada do design de rede neural do KataGo, recursos de entrada e arquitetura de m\xfaltiplas sa\xeddas"},l="Arquitetura de Rede Neural Detalhada",i={},t=[{value:"Vis\xe3o Geral da Arquitetura",id:"vis\xe3o-geral-da-arquitetura",level:2},{value:"Codifica\xe7\xe3o de Recursos de Entrada",id:"codifica\xe7\xe3o-de-recursos-de-entrada",level:2},{value:"Vis\xe3o Geral dos Planos de Recursos",id:"vis\xe3o-geral-dos-planos-de-recursos",level:3},{value:"Empilhamento de Estados Hist\xf3ricos",id:"empilhamento-de-estados-hist\xf3ricos",level:3},{value:"Codifica\xe7\xe3o de Regras",id:"codifica\xe7\xe3o-de-regras",level:3},{value:"Rede Principal: Torre Residual",id:"rede-principal-torre-residual",level:2},{value:"Estrutura do Bloco Residual",id:"estrutura-do-bloco-residual",level:3},{value:"Exemplo de C\xf3digo",id:"exemplo-de-c\xf3digo",level:3},{value:"Camada de Pooling Global",id:"camada-de-pooling-global",level:3},{value:"Design das Cabe\xe7as de Sa\xedda",id:"design-das-cabe\xe7as-de-sa\xedda",level:2},{value:"Policy Head (Cabe\xe7a de Pol\xedtica)",id:"policy-head-cabe\xe7a-de-pol\xedtica",level:3},{value:"Value Head (Cabe\xe7a de Valor)",id:"value-head-cabe\xe7a-de-valor",level:3},{value:"Score Head (Cabe\xe7a de Pontua\xe7\xe3o)",id:"score-head-cabe\xe7a-de-pontua\xe7\xe3o",level:3},{value:"Ownership Head (Cabe\xe7a de Territ\xf3rio)",id:"ownership-head-cabe\xe7a-de-territ\xf3rio",level:3},{value:"Diferen\xe7as em Rela\xe7\xe3o ao AlphaZero",id:"diferen\xe7as-em-rela\xe7\xe3o-ao-alphazero",level:2},{value:"Escala do Modelo",id:"escala-do-modelo",level:2},{value:"Implementa\xe7\xe3o Completa da Rede",id:"implementa\xe7\xe3o-completa-da-rede",level:2},{value:"Leitura Adicional",id:"leitura-adicional",level:2}];function c(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"arquitetura-de-rede-neural-detalhada",children:"Arquitetura de Rede Neural Detalhada"})}),"\n",(0,s.jsx)(n.p,{children:"Este artigo analisa em profundidade a arquitetura completa da rede neural do KataGo, desde a codifica\xe7\xe3o de recursos de entrada at\xe9 o design de m\xfaltiplas sa\xeddas."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"vis\xe3o-geral-da-arquitetura",children:"Vis\xe3o Geral da Arquitetura"}),"\n",(0,s.jsxs)(n.p,{children:["O KataGo utiliza um design de ",(0,s.jsx)(n.strong,{children:"rede neural \xfanica com m\xfaltiplas sa\xeddas"}),":"]}),"\n",(0,s.jsx)(n.mermaid,{value:'flowchart TB\n    Input["Recursos de Entrada (19\xd719\xd722)"]\n    Input --\x3e InitConv["Camada Convolucional Inicial<br/>256 filtros"]\n    InitConv --\x3e ResNet["Torre Residual<br/>20-60 blocos residuais<br/>+ Camadas de Pooling Global"]\n    ResNet --\x3e Policy["Policy Head"]\n    ResNet --\x3e Value["Value Head"]\n    ResNet --\x3e Score["Score Head"]\n    ResNet --\x3e Ownership["Ownership Head"]\n    Policy --\x3e PolicyOut["362 prob.<br/>(incl. pass)"]\n    Value --\x3e ValueOut["Taxa de vitoria<br/>(-1~+1)"]\n    Score --\x3e ScoreOut["Diferenca de pontos<br/>(pontos)"]\n    Ownership --\x3e OwnerOut["361 territ.<br/>(-1~+1)"]'}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"codifica\xe7\xe3o-de-recursos-de-entrada",children:"Codifica\xe7\xe3o de Recursos de Entrada"}),"\n",(0,s.jsx)(n.h3,{id:"vis\xe3o-geral-dos-planos-de-recursos",children:"Vis\xe3o Geral dos Planos de Recursos"}),"\n",(0,s.jsxs)(n.p,{children:["O KataGo usa ",(0,s.jsx)(n.strong,{children:"22 planos de recursos"})," (19\xd719\xd722), cada plano \xe9 uma matriz 19\xd719:"]}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Plano"}),(0,s.jsx)(n.th,{children:"Conte\xfado"}),(0,s.jsx)(n.th,{children:"Descri\xe7\xe3o"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"0"}),(0,s.jsx)(n.td,{children:"Pedras pr\xf3prias"}),(0,s.jsx)(n.td,{children:"1 = tem pedra pr\xf3pria, 0 = n\xe3o tem"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"1"}),(0,s.jsx)(n.td,{children:"Pedras do oponente"}),(0,s.jsx)(n.td,{children:"1 = tem pedra do oponente, 0 = n\xe3o tem"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"2"}),(0,s.jsx)(n.td,{children:"Pontos vazios"}),(0,s.jsx)(n.td,{children:"1 = vazio, 0 = tem pedra"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"3-10"}),(0,s.jsx)(n.td,{children:"Estados hist\xf3ricos"}),(0,s.jsx)(n.td,{children:"Mudan\xe7as do tabuleiro nas \xfaltimas 8 jogadas"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"11"}),(0,s.jsx)(n.td,{children:"Ponto de Ko"}),(0,s.jsx)(n.td,{children:"1 = aqui \xe9 Ko proibido, 0 = pode jogar"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"12-17"}),(0,s.jsx)(n.td,{children:"Codifica\xe7\xe3o de liberdades"}),(0,s.jsx)(n.td,{children:"Grupos com 1, 2, 3... liberdades"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"18-21"}),(0,s.jsx)(n.td,{children:"Codifica\xe7\xe3o de regras"}),(0,s.jsx)(n.td,{children:"Regras Chinesas/Japonesas, komi, etc."})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"empilhamento-de-estados-hist\xf3ricos",children:"Empilhamento de Estados Hist\xf3ricos"}),"\n",(0,s.jsxs)(n.p,{children:["Para que a rede neural entenda a ",(0,s.jsx)(n.strong,{children:"din\xe2mica"})," da posi\xe7\xe3o, o KataGo empilha os estados das \xfaltimas 8 jogadas:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# Codifica\xe7\xe3o de estados hist\xf3ricos (conceitual)\ndef encode_history(game_history, current_player):\n    features = []\n\n    for t in range(8):  # \xdaltimas 8 jogadas\n        if t < len(game_history):\n            board = game_history[-(t+1)]\n            # Codifica pedras pr\xf3prias/do oponente naquele momento\n            features.append(encode_board(board, current_player))\n        else:\n            # Hist\xf3rico insuficiente, preenche com zeros\n            features.append(np.zeros((19, 19)))\n\n    return np.stack(features, axis=0)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"codifica\xe7\xe3o-de-regras",children:"Codifica\xe7\xe3o de Regras"}),"\n",(0,s.jsx)(n.p,{children:"O KataGo suporta m\xfaltiplas regras, informando a rede neural atrav\xe9s de planos de recursos:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'# Codifica\xe7\xe3o de regras (conceitual)\ndef encode_rules(rules, komi):\n    rule_features = np.zeros((4, 19, 19))\n\n    # Tipo de regra (one-hot)\n    if rules == "chinese":\n        rule_features[0] = 1.0\n    elif rules == "japanese":\n        rule_features[1] = 1.0\n\n    # Komi normalizado\n    normalized_komi = komi / 15.0  # Normalizado para [-1, 1]\n    rule_features[2] = normalized_komi\n\n    # Jogador atual\n    rule_features[3] = 1.0 if current_player == BLACK else 0.0\n\n    return rule_features\n'})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"rede-principal-torre-residual",children:"Rede Principal: Torre Residual"}),"\n",(0,s.jsx)(n.h3,{id:"estrutura-do-bloco-residual",children:"Estrutura do Bloco Residual"}),"\n",(0,s.jsxs)(n.p,{children:["O KataGo usa a estrutura ",(0,s.jsx)(n.strong,{children:"Pre-activation ResNet"}),":"]}),"\n",(0,s.jsx)(n.mermaid,{value:'flowchart TB\n    X["Entrada x"] --\x3e BN1["BatchNorm"]\n    X --\x3e Skip["conexao residual"]\n    BN1 --\x3e ReLU1["ReLU"]\n    ReLU1 --\x3e Conv1["Conv 3\xd73"]\n    Conv1 --\x3e BN2["BatchNorm"]\n    BN2 --\x3e ReLU2["ReLU"]\n    ReLU2 --\x3e Conv2["Conv 3\xd73"]\n    Conv2 --\x3e Add(("+"))\n    Skip --\x3e Add\n    Add --\x3e Out["Saida"]'}),"\n",(0,s.jsx)(n.h3,{id:"exemplo-de-c\xf3digo",children:"Exemplo de C\xf3digo"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"class ResidualBlock(nn.Module):\n    def __init__(self, channels):\n        super().__init__()\n        self.bn1 = nn.BatchNorm2d(channels)\n        self.conv1 = nn.Conv2d(channels, channels, 3, padding=1)\n        self.bn2 = nn.BatchNorm2d(channels)\n        self.conv2 = nn.Conv2d(channels, channels, 3, padding=1)\n\n    def forward(self, x):\n        residual = x\n\n        out = self.bn1(x)\n        out = F.relu(out)\n        out = self.conv1(out)\n\n        out = self.bn2(out)\n        out = F.relu(out)\n        out = self.conv2(out)\n\n        return out + residual  # Conex\xe3o residual\n"})}),"\n",(0,s.jsx)(n.h3,{id:"camada-de-pooling-global",children:"Camada de Pooling Global"}),"\n",(0,s.jsxs)(n.p,{children:["Uma das inova\xe7\xf5es-chave do KataGo: adicionar ",(0,s.jsx)(n.strong,{children:"pooling global"})," nos blocos residuais, permitindo que a rede veja informa\xe7\xf5es globais:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"class GlobalPoolingBlock(nn.Module):\n    def __init__(self, channels):\n        super().__init__()\n        self.conv = nn.Conv2d(channels, channels, 3, padding=1)\n        self.fc = nn.Linear(channels, channels)\n\n    def forward(self, x):\n        # Caminho local\n        local = self.conv(x)\n\n        # Caminho global\n        global_pool = x.mean(dim=[2, 3])  # Pooling m\xe9dio global\n        global_fc = self.fc(global_pool)\n        global_broadcast = global_fc.unsqueeze(2).unsqueeze(3)\n        global_broadcast = global_broadcast.expand(-1, -1, 19, 19)\n\n        # Fus\xe3o\n        return local + global_broadcast\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Por que precisamos de pooling global?"})}),"\n",(0,s.jsx)(n.p,{children:'Convolu\xe7\xf5es tradicionais s\xf3 veem localmente (campo receptivo 3\xd73). Mesmo empilhando muitas camadas, a percep\xe7\xe3o de informa\xe7\xf5es globais ainda \xe9 limitada. O pooling global permite que a rede "veja" diretamente:'}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"A diferen\xe7a no n\xfamero de pedras do jogo inteiro"}),"\n",(0,s.jsx)(n.li,{children:"A distribui\xe7\xe3o de influ\xeancia global"}),"\n",(0,s.jsx)(n.li,{children:"A avalia\xe7\xe3o geral da posi\xe7\xe3o"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"design-das-cabe\xe7as-de-sa\xedda",children:"Design das Cabe\xe7as de Sa\xedda"}),"\n",(0,s.jsx)(n.h3,{id:"policy-head-cabe\xe7a-de-pol\xedtica",children:"Policy Head (Cabe\xe7a de Pol\xedtica)"}),"\n",(0,s.jsx)(n.p,{children:"Produz a probabilidade de jogar em cada posi\xe7\xe3o:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"class PolicyHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv = nn.Conv2d(in_channels, 2, 1)  # Convolu\xe7\xe3o 1\xd71\n        self.bn = nn.BatchNorm2d(2)\n        self.fc = nn.Linear(2 * 19 * 19, 362)  # 361 + pass\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv(x)))\n        out = out.view(out.size(0), -1)\n        out = self.fc(out)\n        return F.softmax(out, dim=1)  # Distribui\xe7\xe3o de probabilidade\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Formato de sa\xedda"}),": Vetor de 362 dimens\xf5es"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"\xcdndices 0-360: Probabilidade de jogar em 361 posi\xe7\xf5es do tabuleiro"}),"\n",(0,s.jsx)(n.li,{children:"\xcdndice 361: Probabilidade de passar"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"value-head-cabe\xe7a-de-valor",children:"Value Head (Cabe\xe7a de Valor)"}),"\n",(0,s.jsx)(n.p,{children:"Produz a taxa de vit\xf3ria da posi\xe7\xe3o atual:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"class ValueHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv = nn.Conv2d(in_channels, 1, 1)\n        self.bn = nn.BatchNorm2d(1)\n        self.fc1 = nn.Linear(19 * 19, 256)\n        self.fc2 = nn.Linear(256, 1)\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv(x)))\n        out = out.view(out.size(0), -1)\n        out = F.relu(self.fc1(out))\n        out = torch.tanh(self.fc2(out))  # Sa\xedda de -1 a +1\n        return out\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Formato de sa\xedda"}),": Valor \xfanico [-1, +1]"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"+1: Vit\xf3ria certa pr\xf3pria"}),"\n",(0,s.jsx)(n.li,{children:"-1: Vit\xf3ria certa do oponente"}),"\n",(0,s.jsx)(n.li,{children:"0: Equil\xedbrio"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"score-head-cabe\xe7a-de-pontua\xe7\xe3o",children:"Score Head (Cabe\xe7a de Pontua\xe7\xe3o)"}),"\n",(0,s.jsx)(n.p,{children:"Exclusivo do KataGo, prev\xea a diferen\xe7a final de pontos:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"class ScoreHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv = nn.Conv2d(in_channels, 1, 1)\n        self.bn = nn.BatchNorm2d(1)\n        self.fc1 = nn.Linear(19 * 19, 256)\n        self.fc2 = nn.Linear(256, 1)\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv(x)))\n        out = out.view(out.size(0), -1)\n        out = F.relu(self.fc1(out))\n        out = self.fc2(out)  # Sa\xedda sem restri\xe7\xe3o\n        return out\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Formato de sa\xedda"}),": Valor \xfanico (pontos)"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Positivo: Pr\xf3prio \xe0 frente"}),"\n",(0,s.jsx)(n.li,{children:"Negativo: Oponente \xe0 frente"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"ownership-head-cabe\xe7a-de-territ\xf3rio",children:"Ownership Head (Cabe\xe7a de Territ\xf3rio)"}),"\n",(0,s.jsx)(n.p,{children:"Prev\xea a quem pertence cada ponto no final:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"class OwnershipHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv1 = nn.Conv2d(in_channels, 32, 1)\n        self.bn = nn.BatchNorm2d(32)\n        self.conv2 = nn.Conv2d(32, 1, 1)\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv1(x)))\n        out = torch.tanh(self.conv2(out))  # Cada ponto de -1 a +1\n        return out.view(out.size(0), -1)  # Achatado para 361\n"})}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Formato de sa\xedda"}),": Vetor de 361 dimens\xf5es, cada valor em [-1, +1]"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"+1: Este ponto pertence ao territ\xf3rio pr\xf3prio"}),"\n",(0,s.jsx)(n.li,{children:"-1: Este ponto pertence ao territ\xf3rio do oponente"}),"\n",(0,s.jsx)(n.li,{children:"0: \xc1rea neutra ou disputada"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"diferen\xe7as-em-rela\xe7\xe3o-ao-alphazero",children:"Diferen\xe7as em Rela\xe7\xe3o ao AlphaZero"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Aspecto"}),(0,s.jsx)(n.th,{children:"AlphaZero"}),(0,s.jsx)(n.th,{children:"KataGo"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Cabe\xe7as de sa\xedda"})}),(0,s.jsx)(n.td,{children:"2 (Policy + Value)"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.strong,{children:"4"})," (+ Score + Ownership)"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Pooling global"})}),(0,s.jsx)(n.td,{children:"N\xe3o"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Sim"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Recursos de entrada"})}),(0,s.jsx)(n.td,{children:"17 planos"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.strong,{children:"22 planos"})," (incluindo codifica\xe7\xe3o de regras)"]})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Blocos residuais"})}),(0,s.jsx)(n.td,{children:"ResNet padr\xe3o"}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Pre-activation + Pooling global"})})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Suporte a m\xfaltiplas regras"})}),(0,s.jsx)(n.td,{children:"N\xe3o"}),(0,s.jsxs)(n.td,{children:[(0,s.jsx)(n.strong,{children:"Sim"})," (atrav\xe9s de codifica\xe7\xe3o de recursos)"]})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"escala-do-modelo",children:"Escala do Modelo"}),"\n",(0,s.jsx)(n.p,{children:"O KataGo oferece modelos de diferentes escalas:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Modelo"}),(0,s.jsx)(n.th,{children:"Blocos Residuais"}),(0,s.jsx)(n.th,{children:"Canais"}),(0,s.jsx)(n.th,{children:"Par\xe2metros"}),(0,s.jsx)(n.th,{children:"Cen\xe1rio de Uso"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"b10c128"}),(0,s.jsx)(n.td,{children:"10"}),(0,s.jsx)(n.td,{children:"128"}),(0,s.jsx)(n.td,{children:"~5M"}),(0,s.jsx)(n.td,{children:"CPU, testes r\xe1pidos"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"b18c384"}),(0,s.jsx)(n.td,{children:"18"}),(0,s.jsx)(n.td,{children:"384"}),(0,s.jsx)(n.td,{children:"~75M"}),(0,s.jsx)(n.td,{children:"GPU comum"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"b40c256"}),(0,s.jsx)(n.td,{children:"40"}),(0,s.jsx)(n.td,{children:"256"}),(0,s.jsx)(n.td,{children:"~95M"}),(0,s.jsx)(n.td,{children:"GPU avan\xe7ada"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"b60c320"}),(0,s.jsx)(n.td,{children:"60"}),(0,s.jsx)(n.td,{children:"320"}),(0,s.jsx)(n.td,{children:"~200M"}),(0,s.jsx)(n.td,{children:"GPU topo de linha"})]})]})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Conven\xe7\xe3o de nomes"}),": ",(0,s.jsx)(n.code,{children:"b{blocos}c{canais}"})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"implementa\xe7\xe3o-completa-da-rede",children:"Implementa\xe7\xe3o Completa da Rede"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"class KataGoNetwork(nn.Module):\n    def __init__(self, num_blocks=18, channels=384):\n        super().__init__()\n\n        # Convolu\xe7\xe3o inicial\n        self.initial_conv = nn.Conv2d(22, channels, 3, padding=1)\n        self.initial_bn = nn.BatchNorm2d(channels)\n\n        # Torre residual\n        self.residual_blocks = nn.ModuleList([\n            ResidualBlock(channels) for _ in range(num_blocks)\n        ])\n\n        # Blocos de pooling global (inseridos a cada poucos blocos residuais)\n        self.global_pooling_blocks = nn.ModuleList([\n            GlobalPoolingBlock(channels) for _ in range(num_blocks // 6)\n        ])\n\n        # Cabe\xe7as de sa\xedda\n        self.policy_head = PolicyHead(channels)\n        self.value_head = ValueHead(channels)\n        self.score_head = ScoreHead(channels)\n        self.ownership_head = OwnershipHead(channels)\n\n    def forward(self, x):\n        # Convolu\xe7\xe3o inicial\n        out = F.relu(self.initial_bn(self.initial_conv(x)))\n\n        # Torre residual\n        gp_idx = 0\n        for i, block in enumerate(self.residual_blocks):\n            out = block(out)\n\n            # Insere pooling global ap\xf3s cada 6 blocos residuais\n            if (i + 1) % 6 == 0 and gp_idx < len(self.global_pooling_blocks):\n                out = self.global_pooling_blocks[gp_idx](out)\n                gp_idx += 1\n\n        # Cabe\xe7as de sa\xedda\n        policy = self.policy_head(out)\n        value = self.value_head(out)\n        score = self.score_head(out)\n        ownership = self.ownership_head(out)\n\n        return {\n            'policy': policy,\n            'value': value,\n            'score': score,\n            'ownership': ownership\n        }\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"leitura-adicional",children:"Leitura Adicional"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../mcts-implementation",children:"Detalhes de Implementa\xe7\xe3o do MCTS"})," \u2014 Combina\xe7\xe3o de busca e rede neural"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../training",children:"An\xe1lise do Mecanismo de Treinamento do KataGo"})," \u2014 Como a rede \xe9 treinada"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../papers",children:"Guia de Artigos Importantes"})," \u2014 Deriva\xe7\xf5es matem\xe1ticas dos artigos originais"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},30416(e,n,a){a.d(n,{R:()=>o,x:()=>l});var d=a(59471);const s={},r=d.createContext(s);function o(e){const n=d.useContext(r);return d.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),d.createElement(r.Provider,{value:n},e.children)}}}]);