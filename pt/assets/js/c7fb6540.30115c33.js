"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[6774],{43961(e,n,i){i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"tech/deep-dive/gpu-optimization","title":"Backend GPU e Otimiza\xe7\xe3o","description":"Compara\xe7\xe3o e guia de otimiza\xe7\xe3o de desempenho para backends CUDA, OpenCL e Metal do KataGo","source":"@site/i18n/pt/docusaurus-plugin-content-docs/current/tech/deep-dive/gpu-optimization.md","sourceDirName":"tech/deep-dive","slug":"/tech/deep-dive/gpu-optimization","permalink":"/pt/docs/tech/deep-dive/gpu-optimization","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/tech/deep-dive/gpu-optimization.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"Backend GPU e Otimiza\xe7\xe3o","description":"Compara\xe7\xe3o e guia de otimiza\xe7\xe3o de desempenho para backends CUDA, OpenCL e Metal do KataGo"},"sidebar":"tutorialSidebar","previous":{"title":"Detalhes de Implementa\xe7\xe3o do MCTS","permalink":"/pt/docs/tech/deep-dive/mcts-implementation"},"next":{"title":"Arquitetura de Treinamento Distribu\xeddo","permalink":"/pt/docs/tech/deep-dive/distributed-training"}}');var d=i(62615),a=i(30416);const r={sidebar_position:6,title:"Backend GPU e Otimiza\xe7\xe3o",description:"Compara\xe7\xe3o e guia de otimiza\xe7\xe3o de desempenho para backends CUDA, OpenCL e Metal do KataGo"},l="Backend GPU e Otimiza\xe7\xe3o",o={},c=[{value:"Vis\xe3o Geral dos Backends",id:"vis\xe3o-geral-dos-backends",level:2},{value:"Backend CUDA",id:"backend-cuda",level:2},{value:"Cen\xe1rios de Uso",id:"cen\xe1rios-de-uso",level:3},{value:"Requisitos de Instala\xe7\xe3o",id:"requisitos-de-instala\xe7\xe3o",level:3},{value:"Compila\xe7\xe3o",id:"compila\xe7\xe3o",level:3},{value:"Caracter\xedsticas de Desempenho",id:"caracter\xedsticas-de-desempenho",level:3},{value:"Backend OpenCL",id:"backend-opencl",level:2},{value:"Cen\xe1rios de Uso",id:"cen\xe1rios-de-uso-1",level:3},{value:"Requisitos de Instala\xe7\xe3o",id:"requisitos-de-instala\xe7\xe3o-1",level:3},{value:"Compila\xe7\xe3o",id:"compila\xe7\xe3o-1",level:3},{value:"Escolha de Driver",id:"escolha-de-driver",level:3},{value:"Ajuste de Desempenho",id:"ajuste-de-desempenho",level:3},{value:"Backend Metal",id:"backend-metal",level:2},{value:"Cen\xe1rios de Uso",id:"cen\xe1rios-de-uso-2",level:3},{value:"Compila\xe7\xe3o",id:"compila\xe7\xe3o-2",level:3},{value:"Otimiza\xe7\xe3o para Apple Silicon",id:"otimiza\xe7\xe3o-para-apple-silicon",level:3},{value:"Compara\xe7\xe3o de Desempenho",id:"compara\xe7\xe3o-de-desempenho",level:3},{value:"Backend Eigen (CPU Pura)",id:"backend-eigen-cpu-pura",level:2},{value:"Cen\xe1rios de Uso",id:"cen\xe1rios-de-uso-3",level:3},{value:"Compila\xe7\xe3o",id:"compila\xe7\xe3o-3",level:3},{value:"Expectativa de Desempenho",id:"expectativa-de-desempenho",level:3},{value:"Par\xe2metros de Ajuste de Desempenho",id:"par\xe2metros-de-ajuste-de-desempenho",level:2},{value:"Par\xe2metros Principais",id:"par\xe2metros-principais",level:3},{value:"Guia de Ajuste de Par\xe2metros",id:"guia-de-ajuste-de-par\xe2metros",level:3},{value:"nnMaxBatchSize",id:"nnmaxbatchsize",level:4},{value:"numSearchThreads",id:"numsearchthreads",level:4},{value:"numNNServerThreadsPerModel",id:"numnnserverthreadspermodel",level:4},{value:"Ajuste de Mem\xf3ria",id:"ajuste-de-mem\xf3ria",level:3},{value:"Configura\xe7\xe3o Multi-GPU",id:"configura\xe7\xe3o-multi-gpu",level:2},{value:"M\xfaltiplas GPUs em uma M\xe1quina",id:"m\xfaltiplas-gpus-em-uma-m\xe1quina",level:3},{value:"Balanceamento de Carga",id:"balanceamento-de-carga",level:3},{value:"Benchmark",id:"benchmark",level:2},{value:"Executar Benchmark",id:"executar-benchmark",level:3},{value:"Interpreta\xe7\xe3o da Sa\xedda",id:"interpreta\xe7\xe3o-da-sa\xedda",level:3},{value:"Dados de Desempenho Comuns",id:"dados-de-desempenho-comuns",level:3},{value:"Acelera\xe7\xe3o TensorRT",id:"acelera\xe7\xe3o-tensorrt",level:2},{value:"Cen\xe1rios de Uso",id:"cen\xe1rios-de-uso-4",level:3},{value:"Como Habilitar",id:"como-habilitar",level:3},{value:"Ganho de Desempenho",id:"ganho-de-desempenho",level:3},{value:"Observa\xe7\xf5es",id:"observa\xe7\xf5es",level:3},{value:"Problemas Comuns",id:"problemas-comuns",level:2},{value:"GPU N\xe3o Detectada",id:"gpu-n\xe3o-detectada",level:3},{value:"VRAM Insuficiente",id:"vram-insuficiente",level:3},{value:"Desempenho Abaixo do Esperado",id:"desempenho-abaixo-do-esperado",level:3},{value:"Checklist de Otimiza\xe7\xe3o de Desempenho",id:"checklist-de-otimiza\xe7\xe3o-de-desempenho",level:2},{value:"Leitura Adicional",id:"leitura-adicional",level:2}];function t(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,a.R)(),...e.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(n.header,{children:(0,d.jsx)(n.h1,{id:"backend-gpu-e-otimiza\xe7\xe3o",children:"Backend GPU e Otimiza\xe7\xe3o"})}),"\n",(0,d.jsx)(n.p,{children:"Este artigo apresenta os v\xe1rios backends de GPU suportados pelo KataGo, diferen\xe7as de desempenho e como ajustar para obter o melhor desempenho."}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"vis\xe3o-geral-dos-backends",children:"Vis\xe3o Geral dos Backends"}),"\n",(0,d.jsx)(n.p,{children:"O KataGo suporta quatro backends de computa\xe7\xe3o:"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Backend"}),(0,d.jsx)(n.th,{children:"Suporte de Hardware"}),(0,d.jsx)(n.th,{children:"Desempenho"}),(0,d.jsx)(n.th,{children:"Dificuldade de Instala\xe7\xe3o"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"CUDA"})}),(0,d.jsx)(n.td,{children:"GPU NVIDIA"}),(0,d.jsx)(n.td,{children:"Melhor"}),(0,d.jsx)(n.td,{children:"M\xe9dia"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"OpenCL"})}),(0,d.jsx)(n.td,{children:"GPU NVIDIA/AMD/Intel"}),(0,d.jsx)(n.td,{children:"Bom"}),(0,d.jsx)(n.td,{children:"Simples"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"Metal"})}),(0,d.jsx)(n.td,{children:"Apple Silicon"}),(0,d.jsx)(n.td,{children:"Bom"}),(0,d.jsx)(n.td,{children:"Simples"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:(0,d.jsx)(n.strong,{children:"Eigen"})}),(0,d.jsx)(n.td,{children:"CPU pura"}),(0,d.jsx)(n.td,{children:"Mais lento"}),(0,d.jsx)(n.td,{children:"Mais simples"})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"backend-cuda",children:"Backend CUDA"}),"\n",(0,d.jsx)(n.h3,{id:"cen\xe1rios-de-uso",children:"Cen\xe1rios de Uso"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"GPU NVIDIA (GTX s\xe9rie 10 e superior)"}),"\n",(0,d.jsx)(n.li,{children:"Necessita do melhor desempenho"}),"\n",(0,d.jsx)(n.li,{children:"Tem ambiente de desenvolvimento CUDA"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"requisitos-de-instala\xe7\xe3o",children:"Requisitos de Instala\xe7\xe3o"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# Verificar vers\xe3o do CUDA\nnvcc --version\n\n# Verificar cuDNN\ncat /usr/local/cuda/include/cudnn_version.h | grep CUDNN_MAJOR\n"})}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Componente"}),(0,d.jsx)(n.th,{children:"Vers\xe3o Recomendada"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"CUDA"}),(0,d.jsx)(n.td,{children:"11.x ou 12.x"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"cuDNN"}),(0,d.jsx)(n.td,{children:"8.x"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Driver"}),(0,d.jsx)(n.td,{children:"470+"})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"compila\xe7\xe3o",children:"Compila\xe7\xe3o"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"cd KataGo/cpp\nmkdir build && cd build\n\ncmake .. -DUSE_BACKEND=CUDA \\\n         -DCUDNN_INCLUDE_DIR=/usr/local/cuda/include \\\n         -DCUDNN_LIBRARY=/usr/local/cuda/lib64/libcudnn.so\n\nmake -j$(nproc)\n"})}),"\n",(0,d.jsx)(n.h3,{id:"caracter\xedsticas-de-desempenho",children:"Caracter\xedsticas de Desempenho"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Tensor Cores"}),": Suporta acelera\xe7\xe3o FP16 (s\xe9rie RTX)"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Infer\xeancia em lote"}),": Melhor utiliza\xe7\xe3o da GPU"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.strong,{children:"Gerenciamento de mem\xf3ria"}),": Controle fino do uso de VRAM"]}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"backend-opencl",children:"Backend OpenCL"}),"\n",(0,d.jsx)(n.h3,{id:"cen\xe1rios-de-uso-1",children:"Cen\xe1rios de Uso"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"GPU AMD"}),"\n",(0,d.jsx)(n.li,{children:"GPU integrada Intel"}),"\n",(0,d.jsx)(n.li,{children:"GPU NVIDIA (sem ambiente CUDA)"}),"\n",(0,d.jsx)(n.li,{children:"Implanta\xe7\xe3o multiplataforma"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"requisitos-de-instala\xe7\xe3o-1",children:"Requisitos de Instala\xe7\xe3o"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# Linux - Instalar kit de desenvolvimento OpenCL\nsudo apt install ocl-icd-opencl-dev\n\n# Verificar dispositivos OpenCL dispon\xedveis\nclinfo\n"})}),"\n",(0,d.jsx)(n.h3,{id:"compila\xe7\xe3o-1",children:"Compila\xe7\xe3o"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"cmake .. -DUSE_BACKEND=OPENCL\nmake -j$(nproc)\n"})}),"\n",(0,d.jsx)(n.h3,{id:"escolha-de-driver",children:"Escolha de Driver"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Tipo de GPU"}),(0,d.jsx)(n.th,{children:"Driver Recomendado"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"AMD"}),(0,d.jsx)(n.td,{children:"ROCm ou AMDGPU-PRO"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"Intel"}),(0,d.jsx)(n.td,{children:"intel-opencl-icd"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"NVIDIA"}),(0,d.jsx)(n.td,{children:"nvidia-opencl-icd"})]})]})]}),"\n",(0,d.jsx)(n.h3,{id:"ajuste-de-desempenho",children:"Ajuste de Desempenho"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-ini",children:"# config.cfg\nopenclDeviceToUse = 0          # N\xfamero da GPU\nopenclUseFP16 = auto           # Meia precis\xe3o (quando suportado)\nopenclUseFP16Storage = true    # Armazenamento FP16\n"})}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"backend-metal",children:"Backend Metal"}),"\n",(0,d.jsx)(n.h3,{id:"cen\xe1rios-de-uso-2",children:"Cen\xe1rios de Uso"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Apple Silicon (M1/M2/M3)"}),"\n",(0,d.jsx)(n.li,{children:"Sistema macOS"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"compila\xe7\xe3o-2",children:"Compila\xe7\xe3o"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"cmake .. -DUSE_BACKEND=METAL\nmake -j$(sysctl -n hw.ncpu)\n"})}),"\n",(0,d.jsx)(n.h3,{id:"otimiza\xe7\xe3o-para-apple-silicon",children:"Otimiza\xe7\xe3o para Apple Silicon"}),"\n",(0,d.jsx)(n.p,{children:"A arquitetura de mem\xf3ria unificada do Apple Silicon tem vantagens especiais:"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-ini",children:"# Configura\xe7\xe3o recomendada para Apple Silicon\nnumNNServerThreadsPerModel = 1\nnnMaxBatchSize = 16\nnumSearchThreads = 4\n"})}),"\n",(0,d.jsx)(n.h3,{id:"compara\xe7\xe3o-de-desempenho",children:"Compara\xe7\xe3o de Desempenho"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"Chip"}),(0,d.jsx)(n.th,{children:"Desempenho Relativo"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"M1"}),(0,d.jsx)(n.td,{children:"~RTX 2060"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"M1 Pro/Max"}),(0,d.jsx)(n.td,{children:"~RTX 3060"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"M2"}),(0,d.jsx)(n.td,{children:"~RTX 2070"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"M3 Pro/Max"}),(0,d.jsx)(n.td,{children:"~RTX 3070"})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"backend-eigen-cpu-pura",children:"Backend Eigen (CPU Pura)"}),"\n",(0,d.jsx)(n.h3,{id:"cen\xe1rios-de-uso-3",children:"Cen\xe1rios de Uso"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Sem ambiente GPU"}),"\n",(0,d.jsx)(n.li,{children:"Testes r\xe1pidos"}),"\n",(0,d.jsx)(n.li,{children:"Uso de baixa intensidade"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"compila\xe7\xe3o-3",children:"Compila\xe7\xe3o"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"sudo apt install libeigen3-dev\ncmake .. -DUSE_BACKEND=EIGEN\nmake -j$(nproc)\n"})}),"\n",(0,d.jsx)(n.h3,{id:"expectativa-de-desempenho",children:"Expectativa de Desempenho"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"CPU single-core: ~10-30 playouts/seg\nCPU multi-core: ~50-150 playouts/seg\nGPU (gama m\xe9dia): ~1000-3000 playouts/seg\n"})}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"par\xe2metros-de-ajuste-de-desempenho",children:"Par\xe2metros de Ajuste de Desempenho"}),"\n",(0,d.jsx)(n.h3,{id:"par\xe2metros-principais",children:"Par\xe2metros Principais"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-ini",children:"# config.cfg\n\n# === Configura\xe7\xe3o de Rede Neural ===\n# N\xfamero da GPU (para m\xfaltiplas GPUs)\nnnDeviceIdxs = 0\n\n# Threads de infer\xeancia por modelo\nnumNNServerThreadsPerModel = 2\n\n# Tamanho m\xe1ximo do lote\nnnMaxBatchSize = 16\n\n# Tamanho do cache (2^N posi\xe7\xf5es)\nnnCacheSizePowerOfTwo = 20\n\n# === Configura\xe7\xe3o de Busca ===\n# Threads de busca\nnumSearchThreads = 8\n\n# M\xe1ximo de visitas por jogada\nmaxVisits = 800\n"})}),"\n",(0,d.jsx)(n.h3,{id:"guia-de-ajuste-de-par\xe2metros",children:"Guia de Ajuste de Par\xe2metros"}),"\n",(0,d.jsx)(n.h4,{id:"nnmaxbatchsize",children:"nnMaxBatchSize"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"Muito pequeno: Baixa utiliza\xe7\xe3o da GPU, alta lat\xeancia de infer\xeancia\nMuito grande: VRAM insuficiente, tempo de espera longo\n\nValores recomendados:\n- 4GB VRAM: 8-12\n- 8GB VRAM: 16-24\n- 16GB+ VRAM: 32-64\n"})}),"\n",(0,d.jsx)(n.h4,{id:"numsearchthreads",children:"numSearchThreads"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"Muito poucos: N\xe3o consegue alimentar a GPU\nMuitos: Gargalo de CPU, press\xe3o de mem\xf3ria\n\nValores recomendados:\n- 1-2x o n\xfamero de n\xfacleos de CPU\n- Similar ao nnMaxBatchSize\n"})}),"\n",(0,d.jsx)(n.h4,{id:"numnnserverthreadspermodel",children:"numNNServerThreadsPerModel"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"CUDA: 1-2\nOpenCL: 1-2\nEigen: N\xfamero de n\xfacleos de CPU\n"})}),"\n",(0,d.jsx)(n.h3,{id:"ajuste-de-mem\xf3ria",children:"Ajuste de Mem\xf3ria"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-ini",children:"# Reduzir uso de VRAM\nnnMaxBatchSize = 8\nnnCacheSizePowerOfTwo = 18\n\n# Aumentar uso de VRAM (melhorar desempenho)\nnnMaxBatchSize = 32\nnnCacheSizePowerOfTwo = 22\n"})}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"configura\xe7\xe3o-multi-gpu",children:"Configura\xe7\xe3o Multi-GPU"}),"\n",(0,d.jsx)(n.h3,{id:"m\xfaltiplas-gpus-em-uma-m\xe1quina",children:"M\xfaltiplas GPUs em uma M\xe1quina"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-ini",children:"# Usar GPU 0 e GPU 1\nnnDeviceIdxs = 0,1\n\n# Threads por GPU\nnumNNServerThreadsPerModel = 2\n"})}),"\n",(0,d.jsx)(n.h3,{id:"balanceamento-de-carga",children:"Balanceamento de Carga"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-ini",children:"# Distribuir peso conforme desempenho da GPU\n# GPU 0 \xe9 mais potente, recebe mais trabalho\nnnDeviceIdxs = 0,0,1\n"})}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"benchmark",children:"Benchmark"}),"\n",(0,d.jsx)(n.h3,{id:"executar-benchmark",children:"Executar Benchmark"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"katago benchmark -model model.bin.gz -config config.cfg\n"})}),"\n",(0,d.jsx)(n.h3,{id:"interpreta\xe7\xe3o-da-sa\xedda",children:"Interpreta\xe7\xe3o da Sa\xedda"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"GPU 0: NVIDIA GeForce RTX 3080\nThreads: 8, Batch Size: 16\n\nBenchmark results:\n- Neural net evals/second: 2847.3\n- Playouts/second: 4521.8\n- Time per move (1000 visits): 0.221 sec\n\nMemory usage:\n- Peak GPU memory: 2.1 GB\n- Peak system memory: 1.3 GB\n"})}),"\n",(0,d.jsx)(n.h3,{id:"dados-de-desempenho-comuns",children:"Dados de Desempenho Comuns"}),"\n",(0,d.jsxs)(n.table,{children:[(0,d.jsx)(n.thead,{children:(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.th,{children:"GPU"}),(0,d.jsx)(n.th,{children:"Modelo"}),(0,d.jsx)(n.th,{children:"Playouts/seg"})]})}),(0,d.jsxs)(n.tbody,{children:[(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"RTX 3060"}),(0,d.jsx)(n.td,{children:"b18c384"}),(0,d.jsx)(n.td,{children:"~2500"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"RTX 3080"}),(0,d.jsx)(n.td,{children:"b18c384"}),(0,d.jsx)(n.td,{children:"~4500"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"RTX 4090"}),(0,d.jsx)(n.td,{children:"b18c384"}),(0,d.jsx)(n.td,{children:"~8000"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"M1 Pro"}),(0,d.jsx)(n.td,{children:"b18c384"}),(0,d.jsx)(n.td,{children:"~1500"})]}),(0,d.jsxs)(n.tr,{children:[(0,d.jsx)(n.td,{children:"M2 Max"}),(0,d.jsx)(n.td,{children:"b18c384"}),(0,d.jsx)(n.td,{children:"~2200"})]})]})]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"acelera\xe7\xe3o-tensorrt",children:"Acelera\xe7\xe3o TensorRT"}),"\n",(0,d.jsx)(n.h3,{id:"cen\xe1rios-de-uso-4",children:"Cen\xe1rios de Uso"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"GPU NVIDIA"}),"\n",(0,d.jsx)(n.li,{children:"Busca por desempenho m\xe1ximo"}),"\n",(0,d.jsx)(n.li,{children:"Aceita tempo de inicializa\xe7\xe3o mais longo"}),"\n"]}),"\n",(0,d.jsx)(n.h3,{id:"como-habilitar",children:"Como Habilitar"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# Habilitar na compila\xe7\xe3o\ncmake .. -DUSE_BACKEND=CUDA -DUSE_TENSORRT=ON\n\n# Ou usar vers\xe3o pr\xe9-compilada\nkatago-tensorrt\n"})}),"\n",(0,d.jsx)(n.h3,{id:"ganho-de-desempenho",children:"Ganho de Desempenho"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{children:"CUDA padr\xe3o: 100%\nTensorRT FP32: +20-30%\nTensorRT FP16: +50-80% (s\xe9rie RTX)\nTensorRT INT8: +100-150% (requer calibra\xe7\xe3o)\n"})}),"\n",(0,d.jsx)(n.h3,{id:"observa\xe7\xf5es",children:"Observa\xe7\xf5es"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsx)(n.li,{children:"Primeira inicializa\xe7\xe3o requer compilar engine TensorRT (alguns minutos)"}),"\n",(0,d.jsx)(n.li,{children:"GPUs diferentes requerem recompila\xe7\xe3o"}),"\n",(0,d.jsx)(n.li,{children:"FP16/INT8 podem reduzir levemente a precis\xe3o"}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"problemas-comuns",children:"Problemas Comuns"}),"\n",(0,d.jsx)(n.h3,{id:"gpu-n\xe3o-detectada",children:"GPU N\xe3o Detectada"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-bash",children:"# Verificar status da GPU\nnvidia-smi  # NVIDIA\nrocm-smi    # AMD\nclinfo      # OpenCL\n\n# KataGo lista GPUs dispon\xedveis\nkatago gpuinfo\n"})}),"\n",(0,d.jsx)(n.h3,{id:"vram-insuficiente",children:"VRAM Insuficiente"}),"\n",(0,d.jsx)(n.pre,{children:(0,d.jsx)(n.code,{className:"language-ini",children:"# Usar modelo menor\n# b18c384 \u2192 b10c128\n\n# Reduzir tamanho do lote\nnnMaxBatchSize = 4\n\n# Reduzir cache\nnnCacheSizePowerOfTwo = 16\n"})}),"\n",(0,d.jsx)(n.h3,{id:"desempenho-abaixo-do-esperado",children:"Desempenho Abaixo do Esperado"}),"\n",(0,d.jsxs)(n.ol,{children:["\n",(0,d.jsx)(n.li,{children:"Confirmar uso do backend correto (CUDA > OpenCL > Eigen)"}),"\n",(0,d.jsxs)(n.li,{children:["Verificar se ",(0,d.jsx)(n.code,{children:"numSearchThreads"})," \xe9 suficiente"]}),"\n",(0,d.jsx)(n.li,{children:"Confirmar que a GPU n\xe3o est\xe1 ocupada por outros programas"}),"\n",(0,d.jsxs)(n.li,{children:["Usar comando ",(0,d.jsx)(n.code,{children:"benchmark"})," para confirmar desempenho"]}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"checklist-de-otimiza\xe7\xe3o-de-desempenho",children:"Checklist de Otimiza\xe7\xe3o de Desempenho"}),"\n",(0,d.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Escolher o backend correto (CUDA/OpenCL/Metal)"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Instalar drivers de GPU mais recentes"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Ajustar ",(0,d.jsx)(n.code,{children:"nnMaxBatchSize"})," conforme VRAM"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Ajustar ",(0,d.jsx)(n.code,{children:"numSearchThreads"})," conforme CPU"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Executar ",(0,d.jsx)(n.code,{children:"benchmark"})," para confirmar desempenho"]}),"\n",(0,d.jsxs)(n.li,{className:"task-list-item",children:[(0,d.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Monitorar utiliza\xe7\xe3o da GPU (deve ser > 80%)"]}),"\n"]}),"\n",(0,d.jsx)(n.hr,{}),"\n",(0,d.jsx)(n.h2,{id:"leitura-adicional",children:"Leitura Adicional"}),"\n",(0,d.jsxs)(n.ul,{children:["\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"../mcts-implementation",children:"Detalhes de Implementa\xe7\xe3o do MCTS"})," \u2014 Origem da demanda por infer\xeancia em lote"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"../quantization-deploy",children:"Quantiza\xe7\xe3o e Implanta\xe7\xe3o de Modelos"})," \u2014 Otimiza\xe7\xf5es avan\xe7adas de desempenho"]}),"\n",(0,d.jsxs)(n.li,{children:[(0,d.jsx)(n.a,{href:"../../hands-on/setup",children:"Guia Completo de Instala\xe7\xe3o"})," \u2014 Passos de instala\xe7\xe3o para cada plataforma"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,d.jsx)(n,{...e,children:(0,d.jsx)(t,{...e})}):t(e)}},30416(e,n,i){i.d(n,{R:()=>r,x:()=>l});var s=i(59471);const d={},a=s.createContext(d);function r(e){const n=s.useContext(a);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(d):e.components||d:r(e.components),s.createElement(a.Provider,{value:n},e.children)}}}]);