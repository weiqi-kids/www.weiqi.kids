"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[1776],{50056(e,a,r){r.r(a),r.d(a,{assets:()=>o,contentTitle:()=>l,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"alphago/explained/distributed-systems","title":"Sistemas Distribu\xeddos e TPU","description":"An\xe1lise profunda da arquitetura de treinamento distribu\xeddo do AlphaGo, acelera\xe7\xe3o por TPU e MCTS paralelo em larga escala","source":"@site/i18n/pt/docusaurus-plugin-content-docs/current/alphago/explained/19-distributed-systems.mdx","sourceDirName":"alphago/explained","slug":"/alphago/explained/distributed-systems","permalink":"/pt/docs/alphago/explained/distributed-systems","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/alphago/explained/19-distributed-systems.mdx","tags":[],"version":"current","sidebarPosition":20,"frontMatter":{"sidebar_position":20,"title":"Sistemas Distribu\xeddos e TPU","description":"An\xe1lise profunda da arquitetura de treinamento distribu\xeddo do AlphaGo, acelera\xe7\xe3o por TPU e MCTS paralelo em larga escala","keywords":["sistemas distribu\xeddos","TPU","computa\xe7\xe3o paralela","MCTS","perda virtual","deep learning","acelera\xe7\xe3o de hardware"]},"sidebar":"tutorialSidebar","previous":{"title":"O Processo de Treinamento do Zero","permalink":"/pt/docs/alphago/explained/training-from-scratch"},"next":{"title":"O Legado do AlphaGo","permalink":"/pt/docs/alphago/explained/legacy-and-impact"}}');var n=r(62615),i=r(30416);const d={sidebar_position:20,title:"Sistemas Distribu\xeddos e TPU",description:"An\xe1lise profunda da arquitetura de treinamento distribu\xeddo do AlphaGo, acelera\xe7\xe3o por TPU e MCTS paralelo em larga escala",keywords:["sistemas distribu\xeddos","TPU","computa\xe7\xe3o paralela","MCTS","perda virtual","deep learning","acelera\xe7\xe3o de hardware"]},l="Sistemas Distribu\xeddos e TPU",o={},t=[{value:"Vis\xe3o Geral da Arquitetura de Treinamento",id:"vis\xe3o-geral-da-arquitetura-de-treinamento",level:2},{value:"Arquitetura de Treinamento do AlphaGo Original",id:"arquitetura-de-treinamento-do-alphago-original",level:3},{value:"Arquitetura de Treinamento do AlphaGo Zero",id:"arquitetura-de-treinamento-do-alphago-zero",level:3},{value:"Workers de Auto-Jogo (Self-play Workers)",id:"workers-de-auto-jogo-self-play-workers",level:2},{value:"Distribui\xe7\xe3o de Tarefas",id:"distribui\xe7\xe3o-de-tarefas",level:3},{value:"Fluxo de Trabalho",id:"fluxo-de-trabalho",level:3},{value:"Balanceamento de Carga",id:"balanceamento-de-carga",level:3},{value:"Workers de Treinamento (Training Workers)",id:"workers-de-treinamento-training-workers",level:2},{value:"Distribui\xe7\xe3o de Tarefas",id:"distribui\xe7\xe3o-de-tarefas-1",level:3},{value:"Treinamento Distribu\xeddo",id:"treinamento-distribu\xeddo",level:3},{value:"Atualiza\xe7\xe3o S\xedncrona vs. Ass\xedncrona",id:"atualiza\xe7\xe3o-s\xedncrona-vs-ass\xedncrona",level:3},{value:"O Papel das TPUs",id:"o-papel-das-tpus",level:2},{value:"O Que \xe9 uma TPU?",id:"o-que-\xe9-uma-tpu",level:3},{value:"Arquitetura da TPU",id:"arquitetura-da-tpu",level:3},{value:"Por Que o AlphaGo Precisa de TPUs?",id:"por-que-o-alphago-precisa-de-tpus",level:3},{value:"Evolu\xe7\xe3o do Uso de TPUs",id:"evolu\xe7\xe3o-do-uso-de-tpus",level:3},{value:"MCTS Paralelo e Perda Virtual",id:"mcts-paralelo-e-perda-virtual",level:2},{value:"O Desafio da Paraleliza\xe7\xe3o",id:"o-desafio-da-paraleliza\xe7\xe3o",level:3},{value:"Paraleliza\xe7\xe3o de Folhas (Leaf Parallelization)",id:"paraleliza\xe7\xe3o-de-folhas-leaf-parallelization",level:3},{value:"Perda Virtual (Virtual Loss)",id:"perda-virtual-virtual-loss",level:3},{value:"Conceito B\xe1sico",id:"conceito-b\xe1sico",level:4},{value:"Fluxo de Opera\xe7\xe3o",id:"fluxo-de-opera\xe7\xe3o",level:4},{value:"Efeitos da Perda Virtual",id:"efeitos-da-perda-virtual",level:4},{value:"Avalia\xe7\xe3o de Rede Neural em Batch",id:"avalia\xe7\xe3o-de-rede-neural-em-batch",level:3},{value:"Arquitetura de Infer\xeancia",id:"arquitetura-de-infer\xeancia",level:2},{value:"Configura\xe7\xe3o Durante Partidas",id:"configura\xe7\xe3o-durante-partidas",level:3},{value:"Fluxo de Infer\xeancia Distribu\xedda",id:"fluxo-de-infer\xeancia-distribu\xedda",level:3},{value:"Gerenciamento de Tempo de Reflex\xe3o",id:"gerenciamento-de-tempo-de-reflex\xe3o",level:3},{value:"Comunica\xe7\xe3o e Sincroniza\xe7\xe3o",id:"comunica\xe7\xe3o-e-sincroniza\xe7\xe3o",level:2},{value:"Formato de Dados",id:"formato-de-dados",level:3},{value:"Requisitos de Largura de Banda de Rede",id:"requisitos-de-largura-de-banda-de-rede",level:3},{value:"Tratamento de Falhas",id:"tratamento-de-falhas",level:3},{value:"An\xe1lise de Custos",id:"an\xe1lise-de-custos",level:2},{value:"Estimativa de Custos de Hardware",id:"estimativa-de-custos-de-hardware",level:3},{value:"Compara\xe7\xe3o com Treinamento Humano",id:"compara\xe7\xe3o-com-treinamento-humano",level:3},{value:"Custos de Infer\xeancia",id:"custos-de-infer\xeancia",level:3},{value:"Evolu\xe7\xe3o Tecnol\xf3gica",id:"evolu\xe7\xe3o-tecnol\xf3gica",level:2},{value:"De AlphaGo a AlphaZero",id:"de-alphago-a-alphazero",level:3},{value:"Impacto na Comunidade Open Source",id:"impacto-na-comunidade-open-source",level:3},{value:"Correspond\xeancia com Anima\xe7\xf5es",id:"correspond\xeancia-com-anima\xe7\xf5es",level:2},{value:"Leitura Adicional",id:"leitura-adicional",level:2},{value:"Refer\xeancias",id:"refer\xeancias",level:2}];function c(e){const a={a:"a",annotation:"annotation",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",math:"math",mermaid:"mermaid",mi:"mi",mn:"mn",mo:"mo",mrow:"mrow",ol:"ol",p:"p",pre:"pre",semantics:"semantics",span:"span",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.header,{children:(0,n.jsx)(a.h1,{id:"sistemas-distribu\xeddos-e-tpu",children:"Sistemas Distribu\xeddos e TPU"})}),"\n",(0,n.jsx)(a.p,{children:"O sucesso do AlphaGo n\xe3o foi apenas uma vit\xf3ria de algoritmos, mas tamb\xe9m uma vit\xf3ria de engenharia. Para treinar uma IA de Go que supera os humanos em tempo razo\xe1vel, foi necess\xe1rio um sistema distribu\xeddo cuidadosamente projetado e suporte de hardware especializado."}),"\n",(0,n.jsx)(a.p,{children:"Este artigo analisar\xe1 profundamente a arquitetura de sistemas por tr\xe1s do AlphaGo, incluindo fluxo de treinamento, arquitetura de infer\xeancia, MCTS paralelo e o papel crucial das TPUs."}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h2,{id:"vis\xe3o-geral-da-arquitetura-de-treinamento",children:"Vis\xe3o Geral da Arquitetura de Treinamento"}),"\n",(0,n.jsx)(a.h3,{id:"arquitetura-de-treinamento-do-alphago-original",children:"Arquitetura de Treinamento do AlphaGo Original"}),"\n",(0,n.jsx)(a.p,{children:"A arquitetura de treinamento do AlphaGo original (a vers\xe3o que derrotou Lee Sedol) foi dividida em m\xfaltiplas fases, cada uma usando uma configura\xe7\xe3o de recursos diferente:"}),"\n",(0,n.jsx)(a.mermaid,{value:'flowchart TB\n    subgraph Phase1["Fase 1: Aprendizado Supervisionado"]\n        A1["Registros Humanos<br/>(30M jogos)"] --\x3e B1["Cluster de GPU<br/>(50 GPUs)"] --\x3e C1["Policy Net<br/>(vers\xe3o SL)"]\n    end\n\n    subgraph Phase2["Fase 2: Aprendizado por Refor\xe7o"]\n        A2["Auto-jogo<br/>(milh\xf5es de jogos)"] --\x3e B2["Cluster de GPU<br/>(50 GPUs)"] --\x3e C2["Policy Net<br/>(vers\xe3o RL)"]\n    end\n\n    subgraph Phase3["Fase 3: Treinamento da Value Network"]\n        A3["Dados de jogos RL<br/>(30M pos.)"] --\x3e B3["Cluster de GPU<br/>(50 GPUs)"] --\x3e C3["Value Net"]\n    end\n\n    Phase1 --\x3e Phase2 --\x3e Phase3'}),"\n",(0,n.jsx)(a.h3,{id:"arquitetura-de-treinamento-do-alphago-zero",children:"Arquitetura de Treinamento do AlphaGo Zero"}),"\n",(0,n.jsx)(a.p,{children:"O AlphaGo Zero simplificou significativamente o processo de treinamento, usando um \xfanico ciclo de treinamento de ponta a ponta:"}),"\n",(0,n.jsx)(a.mermaid,{value:'flowchart TB\n    subgraph ZeroCycle["Ciclo de Treinamento AlphaGo Zero"]\n        A["Self-play Workers<br/>(TPU \xd7 N)"] --\x3e|"Gera dados"| B["Replay Buffer<br/>(RAM/SSD)<br/>\xfaltimos 500K jogos"]\n        B --\x3e|"Amostra dados"| C["Training Workers<br/>(TPU \xd7 M)"]\n        C --\x3e|"Salva pesos"| D["Network Checkpoint"]\n        D --\x3e|"Atualiza rede"| A\n    end'}),"\n",(0,n.jsx)(a.p,{children:"As vantagens desta arquitetura:"}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Aprendizado cont\xednuo"}),": Self-play e Training acontecem simultaneamente, sem necessidade de esperar"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Efici\xeancia de recursos"}),": Todos os recursos est\xe3o fazendo trabalho \xfatil"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Itera\xe7\xe3o r\xe1pida"}),": A rede atualizada \xe9 imediatamente usada para gerar novos dados"]}),"\n"]}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h2,{id:"workers-de-auto-jogo-self-play-workers",children:"Workers de Auto-Jogo (Self-play Workers)"}),"\n",(0,n.jsx)(a.h3,{id:"distribui\xe7\xe3o-de-tarefas",children:"Distribui\xe7\xe3o de Tarefas"}),"\n",(0,n.jsx)(a.p,{children:"Os Self-play Workers s\xe3o respons\xe1veis por realizar auto-jogo com a rede mais forte atual, gerando dados de treinamento."}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Configura\xe7\xe3o"}),(0,n.jsx)(a.th,{children:"AlphaGo Zero"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"N\xfamero de Workers"}),(0,n.jsx)(a.td,{children:"Dezenas"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Por Worker"}),(0,n.jsx)(a.td,{children:"1-4 TPU"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"MCTS por jogo"}),(0,n.jsx)(a.td,{children:"1600 simula\xe7\xf5es"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Produ\xe7\xe3o di\xe1ria"}),(0,n.jsx)(a.td,{children:"~100.000 jogos"})]})]})]}),"\n",(0,n.jsx)(a.h3,{id:"fluxo-de-trabalho",children:"Fluxo de Trabalho"}),"\n",(0,n.jsx)(a.p,{children:"O fluxo de trabalho de cada Self-play Worker:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-python",children:"while True:\n    # 1. Baixar os pesos da rede mais recente\n    network = download_latest_checkpoint()\n\n    # 2. Realizar m\xfaltiplos jogos de auto-jogo\n    for game in range(batch_size):\n        positions = []\n        board = EmptyBoard()\n\n        while not board.is_terminal():\n            # Executar MCTS\n            mcts = MCTS(network, board)\n            policy = mcts.search(num_simulations=1600)\n\n            # Selecionar jogada\n            action = sample(policy)\n\n            # Registrar\n            positions.append((board.state, policy))\n\n            # Jogar\n            board = board.play(action)\n\n        # 3. Obter resultado do jogo\n        result = board.get_result()\n\n        # 4. Fazer upload dos dados\n        upload_to_replay_buffer(positions, result)\n"})}),"\n",(0,n.jsx)(a.h3,{id:"balanceamento-de-carga",children:"Balanceamento de Carga"}),"\n",(0,n.jsx)(a.p,{children:"M\xfaltiplos Workers precisam de balanceamento de carga:"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Sincroniza\xe7\xe3o de rede"}),": Todos os Workers usam a mesma vers\xe3o da rede"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Balanceamento de dados"}),": Garantir que os dados de diferentes Workers sejam todos utilizados"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Tratamento de falhas"}),": Falha de um \xfanico Worker n\xe3o afeta o treinamento geral"]}),"\n"]}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h2,{id:"workers-de-treinamento-training-workers",children:"Workers de Treinamento (Training Workers)"}),"\n",(0,n.jsx)(a.h3,{id:"distribui\xe7\xe3o-de-tarefas-1",children:"Distribui\xe7\xe3o de Tarefas"}),"\n",(0,n.jsx)(a.p,{children:"Os Training Workers s\xe3o respons\xe1veis por amostrar dados do Replay Buffer e treinar a rede neural."}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Configura\xe7\xe3o"}),(0,n.jsx)(a.th,{children:"AlphaGo Zero"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"N\xfamero de Workers"}),(0,n.jsx)(a.td,{children:"1-4"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Por Worker"}),(0,n.jsx)(a.td,{children:"4 TPU"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Batch Size"}),(0,n.jsx)(a.td,{children:"2048 (512 por TPU)"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Passos de treinamento"}),(0,n.jsx)(a.td,{children:"Dezenas de milhares por dia"})]})]})]}),"\n",(0,n.jsx)(a.h3,{id:"treinamento-distribu\xeddo",children:"Treinamento Distribu\xeddo"}),"\n",(0,n.jsxs)(a.p,{children:["O treinamento em larga escala usa ",(0,n.jsx)(a.strong,{children:"Paralelismo de Dados (Data Parallelism)"}),":"]}),"\n",(0,n.jsx)(a.mermaid,{value:'flowchart TB\n    PS["Parameter Server"]\n\n    PS --\x3e TPU0["TPU 0<br/>Batch 0"]\n    PS --\x3e TPU1["TPU 1<br/>Batch 1"]\n    PS --\x3e TPU2["TPU 2<br/>Batch 2"]\n\n    TPU0 --\x3e GA["Gradient Aggregation"]\n    TPU1 --\x3e GA\n    TPU2 --\x3e GA\n\n    GA --\x3e PS'}),"\n",(0,n.jsx)(a.p,{children:"Cada TPU processa um mini-batch diferente, calcula o gradiente local e ent\xe3o agrega para atualizar os par\xe2metros globais."}),"\n",(0,n.jsx)(a.h3,{id:"atualiza\xe7\xe3o-s\xedncrona-vs-ass\xedncrona",children:"Atualiza\xe7\xe3o S\xedncrona vs. Ass\xedncrona"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Modo de atualiza\xe7\xe3o"}),(0,n.jsx)(a.th,{children:"Vantagens"}),(0,n.jsx)(a.th,{children:"Desvantagens"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"S\xedncrono"}),(0,n.jsx)(a.td,{children:"Est\xe1vel, reproduz\xedvel"}),(0,n.jsx)(a.td,{children:"Workers precisam esperar pelo mais lento"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Ass\xedncrono"}),(0,n.jsx)(a.td,{children:"Alto throughput"}),(0,n.jsx)(a.td,{children:"Gradientes podem estar desatualizados"})]})]})]}),"\n",(0,n.jsxs)(a.p,{children:["O AlphaGo Zero usa ",(0,n.jsx)(a.strong,{children:"atualiza\xe7\xe3o s\xedncrona"})," para garantir a estabilidade do treinamento."]}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h2,{id:"o-papel-das-tpus",children:"O Papel das TPUs"}),"\n",(0,n.jsx)(a.h3,{id:"o-que-\xe9-uma-tpu",children:"O Que \xe9 uma TPU?"}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"TPU (Tensor Processing Unit)"})," \xe9 um acelerador projetado especificamente pela Google para deep learning:"]}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Caracter\xedstica"}),(0,n.jsx)(a.th,{children:"TPU"}),(0,n.jsx)(a.th,{children:"GPU"}),(0,n.jsx)(a.th,{children:"CPU"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Objetivo de design"}),(0,n.jsx)(a.td,{children:"Opera\xe7\xf5es matriciais"}),(0,n.jsx)(a.td,{children:"Paralelismo geral"}),(0,n.jsx)(a.td,{children:"Computa\xe7\xe3o geral"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Precis\xe3o"}),(0,n.jsx)(a.td,{children:"Otimizado para FP16/BF16"}),(0,n.jsx)(a.td,{children:"FP32/FP16"}),(0,n.jsx)(a.td,{children:"FP64/FP32"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Consumo de energia"}),(0,n.jsx)(a.td,{children:"Relativamente baixo"}),(0,n.jsx)(a.td,{children:"Mais alto"}),(0,n.jsx)(a.td,{children:"Mais alto"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Lat\xeancia"}),(0,n.jsx)(a.td,{children:"Baixa"}),(0,n.jsx)(a.td,{children:"M\xe9dia"}),(0,n.jsx)(a.td,{children:"Alta"})]})]})]}),"\n",(0,n.jsx)(a.h3,{id:"arquitetura-da-tpu",children:"Arquitetura da TPU"}),"\n",(0,n.jsxs)(a.p,{children:["O n\xfacleo da TPU \xe9 a ",(0,n.jsx)(a.strong,{children:"MXU (Matrix Multiply Unit)"}),":"]}),"\n",(0,n.jsx)(a.mermaid,{value:'flowchart TB\n    subgraph TPU["TPU v2/v3"]\n        MXU["MXU (128\xd7128)<br/>Matrix Multiply Unit<br/>16K MACs/ciclo"]\n        VU["Vector Unit"]\n        HBM["HBM<br/>(16-32 GB)"]\n    end'}),"\n",(0,n.jsx)(a.p,{children:"A MXU pode executar 16K opera\xe7\xf5es de multiplica\xe7\xe3o-acumula\xe7\xe3o por ciclo, o que \xe9 crucial para a multiplica\xe7\xe3o de matrizes em redes neurais."}),"\n",(0,n.jsx)(a.h3,{id:"por-que-o-alphago-precisa-de-tpus",children:"Por Que o AlphaGo Precisa de TPUs?"}),"\n",(0,n.jsxs)(a.p,{children:["O gargalo computacional da IA de Go est\xe1 na ",(0,n.jsx)(a.strong,{children:"infer\xeancia da rede neural"}),":"]}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Opera\xe7\xe3o"}),(0,n.jsx)(a.th,{children:"Propor\xe7\xe3o"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Forward pass da rede neural"}),(0,n.jsx)(a.td,{children:"~95%"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Opera\xe7\xf5es da \xe1rvore MCTS"}),(0,n.jsx)(a.td,{children:"~4%"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Outros"}),(0,n.jsx)(a.td,{children:"~1%"})]})]})]}),"\n",(0,n.jsx)(a.p,{children:"Cada passo do MCTS requer 1600 infer\xeancias da rede neural. O alto throughput das TPUs torna isso poss\xedvel."}),"\n",(0,n.jsx)(a.h3,{id:"evolu\xe7\xe3o-do-uso-de-tpus",children:"Evolu\xe7\xe3o do Uso de TPUs"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Vers\xe3o"}),(0,n.jsx)(a.th,{children:"TPU para Treinamento"}),(0,n.jsx)(a.th,{children:"TPU para Infer\xeancia"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"AlphaGo Lee"}),(0,n.jsx)(a.td,{children:"50 GPU"}),(0,n.jsx)(a.td,{children:"48 TPU (v1)"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"AlphaGo Master"}),(0,n.jsx)(a.td,{children:"4 TPU (v2)"}),(0,n.jsx)(a.td,{children:"4 TPU (v2)"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"AlphaGo Zero"}),(0,n.jsx)(a.td,{children:"4 TPU (v2)"}),(0,n.jsx)(a.td,{children:"4 TPU (v2) (escal\xe1vel)"})]})]})]}),"\n",(0,n.jsx)(a.p,{children:"O n\xfamero de TPUs usadas pelo AlphaGo Zero diminuiu significativamente, gra\xe7as a uma arquitetura mais eficiente e vers\xf5es mais recentes das TPUs."}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h2,{id:"mcts-paralelo-e-perda-virtual",children:"MCTS Paralelo e Perda Virtual"}),"\n",(0,n.jsx)(a.h3,{id:"o-desafio-da-paraleliza\xe7\xe3o",children:"O Desafio da Paraleliza\xe7\xe3o"}),"\n",(0,n.jsxs)(a.p,{children:["A implementa\xe7\xe3o padr\xe3o do MCTS \xe9 ",(0,n.jsx)(a.strong,{children:"serial"}),":"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"for i in range(num_simulations):\n    1. Selection: Selecionar da raiz para baixo\n    2. Expansion: Expandir n\xf3 folha\n    3. Evaluation: Avalia\xe7\xe3o da rede neural\n    4. Backup: Propagar atualiza\xe7\xe3o para cima\n"})}),"\n",(0,n.jsxs)(a.p,{children:["Mas a avalia\xe7\xe3o da rede neural \xe9 uma ",(0,n.jsx)(a.strong,{children:"opera\xe7\xe3o em batch"})," amig\xe1vel para GPU/TPU. Como fazer m\xfaltiplas simula\xe7\xf5es ocorrerem simultaneamente?"]}),"\n",(0,n.jsx)(a.h3,{id:"paraleliza\xe7\xe3o-de-folhas-leaf-parallelization",children:"Paraleliza\xe7\xe3o de Folhas (Leaf Parallelization)"}),"\n",(0,n.jsx)(a.p,{children:"A forma mais simples de paraleliza\xe7\xe3o: executar m\xfaltiplas simula\xe7\xf5es completas simultaneamente, depois mesclar os resultados."}),"\n",(0,n.jsx)(a.mermaid,{value:'flowchart TB\n    Root["Root"]\n    Root --\x3e S1["Sim 1<br/>(indep)"]\n    Root --\x3e S2["Sim 2<br/>(indep)"]\n    Root --\x3e S3["Sim 3<br/>(indep)"]\n    Root --\x3e S4["Sim 4<br/>(indep)"]\n\n    S1 --\x3e Merge["Merge Trees"]\n    S2 --\x3e Merge\n    S3 --\x3e Merge\n    S4 --\x3e Merge'}),"\n",(0,n.jsx)(a.p,{children:"Problema: Cada simula\xe7\xe3o come\xe7a da raiz, e pode explorar repetidamente os mesmos caminhos."}),"\n",(0,n.jsx)(a.h3,{id:"perda-virtual-virtual-loss",children:"Perda Virtual (Virtual Loss)"}),"\n",(0,n.jsxs)(a.p,{children:["A DeepMind adotou a t\xe9cnica de ",(0,n.jsx)(a.strong,{children:"perda virtual"})," para implementar Paraleliza\xe7\xe3o de \xc1rvore (Tree Parallelization)."]}),"\n",(0,n.jsx)(a.h4,{id:"conceito-b\xe1sico",children:"Conceito B\xe1sico"}),"\n",(0,n.jsx)(a.p,{children:"Quando uma thread est\xe1 explorando um determinado n\xf3, reduz temporariamente o valor desse n\xf3, fazendo com que outras threads escolham outros caminhos."}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:"UCB normal: Q(s,a) + c * P(s,a) * sqrt(N(s)) / (1 + N(s,a))\n\nCom perda virtual:\n(Q(s,a) * N(s,a) - v * n_virtual) / (N(s,a) + n_virtual) + c * P(s,a) * sqrt(N(s)) / (1 + N(s,a) + n_virtual)\n"})}),"\n",(0,n.jsx)(a.p,{children:"Onde:"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"n_virtual"})," \xe9 o n\xfamero de threads explorando esse n\xf3"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.code,{children:"v"})," \xe9 o valor da perda virtual (geralmente 1 ou o valor correspondente \xe0 taxa de vit\xf3ria)"]}),"\n"]}),"\n",(0,n.jsx)(a.h4,{id:"fluxo-de-opera\xe7\xe3o",children:"Fluxo de Opera\xe7\xe3o"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{children:'Tempo T1:\n  Thread 1 seleciona caminho A \u2192 B \u2192 C\n  N\xf3 C recebe perda virtual -1\n\nTempo T2:\n  Thread 2 seleciona caminho A \u2192 B \u2192 D (porque C foi "penalizado")\n  N\xf3 D recebe perda virtual -1\n\nTempo T3:\n  Thread 1 completa avalia\xe7\xe3o, atualiza valor real de C, remove perda virtual\n  Thread 3 agora pode escolher C (se o valor real for bom o suficiente)\n'})}),"\n",(0,n.jsx)(a.h4,{id:"efeitos-da-perda-virtual",children:"Efeitos da Perda Virtual"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Aspecto"}),(0,n.jsx)(a.th,{children:"Efeito"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Diversidade de explora\xe7\xe3o"}),(0,n.jsx)(a.td,{children:"For\xe7a explora\xe7\xe3o de diferentes caminhos"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Efici\xeancia de batch"}),(0,n.jsx)(a.td,{children:"Pode avaliar m\xfaltiplos n\xf3s folha simultaneamente"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Converg\xeancia"}),(0,n.jsx)(a.td,{children:"Perda virtual \xe9 eventualmente substitu\xedda pelo valor real, n\xe3o afeta converg\xeancia"})]})]})]}),"\n",(0,n.jsx)(a.h3,{id:"avalia\xe7\xe3o-de-rede-neural-em-batch",children:"Avalia\xe7\xe3o de Rede Neural em Batch"}),"\n",(0,n.jsxs)(a.p,{children:["Atrav\xe9s da perda virtual, m\xfaltiplos n\xf3s folha a serem avaliados podem ser coletados para ",(0,n.jsx)(a.strong,{children:"infer\xeancia em batch"}),":"]}),"\n",(0,n.jsx)(a.mermaid,{value:'flowchart LR\n    subgraph PMCTS["Parallel MCTS"]\n        T1["Thread 1"] --\x3e L1["N\xf3 folha L1"]\n        T2["Thread 2"] --\x3e L2["N\xf3 folha L2"]\n        T3["Thread 3"] --\x3e L3["N\xf3 folha L3"]\n        T4["Thread 4"] --\x3e L4["N\xf3 folha L4"]\n    end\n\n    L1 --\x3e Batch["Batch"]\n    L2 --\x3e Batch\n    L3 --\x3e Batch\n    L4 --\x3e Batch\n\n    Batch --\x3e TPU["TPU"]\n    TPU --\x3e|"(P1,V1), (P2,V2), ..."| PMCTS'}),"\n",(0,n.jsx)(a.p,{children:"A efici\xeancia da infer\xeancia em batch da TPU \xe9 muito maior que a infer\xeancia individual, tornando o MCTS paralelo poss\xedvel."}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h2,{id:"arquitetura-de-infer\xeancia",children:"Arquitetura de Infer\xeancia"}),"\n",(0,n.jsx)(a.h3,{id:"configura\xe7\xe3o-durante-partidas",children:"Configura\xe7\xe3o Durante Partidas"}),"\n",(0,n.jsx)(a.p,{children:"A arquitetura de infer\xeancia do AlphaGo durante partidas oficiais:"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Vers\xe3o"}),(0,n.jsx)(a.th,{children:"Configura\xe7\xe3o de Hardware"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"AlphaGo Fan"}),(0,n.jsx)(a.td,{children:"176 GPU"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"AlphaGo Lee"}),(0,n.jsx)(a.td,{children:"48 TPU + m\xfaltiplos servidores"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"AlphaGo Master"}),(0,n.jsx)(a.td,{children:"4 TPU"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"AlphaGo Zero"}),(0,n.jsx)(a.td,{children:"4 TPU (escal\xe1vel)"})]})]})]}),"\n",(0,n.jsx)(a.h3,{id:"fluxo-de-infer\xeancia-distribu\xedda",children:"Fluxo de Infer\xeancia Distribu\xedda"}),"\n",(0,n.jsx)(a.p,{children:"Fluxo de infer\xeancia durante partidas (usando AlphaGo Lee como exemplo):"}),"\n",(0,n.jsx)(a.mermaid,{value:'flowchart TB\n    subgraph Inference["Arquitetura de Infer\xeancia Distribu\xedda"]\n        Master["N\xf3 Master<br/>Recebe/envia jogadas"]\n        Master --\x3e MCTS["Controlador MCTS<br/>Gerencia \xe1rvore, distribui tarefas"]\n\n        subgraph TPUCluster["Cluster de TPU (48 TPUs)"]\n            TPU1["TPU 1"]\n            TPU2["TPU 2"]\n            TPU3["TPU 3"]\n            TPU4["TPU 4"]\n            TPU5["TPU 5"]\n            TPU48["... TPU 48"]\n        end\n\n        MCTS --\x3e TPUCluster\n    end'}),"\n",(0,n.jsx)(a.h3,{id:"gerenciamento-de-tempo-de-reflex\xe3o",children:"Gerenciamento de Tempo de Reflex\xe3o"}),"\n",(0,n.jsx)(a.p,{children:"Estrat\xe9gia de gerenciamento de tempo do AlphaGo:"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Posi\xe7\xe3o"}),(0,n.jsx)(a.th,{children:"Tempo de Reflex\xe3o"}),(0,n.jsx)(a.th,{children:"Simula\xe7\xf5es MCTS"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Abertura (tem joseki)"}),(0,n.jsx)(a.td,{children:"Mais curto"}),(0,n.jsx)(a.td,{children:"~10.000"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Meio-jogo (complexo)"}),(0,n.jsx)(a.td,{children:"Mais longo"}),(0,n.jsx)(a.td,{children:"~100.000"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Posi\xe7\xe3o simples"}),(0,n.jsx)(a.td,{children:"Mais curto"}),(0,n.jsx)(a.td,{children:"~5.000"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Byoyomi"}),(0,n.jsx)(a.td,{children:"Fixo"}),(0,n.jsx)(a.td,{children:"~1.600"})]})]})]}),"\n",(0,n.jsx)(a.p,{children:"Mais simula\xe7\xf5es MCTS geralmente significam jogadas de melhor qualidade."}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h2,{id:"comunica\xe7\xe3o-e-sincroniza\xe7\xe3o",children:"Comunica\xe7\xe3o e Sincroniza\xe7\xe3o"}),"\n",(0,n.jsx)(a.h3,{id:"formato-de-dados",children:"Formato de Dados"}),"\n",(0,n.jsx)(a.p,{children:"Formato de transmiss\xe3o de dados de treinamento:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-protobuf",children:"message TrainingExample {\n    // Estado do tabuleiro (17 \xd7 19 \xd7 19)\n    repeated float board_planes = 1;\n\n    // Resultado da busca MCTS (362)\n    repeated float mcts_policy = 2;\n\n    // Resultado do jogo (1 = jogador atual vence, -1 = jogador atual perde)\n    float game_result = 3;\n}\n"})}),"\n",(0,n.jsx)(a.h3,{id:"requisitos-de-largura-de-banda-de-rede",children:"Requisitos de Largura de Banda de Rede"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Fluxo de dados"}),(0,n.jsx)(a.th,{children:"Tamanho"}),(0,n.jsx)(a.th,{children:"Frequ\xeancia"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Amostras de treinamento"}),(0,n.jsx)(a.td,{children:"~10 KB/amostra"}),(0,n.jsx)(a.td,{children:"Milhares de amostras/segundo"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Pesos da rede"}),(0,n.jsx)(a.td,{children:"~200 MB"}),(0,n.jsx)(a.td,{children:"V\xe1rias vezes/hora"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Mensagens de controle"}),(0,n.jsx)(a.td,{children:"< 1 KB"}),(0,n.jsx)(a.td,{children:"Cont\xednuo"})]})]})]}),"\n",(0,n.jsx)(a.p,{children:"Requisito total de largura de banda: ~100 Mbps (rede interna \xe9 suficiente)"}),"\n",(0,n.jsx)(a.h3,{id:"tratamento-de-falhas",children:"Tratamento de Falhas"}),"\n",(0,n.jsx)(a.p,{children:"Tratamento de falhas em sistemas distribu\xeddos:"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Tipo de falha"}),(0,n.jsx)(a.th,{children:"Forma de tratamento"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Worker caiu"}),(0,n.jsx)(a.td,{children:"Reinicia, continua usando checkpoint mais recente"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Desconex\xe3o de rede"}),(0,n.jsx)(a.td,{children:"Buffer de dados, continua transmiss\xe3o ap\xf3s reconex\xe3o"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Falha de TPU"}),(0,n.jsx)(a.td,{children:"Troca autom\xe1tica para TPU reserva"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Dados corrompidos"}),(0,n.jsx)(a.td,{children:"Descarta ap\xf3s verifica\xe7\xe3o, regenera"})]})]})]}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h2,{id:"an\xe1lise-de-custos",children:"An\xe1lise de Custos"}),"\n",(0,n.jsx)(a.h3,{id:"estimativa-de-custos-de-hardware",children:"Estimativa de Custos de Hardware"}),"\n",(0,n.jsx)(a.p,{children:"Estimativa de custos de treinamento do AlphaGo Zero baseada nos pre\xe7os de TPU do Google Cloud:"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Recurso"}),(0,n.jsx)(a.th,{children:"Quantidade"}),(0,n.jsx)(a.th,{children:"Pre\xe7o/hora"}),(0,n.jsx)(a.th,{children:"Total/dia"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"TPU v2 Pod"}),(0,n.jsx)(a.td,{children:"4"}),(0,n.jsx)(a.td,{children:"~$32"}),(0,n.jsx)(a.td,{children:"~$3.000"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"VM alta mem\xf3ria"}),(0,n.jsx)(a.td,{children:"V\xe1rios"}),(0,n.jsx)(a.td,{children:"~$5"}),(0,n.jsx)(a.td,{children:"~$500"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Espa\xe7o de armazenamento"}),(0,n.jsx)(a.td,{children:"10 TB"}),(0,n.jsx)(a.td,{children:"~$0.02/GB"}),(0,n.jsx)(a.td,{children:"~$200"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Rede"}),(0,n.jsx)(a.td,{children:"-"}),(0,n.jsx)(a.td,{children:"Inclu\xeddo"}),(0,n.jsx)(a.td,{children:"-"})]})]})]}),"\n",(0,n.jsxs)(a.p,{children:[(0,n.jsxs)(a.strong,{children:["Aproximadamente ",(0,n.jsxs)(a.span,{className:"katex",children:[(0,n.jsx)(a.span,{className:"katex-mathml",children:(0,n.jsx)(a.math,{xmlns:"http://www.w3.org/1998/Math/MathML",children:(0,n.jsxs)(a.semantics,{children:[(0,n.jsxs)(a.mrow,{children:[(0,n.jsx)(a.mn,{children:"3.700"}),(0,n.jsx)(a.mi,{mathvariant:"normal",children:"/"}),(0,n.jsx)(a.mi,{children:"d"}),(0,n.jsx)(a.mi,{children:"i"}),(0,n.jsx)(a.mi,{children:"a"}),(0,n.jsx)(a.mo,{children:"\u2217"}),(0,n.jsx)(a.mo,{children:"\u2217"}),(0,n.jsx)(a.mo,{separator:"true",children:","}),(0,n.jsx)(a.mi,{children:"t"}),(0,n.jsx)(a.mi,{children:"r"}),(0,n.jsx)(a.mi,{children:"e"}),(0,n.jsx)(a.mi,{children:"i"}),(0,n.jsx)(a.mi,{children:"n"}),(0,n.jsx)(a.mi,{children:"a"}),(0,n.jsx)(a.mi,{children:"m"}),(0,n.jsx)(a.mi,{children:"e"}),(0,n.jsx)(a.mi,{children:"n"}),(0,n.jsx)(a.mi,{children:"t"}),(0,n.jsx)(a.mi,{children:"o"}),(0,n.jsx)(a.mi,{children:"c"}),(0,n.jsx)(a.mi,{children:"o"}),(0,n.jsx)(a.mi,{children:"m"}),(0,n.jsx)(a.mi,{children:"p"}),(0,n.jsx)(a.mi,{children:"l"}),(0,n.jsx)(a.mi,{children:"e"}),(0,n.jsx)(a.mi,{children:"t"}),(0,n.jsx)(a.mi,{children:"o"}),(0,n.jsx)(a.mo,{stretchy:"false",children:"("}),(0,n.jsx)(a.mn,{children:"40"}),(0,n.jsx)(a.mi,{children:"d"}),(0,n.jsx)(a.mi,{children:"i"}),(0,n.jsx)(a.mi,{children:"a"}),(0,n.jsx)(a.mi,{children:"s"}),(0,n.jsx)(a.mo,{stretchy:"false",children:")"}),(0,n.jsx)(a.mi,{children:"a"}),(0,n.jsx)(a.mi,{children:"p"}),(0,n.jsx)(a.mi,{children:"r"}),(0,n.jsx)(a.mi,{children:"o"}),(0,n.jsx)(a.mi,{children:"x"}),(0,n.jsx)(a.mi,{children:"i"}),(0,n.jsx)(a.mi,{children:"m"}),(0,n.jsx)(a.mi,{children:"a"}),(0,n.jsx)(a.mi,{children:"d"}),(0,n.jsx)(a.mi,{children:"a"}),(0,n.jsx)(a.mi,{children:"m"}),(0,n.jsx)(a.mi,{children:"e"}),(0,n.jsx)(a.mi,{children:"n"}),(0,n.jsx)(a.mi,{children:"t"}),(0,n.jsx)(a.mi,{children:"e"}),(0,n.jsx)(a.mo,{children:"\u2217"}),(0,n.jsx)(a.mo,{children:"\u2217"})]}),(0,n.jsx)(a.annotation,{encoding:"application/x-tex",children:"3.700/dia**, treinamento completo (40 dias) aproximadamente **"})]})})}),(0,n.jsxs)(a.span,{className:"katex-html","aria-hidden":"true",children:[(0,n.jsxs)(a.span,{className:"base",children:[(0,n.jsx)(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(a.span,{className:"mord",children:"3.700/"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"d"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"ia"}),(0,n.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(a.span,{className:"mbin",children:"\u2217"}),(0,n.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(a.span,{className:"base",children:[(0,n.jsx)(a.span,{className:"strut",style:{height:"1em",verticalAlign:"-0.25em"}}),(0,n.jsx)(a.span,{className:"mord",children:"\u2217"}),(0,n.jsx)(a.span,{className:"mpunct",children:","}),(0,n.jsx)(a.span,{className:"mspace",style:{marginRight:"0.1667em"}}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"t"}),(0,n.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"e"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"inam"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"e"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"n"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"t"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"oco"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"m"}),(0,n.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.01968em"},children:"pl"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"e"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"t"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"o"}),(0,n.jsx)(a.span,{className:"mopen",children:"("}),(0,n.jsx)(a.span,{className:"mord",children:"40"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"d"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"ia"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"s"}),(0,n.jsx)(a.span,{className:"mclose",children:")"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"a"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"p"}),(0,n.jsx)(a.span,{className:"mord mathnormal",style:{marginRight:"0.02778em"},children:"r"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"o"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"x"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"ima"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"d"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"am"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"e"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"n"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"t"}),(0,n.jsx)(a.span,{className:"mord mathnormal",children:"e"}),(0,n.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}}),(0,n.jsx)(a.span,{className:"mbin",children:"\u2217"}),(0,n.jsx)(a.span,{className:"mspace",style:{marginRight:"0.2222em"}})]}),(0,n.jsxs)(a.span,{className:"base",children:[(0,n.jsx)(a.span,{className:"strut",style:{height:"0.4653em"}}),(0,n.jsx)(a.span,{className:"mord",children:"\u2217"})]})]})]}),"150.000"]}),"."]}),"\n",(0,n.jsx)(a.p,{children:"Nota: Esta \xe9 uma estimativa de 2017, a DeepMind como subsidi\xe1ria do Google pode ter descontos internos."}),"\n",(0,n.jsx)(a.h3,{id:"compara\xe7\xe3o-com-treinamento-humano",children:"Compara\xe7\xe3o com Treinamento Humano"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Aspecto"}),(0,n.jsx)(a.th,{children:"AlphaGo Zero"}),(0,n.jsx)(a.th,{children:"Jogador profissional humano"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Tempo para n\xedvel profissional"}),(0,n.jsx)(a.td,{children:"2 dias"}),(0,n.jsx)(a.td,{children:"10-15 anos"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Custo de treinamento"}),(0,n.jsx)(a.td,{children:"~$7.500"}),(0,n.jsx)(a.td,{children:"Milh\xf5es (mensalidades, custo de vida, custo de oportunidade)"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Custos cont\xednuos"}),(0,n.jsx)(a.td,{children:"Eletricidade"}),(0,n.jsx)(a.td,{children:"Custo de vida"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Replicabilidade"}),(0,n.jsx)(a.td,{children:"R\xe9plica perfeita"}),(0,n.jsx)(a.td,{children:"N\xe3o replic\xe1vel"})]})]})]}),"\n",(0,n.jsx)(a.p,{children:"Claro, esta compara\xe7\xe3o n\xe3o \xe9 totalmente justa \u2014 os humanos aprendem muito mais do que apenas Go durante seu treinamento."}),"\n",(0,n.jsx)(a.h3,{id:"custos-de-infer\xeancia",children:"Custos de Infer\xeancia"}),"\n",(0,n.jsx)(a.p,{children:"Custos de infer\xeancia em partidas oficiais:"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Configura\xe7\xe3o"}),(0,n.jsx)(a.th,{children:"Custo por jogo"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"48 TPU (AlphaGo Lee)"}),(0,n.jsx)(a.td,{children:"~$500"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"4 TPU (AlphaGo Zero)"}),(0,n.jsx)(a.td,{children:"~$50"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"GPU \xfanica (KataGo)"}),(0,n.jsx)(a.td,{children:"~$1"})]})]})]}),"\n",(0,n.jsx)(a.p,{children:"Os custos de infer\xeancia diminu\xedram significativamente com o avan\xe7o tecnol\xf3gico."}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h2,{id:"evolu\xe7\xe3o-tecnol\xf3gica",children:"Evolu\xe7\xe3o Tecnol\xf3gica"}),"\n",(0,n.jsx)(a.h3,{id:"de-alphago-a-alphazero",children:"De AlphaGo a AlphaZero"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Aspecto"}),(0,n.jsx)(a.th,{children:"AlphaGo Lee"}),(0,n.jsx)(a.th,{children:"AlphaGo Zero"}),(0,n.jsx)(a.th,{children:"AlphaZero"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"TPU de treinamento"}),(0,n.jsx)(a.td,{children:"50+ GPU \u2192 TPU"}),(0,n.jsx)(a.td,{children:"4 TPU"}),(0,n.jsx)(a.td,{children:"4 TPU"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"TPU de infer\xeancia"}),(0,n.jsx)(a.td,{children:"48 TPU"}),(0,n.jsx)(a.td,{children:"4 TPU"}),(0,n.jsx)(a.td,{children:"4 TPU"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"MCTS/jogada"}),(0,n.jsx)(a.td,{children:"~100.000"}),(0,n.jsx)(a.td,{children:"~1.600"}),(0,n.jsx)(a.td,{children:"~800"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Tempo de treinamento"}),(0,n.jsx)(a.td,{children:"Meses"}),(0,n.jsx)(a.td,{children:"40 dias"}),(0,n.jsx)(a.td,{children:"Horas a dias"})]})]})]}),"\n",(0,n.jsx)(a.p,{children:"Melhoria de efici\xeancia de aproximadamente 100 vezes."}),"\n",(0,n.jsx)(a.h3,{id:"impacto-na-comunidade-open-source",children:"Impacto na Comunidade Open Source"}),"\n",(0,n.jsx)(a.p,{children:"A arquitetura do AlphaGo inspirou m\xfaltiplos projetos open source:"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"Projeto"}),(0,n.jsx)(a.th,{children:"Caracter\xedsticas"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Leela Zero"}),(0,n.jsx)(a.td,{children:"Treinamento distribu\xeddo comunit\xe1rio, replica AlphaGo Zero"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"KataGo"}),(0,n.jsx)(a.td,{children:"Treinamento eficiente em GPU \xfanica, supera AlphaGo Zero"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"ELF OpenGo"}),(0,n.jsx)(a.td,{children:"Open source do Facebook, usa PyTorch"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"Minigo"}),(0,n.jsx)(a.td,{children:"Open source do Google, usa TensorFlow"})]})]})]}),"\n",(0,n.jsx)(a.p,{children:"Esses projetos permitem que pesquisadores comuns tamb\xe9m possam treinar IAs de Go poderosas."}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h2,{id:"correspond\xeancia-com-anima\xe7\xf5es",children:"Correspond\xeancia com Anima\xe7\xf5es"}),"\n",(0,n.jsx)(a.p,{children:"Os conceitos principais deste artigo e n\xfameros de anima\xe7\xe3o correspondentes:"}),"\n",(0,n.jsxs)(a.table,{children:[(0,n.jsx)(a.thead,{children:(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.th,{children:"N\xfamero"}),(0,n.jsx)(a.th,{children:"Conceito"}),(0,n.jsx)(a.th,{children:"Correspond\xeancia F\xedsica/Matem\xe1tica"})]})}),(0,n.jsxs)(a.tbody,{children:[(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"\ud83c\udfac C9"}),(0,n.jsx)(a.td,{children:"MCTS paralelo"}),(0,n.jsx)(a.td,{children:"Problema de N-corpos"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"\ud83c\udfac E9"}),(0,n.jsx)(a.td,{children:"Treinamento distribu\xeddo"}),(0,n.jsx)(a.td,{children:"Computa\xe7\xe3o distribu\xedda"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"\ud83c\udfac C5"}),(0,n.jsx)(a.td,{children:"Perda virtual"}),(0,n.jsx)(a.td,{children:"Potencial de repuls\xe3o"})]}),(0,n.jsxs)(a.tr,{children:[(0,n.jsx)(a.td,{children:"\ud83c\udfac D15"}),(0,n.jsx)(a.td,{children:"Infer\xeancia em batch"}),(0,n.jsx)(a.td,{children:"Computa\xe7\xe3o vetorizada"})]})]})]}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h2,{id:"leitura-adicional",children:"Leitura Adicional"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Artigo anterior"}),": ",(0,n.jsx)(a.a,{href:"../training-from-scratch",children:"O Processo de Treinamento do Zero"})," \u2014 An\xe1lise detalhada da curva de treinamento"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Pr\xf3ximo artigo"}),": ",(0,n.jsx)(a.a,{href:"../legacy-and-impact",children:"O Legado do AlphaGo"})," \u2014 O impacto profundo do AlphaGo no campo da IA"]}),"\n",(0,n.jsxs)(a.li,{children:[(0,n.jsx)(a.strong,{children:"Artigo relacionado"}),": ",(0,n.jsx)(a.a,{href:"../mcts-neural-combo",children:"A Combina\xe7\xe3o de MCTS e Redes Neurais"})," \u2014 Conhecimentos b\xe1sicos de MCTS"]}),"\n"]}),"\n",(0,n.jsx)(a.hr,{}),"\n",(0,n.jsx)(a.h2,{id:"refer\xeancias",children:"Refer\xeancias"}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:['Silver, D., et al. (2017). "Mastering the game of Go without human knowledge." ',(0,n.jsx)(a.em,{children:"Nature"}),", 550, 354-359."]}),"\n",(0,n.jsxs)(a.li,{children:['Jouppi, N., et al. (2017). "In-Datacenter Performance Analysis of a Tensor Processing Unit." ',(0,n.jsx)(a.em,{children:"ISCA 2017"}),"."]}),"\n",(0,n.jsxs)(a.li,{children:['Dean, J., et al. (2012). "Large Scale Distributed Deep Networks." ',(0,n.jsx)(a.em,{children:"NeurIPS 2012"}),"."]}),"\n",(0,n.jsxs)(a.li,{children:['Chaslot, G., et al. (2008). "Parallel Monte-Carlo Tree Search." ',(0,n.jsx)(a.em,{children:"CIG 2008"}),"."]}),"\n",(0,n.jsxs)(a.li,{children:['Segal, R. (2010). "On the Scalability of Parallel UCT." ',(0,n.jsx)(a.em,{children:"CIG 2010"}),"."]}),"\n"]})]})}function h(e={}){const{wrapper:a}={...(0,i.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},30416(e,a,r){r.d(a,{R:()=>d,x:()=>l});var s=r(59471);const n={},i=s.createContext(n);function d(e){const a=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function l(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:d(e.components),s.createElement(i.Provider,{value:a},e.children)}}}]);