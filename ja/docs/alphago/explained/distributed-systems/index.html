<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-alphago/explained/distributed-systems" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">分散システムと TPU | 好棋寶寶協會 | Weiqi.Kids</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://www.weiqi.kids/ja/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://www.weiqi.kids/ja/img/social-card.png"><meta data-rh="true" property="og:url" content="https://www.weiqi.kids/ja/docs/alphago/explained/distributed-systems/"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" property="og:locale:alternate" content="zh_tw"><meta data-rh="true" property="og:locale:alternate" content="zh_cn"><meta data-rh="true" property="og:locale:alternate" content="zh_hk"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" property="og:locale:alternate" content="ko"><meta data-rh="true" property="og:locale:alternate" content="es"><meta data-rh="true" property="og:locale:alternate" content="pt"><meta data-rh="true" property="og:locale:alternate" content="hi"><meta data-rh="true" property="og:locale:alternate" content="id"><meta data-rh="true" property="og:locale:alternate" content="ar"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="分散システムと TPU | 好棋寶寶協會 | Weiqi.Kids"><meta data-rh="true" name="description" content="AlphaGo の分散学習アーキテクチャ、TPU アクセラレーション、大規模並列 MCTS を詳しく解説"><meta data-rh="true" property="og:description" content="AlphaGo の分散学習アーキテクチャ、TPU アクセラレーション、大規模並列 MCTS を詳しく解説"><meta data-rh="true" name="keywords" content="分散システム,TPU,並列計算,MCTS,仮想損失,深層学習,ハードウェアアクセラレーション"><link data-rh="true" rel="icon" href="/ja/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://www.weiqi.kids/ja/docs/alphago/explained/distributed-systems/"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/docs/alphago/explained/distributed-systems/" hreflang="zh-tw"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/zh-cn/docs/alphago/explained/distributed-systems/" hreflang="zh-cn"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/zh-hk/docs/alphago/explained/distributed-systems/" hreflang="zh-hk"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/en/docs/alphago/explained/distributed-systems/" hreflang="en"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/ja/docs/alphago/explained/distributed-systems/" hreflang="ja"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/ko/docs/alphago/explained/distributed-systems/" hreflang="ko"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/es/docs/alphago/explained/distributed-systems/" hreflang="es"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/pt/docs/alphago/explained/distributed-systems/" hreflang="pt"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/hi/docs/alphago/explained/distributed-systems/" hreflang="hi"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/id/docs/alphago/explained/distributed-systems/" hreflang="id"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/ar/docs/alphago/explained/distributed-systems/" hreflang="ar"><link data-rh="true" rel="alternate" href="https://www.weiqi.kids/docs/alphago/explained/distributed-systems/" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@graph":[{"@type":"Organization","@id":"https://www.weiqi.kids#organization","name":"台灣好棋寶寶協會","alternateName":"Taiwan Good Go Baby Association","url":"https://www.weiqi.kids","logo":{"@type":"ImageObject","url":"https://www.weiqi.kids/img/logo.svg","width":200,"height":200},"sameAs":["https://mastodon.weiqi.kids/","https://peertube.weiqi.kids/"],"contactPoint":{"@type":"ContactPoint","contactType":"customer service","url":"https://www.weiqi.kids/docs/aboutus"},"description":"推動圍棋文化與 AI 研究的台灣非營利組織"},{"@type":"WebSite","@id":"https://www.weiqi.kids#website","name":"好棋寶寶協會官網","url":"https://www.weiqi.kids","publisher":{"@id":"https://www.weiqi.kids#organization"},"inLanguage":["zh-TW","zh-CN","zh-HK","en","ja","ko","es","pt","hi","id","ar"],"potentialAction":{"@type":"SearchAction","target":{"@type":"EntryPoint","urlTemplate":"https://www.weiqi.kids/search?q={search_term_string}"},"query-input":"required name=search_term_string"}}]}</script><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"AlphaGo","item":"https://www.weiqi.kids/ja/docs/alphago/"},{"@type":"ListItem","position":2,"name":"完整解析","item":"https://www.weiqi.kids/ja/docs/alphago/explained/"},{"@type":"ListItem","position":3,"name":"分散システムと TPU","item":"https://www.weiqi.kids/ja/docs/alphago/explained/distributed-systems"}]}</script><meta property="og:type" content="website">
<meta property="og:site_name" content="好棋寶寶協會">
<meta name="twitter:card" content="summary_large_image">
<meta name="robots" content="index, follow">
<meta name="author" content="台灣好棋寶寶協會">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous"><link rel="stylesheet" href="/ja/assets/css/styles.f23bf74b.css">
<script src="/ja/assets/js/runtime~main.a1068d2c.js" defer="defer"></script>
<script src="/ja/assets/js/main.d9aeac32.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>document.documentElement.setAttribute("data-theme","light"),document.documentElement.setAttribute("data-theme-choice","light"),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/ja/img/logo.svg"><div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_WWLT" href="#__docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="ナビゲーション" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="ナビゲーションバーを開く" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ja/"><div class="navbar__logo"><img src="/ja/img/logo.svg" alt="好棋宝宝協会ロゴ" class="themedComponent_rBb5 themedComponent--light_t3c2"><img src="/ja/img/logo.svg" alt="好棋宝宝協会ロゴ" class="themedComponent_rBb5 themedComponent--dark_Z76H"></div><b class="navbar__title text--truncate">囲碁キッズ</b></a><a class="navbar__item navbar__link" href="/ja/docs/learn/">囲碁を学ぶ</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/ja/docs/alphago/">AlphaGo</a><a class="navbar__item navbar__link" href="/ja/docs/animations/">アニメ教室</a><a class="navbar__item navbar__link" href="/ja/docs/tech/">技術ドキュメント</a><a class="navbar__item navbar__link" href="/ja/docs/about/">私たちについて</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link navbar__item--compact"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_LXmZ"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>日本語</a><ul class="dropdown__menu"><li><a href="/docs/alphago/explained/distributed-systems/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-tw">繁體中文</a></li><li><a href="/zh-cn/docs/alphago/explained/distributed-systems/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-cn">简体中文</a></li><li><a href="/zh-hk/docs/alphago/explained/distributed-systems/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="zh-hk">粵語（香港）</a></li><li><a href="/en/docs/alphago/explained/distributed-systems/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/ja/docs/alphago/explained/distributed-systems/" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ja">日本語</a></li><li><a href="/ko/docs/alphago/explained/distributed-systems/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ko">한국어</a></li><li><a href="/es/docs/alphago/explained/distributed-systems/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="es">Español</a></li><li><a href="/pt/docs/alphago/explained/distributed-systems/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="pt">Português</a></li><li><a href="/hi/docs/alphago/explained/distributed-systems/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="hi">हिन्दी</a></li><li><a href="/id/docs/alphago/explained/distributed-systems/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="id">Bahasa Indonesia</a></li><li><a href="/ar/docs/alphago/explained/distributed-systems/" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="ar">العربية</a></li></ul></div><a href="https://github.com/weiqi-kids/www.weiqi.kids" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link navbar__item--compact" aria-label="GitHub"></a><div class="navbarSearchContainer_MDM0"><div class="navbar__search searchBarContainer_Qpyg" dir="ltr"><input placeholder="検索" aria-label="Search" class="navbar__search-input searchInput_KBva" value=""><div class="loadingRing_riNO searchBarLoadingRing_XquT"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_SQvo"><div class="docsWrapper_HjTU"><button aria-label="先頭へ戻る" class="clean-btn theme-back-to-top-button backToTopButton_91RE" type="button"></button><div class="docRoot_SzOB"><aside class="theme-doc-sidebar-container docSidebarContainer_Q0cb"><div class="sidebarViewport_TEb6"><div class="sidebar_LiQ3"><nav aria-label="ドキュメントのサイドバー" class="menu thin-scrollbar menu_iDgU"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/docs/intro/"><span title="ご利用ガイド" class="linkLabel_REp1">ご利用ガイド</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_nItb menu__link menu__link--sublist" href="/ja/docs/learn/"><span title="學圍棋" class="categoryLinkLabel_ezQx">學圍棋</span></a><button aria-label="&#x27;學圍棋&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_nItb menu__link menu__link--sublist menu__link--active" href="/ja/docs/alphago/"><span title="AlphaGo" class="categoryLinkLabel_ezQx">AlphaGo</span></a><button aria-label="&#x27;AlphaGo&#x27;の目次を隠す" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_nItb menu__link menu__link--sublist menu__link--active" tabindex="0" href="/ja/docs/alphago/explained/"><span title="完整解析" class="categoryLinkLabel_ezQx">完整解析</span></a><button aria-label="&#x27;完整解析&#x27;の目次を隠す" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/birth-of-alphago/"><span title="AlphaGo の誕生" class="linkLabel_REp1">AlphaGo の誕生</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/key-matches/"><span title="重要対局の回顧" class="linkLabel_REp1">重要対局の回顧</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/move-37/"><span title="「神の一手」徹底分析" class="linkLabel_REp1">「神の一手」徹底分析</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/why-go-is-hard/"><span title="囲碁はなぜ難しいのか？" class="linkLabel_REp1">囲碁はなぜ難しいのか？</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/traditional-limits/"><span title="従来手法の限界" class="linkLabel_REp1">従来手法の限界</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/board-representation/"><span title="盤面状態の表現" class="linkLabel_REp1">盤面状態の表現</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/policy-network/"><span title="Policy Network 詳解" class="linkLabel_REp1">Policy Network 詳解</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/value-network/"><span title="Value Network 詳解" class="linkLabel_REp1">Value Network 詳解</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/input-features/"><span title="入力特徴量の設計" class="linkLabel_REp1">入力特徴量の設計</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/cnn-and-go/"><span title="CNNと囲碁の融合" class="linkLabel_REp1">CNNと囲碁の融合</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/supervised-learning/"><span title="教師あり学習フェーズ" class="linkLabel_REp1">教師あり学習フェーズ</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/reinforcement-intro/"><span title="強化学習入門" class="linkLabel_REp1">強化学習入門</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/self-play/"><span title="自己対局" class="linkLabel_REp1">自己対局</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/mcts-neural-combo/"><span title="MCTS とニューラルネットワークの融合" class="linkLabel_REp1">MCTS とニューラルネットワークの融合</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/puct-formula/"><span title="PUCT 公式詳解" class="linkLabel_REp1">PUCT 公式詳解</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/alphago-zero/"><span title="AlphaGo Zero 概要" class="linkLabel_REp1">AlphaGo Zero 概要</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/dual-head-resnet/"><span title="デュアルヘッドネットワークと残差ネットワーク" class="linkLabel_REp1">デュアルヘッドネットワークと残差ネットワーク</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/training-from-scratch/"><span title="ゼロからの学習過程" class="linkLabel_REp1">ゼロからの学習過程</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ja/docs/alphago/explained/distributed-systems/"><span title="分散システムと TPU" class="linkLabel_REp1">分散システムと TPU</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/alphago/explained/legacy-and-impact/"><span title="AlphaGo の遺産" class="linkLabel_REp1">AlphaGo の遺産</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/docs/animations/"><span title="動畫教室" class="linkLabel_REp1">動畫教室</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_nItb menu__link menu__link--sublist" href="/ja/docs/tech/"><span title="技術文件" class="categoryLinkLabel_ezQx">技術文件</span></a><button aria-label="&#x27;技術文件&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_nItb menu__link menu__link--sublist" href="/ja/docs/about/"><span title="關於我們" class="categoryLinkLabel_ezQx">關於我們</span></a><button aria-label="&#x27;關於我們&#x27;の目次を開く" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_C0wL"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_txwF"><div class="docItemContainer_FUEM"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_DlgT" aria-label="パンくずリストのナビゲーション"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="ホームページ" class="breadcrumbs__link" href="/ja/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_BMIH"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/ja/docs/alphago/"><span>AlphaGo</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/ja/docs/alphago/explained/"><span>完整解析</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">分散システムと TPU</span></li></ul></nav><div class="tocCollapsible_LBsY theme-doc-toc-mobile tocMobile_eMWB"><button type="button" class="clean-btn tocCollapsibleButton_fVBn">このページの見出し</button></div><div class="theme-doc-markdown markdown"><header><h1>分散システムと TPU</h1></header>
<p>AlphaGo の成功は、アルゴリズムの勝利だけでなく、エンジニアリングの勝利でもあります。合理的な時間内に人類を超える囲碁 AI を学習させるには、精巧に設計された分散システムと専用ハードウェアのサポートが必要です。</p>
<p>本記事では、AlphaGo を支えるシステムアーキテクチャを詳しく解説します。学習フロー、推論アーキテクチャ、並列 MCTS、そして TPU の重要な役割について説明します。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="学習アーキテクチャの概要">学習アーキテクチャの概要<a href="#学習アーキテクチャの概要" class="hash-link" aria-label="学習アーキテクチャの概要 への直接リンク" title="学習アーキテクチャの概要 への直接リンク" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="オリジナル-alphago-の学習アーキテクチャ">オリジナル AlphaGo の学習アーキテクチャ<a href="#オリジナル-alphago-の学習アーキテクチャ" class="hash-link" aria-label="オリジナル AlphaGo の学習アーキテクチャ への直接リンク" title="オリジナル AlphaGo の学習アーキテクチャ への直接リンク" translate="no">​</a></h3>
<p>オリジナル AlphaGo（李世乭を破ったバージョン）の学習は複数の段階に分かれ、各段階で異なるリソース構成を使用しました：</p>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="alphago-zero-の学習アーキテクチャ">AlphaGo Zero の学習アーキテクチャ<a href="#alphago-zero-の学習アーキテクチャ" class="hash-link" aria-label="AlphaGo Zero の学習アーキテクチャ への直接リンク" title="AlphaGo Zero の学習アーキテクチャ への直接リンク" translate="no">​</a></h3>
<p>AlphaGo Zero は学習フローを大幅に簡略化し、単一のエンドツーエンド学習ループを使用しました：</p>
<!-- -->
<p>このアーキテクチャの利点：</p>
<ol>
<li class=""><strong>継続的学習</strong>：Self-play と Training が同時に進行し、待機が不要</li>
<li class=""><strong>リソース効率</strong>：すべてのリソースが有用な作業を行う</li>
<li class=""><strong>高速イテレーション</strong>：ネットワーク更新後、すぐに新しいデータの生成に使用</li>
</ol>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="自己対局ワーカーself-play-workers">自己対局ワーカー（Self-play Workers）<a href="#自己対局ワーカーself-play-workers" class="hash-link" aria-label="自己対局ワーカー（Self-play Workers） への直接リンク" title="自己対局ワーカー（Self-play Workers） への直接リンク" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="タスク割り当て">タスク割り当て<a href="#タスク割り当て" class="hash-link" aria-label="タスク割り当て への直接リンク" title="タスク割り当て への直接リンク" translate="no">​</a></h3>
<p>Self-play Workers は、現在最強のネットワークを使用して自己対局を行い、学習データを生成します。</p>
<table><thead><tr><th>構成</th><th>AlphaGo Zero</th></tr></thead><tbody><tr><td>Worker 数</td><td>数十個</td></tr><tr><td>各 Worker</td><td>1-4 TPU</td></tr><tr><td>各局の MCTS</td><td>1600 回シミュレーション</td></tr><tr><td>1日の生成数</td><td>~100,000 局</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="ワークフロー">ワークフロー<a href="#ワークフロー" class="hash-link" aria-label="ワークフロー への直接リンク" title="ワークフロー への直接リンク" translate="no">​</a></h3>
<p>各 Self-play Worker のワークフロー：</p>
<div class="language-python codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-python codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">True</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 1. 最新のネットワーク重みをダウンロード</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    network </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> download_latest_checkpoint</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># 2. 複数局の自己対局を実行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> game </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token builtin">range</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">batch_size</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        positions </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        board </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> EmptyBoard</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">not</span><span class="token plain"> board</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">is_terminal</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># MCTS を実行</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            mcts </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> MCTS</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">network</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> board</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            policy </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> mcts</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">search</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">num_simulations</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">1600</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 着手を選択</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            action </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sample</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">policy</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 記録</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            positions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">append</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">board</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> policy</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token comment" style="color:#999988;font-style:italic"># 着手</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            board </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> board</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">play</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">action</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 3. 勝敗結果を取得</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> board</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">get_result</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token comment" style="color:#999988;font-style:italic"># 4. データをアップロード</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        upload_to_replay_buffer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">positions</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> result</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="負荷分散">負荷分散<a href="#負荷分散" class="hash-link" aria-label="負荷分散 への直接リンク" title="負荷分散 への直接リンク" translate="no">​</a></h3>
<p>複数の Worker には負荷分散が必要です：</p>
<ul>
<li class=""><strong>ネットワーク同期</strong>：すべての Worker が同じバージョンのネットワークを使用</li>
<li class=""><strong>データバランス</strong>：異なる Worker のデータがすべて使用されることを保証</li>
<li class=""><strong>フォールトトレランス</strong>：単一の Worker の障害が全体の学習に影響しない</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="学習ワーカーtraining-workers">学習ワーカー（Training Workers）<a href="#学習ワーカーtraining-workers" class="hash-link" aria-label="学習ワーカー（Training Workers） への直接リンク" title="学習ワーカー（Training Workers） への直接リンク" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="タスク割り当て-1">タスク割り当て<a href="#タスク割り当て-1" class="hash-link" aria-label="タスク割り当て への直接リンク" title="タスク割り当て への直接リンク" translate="no">​</a></h3>
<p>Training Workers は Replay Buffer からデータをサンプリングし、ニューラルネットワークを学習します。</p>
<table><thead><tr><th>構成</th><th>AlphaGo Zero</th></tr></thead><tbody><tr><td>Worker 数</td><td>1-4</td></tr><tr><td>各 Worker</td><td>4 TPU</td></tr><tr><td>Batch Size</td><td>2048（各 TPU 512）</td></tr><tr><td>学習ステップ</td><td>毎日数万ステップ</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="分散学習">分散学習<a href="#分散学習" class="hash-link" aria-label="分散学習 への直接リンク" title="分散学習 への直接リンク" translate="no">​</a></h3>
<p>大規模学習では**データ並列（Data Parallelism）**を使用します：</p>
<!-- -->
<p>各 TPU は異なる mini-batch を処理し、ローカル勾配を計算し、その後グローバルパラメータを集約更新します。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="同期-vs-非同期更新">同期 vs. 非同期更新<a href="#同期-vs-非同期更新" class="hash-link" aria-label="同期 vs. 非同期更新 への直接リンク" title="同期 vs. 非同期更新 への直接リンク" translate="no">​</a></h3>
<table><thead><tr><th>更新方式</th><th>利点</th><th>欠点</th></tr></thead><tbody><tr><td>同期</td><td>安定、再現可能</td><td>Worker が最も遅いものを待つ必要がある</td></tr><tr><td>非同期</td><td>スループットが高い</td><td>勾配が古くなる可能性</td></tr></tbody></table>
<p>AlphaGo Zero は<strong>同期更新</strong>を使用し、学習の安定性を確保しました。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="tpu-の役割">TPU の役割<a href="#tpu-の役割" class="hash-link" aria-label="TPU の役割 への直接リンク" title="TPU の役割 への直接リンク" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="tpu-とは">TPU とは？<a href="#tpu-とは" class="hash-link" aria-label="TPU とは？ への直接リンク" title="TPU とは？ への直接リンク" translate="no">​</a></h3>
<p><strong>TPU（Tensor Processing Unit）</strong> は Google が深層学習専用に設計したアクセラレータです：</p>
<table><thead><tr><th>特性</th><th>TPU</th><th>GPU</th><th>CPU</th></tr></thead><tbody><tr><td>設計目標</td><td>行列演算</td><td>汎用並列</td><td>汎用計算</td></tr><tr><td>精度</td><td>FP16/BF16 最適化</td><td>FP32/FP16</td><td>FP64/FP32</td></tr><tr><td>消費電力</td><td>比較的低い</td><td>高い</td><td>最も高い</td></tr><tr><td>レイテンシ</td><td>低い</td><td>中程度</td><td>高い</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="tpu-のアーキテクチャ">TPU のアーキテクチャ<a href="#tpu-のアーキテクチャ" class="hash-link" aria-label="TPU のアーキテクチャ への直接リンク" title="TPU のアーキテクチャ への直接リンク" translate="no">​</a></h3>
<p>TPU の核心は <strong>MXU（Matrix Multiply Unit）</strong> です：</p>
<!-- -->
<p>MXU は各サイクルで 16K 回の乗加算演算を実行でき、ニューラルネットワークの行列乗算にとって極めて重要です。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="なぜ-alphago-は-tpu-を必要とするのか">なぜ AlphaGo は TPU を必要とするのか？<a href="#なぜ-alphago-は-tpu-を必要とするのか" class="hash-link" aria-label="なぜ AlphaGo は TPU を必要とするのか？ への直接リンク" title="なぜ AlphaGo は TPU を必要とするのか？ への直接リンク" translate="no">​</a></h3>
<p>囲碁 AI の計算ボトルネックは<strong>ニューラルネットワーク推論</strong>です：</p>
<table><thead><tr><th>操作</th><th>割合</th></tr></thead><tbody><tr><td>ニューラルネットワーク順伝播</td><td>~95%</td></tr><tr><td>MCTS ツリー操作</td><td>~4%</td></tr><tr><td>その他</td><td>~1%</td></tr></tbody></table>
<p>各手の MCTS には 1600 回のニューラルネットワーク推論が必要です。TPU の高スループットがこれを可能にしました。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="tpu-使用の進化">TPU 使用の進化<a href="#tpu-使用の進化" class="hash-link" aria-label="TPU 使用の進化 への直接リンク" title="TPU 使用の進化 への直接リンク" translate="no">​</a></h3>
<table><thead><tr><th>バージョン</th><th>学習 TPU</th><th>推論 TPU</th></tr></thead><tbody><tr><td>AlphaGo Lee</td><td>50 GPU</td><td>48 TPU（v1）</td></tr><tr><td>AlphaGo Master</td><td>4 TPU（v2）</td><td>4 TPU（v2）</td></tr><tr><td>AlphaGo Zero</td><td>4 TPU（v2）</td><td>4 TPU（v2）（スケーラブル）</td></tr></tbody></table>
<p>AlphaGo Zero は使用する TPU 数が大幅に減少しました。これはより効率的なアーキテクチャと新しい TPU バージョンのおかげです。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="並列-mcts-と仮想損失">並列 MCTS と仮想損失<a href="#並列-mcts-と仮想損失" class="hash-link" aria-label="並列 MCTS と仮想損失 への直接リンク" title="並列 MCTS と仮想損失 への直接リンク" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="並列化の課題">並列化の課題<a href="#並列化の課題" class="hash-link" aria-label="並列化の課題 への直接リンク" title="並列化の課題 への直接リンク" translate="no">​</a></h3>
<p>MCTS の標準実装は<strong>シリアル</strong>です：</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">for i in range(num_simulations):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    1. Selection：ルートから下に選択</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    2. Expansion：リーフノードを展開</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    3. Evaluation：ニューラルネットワーク評価</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    4. Backup：逆伝播で更新</span><br></span></code></pre></div></div>
<p>しかしニューラルネットワーク評価は GPU/TPU フレンドリーな<strong>バッチ処理</strong>です。複数のシミュレーションを同時に行うにはどうすればよいでしょうか？</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="リーフ並列化leaf-parallelization">リーフ並列化（Leaf Parallelization）<a href="#リーフ並列化leaf-parallelization" class="hash-link" aria-label="リーフ並列化（Leaf Parallelization） への直接リンク" title="リーフ並列化（Leaf Parallelization） への直接リンク" translate="no">​</a></h3>
<p>最も単純な並列化方式：複数の完全なシミュレーションを同時に実行し、最後に結果をマージします。</p>
<!-- -->
<p>問題：各シミュレーションがルートから始まるため、同じパスを繰り返し探索してしまいます。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="仮想損失virtual-loss">仮想損失（Virtual Loss）<a href="#仮想損失virtual-loss" class="hash-link" aria-label="仮想損失（Virtual Loss） への直接リンク" title="仮想損失（Virtual Loss） への直接リンク" translate="no">​</a></h3>
<p>DeepMind はツリー並列化（Tree Parallelization）を実現するために<strong>仮想損失</strong>技術を採用しました。</p>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="基本概念">基本概念<a href="#基本概念" class="hash-link" aria-label="基本概念 への直接リンク" title="基本概念 への直接リンク" translate="no">​</a></h4>
<p>あるスレッドがあるノードを探索中の時、そのノードの価値を一時的に下げ、他のスレッドが別のパスを選択するようにします。</p>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">通常の UCB：Q(s,a) + c * P(s,a) * sqrt(N(s)) / (1 + N(s,a))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">仮想損失を加えた後：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">(Q(s,a) * N(s,a) - v * n_virtual) / (N(s,a) + n_virtual) + c * P(s,a) * sqrt(N(s)) / (1 + N(s,a) + n_virtual)</span><br></span></code></pre></div></div>
<p>ここで：</p>
<ul>
<li class=""><code>n_virtual</code> はそのノードを探索中のスレッド数</li>
<li class=""><code>v</code> は仮想損失の値（通常 1 または勝率に対応する値）</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="動作フロー">動作フロー<a href="#動作フロー" class="hash-link" aria-label="動作フロー への直接リンク" title="動作フロー への直接リンク" translate="no">​</a></h4>
<div class="language-text codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-text codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">時間 T1：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Thread 1 がパス A → B → C を選択</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ノード C に仮想損失 -1 を付与</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">時間 T2：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Thread 2 がパス A → B → D を選択（C が「ペナルティ」を受けているため）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ノード D に仮想損失 -1 を付与</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">時間 T3：</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Thread 1 が評価を完了し、C の実際の値を更新し、仮想損失を除去</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Thread 3 は今 C を選択する可能性がある（実際の値が十分良ければ）</span><br></span></code></pre></div></div>
<h4 class="anchor anchorTargetStickyNavbar_l_sM" id="仮想損失の効果">仮想損失の効果<a href="#仮想損失の効果" class="hash-link" aria-label="仮想損失の効果 への直接リンク" title="仮想損失の効果 への直接リンク" translate="no">​</a></h4>
<table><thead><tr><th>側面</th><th>効果</th></tr></thead><tbody><tr><td>探索の多様性</td><td>異なるパスの探索を強制</td></tr><tr><td>バッチ効率</td><td>複数のリーフノードを同時に評価可能</td></tr><tr><td>収束性</td><td>仮想損失は最終的に真の値で上書きされ、収束に影響しない</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="バッチニューラルネットワーク評価">バッチニューラルネットワーク評価<a href="#バッチニューラルネットワーク評価" class="hash-link" aria-label="バッチニューラルネットワーク評価 への直接リンク" title="バッチニューラルネットワーク評価 への直接リンク" translate="no">​</a></h3>
<p>仮想損失により、評価待ちの複数のリーフノードを収集し、<strong>バッチ推論</strong>を行えます：</p>
<!-- -->
<p>TPU のバッチ推論効率は個別推論よりはるかに高く、並列 MCTS を可能にしました。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="推論アーキテクチャ">推論アーキテクチャ<a href="#推論アーキテクチャ" class="hash-link" aria-label="推論アーキテクチャ への直接リンク" title="推論アーキテクチャ への直接リンク" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="対局時の構成">対局時の構成<a href="#対局時の構成" class="hash-link" aria-label="対局時の構成 への直接リンク" title="対局時の構成 への直接リンク" translate="no">​</a></h3>
<p>AlphaGo の公式対局時の推論アーキテクチャ：</p>
<table><thead><tr><th>バージョン</th><th>ハードウェア構成</th></tr></thead><tbody><tr><td>AlphaGo Fan</td><td>176 GPU</td></tr><tr><td>AlphaGo Lee</td><td>48 TPU + 複数サーバー</td></tr><tr><td>AlphaGo Master</td><td>4 TPU</td></tr><tr><td>AlphaGo Zero</td><td>4 TPU（スケーラブル）</td></tr></tbody></table>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="分散推論フロー">分散推論フロー<a href="#分散推論フロー" class="hash-link" aria-label="分散推論フロー への直接リンク" title="分散推論フロー への直接リンク" translate="no">​</a></h3>
<p>対局時の推論フロー（AlphaGo Lee を例に）：</p>
<!-- -->
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="思考時間管理">思考時間管理<a href="#思考時間管理" class="hash-link" aria-label="思考時間管理 への直接リンク" title="思考時間管理 への直接リンク" translate="no">​</a></h3>
<p>AlphaGo の時間管理戦略：</p>
<table><thead><tr><th>局面</th><th>思考時間</th><th>MCTS 回数</th></tr></thead><tbody><tr><td>序盤（定石あり）</td><td>短め</td><td>~10,000</td></tr><tr><td>中盤（複雑）</td><td>長め</td><td>~100,000</td></tr><tr><td>単純な局面</td><td>短め</td><td>~5,000</td></tr><tr><td>秒読み</td><td>固定</td><td>~1,600</td></tr></tbody></table>
<p>より多くの MCTS シミュレーションは通常、より良い着手の質を意味します。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="通信と同期">通信と同期<a href="#通信と同期" class="hash-link" aria-label="通信と同期 への直接リンク" title="通信と同期 への直接リンク" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="データ形式">データ形式<a href="#データ形式" class="hash-link" aria-label="データ形式 への直接リンク" title="データ形式 への直接リンク" translate="no">​</a></h3>
<p>学習データの転送形式：</p>
<div class="language-protobuf codeBlockContainer_huE5 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_oko_"><pre tabindex="0" class="prism-code language-protobuf codeBlock_BBgU thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_t9f9"><span class="token-line" style="color:#393A34"><span class="token plain">message TrainingExample {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 盤面状態（17 × 19 × 19）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repeated float board_planes = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // MCTS 探索結果（362）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    repeated float mcts_policy = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 勝敗結果（1 = 現在側の勝ち、-1 = 現在側の負け）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    float game_result = 3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="ネットワーク帯域幅要件">ネットワーク帯域幅要件<a href="#ネットワーク帯域幅要件" class="hash-link" aria-label="ネットワーク帯域幅要件 への直接リンク" title="ネットワーク帯域幅要件 への直接リンク" translate="no">​</a></h3>
<table><thead><tr><th>データフロー</th><th>サイズ</th><th>頻度</th></tr></thead><tbody><tr><td>学習サンプル</td><td>~10 KB/サンプル</td><td>毎秒数千サンプル</td></tr><tr><td>ネットワーク重み</td><td>~200 MB</td><td>毎時数回</td></tr><tr><td>制御メッセージ</td><td>&lt; 1 KB</td><td>継続的</td></tr></tbody></table>
<p>総帯域幅要件：~100 Mbps（内部ネットワークで十分）</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="障害処理">障害処理<a href="#障害処理" class="hash-link" aria-label="障害処理 への直接リンク" title="障害処理 への直接リンク" translate="no">​</a></h3>
<p>分散システムの障害処理：</p>
<table><thead><tr><th>障害タイプ</th><th>処理方法</th></tr></thead><tbody><tr><td>Worker ダウン</td><td>再起動し、最新の checkpoint から継続</td></tr><tr><td>ネットワーク切断</td><td>データをバッファリングし、再接続後に続けて転送</td></tr><tr><td>TPU 障害</td><td>自動的にバックアップ TPU に切り替え</td></tr><tr><td>データ破損</td><td>検証後に破棄し、再生成</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="コスト分析">コスト分析<a href="#コスト分析" class="hash-link" aria-label="コスト分析 への直接リンク" title="コスト分析 への直接リンク" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="ハードウェアコスト見積もり">ハードウェアコスト見積もり<a href="#ハードウェアコスト見積もり" class="hash-link" aria-label="ハードウェアコスト見積もり への直接リンク" title="ハードウェアコスト見積もり への直接リンク" translate="no">​</a></h3>
<p>Google Cloud の TPU 価格で AlphaGo Zero の学習コストを見積もり：</p>
<table><thead><tr><th>リソース</th><th>数量</th><th>単価/時間</th><th>総額/日</th></tr></thead><tbody><tr><td>TPU v2 Pod</td><td>4</td><td>~$32</td><td>~$3,000</td></tr><tr><td>大容量メモリ VM</td><td>数台</td><td>~$5</td><td>~$500</td></tr><tr><td>ストレージ</td><td>10 TB</td><td>~$0.02/GB</td><td>~$200</td></tr><tr><td>ネットワーク</td><td>-</td><td>含む</td><td>-</td></tr></tbody></table>
<p><strong>1日あたり約 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mo separator="true">,</mo><mn>700</mn><mo>∗</mo><mo>∗</mo><mtext>、完全な学習（</mtext><mn>40</mn><mtext>日）で約</mtext><mo>∗</mo><mo>∗</mo></mrow><annotation encoding="application/x-tex">3,700**、完全な学習（40日）で約 **</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em"></span><span class="mord">700</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.6833em"></span><span class="mord">∗</span><span class="mord cjk_fallback">、完全な学習（</span><span class="mord">40</span><span class="mord cjk_fallback">日）で約</span><span class="mspace" style="margin-right:0.2222em"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em"></span></span><span class="base"><span class="strut" style="height:0.4653em"></span><span class="mord">∗</span></span></span></span>150,000</strong>。</p>
<p>注意：これは 2017 年の見積もりで、DeepMind は Google の子会社として内部割引がある可能性があります。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="人間の学習との比較">人間の学習との比較<a href="#人間の学習との比較" class="hash-link" aria-label="人間の学習との比較 への直接リンク" title="人間の学習との比較 への直接リンク" translate="no">​</a></h3>
<table><thead><tr><th>側面</th><th>AlphaGo Zero</th><th>人間のプロ棋士</th></tr></thead><tbody><tr><td>プロレベル到達</td><td>2日</td><td>10-15年</td></tr><tr><td>学習コスト</td><td>~$7,500</td><td>数百万（学費、生活費、機会費用）</td></tr><tr><td>継続コスト</td><td>電気代</td><td>生活費</td></tr><tr><td>複製可能性</td><td>完璧に複製可能</td><td>複製不可能</td></tr></tbody></table>
<p>もちろん、この比較は完全に公平ではありません——人間は碁を学ぶ過程で囲碁だけでなく多くのことを学びます。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="推論コスト">推論コスト<a href="#推論コスト" class="hash-link" aria-label="推論コスト への直接リンク" title="推論コスト への直接リンク" translate="no">​</a></h3>
<p>公式対局の推論コスト：</p>
<table><thead><tr><th>構成</th><th>1局あたりのコスト</th></tr></thead><tbody><tr><td>48 TPU（AlphaGo Lee）</td><td>~$500</td></tr><tr><td>4 TPU（AlphaGo Zero）</td><td>~$50</td></tr><tr><td>単一 GPU（KataGo）</td><td>~$1</td></tr></tbody></table>
<p>推論コストは技術の進歩とともに大幅に低下しました。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="技術の進化">技術の進化<a href="#技術の進化" class="hash-link" aria-label="技術の進化 への直接リンク" title="技術の進化 への直接リンク" translate="no">​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="alphago-から-alphazero-へ">AlphaGo から AlphaZero へ<a href="#alphago-から-alphazero-へ" class="hash-link" aria-label="AlphaGo から AlphaZero へ への直接リンク" title="AlphaGo から AlphaZero へ への直接リンク" translate="no">​</a></h3>
<table><thead><tr><th>側面</th><th>AlphaGo Lee</th><th>AlphaGo Zero</th><th>AlphaZero</th></tr></thead><tbody><tr><td>学習 TPU</td><td>50+ GPU → TPU</td><td>4 TPU</td><td>4 TPU</td></tr><tr><td>推論 TPU</td><td>48 TPU</td><td>4 TPU</td><td>4 TPU</td></tr><tr><td>MCTS/手</td><td>~100,000</td><td>~1,600</td><td>~800</td></tr><tr><td>学習時間</td><td>数ヶ月</td><td>40日</td><td>数時間〜数日</td></tr></tbody></table>
<p>効率は約 100 倍向上しました。</p>
<h3 class="anchor anchorTargetStickyNavbar_l_sM" id="オープンソースコミュニティへの影響">オープンソースコミュニティへの影響<a href="#オープンソースコミュニティへの影響" class="hash-link" aria-label="オープンソースコミュニティへの影響 への直接リンク" title="オープンソースコミュニティへの影響 への直接リンク" translate="no">​</a></h3>
<p>AlphaGo のアーキテクチャは複数のオープンソースプロジェクトにインスピレーションを与えました：</p>
<table><thead><tr><th>プロジェクト</th><th>特徴</th></tr></thead><tbody><tr><td>Leela Zero</td><td>コミュニティ分散学習、AlphaGo Zero を再現</td></tr><tr><td>KataGo</td><td>単一 GPU 高効率学習、AlphaGo Zero を超越</td></tr><tr><td>ELF OpenGo</td><td>Facebook オープンソース、PyTorch 使用</td></tr><tr><td>Minigo</td><td>Google オープンソース、TensorFlow 使用</td></tr></tbody></table>
<p>これらのプロジェクトにより、一般の研究者も強力な囲碁 AI を学習できるようになりました。</p>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="アニメーション対応">アニメーション対応<a href="#アニメーション対応" class="hash-link" aria-label="アニメーション対応 への直接リンク" title="アニメーション対応 への直接リンク" translate="no">​</a></h2>
<p>本記事で扱った核心概念とアニメーション番号：</p>
<table><thead><tr><th>番号</th><th>概念</th><th>物理/数学対応</th></tr></thead><tbody><tr><td>🎬<!-- --> C9</td><td>並列 MCTS</td><td>多体問題</td></tr><tr><td>🎬<!-- --> E9</td><td>分散学習</td><td>分散コンピューティング</td></tr><tr><td>🎬<!-- --> C5</td><td>仮想損失</td><td>斥力ポテンシャル</td></tr><tr><td>🎬<!-- --> D15</td><td>バッチ推論</td><td>ベクトル化計算</td></tr></tbody></table>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="関連記事">関連記事<a href="#関連記事" class="hash-link" aria-label="関連記事 への直接リンク" title="関連記事 への直接リンク" translate="no">​</a></h2>
<ul>
<li class=""><strong>前の記事</strong>：<a class="" href="/ja/docs/alphago/explained/training-from-scratch/">ゼロからの学習過程</a> — 学習曲線の詳細分析</li>
<li class=""><strong>次の記事</strong>：<a class="" href="/ja/docs/alphago/explained/legacy-and-impact/">AlphaGo の遺産</a> — AlphaGo の AI 分野への深遠な影響</li>
<li class=""><strong>関連記事</strong>：<a class="" href="/ja/docs/alphago/explained/mcts-neural-combo/">MCTS とニューラルネットワークの統合</a> — MCTS の基礎知識</li>
</ul>
<hr>
<h2 class="anchor anchorTargetStickyNavbar_l_sM" id="参考文献">参考文献<a href="#参考文献" class="hash-link" aria-label="参考文献 への直接リンク" title="参考文献 への直接リンク" translate="no">​</a></h2>
<ol>
<li class="">Silver, D., et al. (2017). &quot;Mastering the game of Go without human knowledge.&quot; <em>Nature</em>, 550, 354-359.</li>
<li class="">Jouppi, N., et al. (2017). &quot;In-Datacenter Performance Analysis of a Tensor Processing Unit.&quot; <em>ISCA 2017</em>.</li>
<li class="">Dean, J., et al. (2012). &quot;Large Scale Distributed Deep Networks.&quot; <em>NeurIPS 2012</em>.</li>
<li class="">Chaslot, G., et al. (2008). &quot;Parallel Monte-Carlo Tree Search.&quot; <em>CIG 2008</em>.</li>
<li class="">Segal, R. (2010). &quot;On the Scalability of Parallel UCT.&quot; <em>CIG 2010</em>.</li>
</ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_YM8j"><a href="https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/alphago/explained/19-distributed-systems.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_hRvp" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div><div class="col lastUpdated_LNbR"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="ドキュメントページ"><a class="pagination-nav__link pagination-nav__link--prev" href="/ja/docs/alphago/explained/training-from-scratch/"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">ゼロからの学習過程</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/ja/docs/alphago/explained/legacy-and-impact/"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">AlphaGo の遺産</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_VU0O thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#学習アーキテクチャの概要" class="table-of-contents__link toc-highlight">学習アーキテクチャの概要</a><ul><li><a href="#オリジナル-alphago-の学習アーキテクチャ" class="table-of-contents__link toc-highlight">オリジナル AlphaGo の学習アーキテクチャ</a></li><li><a href="#alphago-zero-の学習アーキテクチャ" class="table-of-contents__link toc-highlight">AlphaGo Zero の学習アーキテクチャ</a></li></ul></li><li><a href="#自己対局ワーカーself-play-workers" class="table-of-contents__link toc-highlight">自己対局ワーカー（Self-play Workers）</a><ul><li><a href="#タスク割り当て" class="table-of-contents__link toc-highlight">タスク割り当て</a></li><li><a href="#ワークフロー" class="table-of-contents__link toc-highlight">ワークフロー</a></li><li><a href="#負荷分散" class="table-of-contents__link toc-highlight">負荷分散</a></li></ul></li><li><a href="#学習ワーカーtraining-workers" class="table-of-contents__link toc-highlight">学習ワーカー（Training Workers）</a><ul><li><a href="#タスク割り当て-1" class="table-of-contents__link toc-highlight">タスク割り当て</a></li><li><a href="#分散学習" class="table-of-contents__link toc-highlight">分散学習</a></li><li><a href="#同期-vs-非同期更新" class="table-of-contents__link toc-highlight">同期 vs. 非同期更新</a></li></ul></li><li><a href="#tpu-の役割" class="table-of-contents__link toc-highlight">TPU の役割</a><ul><li><a href="#tpu-とは" class="table-of-contents__link toc-highlight">TPU とは？</a></li><li><a href="#tpu-のアーキテクチャ" class="table-of-contents__link toc-highlight">TPU のアーキテクチャ</a></li><li><a href="#なぜ-alphago-は-tpu-を必要とするのか" class="table-of-contents__link toc-highlight">なぜ AlphaGo は TPU を必要とするのか？</a></li><li><a href="#tpu-使用の進化" class="table-of-contents__link toc-highlight">TPU 使用の進化</a></li></ul></li><li><a href="#並列-mcts-と仮想損失" class="table-of-contents__link toc-highlight">並列 MCTS と仮想損失</a><ul><li><a href="#並列化の課題" class="table-of-contents__link toc-highlight">並列化の課題</a></li><li><a href="#リーフ並列化leaf-parallelization" class="table-of-contents__link toc-highlight">リーフ並列化（Leaf Parallelization）</a></li><li><a href="#仮想損失virtual-loss" class="table-of-contents__link toc-highlight">仮想損失（Virtual Loss）</a></li><li><a href="#バッチニューラルネットワーク評価" class="table-of-contents__link toc-highlight">バッチニューラルネットワーク評価</a></li></ul></li><li><a href="#推論アーキテクチャ" class="table-of-contents__link toc-highlight">推論アーキテクチャ</a><ul><li><a href="#対局時の構成" class="table-of-contents__link toc-highlight">対局時の構成</a></li><li><a href="#分散推論フロー" class="table-of-contents__link toc-highlight">分散推論フロー</a></li><li><a href="#思考時間管理" class="table-of-contents__link toc-highlight">思考時間管理</a></li></ul></li><li><a href="#通信と同期" class="table-of-contents__link toc-highlight">通信と同期</a><ul><li><a href="#データ形式" class="table-of-contents__link toc-highlight">データ形式</a></li><li><a href="#ネットワーク帯域幅要件" class="table-of-contents__link toc-highlight">ネットワーク帯域幅要件</a></li><li><a href="#障害処理" class="table-of-contents__link toc-highlight">障害処理</a></li></ul></li><li><a href="#コスト分析" class="table-of-contents__link toc-highlight">コスト分析</a><ul><li><a href="#ハードウェアコスト見積もり" class="table-of-contents__link toc-highlight">ハードウェアコスト見積もり</a></li><li><a href="#人間の学習との比較" class="table-of-contents__link toc-highlight">人間の学習との比較</a></li><li><a href="#推論コスト" class="table-of-contents__link toc-highlight">推論コスト</a></li></ul></li><li><a href="#技術の進化" class="table-of-contents__link toc-highlight">技術の進化</a><ul><li><a href="#alphago-から-alphazero-へ" class="table-of-contents__link toc-highlight">AlphaGo から AlphaZero へ</a></li><li><a href="#オープンソースコミュニティへの影響" class="table-of-contents__link toc-highlight">オープンソースコミュニティへの影響</a></li></ul></li><li><a href="#アニメーション対応" class="table-of-contents__link toc-highlight">アニメーション対応</a></li><li><a href="#関連記事" class="table-of-contents__link toc-highlight">関連記事</a></li><li><a href="#参考文献" class="table-of-contents__link toc-highlight">参考文献</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Weiqi.Kids. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>