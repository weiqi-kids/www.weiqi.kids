"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[4437],{39479(n,e,a){a.r(e),a.d(e,{assets:()=>d,contentTitle:()=>t,default:()=>c,frontMatter:()=>r,metadata:()=>i,toc:()=>o});const i=JSON.parse('{"id":"for-engineers/deep-dive/neural-network","title":"Detail Arsitektur Neural Network","description":"Analisis mendalam desain neural network KataGo, fitur input, dan arsitektur multi-head output","source":"@site/i18n/id/docusaurus-plugin-content-docs/current/for-engineers/deep-dive/neural-network.md","sourceDirName":"for-engineers/deep-dive","slug":"/for-engineers/deep-dive/neural-network","permalink":"/id/docs/for-engineers/deep-dive/neural-network","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/for-engineers/deep-dive/neural-network.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"Detail Arsitektur Neural Network","description":"Analisis mendalam desain neural network KataGo, fitur input, dan arsitektur multi-head output"},"sidebar":"tutorialSidebar","previous":{"title":"Berkontribusi ke Komunitas Open Source","permalink":"/id/docs/for-engineers/deep-dive/contributing"},"next":{"title":"Detail Implementasi MCTS","permalink":"/id/docs/for-engineers/deep-dive/mcts-implementation"}}');var l=a(62615),s=a(30416);const r={sidebar_position:4,title:"Detail Arsitektur Neural Network",description:"Analisis mendalam desain neural network KataGo, fitur input, dan arsitektur multi-head output"},t="Detail Arsitektur Neural Network",d={},o=[{value:"Gambaran Arsitektur",id:"gambaran-arsitektur",level:2},{value:"Encoding Fitur Input",id:"encoding-fitur-input",level:2},{value:"Gambaran Feature Plane",id:"gambaran-feature-plane",level:3},{value:"Stacking Status Historis",id:"stacking-status-historis",level:3},{value:"Encoding Aturan",id:"encoding-aturan",level:3},{value:"Backbone Network: Residual Tower",id:"backbone-network-residual-tower",level:2},{value:"Struktur Blok Residual",id:"struktur-blok-residual",level:3},{value:"Contoh Kode",id:"contoh-kode",level:3},{value:"Layer Global Pooling",id:"layer-global-pooling",level:3},{value:"Desain Output Head",id:"desain-output-head",level:2},{value:"Policy Head (Head Kebijakan)",id:"policy-head-head-kebijakan",level:3},{value:"Value Head (Head Nilai)",id:"value-head-head-nilai",level:3},{value:"Score Head (Head Skor)",id:"score-head-head-skor",level:3},{value:"Ownership Head (Head Kepemilikan)",id:"ownership-head-head-kepemilikan",level:3},{value:"Perbedaan dengan AlphaZero",id:"perbedaan-dengan-alphazero",level:2},{value:"Skala Model",id:"skala-model",level:2},{value:"Implementasi Network Lengkap",id:"implementasi-network-lengkap",level:2},{value:"Bacaan Lanjutan",id:"bacaan-lanjutan",level:2}];function u(n){const e={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...n.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(e.header,{children:(0,l.jsx)(e.h1,{id:"detail-arsitektur-neural-network",children:"Detail Arsitektur Neural Network"})}),"\n",(0,l.jsx)(e.p,{children:"Artikel ini menganalisis secara mendalam arsitektur lengkap neural network KataGo, dari encoding fitur input hingga desain multi-head output."}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"gambaran-arsitektur",children:"Gambaran Arsitektur"}),"\n",(0,l.jsxs)(e.p,{children:["KataGo menggunakan desain ",(0,l.jsx)(e.strong,{children:"neural network tunggal dengan multi-head output"}),":"]}),"\n",(0,l.jsx)(e.mermaid,{value:'flowchart TB\n    Input["Fitur Input (19\xd719\xd722)"]\n    Conv["Layer Konvolusi Awal<br/>256 filter"]\n    Trunk["Residual Tower<br/>20-60 blok residual<br/>+ Global Pooling"]\n\n    Input --\x3e Conv --\x3e Trunk\n\n    Trunk --\x3e Policy["Policy Head"]\n    Trunk --\x3e Value["Value Head"]\n    Trunk --\x3e Score["Score Head"]\n    Trunk --\x3e Owner["Ownership Head"]\n\n    Policy --\x3e P_Out["362 prob<br/>(incl pass)"]\n    Value --\x3e V_Out["Winrate<br/>(-1~+1)"]\n    Score --\x3e S_Out["Selisih<br/>(poin)"]\n    Owner --\x3e O_Out["361 kepemilikan<br/>(-1~+1)"]'}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"encoding-fitur-input",children:"Encoding Fitur Input"}),"\n",(0,l.jsx)(e.h3,{id:"gambaran-feature-plane",children:"Gambaran Feature Plane"}),"\n",(0,l.jsxs)(e.p,{children:["KataGo menggunakan ",(0,l.jsx)(e.strong,{children:"22 feature plane"})," (19\xd719\xd722), setiap plane adalah matriks 19\xd719:"]}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"Plane"}),(0,l.jsx)(e.th,{children:"Konten"}),(0,l.jsx)(e.th,{children:"Deskripsi"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"0"}),(0,l.jsx)(e.td,{children:"Batu sendiri"}),(0,l.jsx)(e.td,{children:"1 = ada batu sendiri, 0 = tidak ada"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"1"}),(0,l.jsx)(e.td,{children:"Batu lawan"}),(0,l.jsx)(e.td,{children:"1 = ada batu lawan, 0 = tidak ada"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"2"}),(0,l.jsx)(e.td,{children:"Titik kosong"}),(0,l.jsx)(e.td,{children:"1 = kosong, 0 = ada batu"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"3-10"}),(0,l.jsx)(e.td,{children:"Status historis"}),(0,l.jsx)(e.td,{children:"Perubahan papan 8 langkah terakhir"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"11"}),(0,l.jsx)(e.td,{children:"Titik ko"}),(0,l.jsx)(e.td,{children:"1 = titik ini adalah ko, 0 = boleh dimainkan"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"12-17"}),(0,l.jsx)(e.td,{children:"Encoding liberty"}),(0,l.jsx)(e.td,{children:"Grup dengan 1, 2, 3... liberty"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"18-21"}),(0,l.jsx)(e.td,{children:"Encoding aturan"}),(0,l.jsx)(e.td,{children:"Aturan Tiongkok/Jepang, komi, dll"})]})]})]}),"\n",(0,l.jsx)(e.h3,{id:"stacking-status-historis",children:"Stacking Status Historis"}),"\n",(0,l.jsxs)(e.p,{children:["Agar neural network memahami ",(0,l.jsx)(e.strong,{children:"perubahan dinamis"})," posisi, KataGo menumpuk status papan 8 langkah terakhir:"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"# Encoding status historis (konsep)\ndef encode_history(game_history, current_player):\n    features = []\n\n    for t in range(8):  # 8 langkah terakhir\n        if t < len(game_history):\n            board = game_history[-(t+1)]\n            # Encode batu sendiri/lawan pada waktu tersebut\n            features.append(encode_board(board, current_player))\n        else:\n            # Histori tidak cukup, isi dengan nol\n            features.append(np.zeros((19, 19)))\n\n    return np.stack(features, axis=0)\n"})}),"\n",(0,l.jsx)(e.h3,{id:"encoding-aturan",children:"Encoding Aturan"}),"\n",(0,l.jsx)(e.p,{children:"KataGo mendukung berbagai aturan, memberitahu neural network melalui feature plane:"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:'# Encoding aturan (konsep)\ndef encode_rules(rules, komi):\n    rule_features = np.zeros((4, 19, 19))\n\n    # Tipe aturan (one-hot)\n    if rules == "chinese":\n        rule_features[0] = 1.0\n    elif rules == "japanese":\n        rule_features[1] = 1.0\n\n    # Normalisasi Komi\n    normalized_komi = komi / 15.0  # Normalisasi ke [-1, 1]\n    rule_features[2] = normalized_komi\n\n    # Pemain saat ini\n    rule_features[3] = 1.0 if current_player == BLACK else 0.0\n\n    return rule_features\n'})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"backbone-network-residual-tower",children:"Backbone Network: Residual Tower"}),"\n",(0,l.jsx)(e.h3,{id:"struktur-blok-residual",children:"Struktur Blok Residual"}),"\n",(0,l.jsxs)(e.p,{children:["KataGo menggunakan struktur ",(0,l.jsx)(e.strong,{children:"Pre-activation ResNet"}),":"]}),"\n",(0,l.jsx)(e.mermaid,{value:'flowchart TB\n    Input["Input x"]\n    BN1["BatchNorm"]\n    R1["ReLU"]\n    C1["Conv 3\xd73"]\n    BN2["BatchNorm"]\n    R2["ReLU"]\n    C2["Conv 3\xd73"]\n    Add["+ (koneksi residual)"]\n    Output["Output"]\n\n    Input --\x3e BN1 --\x3e R1 --\x3e C1 --\x3e BN2 --\x3e R2 --\x3e C2 --\x3e Add\n    Input -.-> Add\n    Add --\x3e Output'}),"\n",(0,l.jsx)(e.h3,{id:"contoh-kode",children:"Contoh Kode"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"class ResidualBlock(nn.Module):\n    def __init__(self, channels):\n        super().__init__()\n        self.bn1 = nn.BatchNorm2d(channels)\n        self.conv1 = nn.Conv2d(channels, channels, 3, padding=1)\n        self.bn2 = nn.BatchNorm2d(channels)\n        self.conv2 = nn.Conv2d(channels, channels, 3, padding=1)\n\n    def forward(self, x):\n        residual = x\n\n        out = self.bn1(x)\n        out = F.relu(out)\n        out = self.conv1(out)\n\n        out = self.bn2(out)\n        out = F.relu(out)\n        out = self.conv2(out)\n\n        return out + residual  # Koneksi residual\n"})}),"\n",(0,l.jsx)(e.h3,{id:"layer-global-pooling",children:"Layer Global Pooling"}),"\n",(0,l.jsxs)(e.p,{children:["Salah satu inovasi kunci KataGo: menambahkan ",(0,l.jsx)(e.strong,{children:"global pooling"})," dalam blok residual, memungkinkan network melihat informasi global:"]}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"class GlobalPoolingBlock(nn.Module):\n    def __init__(self, channels):\n        super().__init__()\n        self.conv = nn.Conv2d(channels, channels, 3, padding=1)\n        self.fc = nn.Linear(channels, channels)\n\n    def forward(self, x):\n        # Jalur lokal\n        local = self.conv(x)\n\n        # Jalur global\n        global_pool = x.mean(dim=[2, 3])  # Global average pooling\n        global_fc = self.fc(global_pool)\n        global_broadcast = global_fc.unsqueeze(2).unsqueeze(3)\n        global_broadcast = global_broadcast.expand(-1, -1, 19, 19)\n\n        # Penggabungan\n        return local + global_broadcast\n"})}),"\n",(0,l.jsx)(e.p,{children:(0,l.jsx)(e.strong,{children:"Mengapa perlu global pooling?"})}),"\n",(0,l.jsx)(e.p,{children:'Konvolusi tradisional hanya melihat lokal (receptive field 3\xd73), bahkan dengan banyak layer, persepsi terhadap informasi global tetap terbatas. Global pooling memungkinkan network langsung "melihat":'}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"Perbedaan jumlah batu di seluruh papan"}),"\n",(0,l.jsx)(e.li,{children:"Distribusi pengaruh global"}),"\n",(0,l.jsx)(e.li,{children:"Penilaian situasi keseluruhan"}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"desain-output-head",children:"Desain Output Head"}),"\n",(0,l.jsx)(e.h3,{id:"policy-head-head-kebijakan",children:"Policy Head (Head Kebijakan)"}),"\n",(0,l.jsx)(e.p,{children:"Menghasilkan probabilitas langkah untuk setiap posisi:"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"class PolicyHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv = nn.Conv2d(in_channels, 2, 1)  # Konvolusi 1\xd71\n        self.bn = nn.BatchNorm2d(2)\n        self.fc = nn.Linear(2 * 19 * 19, 362)  # 361 + pass\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv(x)))\n        out = out.view(out.size(0), -1)\n        out = self.fc(out)\n        return F.softmax(out, dim=1)  # Distribusi probabilitas\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"Format Output"}),": Vektor 362 dimensi"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"Indeks 0-360: Probabilitas langkah untuk 361 posisi papan"}),"\n",(0,l.jsx)(e.li,{children:"Indeks 361: Probabilitas pass"}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"value-head-head-nilai",children:"Value Head (Head Nilai)"}),"\n",(0,l.jsx)(e.p,{children:"Menghasilkan winrate posisi saat ini:"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"class ValueHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv = nn.Conv2d(in_channels, 1, 1)\n        self.bn = nn.BatchNorm2d(1)\n        self.fc1 = nn.Linear(19 * 19, 256)\n        self.fc2 = nn.Linear(256, 1)\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv(x)))\n        out = out.view(out.size(0), -1)\n        out = F.relu(self.fc1(out))\n        out = torch.tanh(self.fc2(out))  # Output -1 sampai +1\n        return out\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"Format Output"}),": Nilai tunggal [-1, +1]"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"+1: Pasti menang"}),"\n",(0,l.jsx)(e.li,{children:"-1: Pasti kalah"}),"\n",(0,l.jsx)(e.li,{children:"0: Seimbang"}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"score-head-head-skor",children:"Score Head (Head Skor)"}),"\n",(0,l.jsx)(e.p,{children:"Eksklusif KataGo, memprediksi selisih poin akhir:"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"class ScoreHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv = nn.Conv2d(in_channels, 1, 1)\n        self.bn = nn.BatchNorm2d(1)\n        self.fc1 = nn.Linear(19 * 19, 256)\n        self.fc2 = nn.Linear(256, 1)\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv(x)))\n        out = out.view(out.size(0), -1)\n        out = F.relu(self.fc1(out))\n        out = self.fc2(out)  # Output tanpa batasan\n        return out\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"Format Output"}),": Nilai tunggal (poin)"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"Positif: Unggul"}),"\n",(0,l.jsx)(e.li,{children:"Negatif: Tertinggal"}),"\n"]}),"\n",(0,l.jsx)(e.h3,{id:"ownership-head-head-kepemilikan",children:"Ownership Head (Head Kepemilikan)"}),"\n",(0,l.jsx)(e.p,{children:"Memprediksi kepemilikan akhir setiap titik:"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"class OwnershipHead(nn.Module):\n    def __init__(self, in_channels):\n        super().__init__()\n        self.conv1 = nn.Conv2d(in_channels, 32, 1)\n        self.bn = nn.BatchNorm2d(32)\n        self.conv2 = nn.Conv2d(32, 1, 1)\n\n    def forward(self, x):\n        out = F.relu(self.bn(self.conv1(x)))\n        out = torch.tanh(self.conv2(out))  # Setiap titik -1 sampai +1\n        return out.view(out.size(0), -1)  # Flatten menjadi 361\n"})}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"Format Output"}),": Vektor 361 dimensi, setiap nilai dalam [-1, +1]"]}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsx)(e.li,{children:"+1: Titik tersebut milik kita"}),"\n",(0,l.jsx)(e.li,{children:"-1: Titik tersebut milik lawan"}),"\n",(0,l.jsx)(e.li,{children:"0: Netral atau area sengketa"}),"\n"]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"perbedaan-dengan-alphazero",children:"Perbedaan dengan AlphaZero"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"Aspek"}),(0,l.jsx)(e.th,{children:"AlphaZero"}),(0,l.jsx)(e.th,{children:"KataGo"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"Output Head"})}),(0,l.jsx)(e.td,{children:"2 (Policy + Value)"}),(0,l.jsxs)(e.td,{children:[(0,l.jsx)(e.strong,{children:"4"})," (+ Score + Ownership)"]})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"Global Pooling"})}),(0,l.jsx)(e.td,{children:"Tidak ada"}),(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"Ada"})})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"Fitur Input"})}),(0,l.jsx)(e.td,{children:"17 plane"}),(0,l.jsxs)(e.td,{children:[(0,l.jsx)(e.strong,{children:"22 plane"})," (termasuk encoding aturan)"]})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"Blok Residual"})}),(0,l.jsx)(e.td,{children:"ResNet standar"}),(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"Pre-activation + Global Pooling"})})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:(0,l.jsx)(e.strong,{children:"Dukungan Multi-aturan"})}),(0,l.jsx)(e.td,{children:"Tidak ada"}),(0,l.jsxs)(e.td,{children:[(0,l.jsx)(e.strong,{children:"Ada"})," (melalui encoding fitur)"]})]})]})]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"skala-model",children:"Skala Model"}),"\n",(0,l.jsx)(e.p,{children:"KataGo menyediakan model dengan berbagai skala:"}),"\n",(0,l.jsxs)(e.table,{children:[(0,l.jsx)(e.thead,{children:(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.th,{children:"Model"}),(0,l.jsx)(e.th,{children:"Jumlah Blok Residual"}),(0,l.jsx)(e.th,{children:"Jumlah Channel"}),(0,l.jsx)(e.th,{children:"Jumlah Parameter"}),(0,l.jsx)(e.th,{children:"Kasus Penggunaan"})]})}),(0,l.jsxs)(e.tbody,{children:[(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"b10c128"}),(0,l.jsx)(e.td,{children:"10"}),(0,l.jsx)(e.td,{children:"128"}),(0,l.jsx)(e.td,{children:"~5M"}),(0,l.jsx)(e.td,{children:"CPU, pengujian cepat"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"b18c384"}),(0,l.jsx)(e.td,{children:"18"}),(0,l.jsx)(e.td,{children:"384"}),(0,l.jsx)(e.td,{children:"~75M"}),(0,l.jsx)(e.td,{children:"GPU umum"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"b40c256"}),(0,l.jsx)(e.td,{children:"40"}),(0,l.jsx)(e.td,{children:"256"}),(0,l.jsx)(e.td,{children:"~95M"}),(0,l.jsx)(e.td,{children:"GPU high-end"})]}),(0,l.jsxs)(e.tr,{children:[(0,l.jsx)(e.td,{children:"b60c320"}),(0,l.jsx)(e.td,{children:"60"}),(0,l.jsx)(e.td,{children:"320"}),(0,l.jsx)(e.td,{children:"~200M"}),(0,l.jsx)(e.td,{children:"GPU top-tier"})]})]})]}),"\n",(0,l.jsxs)(e.p,{children:[(0,l.jsx)(e.strong,{children:"Konvensi Penamaan"}),": ",(0,l.jsx)(e.code,{children:"b{jumlah_blok_residual}c{jumlah_channel}"})]}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"implementasi-network-lengkap",children:"Implementasi Network Lengkap"}),"\n",(0,l.jsx)(e.pre,{children:(0,l.jsx)(e.code,{className:"language-python",children:"class KataGoNetwork(nn.Module):\n    def __init__(self, num_blocks=18, channels=384):\n        super().__init__()\n\n        # Konvolusi awal\n        self.initial_conv = nn.Conv2d(22, channels, 3, padding=1)\n        self.initial_bn = nn.BatchNorm2d(channels)\n\n        # Residual tower\n        self.residual_blocks = nn.ModuleList([\n            ResidualBlock(channels) for _ in range(num_blocks)\n        ])\n\n        # Blok global pooling (sisipkan satu setiap beberapa blok residual)\n        self.global_pooling_blocks = nn.ModuleList([\n            GlobalPoolingBlock(channels) for _ in range(num_blocks // 6)\n        ])\n\n        # Output head\n        self.policy_head = PolicyHead(channels)\n        self.value_head = ValueHead(channels)\n        self.score_head = ScoreHead(channels)\n        self.ownership_head = OwnershipHead(channels)\n\n    def forward(self, x):\n        # Konvolusi awal\n        out = F.relu(self.initial_bn(self.initial_conv(x)))\n\n        # Residual tower\n        gp_idx = 0\n        for i, block in enumerate(self.residual_blocks):\n            out = block(out)\n\n            # Sisipkan global pooling setiap 6 blok residual\n            if (i + 1) % 6 == 0 and gp_idx < len(self.global_pooling_blocks):\n                out = self.global_pooling_blocks[gp_idx](out)\n                gp_idx += 1\n\n        # Output head\n        policy = self.policy_head(out)\n        value = self.value_head(out)\n        score = self.score_head(out)\n        ownership = self.ownership_head(out)\n\n        return {\n            'policy': policy,\n            'value': value,\n            'score': score,\n            'ownership': ownership\n        }\n"})}),"\n",(0,l.jsx)(e.hr,{}),"\n",(0,l.jsx)(e.h2,{id:"bacaan-lanjutan",children:"Bacaan Lanjutan"}),"\n",(0,l.jsxs)(e.ul,{children:["\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"../mcts-implementation",children:"Detail Implementasi MCTS"})," \u2014 Kombinasi pencarian dan neural network"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"../training",children:"Analisis Mekanisme Pelatihan KataGo"})," \u2014 Bagaimana network dilatih"]}),"\n",(0,l.jsxs)(e.li,{children:[(0,l.jsx)(e.a,{href:"../papers",children:"Panduan Paper Kunci"})," \u2014 Derivasi matematis dari paper asli"]}),"\n"]})]})}function c(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,l.jsx)(e,{...n,children:(0,l.jsx)(u,{...n})}):u(n)}},30416(n,e,a){a.d(e,{R:()=>r,x:()=>t});var i=a(59471);const l={},s=i.createContext(l);function r(n){const e=i.useContext(s);return i.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(l):n.components||l:r(n.components),i.createElement(s.Provider,{value:e},n.children)}}}]);