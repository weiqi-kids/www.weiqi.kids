"use strict";(self.webpackChunktemp_docusaurus=self.webpackChunktemp_docusaurus||[]).push([[7],{587:(n,a,e)=>{e.r(a),e.d(a,{assets:()=>o,contentTitle:()=>s,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"for-engineers/katago-source/architecture","title":"Arsitektur Kode Sumber","description":"Artikel ini menganalisis secara mendalam struktur kode sumber KataGo, membantu Anda memahami implementasi internalnya. Baik Anda ingin berkontribusi kode, memodifikasi fitur, atau menerapkan teknologinya ke proyek Anda sendiri, ini adalah referensi wajib baca.","source":"@site/i18n/id/docusaurus-plugin-content-docs/current/for-engineers/katago-source/architecture.md","sourceDirName":"for-engineers/katago-source","slug":"/for-engineers/katago-source/architecture","permalink":"/www.weiqi.kids/id/docs/for-engineers/katago-source/architecture","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/for-engineers/katago-source/architecture.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"title":"Arsitektur Kode Sumber"},"sidebar":"tutorialSidebar","previous":{"title":"Perintah Umum","permalink":"/www.weiqi.kids/id/docs/for-engineers/katago-source/commands"},"next":{"title":"Untuk Pemain Go","permalink":"/www.weiqi.kids/id/docs/for-players/"}}');var r=e(3420),t=e(5521);const l={sidebar_position:3,title:"Arsitektur Kode Sumber"},s="Arsitektur Kode Sumber KataGo",o={},d=[{value:"Struktur Direktori Proyek",id:"struktur-direktori-proyek",level:2},{value:"Penjelasan Detail Direktori cpp/",id:"penjelasan-detail-direktori-cpp",level:3},{value:"Arsitektur Neural Network",id:"arsitektur-neural-network",level:2},{value:"Gambaran Struktur Jaringan",id:"gambaran-struktur-jaringan",level:3},{value:"Fitur Input (nninputs.cpp)",id:"fitur-input-nninputscpp",level:3},{value:"Branch Global Pooling",id:"branch-global-pooling",level:3},{value:"Output Head",id:"output-head",level:3},{value:"Implementasi Mesin Pencarian",id:"implementasi-mesin-pencarian",level:2},{value:"Kelas Inti MCTS",id:"kelas-inti-mcts",level:3},{value:"Struktur Node Pencarian",id:"struktur-node-pencarian",level:3},{value:"Algoritma Seleksi PUCT",id:"algoritma-seleksi-puct",level:3},{value:"Implementasi Pencarian Paralel",id:"implementasi-pencarian-paralel",level:3},{value:"Virtual Loss",id:"virtual-loss",level:3},{value:"Gambaran Proses Pelatihan",id:"gambaran-proses-pelatihan",level:2},{value:"Generasi Data Pelatihan",id:"generasi-data-pelatihan",level:3},{value:"Self-play (cpp/command/selfplay.cpp)",id:"self-play-cppcommandselfplaycpp",level:3},{value:"Format Data Pelatihan",id:"format-data-pelatihan",level:3},{value:"Program Pelatihan Python (python/train.py)",id:"program-pelatihan-python-pythontrainpy",level:3},{value:"Definisi Model (python/model.py)",id:"definisi-model-pythonmodelpy",level:3},{value:"Struktur Data Utama",id:"struktur-data-utama",level:2},{value:"Board (game/board.h)",id:"board-gameboardh",level:3},{value:"BoardHistory (game/boardhistory.h)",id:"boardhistory-gameboardhistoryh",level:3},{value:"NNOutput (neuralnet/nneval.h)",id:"nnoutput-neuralnetnnevalh",level:3},{value:"Pengembangan dan Debugging",id:"pengembangan-dan-debugging",level:2},{value:"Kompilasi Versi Test",id:"kompilasi-versi-test",level:3},{value:"Menjalankan Unit Test",id:"menjalankan-unit-test",level:3},{value:"Metode Debugging Umum",id:"metode-debugging-umum",level:3},{value:"Analisis Performa",id:"analisis-performa",level:3},{value:"Bacaan Lanjutan",id:"bacaan-lanjutan",level:2}];function c(n){const a={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.header,{children:(0,r.jsx)(a.h1,{id:"arsitektur-kode-sumber-katago",children:"Arsitektur Kode Sumber KataGo"})}),"\n",(0,r.jsx)(a.p,{children:"Artikel ini menganalisis secara mendalam struktur kode sumber KataGo, membantu Anda memahami implementasi internalnya. Baik Anda ingin berkontribusi kode, memodifikasi fitur, atau menerapkan teknologinya ke proyek Anda sendiri, ini adalah referensi wajib baca."}),"\n",(0,r.jsx)(a.h2,{id:"struktur-direktori-proyek",children:"Struktur Direktori Proyek"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"KataGo/\n\u251c\u2500\u2500 cpp/                    # Kode inti C++\n\u2502   \u251c\u2500\u2500 main.cpp           # Entry point program utama\n\u2502   \u251c\u2500\u2500 command/           # Berbagai mode eksekusi\n\u2502   \u251c\u2500\u2500 core/              # Kelas utilitas inti\n\u2502   \u251c\u2500\u2500 game/              # Aturan Go dan papan\n\u2502   \u251c\u2500\u2500 search/            # Mesin pencarian MCTS\n\u2502   \u251c\u2500\u2500 neuralnet/         # Interface neural network\n\u2502   \u251c\u2500\u2500 dataio/            # I/O data\n\u2502   \u251c\u2500\u2500 configs/           # Contoh file konfigurasi\n\u2502   \u2514\u2500\u2500 tests/             # Unit test\n\u251c\u2500\u2500 python/                 # Kode pelatihan Python\n\u2502   \u251c\u2500\u2500 train.py           # Program pelatihan utama\n\u2502   \u251c\u2500\u2500 model.py           # Definisi model\n\u2502   \u251c\u2500\u2500 data_processing_pytorch.py\n\u2502   \u2514\u2500\u2500 configs/           # Konfigurasi pelatihan\n\u251c\u2500\u2500 docs/                   # Dokumentasi\n\u2514\u2500\u2500 scripts/               # Skrip pembantu\n"})}),"\n",(0,r.jsx)(a.h3,{id:"penjelasan-detail-direktori-cpp",children:"Penjelasan Detail Direktori cpp/"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"cpp/\n\u251c\u2500\u2500 main.cpp                # Entry point program, parsing argumen command line\n\u251c\u2500\u2500 command/\n\u2502   \u251c\u2500\u2500 gtp.cpp            # Implementasi protokol GTP\n\u2502   \u251c\u2500\u2500 analysis.cpp       # Implementasi Analysis Engine\n\u2502   \u251c\u2500\u2500 benchmark.cpp      # Benchmark\n\u2502   \u251c\u2500\u2500 genconfig.cpp      # Generasi file konfigurasi\n\u2502   \u2514\u2500\u2500 selfplay.cpp       # Self-play\n\u251c\u2500\u2500 core/\n\u2502   \u251c\u2500\u2500 global.h           # Konstanta dan pengaturan global\n\u2502   \u251c\u2500\u2500 hash.h             # Hash Zobrist\n\u2502   \u251c\u2500\u2500 rand.h             # Generator bilangan acak\n\u2502   \u251c\u2500\u2500 logger.h           # Sistem log\n\u2502   \u251c\u2500\u2500 config_parser.h    # Parser file konfigurasi\n\u2502   \u2514\u2500\u2500 threadsafe*.h      # Utilitas thread-safe\n\u251c\u2500\u2500 game/\n\u2502   \u251c\u2500\u2500 board.h/cpp        # Representasi dan operasi dasar papan\n\u2502   \u251c\u2500\u2500 rules.h/cpp        # Aturan Go\n\u2502   \u251c\u2500\u2500 boardhistory.h/cpp # Histori permainan\n\u2502   \u2514\u2500\u2500 graphhash.h/cpp    # Hash posisi\n\u251c\u2500\u2500 search/\n\u2502   \u251c\u2500\u2500 search.h/cpp       # Kelas utama mesin pencarian\n\u2502   \u251c\u2500\u2500 searchnode.h/cpp   # Node pohon pencarian\n\u2502   \u251c\u2500\u2500 searchparams.h     # Parameter pencarian\n\u2502   \u251c\u2500\u2500 mutexpool.h        # Pool lock\n\u2502   \u251c\u2500\u2500 searchresults.h    # Hasil pencarian\n\u2502   \u2514\u2500\u2500 asyncbot.h/cpp     # Bot asinkron\n\u251c\u2500\u2500 neuralnet/\n\u2502   \u251c\u2500\u2500 nninputs.h/cpp     # Fitur input neural network\n\u2502   \u251c\u2500\u2500 nneval.h/cpp       # Evaluasi neural network\n\u2502   \u251c\u2500\u2500 nninterface.h      # Interface abstraksi backend\n\u2502   \u251c\u2500\u2500 cudabackend.cpp    # Backend CUDA\n\u2502   \u251c\u2500\u2500 openclbackend.cpp  # Backend OpenCL\n\u2502   \u251c\u2500\u2500 eigenbackend.cpp   # Backend Eigen (CPU)\n\u2502   \u2514\u2500\u2500 modelversion.h     # Manajemen versi model\n\u2514\u2500\u2500 dataio/\n    \u251c\u2500\u2500 sgf.h/cpp          # Pemrosesan file SGF\n    \u251c\u2500\u2500 numpywrite.h/cpp   # Output format NumPy\n    \u2514\u2500\u2500 trainingwrite.h/cpp # Penulisan data pelatihan\n"})}),"\n",(0,r.jsx)(a.h2,{id:"arsitektur-neural-network",children:"Arsitektur Neural Network"}),"\n",(0,r.jsx)(a.h3,{id:"gambaran-struktur-jaringan",children:"Gambaran Struktur Jaringan"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                 Arsitektur Neural Network KataGo             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                             \u2502\n\u2502   Layer Input (22 feature planes \xd7 19 \xd7 19)                 \u2502\n\u2502                        \u2502                                    \u2502\n\u2502                        \u25bc                                    \u2502\n\u2502              \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                           \u2502\n\u2502              \u2502  Layer Konvolusi \u2502                           \u2502\n\u2502              \u2502   Awal 3\xd73,     \u2502                           \u2502\n\u2502              \u2502   C channels    \u2502                           \u2502\n\u2502              \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                           \u2502\n\u2502                       \u2502                                    \u2502\n\u2502                       \u25bc                                    \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502   \u2502          Residual Block \xd7 N               \u2502           \u2502\n\u2502   \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502           \u2502\n\u2502   \u2502  \u2502  BatchNorm \u2192 ReLU \u2192 Conv 3\xd73        \u2502  \u2502           \u2502\n\u2502   \u2502  \u2502  BatchNorm \u2192 ReLU \u2192 Conv 3\xd73        \u2502  \u2502           \u2502\n\u2502   \u2502  \u2502  + Global Pooling Branch            \u2502  \u2502           \u2502\n\u2502   \u2502  \u2502  + Skip Connection                  \u2502  \u2502           \u2502\n\u2502   \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502           \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n\u2502                       \u2502                                    \u2502\n\u2502       \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                   \u2502\n\u2502       \u25bc               \u25bc               \u25bc                   \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510              \u2502\n\u2502  \u2502 Policy  \u2502    \u2502  Value  \u2502    \u2502  Other  \u2502              \u2502\n\u2502  \u2502  Head   \u2502    \u2502  Head   \u2502    \u2502  Heads  \u2502              \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518              \u2502\n\u2502                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(a.h3,{id:"fitur-input-nninputscpp",children:"Fitur Input (nninputs.cpp)"}),"\n",(0,r.jsx)(a.p,{children:"KataGo menggunakan 22 feature planes sebagai input:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"// Kategori fitur input utama\nenum {\n  // Status papan\n  INPUT_FEATURE_STONE_OUR,      // Batu kita\n  INPUT_FEATURE_STONE_OPP,      // Batu lawan\n\n  // Terkait liberti (1-8 liberti)\n  INPUT_FEATURE_LIBERTIES_1,\n  INPUT_FEATURE_LIBERTIES_2,\n  // ...\n  INPUT_FEATURE_LIBERTIES_8_OR_MORE,\n\n  // Status historis\n  INPUT_FEATURE_LAST_MOVE,      // Posisi langkah terakhir\n  INPUT_FEATURE_SECOND_LAST_MOVE,\n\n  // Terkait aturan\n  INPUT_FEATURE_KOMI,           // Komi\n  INPUT_FEATURE_RULES,          // Encoding aturan\n  // ...\n};\n"})}),"\n",(0,r.jsx)(a.h3,{id:"branch-global-pooling",children:"Branch Global Pooling"}),"\n",(0,r.jsx)(a.p,{children:"Salah satu inovasi KataGo adalah menambahkan global pooling dalam residual block:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"// Konsep implementasi global pooling yang disederhanakan\nclass GlobalPoolingResBlock {\npublic:\n  void forward(Tensor& x) {\n    // Jalur residual standar\n    Tensor regular_out = regular_conv_path(x);\n\n    // Jalur global pooling\n    Tensor global_mean = global_avg_pool(x);  // [batch, C]\n    Tensor global_max = global_max_pool(x);    // [batch, C]\n    Tensor global_features = concat(global_mean, global_max);\n\n    // Memproses fitur global\n    global_features = dense_layer(global_features);  // [batch, C]\n\n    // Broadcast kembali ke dimensi spasial dan gabung dengan jalur reguler\n    Tensor global_broadcast = broadcast_to_spatial(global_features);\n    x = regular_out + global_broadcast;\n  }\n};\n"})}),"\n",(0,r.jsx)(a.h3,{id:"output-head",children:"Output Head"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"// Policy Head: Memprediksi probabilitas langkah\nclass PolicyHead {\n  // Output: 19\xd719+1 (termasuk pass)\n  // Menggunakan normalisasi softmax\n};\n\n// Value Head: Memprediksi hasil menang-kalah\nclass ValueHead {\n  // Output: 3 (probabilitas menang/kalah/seri)\n  // Menggunakan normalisasi softmax\n};\n\n// Score Head: Memprediksi poin\nclass ScoreHead {\n  // Output: Nilai kontinu (prediksi selisih poin)\n};\n\n// Ownership Head: Memprediksi wilayah\nclass OwnershipHead {\n  // Output: 19\xd719 (kepemilikan setiap titik, tanh)\n};\n"})}),"\n",(0,r.jsx)(a.h2,{id:"implementasi-mesin-pencarian",children:"Implementasi Mesin Pencarian"}),"\n",(0,r.jsx)(a.h3,{id:"kelas-inti-mcts",children:"Kelas Inti MCTS"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"// search/search.h\nclass Search {\npublic:\n  // Menjalankan pencarian\n  void runWholeSearch(Player pla);\n\n  // Mendapatkan langkah terbaik\n  Loc getBestMove();\n\n  // Mendapatkan hasil analisis\n  AnalysisData getAnalysisData();\n\nprivate:\n  SearchParams params;          // Parameter pencarian\n  SearchNode* rootNode;         // Node root\n  NNEvaluator* nnEval;         // Evaluator neural network\n  std::mutex* mutexPool;       // Pool lock\n};\n"})}),"\n",(0,r.jsx)(a.h3,{id:"struktur-node-pencarian",children:"Struktur Node Pencarian"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"// search/searchnode.h\nstruct SearchNode {\n  // Statistik node\n  std::atomic<int64_t> visits;           // Jumlah kunjungan\n  std::atomic<double> valueSumWeight;    // Bobot akumulasi nilai\n  std::atomic<double> valueSum;          // Jumlah akumulasi nilai\n\n  // Child node\n  std::atomic<int> numChildren;\n  SearchChildPointer* children;          // Array pointer child node\n\n  // Cache output neural network\n  std::shared_ptr<NNOutput> nnOutput;\n};\n\nstruct SearchChildPointer {\n  Loc moveLoc;                           // Posisi langkah\n  std::atomic<SearchNode*> node;         // Pointer child node\n  std::atomic<int64_t> edgeVisits;       // Kunjungan edge\n};\n"})}),"\n",(0,r.jsx)(a.h3,{id:"algoritma-seleksi-puct",children:"Algoritma Seleksi PUCT"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"// Memilih child node untuk dieksplorasi\nint Search::selectChildToDescend(SearchNode* node, Player pla) {\n  int bestIdx = -1;\n  double bestValue = -1e100;\n\n  for (int i = 0; i < node->numChildren; i++) {\n    SearchChildPointer& child = node->children[i];\n\n    // Menghitung nilai Q (exploitation)\n    double q = getChildQ(child);\n\n    // Menghitung nilai U (exploration)\n    double prior = getPrior(node, child.moveLoc);\n    double parentVisits = node->visits.load();\n    double childVisits = child.edgeVisits.load();\n\n    double u = params.cpuctExploration * prior *\n               sqrt(parentVisits) / (1.0 + childVisits);\n\n    // Formula PUCT\n    double value = q + u;\n\n    if (value > bestValue) {\n      bestValue = value;\n      bestIdx = i;\n    }\n  }\n\n  return bestIdx;\n}\n"})}),"\n",(0,r.jsx)(a.h3,{id:"implementasi-pencarian-paralel",children:"Implementasi Pencarian Paralel"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"void Search::runWholeSearch(Player pla) {\n  // Menjalankan beberapa thread pencarian\n  std::vector<std::thread> threads;\n  for (int i = 0; i < params.numSearchThreads; i++) {\n    threads.emplace_back([this, pla]() {\n      runSingleSearchThread(pla);\n    });\n  }\n\n  // Menunggu semua thread selesai\n  for (auto& t : threads) {\n    t.join();\n  }\n}\n\nvoid Search::runSingleSearchThread(Player pla) {\n  while (!shouldStop()) {\n    // Memilih jalur\n    std::vector<SearchNode*> path;\n    SearchNode* leaf = selectAndDescend(rootNode, path);\n\n    // Memperluas node\n    expandNode(leaf);\n\n    // Evaluasi neural network\n    NNOutput output = nnEval->evaluate(leaf->board);\n\n    // Backpropagation nilai\n    backpropagateValue(path, output.value);\n  }\n}\n"})}),"\n",(0,r.jsx)(a.h3,{id:"virtual-loss",children:"Virtual Loss"}),"\n",(0,r.jsx)(a.p,{children:"Digunakan untuk menghindari multiple thread memilih jalur yang sama dalam pencarian paralel:"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"void Search::applyVirtualLoss(SearchNode* node) {\n  // Sementara mengurangi nilai evaluasi node ini\n  // Membuat thread lain cenderung memilih jalur berbeda\n  node->virtualLoss.fetch_add(1);\n}\n\nvoid Search::removeVirtualLoss(SearchNode* node) {\n  node->virtualLoss.fetch_sub(1);\n}\n"})}),"\n",(0,r.jsx)(a.h2,{id:"gambaran-proses-pelatihan",children:"Gambaran Proses Pelatihan"}),"\n",(0,r.jsx)(a.h3,{id:"generasi-data-pelatihan",children:"Generasi Data Pelatihan"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                  Gambaran Proses Pelatihan                   \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502                                                             \u2502\n\u2502   \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502   \u2502  Self-play  \u2502 \u2192  \u2502    Data     \u2502 \u2192  \u2502   Trainer   \u2502    \u2502\n\u2502   \u2502   Worker    \u2502    \u2502   Buffer    \u2502    \u2502  (PyTorch)  \u2502    \u2502\n\u2502   \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502          \u25b2                                      \u2502           \u2502\n\u2502          \u2502                                      \u25bc           \u2502\n\u2502          \u2502                               \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510    \u2502\n\u2502          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2502  Model Baru \u2502    \u2502\n\u2502                                          \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518    \u2502\n\u2502                                                             \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,r.jsx)(a.h3,{id:"self-play-cppcommandselfplaycpp",children:"Self-play (cpp/command/selfplay.cpp)"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"// Loop utama self-play\nvoid runSelfPlayLoop() {\n  while (true) {\n    // Memuat model terbaru\n    loadLatestModel();\n\n    // Memainkan satu permainan\n    GameData gameData = playSingleGame();\n\n    // Menyimpan data pelatihan\n    writeTrainingData(gameData);\n  }\n}\n\nGameData playSingleGame() {\n  Board board;\n  BoardHistory history;\n  GameData gameData;\n\n  while (!history.isGameOver()) {\n    // Menggunakan MCTS untuk memilih langkah\n    Search search(board, history, params);\n    search.runWholeSearch(history.currentPla);\n\n    // Mendapatkan hasil MCTS sebagai target pelatihan\n    MoveData moveData;\n    moveData.policyTarget = search.getPolicyDistribution();\n    moveData.valueTarget = search.getValue();\n\n    // Menjalankan langkah\n    Loc move = search.sampleMove();\n    board.playMove(move, history.currentPla);\n\n    gameData.moves.push_back(moveData);\n  }\n\n  // Mengisi hasil akhir\n  gameData.finalScore = history.finalScore();\n  return gameData;\n}\n"})}),"\n",(0,r.jsx)(a.h3,{id:"format-data-pelatihan",children:"Format Data Pelatihan"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"// dataio/trainingwrite.h\nstruct TrainingRow {\n  // Fitur input\n  float inputFeatures[NUM_FEATURES][BOARD_SIZE][BOARD_SIZE];\n\n  // Target pelatihan\n  float policyTarget[BOARD_SIZE * BOARD_SIZE + 1];  // Termasuk pass\n  float valueTarget[3];                              // Menang/kalah/seri\n  float scoreTarget;                                 // Poin\n  float ownershipTarget[BOARD_SIZE][BOARD_SIZE];    // Wilayah\n\n  // Metadata\n  int turn;\n  int rules;\n  float komi;\n};\n"})}),"\n",(0,r.jsx)(a.h3,{id:"program-pelatihan-python-pythontrainpy",children:"Program Pelatihan Python (python/train.py)"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:"# Loop pelatihan utama (disederhanakan)\ndef train():\n    model = KataGoModel(config)\n    optimizer = torch.optim.SGD(model.parameters(), lr=config.lr)\n\n    for epoch in range(config.num_epochs):\n        for batch in data_loader:\n            # Forward pass\n            policy_pred, value_pred, score_pred, ownership_pred = model(batch.input)\n\n            # Menghitung loss\n            policy_loss = cross_entropy(policy_pred, batch.policy_target)\n            value_loss = cross_entropy(value_pred, batch.value_target)\n            score_loss = mse_loss(score_pred, batch.score_target)\n            ownership_loss = mse_loss(ownership_pred, batch.ownership_target)\n\n            # Total loss (weighted sum)\n            total_loss = (\n                policy_loss +\n                config.value_weight * value_loss +\n                config.score_weight * score_loss +\n                config.ownership_weight * ownership_loss\n            )\n\n            # Backward pass\n            optimizer.zero_grad()\n            total_loss.backward()\n            optimizer.step()\n\n        # Menyimpan checkpoint\n        save_checkpoint(model, epoch)\n"})}),"\n",(0,r.jsx)(a.h3,{id:"definisi-model-pythonmodelpy",children:"Definisi Model (python/model.py)"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-python",children:"class KataGoModel(nn.Module):\n    def __init__(self, config):\n        super().__init__()\n\n        # Konvolusi awal\n        self.initial_conv = nn.Conv2d(\n            config.input_channels,\n            config.trunk_channels,\n            kernel_size=3, padding=1\n        )\n\n        # Residual block\n        self.blocks = nn.ModuleList([\n            ResBlock(config.trunk_channels, use_global_pooling=True)\n            for _ in range(config.num_blocks)\n        ])\n\n        # Output head\n        self.policy_head = PolicyHead(config)\n        self.value_head = ValueHead(config)\n        self.score_head = ScoreHead(config)\n        self.ownership_head = OwnershipHead(config)\n\n    def forward(self, x):\n        # Jaringan trunk\n        x = self.initial_conv(x)\n        for block in self.blocks:\n            x = block(x)\n\n        # Setiap output head\n        policy = self.policy_head(x)\n        value = self.value_head(x)\n        score = self.score_head(x)\n        ownership = self.ownership_head(x)\n\n        return policy, value, score, ownership\n"})}),"\n",(0,r.jsx)(a.h2,{id:"struktur-data-utama",children:"Struktur Data Utama"}),"\n",(0,r.jsx)(a.h3,{id:"board-gameboardh",children:"Board (game/board.h)"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"class Board {\npublic:\n  // Status papan\n  Color stones[MAX_BOARD_AREA];    // Warna setiap titik\n  Chain chains[MAX_BOARD_AREA];    // Informasi rantai batu\n\n  // Ko\n  Loc koLoc;\n\n  // Menjalankan langkah\n  void playMove(Loc loc, Color pla);\n\n  // Pemeriksaan legalitas\n  bool isLegal(Loc loc, Color pla) const;\n\n  // Perhitungan liberti\n  int getLiberties(Loc loc) const;\n};\n\nstruct Chain {\n  int liberties;                   // Jumlah liberti\n  int numStones;                   // Jumlah batu\n  Loc head;                        // Head linked list\n};\n"})}),"\n",(0,r.jsx)(a.h3,{id:"boardhistory-gameboardhistoryh",children:"BoardHistory (game/boardhistory.h)"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"class BoardHistory {\npublic:\n  std::vector<Board> boards;       // Histori status papan\n  std::vector<Move> moves;         // Histori langkah\n  Rules rules;                     // Aturan\n  Player currentPla;               // Giliran siapa saat ini\n\n  // Status permainan\n  bool isGameOver() const;\n  float finalScore() const;\n};\n"})}),"\n",(0,r.jsx)(a.h3,{id:"nnoutput-neuralnetnnevalh",children:"NNOutput (neuralnet/nneval.h)"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:"struct NNOutput {\n  // Policy\n  float policyProbs[MAX_BOARD_AREA + 1];  // Termasuk pass\n\n  // Value\n  float whiteWinProb;\n  float whiteLossProb;\n  float noResultProb;\n\n  // Score\n  float whiteScoreMean;\n  float whiteScoreStdev;\n\n  // Ownership\n  float ownership[MAX_BOARD_AREA];  // -1 sampai 1\n};\n"})}),"\n",(0,r.jsx)(a.h2,{id:"pengembangan-dan-debugging",children:"Pengembangan dan Debugging"}),"\n",(0,r.jsx)(a.h3,{id:"kompilasi-versi-test",children:"Kompilasi Versi Test"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"cd cpp\nmkdir build_debug && cd build_debug\ncmake .. -DCMAKE_BUILD_TYPE=Debug -DUSE_BACKEND=OPENCL\nmake -j$(nproc)\n"})}),"\n",(0,r.jsx)(a.h3,{id:"menjalankan-unit-test",children:"Menjalankan Unit Test"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:"./katago runtests\n"})}),"\n",(0,r.jsx)(a.h3,{id:"metode-debugging-umum",children:"Metode Debugging Umum"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-cpp",children:'// 1. Menggunakan log\n#include "core/logger.h"\nLogger::log("Debug message", value);\n\n// 2. Menggunakan perintah GTP kata-debug-print\n// Output informasi pencarian detail\n\n// 3. Mengaktifkan sanitizers saat kompilasi\ncmake .. -DCMAKE_CXX_FLAGS="-fsanitize=address"\n'})}),"\n",(0,r.jsx)(a.h3,{id:"analisis-performa",children:"Analisis Performa"}),"\n",(0,r.jsx)(a.pre,{children:(0,r.jsx)(a.code,{className:"language-bash",children:'# Menggunakan perf (Linux)\nperf record ./katago benchmark -model model.bin.gz\nperf report\n\n# Menggunakan Instruments (macOS)\ninstruments -t "Time Profiler" ./katago benchmark -model model.bin.gz\n'})}),"\n",(0,r.jsx)(a.h2,{id:"bacaan-lanjutan",children:"Bacaan Lanjutan"}),"\n",(0,r.jsxs)(a.ul,{children:["\n",(0,r.jsx)(a.li,{children:(0,r.jsx)(a.a,{href:"https://github.com/lightvector/KataGo",children:"KataGo GitHub"})}),"\n",(0,r.jsx)(a.li,{children:(0,r.jsx)(a.a,{href:"https://arxiv.org/abs/1902.10565",children:"Makalah KataGo"})}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.a,{href:"https://discord.gg/bqkZAz3",children:"KataGo Discord"})," - Berkomunikasi dengan pengembang"]}),"\n",(0,r.jsxs)(a.li,{children:[(0,r.jsx)(a.a,{href:"https://katagotraining.org/",children:"KataGo Training"})," - Melihat progres pelatihan"]}),"\n"]}),"\n",(0,r.jsx)(a.p,{children:"Setelah memahami arsitektur kode sumber KataGo, Anda sudah memiliki kemampuan untuk meneliti lebih dalam atau berkontribusi pada proyek open source. Jika ingin memahami lebih lanjut, disarankan untuk langsung membaca kode sumber di GitHub KataGo dan berpartisipasi dalam diskusi komunitas."})]})}function u(n={}){const{wrapper:a}={...(0,t.R)(),...n.components};return a?(0,r.jsx)(a,{...n,children:(0,r.jsx)(c,{...n})}):c(n)}},5521:(n,a,e)=>{e.d(a,{R:()=>l,x:()=>s});var i=e(6672);const r={},t=i.createContext(r);function l(n){const a=i.useContext(t);return i.useMemo((function(){return"function"==typeof n?n(a):{...a,...n}}),[a,n])}function s(n){let a;return a=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),i.createElement(t.Provider,{value:a},n.children)}}}]);