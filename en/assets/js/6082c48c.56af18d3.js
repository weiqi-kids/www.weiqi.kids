"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[4401],{67421(e,n,t){t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"alphago/explained/training-from-scratch","title":"Training from Scratch","description":"Witness how AlphaGo Zero went from random moves to surpassing humans in three days, rediscovering and transcending millennia of Go wisdom","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/alphago/explained/18-training-from-scratch.mdx","sourceDirName":"alphago/explained","slug":"/alphago/explained/training-from-scratch","permalink":"/en/docs/alphago/explained/training-from-scratch","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/alphago/explained/18-training-from-scratch.mdx","tags":[],"version":"current","sidebarPosition":19,"frontMatter":{"sidebar_position":19,"title":"Training from Scratch","description":"Witness how AlphaGo Zero went from random moves to surpassing humans in three days, rediscovering and transcending millennia of Go wisdom","keywords":["AlphaGo Zero","training process","self-play","strength growth","Go AI","deep learning"]},"sidebar":"tutorialSidebar","previous":{"title":"Dual-Head Network and Residual Network","permalink":"/en/docs/alphago/explained/dual-head-resnet"},"next":{"title":"Distributed Systems and TPU","permalink":"/en/docs/alphago/explained/distributed-systems"}}');var r=t(62615),i=t(30416),a=t(45695);const l={sidebar_position:19,title:"Training from Scratch",description:"Witness how AlphaGo Zero went from random moves to surpassing humans in three days, rediscovering and transcending millennia of Go wisdom",keywords:["AlphaGo Zero","training process","self-play","strength growth","Go AI","deep learning"]},o="Training from Scratch",d={},c=[{value:"Training Curve",id:"training-curve",level:2},{value:"Day 0: Chaotic Beginning",id:"day-0-chaotic-beginning",level:2},{value:"Completely Random Initial State",id:"completely-random-initial-state",level:3},{value:"The First Self-Play Game",id:"the-first-self-play-game",level:3},{value:"The First Training Signal",id:"the-first-training-signal",level:3},{value:"Hour 1-3: Discovering Game Rules",id:"hour-1-3-discovering-game-rules",level:2},{value:"Emerging Rule Awareness",id:"emerging-rule-awareness",level:3},{value:"1. Importance of Connection",id:"1-importance-of-connection",level:4},{value:"2. Concept of Liberties",id:"2-concept-of-liberties",level:4},{value:"3. Embryo of Eyes",id:"3-embryo-of-eyes",level:4},{value:"Strength Assessment",id:"strength-assessment",level:3},{value:"Hour 3-12: Discovering Joseki and Shapes",id:"hour-3-12-discovering-joseki-and-shapes",level:2},{value:"Corner Awakening",id:"corner-awakening",level:3},{value:"Emergence of Joseki",id:"emergence-of-joseki",level:3},{value:"Observed Phenomenon",id:"observed-phenomenon",level:4},{value:"Typical Emergent Joseki",id:"typical-emergent-joseki",level:3},{value:"Shape Knowledge",id:"shape-knowledge",level:3},{value:"Strength Assessment",id:"strength-assessment-1",level:3},{value:"Hour 12-36: Maturation of Go Principles",id:"hour-12-36-maturation-of-go-principles",level:2},{value:"Formation of Global Vision",id:"formation-of-global-vision",level:3},{value:"Influence vs. Territory",id:"influence-vs-territory",level:4},{value:"Thickness Judgment",id:"thickness-judgment",level:4},{value:"Middle Game Tactics",id:"middle-game-tactics",level:3},{value:"Endgame Skills",id:"endgame-skills",level:3},{value:"Strength Assessment",id:"strength-assessment-2",level:3},{value:"Hour 36-72: Surpassing Humans",id:"hour-36-72-surpassing-humans",level:2},{value:"Breaking Through Professional Level",id:"breaking-through-professional-level",level:3},{value:"Revolutionary Openings",id:"revolutionary-openings",level:3},{value:"Counter-intuitive Shapes",id:"counter-intuitive-shapes",level:3},{value:"Aggressive Sacrifices",id:"aggressive-sacrifices",level:3},{value:"Strength Assessment",id:"strength-assessment-3",level:3},{value:"Rediscovering Human Go Principles",id:"rediscovering-human-go-principles",level:2},{value:"Thousands of Years vs. Three Days",id:"thousands-of-years-vs-three-days",level:3},{value:"Validation and Transcendence",id:"validation-and-transcendence",level:3},{value:"Insights for Human Learning",id:"insights-for-human-learning",level:3},{value:"Technical Details of Training",id:"technical-details-of-training",level:2},{value:"Self-Play Mechanism",id:"self-play-mechanism",level:3},{value:"Training Rhythm",id:"training-rhythm",level:3},{value:"Data Pool Management",id:"data-pool-management",level:3},{value:"Network Update Strategy",id:"network-update-strategy",level:3},{value:"Analysis of Learning Speed",id:"analysis-of-learning-speed",level:2},{value:"Why So Fast?",id:"why-so-fast",level:3},{value:"1. Computational Resources",id:"1-computational-resources",level:4},{value:"2. Perfect Opponent",id:"2-perfect-opponent",level:4},{value:"3. Direct Objective",id:"3-direct-objective",level:4},{value:"4. Efficient Representation Learning",id:"4-efficient-representation-learning",level:4},{value:"Comparison with Humans",id:"comparison-with-humans",level:3},{value:"Interesting Phenomena During Training",id:"interesting-phenomena-during-training",level:2},{value:"Periodic Stagnation",id:"periodic-stagnation",level:3},{value:"Emergence and Disappearance of Strategies",id:"emergence-and-disappearance-of-strategies",level:3},{value:"&quot;Reinventing the Wheel&quot;",id:"reinventing-the-wheel",level:3},{value:"Animation Reference",id:"animation-reference",level:2},{value:"Further Reading",id:"further-reading",level:2},{value:"References",id:"references",level:2}];function h(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"training-from-scratch",children:"Training from Scratch"})}),"\n",(0,r.jsxs)(n.p,{children:["What's most astonishing about AlphaGo Zero isn't just its final playing strength, but its ",(0,r.jsx)(n.strong,{children:"growth process"})," - starting from a completely random state, in just three days it went through the Go knowledge accumulation that took humans thousands of years, then surpassed all human understanding."]}),"\n",(0,r.jsx)(n.p,{children:"This article will walk you through this stunning transformation step by step."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"training-curve",children:"Training Curve"}),"\n",(0,r.jsx)(n.p,{children:"First, let's look at AlphaGo Zero's strength growth curve:"}),"\n",(0,r.jsx)(a.$W,{mode:"zero",width:700,height:400}),"\n",(0,r.jsx)(n.p,{children:"This curve shows AlphaGo Zero's strength changes over 72 hours. Note several key milestones:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Time"}),(0,r.jsx)(n.th,{children:"ELO Rating"}),(0,r.jsx)(n.th,{children:"Equivalent to"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"0 hours"}),(0,r.jsx)(n.td,{children:"0"}),(0,r.jsx)(n.td,{children:"Random moves"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"3 hours"}),(0,r.jsx)(n.td,{children:"~1000"}),(0,r.jsx)(n.td,{children:"Discovers basic rules"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"12 hours"}),(0,r.jsx)(n.td,{children:"~3000"}),(0,r.jsx)(n.td,{children:"Discovers joseki and shapes"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"36 hours"}),(0,r.jsx)(n.td,{children:"~4500"}),(0,r.jsx)(n.td,{children:"Surpasses AlphaGo Fan version"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"60 hours"}),(0,r.jsx)(n.td,{children:"~5200"}),(0,r.jsx)(n.td,{children:"Surpasses AlphaGo Lee version"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"72 hours"}),(0,r.jsx)(n.td,{children:"~5400"}),(0,r.jsx)(n.td,{children:"Surpasses all previous versions"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Three days, from zero to surpassing the peak of human achievement."})}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"day-0-chaotic-beginning",children:"Day 0: Chaotic Beginning"}),"\n",(0,r.jsx)(n.h3,{id:"completely-random-initial-state",children:"Completely Random Initial State"}),"\n",(0,r.jsx)(n.p,{children:"At the start of training, the neural network weights are randomly initialized. This means:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Policy Head"}),": Outputs approximately uniform distribution, each position has about 1/361 probability"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Value Head"}),": Outputs approximately 0, cannot distinguish good positions from bad ones"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"At this point, AlphaGo Zero plays completely randomly - worse than someone who has never seen a Go board."}),"\n",(0,r.jsx)(n.h3,{id:"the-first-self-play-game",children:"The First Self-Play Game"}),"\n",(0,r.jsx)(n.p,{children:"Imagine what the first self-play game looks like:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Black 1: Randomly placed somewhere (could be tengen, a corner, or the first line)\nWhite 2: Randomly placed elsewhere\nBlack 3: Random...\n...\nMove 200: The board is covered with isolated stones, no connections\nFinal: Win/loss determined by random factors\n"})}),"\n",(0,r.jsxs)(n.p,{children:['This game\'s "quality" is extremely low, but it contains precious information: ',(0,r.jsx)(n.strong,{children:"who won in the end"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"the-first-training-signal",children:"The First Training Signal"}),"\n",(0,r.jsx)(n.p,{children:"Although both sides are playing randomly, the outcome is definite. The neural network begins to learn:"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:'"In this position, Black won in the end. I don\'t know why, but this position might be better for Black."'}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:'This is a very weak signal, but it\'s real. After thousands of such "junk games," the network begins to discover some statistical patterns.'}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"hour-1-3-discovering-game-rules",children:"Hour 1-3: Discovering Game Rules"}),"\n",(0,r.jsx)(n.h3,{id:"emerging-rule-awareness",children:"Emerging Rule Awareness"}),"\n",(0,r.jsx)(n.p,{children:'After tens of thousands of self-play games, AlphaGo Zero begins to "discover" Go\'s basic rules (though these rules were built into the game engine all along):'}),"\n",(0,r.jsx)(n.h4,{id:"1-importance-of-connection",children:"1. Importance of Connection"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Observation: When stones are connected, they're harder to capture\nLearning: Begins to prefer playing next to existing stones\n"})}),"\n",(0,r.jsx)(n.p,{children:"This wasn't taught - it was learned from win/loss results. Scattered stones are easily defeated one by one; connected groups survive more easily."}),"\n",(0,r.jsx)(n.h4,{id:"2-concept-of-liberties",children:"2. Concept of Liberties"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Observation: When all adjacent empty points of a stone are occupied, the stone disappears\nLearning: Begins to avoid positions with few liberties, begins to attack opponent's stones with few liberties\n"})}),"\n",(0,r.jsx)(n.p,{children:'The network learned to track liberty counts - though there\'s no explicit "liberty count" feature in the input, it can be inferred from historical board states.'}),"\n",(0,r.jsx)(n.h4,{id:"3-embryo-of-eyes",children:"3. Embryo of Eyes"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Observation: Certain shapes are especially hard to capture\nLearning: Begins forming shapes with internal space in corners and edges\n"})}),"\n",(0,r.jsx)(n.p,{children:"This is the beginning of the living group concept. The network discovered that stone groups with internal space survive more easily."}),"\n",(0,r.jsx)(n.h3,{id:"strength-assessment",children:"Strength Assessment"}),"\n",(0,r.jsx)(n.p,{children:"At this point, AlphaGo Zero is approximately:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ELO"}),": ~1000"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Equivalent to"}),": Beginner who just learned the rules"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Characteristics"}),": Knows to connect stones, knows to capture opponent's stones"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"hour-3-12-discovering-joseki-and-shapes",children:"Hour 3-12: Discovering Joseki and Shapes"}),"\n",(0,r.jsx)(n.h3,{id:"corner-awakening",children:"Corner Awakening"}),"\n",(0,r.jsx)(n.p,{children:"With more training, the network discovered the importance of corners:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Observation: Corner stones only need 2 eyes to live\n          Edge stones need 2 eyes but it's harder\n          Center stones need 2 eyes and it's hardest\nLearning: Prioritize occupying corners in the opening\n"})}),"\n",(0,r.jsx)(n.p,{children:'This is the discovery process for what humans call "corners are gold, edges are silver, center is grass." The network wasn\'t told this principle - it discovered it from hundreds of thousands of games.'}),"\n",(0,r.jsx)(n.h3,{id:"emergence-of-joseki",children:"Emergence of Joseki"}),"\n",(0,r.jsx)(n.p,{children:'More amazingly, the network began to "invent" joseki - standard corner sequences for both sides:'}),"\n",(0,r.jsx)(n.h4,{id:"observed-phenomenon",children:"Observed Phenomenon"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Early training: Corner play varies wildly\nMid training: Certain sequences appear repeatedly\nLate training: Stable corner joseki forms\n"})}),"\n",(0,r.jsxs)(n.p,{children:["These joseki are ",(0,r.jsx)(n.strong,{children:"highly similar"})," to joseki humans accumulated over centuries, validating that these joseki are indeed approximations of optimal play for both sides."]}),"\n",(0,r.jsx)(n.h3,{id:"typical-emergent-joseki",children:"Typical Emergent Joseki"}),"\n",(0,r.jsx)(n.p,{children:"Using komoku joseki as an example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"  A B C D E F G H J\n9 . . . . . . . . .\n8 . . . . . . . . .\n7 . . . . . . . . .\n6 . . . \u25cf . . . . .   \u25cf = Black\n5 . . . . . . . . .   \u25cb = White\n4 . . . \u25cb . \u25cf . . .\n3 . . . . . . . . .\n2 . . . . . . . . .\n1 . . . . . . . . .\n"})}),"\n",(0,r.jsx)(n.p,{children:"Black occupies komoku, White approaches, Black pincer - this sequence naturally emerged during training."}),"\n",(0,r.jsx)(n.h3,{id:"shape-knowledge",children:"Shape Knowledge"}),"\n",(0,r.jsx)(n.p,{children:"Beyond joseki, the network also learned the difference between good and bad shapes:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Shape"}),(0,r.jsx)(n.th,{children:"Human Evaluation"}),(0,r.jsx)(n.th,{children:"Zero's Learning"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Empty triangle"}),(0,r.jsx)(n.td,{children:"Bad shape"}),(0,r.jsx)(n.td,{children:"Gradually avoids"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Tiger's mouth"}),(0,r.jsx)(n.td,{children:"Good shape"}),(0,r.jsx)(n.td,{children:"Gradually prefers"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Double wing"}),(0,r.jsx)(n.td,{children:"Classic attack shape"}),(0,r.jsx)(n.td,{children:"Naturally discovered"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Capping move"}),(0,r.jsx)(n.td,{children:"Strong attack"}),(0,r.jsx)(n.td,{children:"Naturally discovered"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"strength-assessment-1",children:"Strength Assessment"}),"\n",(0,r.jsx)(n.p,{children:"At this point, AlphaGo Zero:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ELO"}),": ~3000"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Equivalent to"}),": Strong amateur"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Characteristics"}),": Has basic joseki knowledge, understands basic shapes"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"hour-12-36-maturation-of-go-principles",children:"Hour 12-36: Maturation of Go Principles"}),"\n",(0,r.jsx)(n.h3,{id:"formation-of-global-vision",children:"Formation of Global Vision"}),"\n",(0,r.jsxs)(n.p,{children:["Entering the second day, the network began to exhibit ",(0,r.jsx)(n.strong,{children:"global vision"}),":"]}),"\n",(0,r.jsx)(n.h4,{id:"influence-vs-territory",children:"Influence vs. Territory"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Observation: Enclosing space gives points\n          But influence also has value - can attack opponent\nLearning: Finding balance between territory and influence\n"})}),"\n",(0,r.jsx)(n.p,{children:'This is one of Go\'s most profound concepts. The network learned to evaluate "virtual" and "solid" value.'}),"\n",(0,r.jsx)(n.h4,{id:"thickness-judgment",children:"Thickness Judgment"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'Observation: "Thick" stones can support distant fighting\n          "Thin" stones need reinforcement or will be attacked\nLearning: Proactively build thickness, attack opponent\'s weaknesses\n'})}),"\n",(0,r.jsx)(n.h3,{id:"middle-game-tactics",children:"Middle Game Tactics"}),"\n",(0,r.jsx)(n.p,{children:"The network's middle game fighting ability improved dramatically:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Technique"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Attack weak groups"}),(0,r.jsx)(n.td,{children:"Identify opponent's isolated stones, launch attacks"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Utilize thickness"}),(0,r.jsx)(n.td,{children:"Use strong positions to support attacks, gain benefits"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Exchange"}),(0,r.jsx)(n.td,{children:"Give up local loss for global advantage"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Invasion"}),(0,r.jsx)(n.td,{children:"Reduce opponent's framework"})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"endgame-skills",children:"Endgame Skills"}),"\n",(0,r.jsx)(n.p,{children:"Endgame calculation precision also improved:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Observation: Each endgame move's value can be precisely calculated\nLearning: Collect endgame points in order of value\n"})}),"\n",(0,r.jsx)(n.p,{children:'The network learned endgame concepts like "sente for both," "sente for one," and "gote."'}),"\n",(0,r.jsx)(n.h3,{id:"strength-assessment-2",children:"Strength Assessment"}),"\n",(0,r.jsx)(n.p,{children:"At this point, AlphaGo Zero:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ELO"}),": ~4500"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Equivalent to"}),": Professional level"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Characteristics"}),": Has complete Go understanding, can play high-quality games"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"hour-36-72-surpassing-humans",children:"Hour 36-72: Surpassing Humans"}),"\n",(0,r.jsx)(n.h3,{id:"breaking-through-professional-level",children:"Breaking Through Professional Level"}),"\n",(0,r.jsx)(n.p,{children:"Around 36 hours, AlphaGo Zero's strength reached professional level. But training didn't stop - it continued self-play, continued improving."}),"\n",(0,r.jsxs)(n.p,{children:["What happened next is even more interesting: ",(0,r.jsx)(n.strong,{children:"it began discovering moves humans never thought of"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"revolutionary-openings",children:"Revolutionary Openings"}),"\n",(0,r.jsx)(n.p,{children:'Traditional Go openings have many "established views":'}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Traditional View"}),(0,r.jsx)(n.th,{children:"AlphaGo Zero's Discovery"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Occupy corners first in opening"}),(0,r.jsx)(n.td,{children:"Sometimes occupying edges first is better"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Komoku is most stable"}),(0,r.jsx)(n.td,{children:"Direct 3-3 invasion is viable"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Must memorize joseki"}),(0,r.jsx)(n.td,{children:"Can actively deviate from joseki"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"3-3 invasion too early is greedy"}),(0,r.jsx)(n.td,{children:"3-3 invasion is correct in some positions"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:'These "discoveries" have been widely studied by professional players after AlphaGo, and many have been incorporated into modern Go theory.'}),"\n",(0,r.jsx)(n.h3,{id:"counter-intuitive-shapes",children:"Counter-intuitive Shapes"}),"\n",(0,r.jsx)(n.p,{children:'AlphaGo Zero sometimes plays shapes humans consider "ugly":'}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:'Human: "This is bad shape, can\'t possibly be good"\nZero: (plays that move)\nAfter analysis: "Turns out this is more efficient"\n'})}),"\n",(0,r.jsx)(n.p,{children:'This reveals limitations in human Go theory: some "bad shapes" are actually optimal in specific positions.'}),"\n",(0,r.jsx)(n.h3,{id:"aggressive-sacrifices",children:"Aggressive Sacrifices"}),"\n",(0,r.jsx)(n.p,{children:"Zero is more willing than humans to sacrifice stones for other benefits:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Local loss of 3 points\nGain global initiative\nFinal win rate increases\n"})}),"\n",(0,r.jsx)(n.p,{children:"Human players often care too much about local gains and losses, while Zero always focuses on final win rate."}),"\n",(0,r.jsx)(n.h3,{id:"strength-assessment-3",children:"Strength Assessment"}),"\n",(0,r.jsx)(n.p,{children:"AlphaGo Zero after 72 hours:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"ELO"}),": ~5400"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Equivalent to"}),": Surpasses all human players"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Characteristics"}),": Discovers unknown moves, creates new Go theory"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"rediscovering-human-go-principles",children:"Rediscovering Human Go Principles"}),"\n",(0,r.jsx)(n.h3,{id:"thousands-of-years-vs-three-days",children:"Thousands of Years vs. Three Days"}),"\n",(0,r.jsx)(n.p,{children:"Human Go developed over thousands of years:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Originated in China around 2000 BCE"}),"\n",(0,r.jsx)(n.li,{children:"Spread to Japan during Tang Dynasty, developed refined theory"}),"\n",(0,r.jsx)(n.li,{children:"Professional system emerged in 20th century, theory deepened further"}),"\n",(0,r.jsx)(n.li,{children:"By 2016, humans believed they understood Go quite well"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["AlphaGo Zero completed this journey in three days. Even more stunning, the Go principles it discovered are ",(0,r.jsx)(n.strong,{children:"highly consistent"})," with human ones."]}),"\n",(0,r.jsx)(n.h3,{id:"validation-and-transcendence",children:"Validation and Transcendence"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Human Knowledge"}),(0,r.jsx)(n.th,{children:"Zero's Attitude"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Corners gold, edges silver, center grass"}),(0,r.jsx)(n.td,{children:"Confirmed (corners are indeed important)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Basic joseki"}),(0,r.jsx)(n.td,{children:"Mostly confirmed, few improvements"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Good/bad shapes"}),(0,r.jsx)(n.td,{children:"Mostly confirmed, exceptions exist"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Sacrifice exchanges"}),(0,r.jsx)(n.td,{children:"More aggressive than humans"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Thickness judgment"}),(0,r.jsx)(n.td,{children:"Generally consistent, details differ"})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:["This shows human Go principles accumulated over thousands of years ",(0,r.jsx)(n.strong,{children:"are largely correct"}),". But there are also areas where human understanding needs revision."]}),"\n",(0,r.jsx)(n.h3,{id:"insights-for-human-learning",children:"Insights for Human Learning"}),"\n",(0,r.jsx)(n.p,{children:"AlphaGo Zero's training process offers insights for human learning:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Start from basics"}),": Zero first learned rules, then shapes, finally global vision"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Massive practice"}),": 4.9 million self-play games equals tens of thousands of years of human games"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Focus on winning"}),': Don\'t pursue "beautiful play," only pursue winning']}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Don't be bound by tradition"}),': Dare to try "impossible" moves']}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"technical-details-of-training",children:"Technical Details of Training"}),"\n",(0,r.jsx)(n.h3,{id:"self-play-mechanism",children:"Self-Play Mechanism"}),"\n",(0,r.jsx)(n.p,{children:"Each self-play game flow:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Initialize: Empty board\n\u2193\nEach move:\n  1. Evaluate current position with neural network\n  2. Execute MCTS search (1600 simulations)\n  3. Select move based on search results\n  4. Record (position, MCTS probabilities, -)\n\u2193\nGame ends:\n  1. Determine winner z \u2208 {-1, +1}\n  2. Add outcome to all records (position, MCTS probabilities, z)\n  3. Add data to training pool\n"})}),"\n",(0,r.jsx)(n.h3,{id:"training-rhythm",children:"Training Rhythm"}),"\n",(0,r.jsxs)(n.p,{children:["AlphaGo Zero's training is ",(0,r.jsx)(n.strong,{children:"continuous"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Self-play Workers:       Continuously generate self-play data\nTraining Workers:        Continuously sample from data pool and train\nNetwork Updates:         Periodically update network used for self-play\n"})}),"\n",(0,r.jsx)(n.p,{children:"These three processes run simultaneously, forming a continuous improvement loop."}),"\n",(0,r.jsx)(n.h3,{id:"data-pool-management",children:"Data Pool Management"}),"\n",(0,r.jsx)(n.p,{children:"Training data pool management:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Value"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Pool size"}),(0,r.jsx)(n.td,{children:"Most recent 500,000 games"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Samples per game"}),(0,r.jsx)(n.td,{children:"~200 moves"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Total samples"}),(0,r.jsx)(n.td,{children:"~100 million"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Sampling method"}),(0,r.jsx)(n.td,{children:"Uniform random"})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Old data is replaced by new data, ensuring training data reflects current network level."}),"\n",(0,r.jsx)(n.h3,{id:"network-update-strategy",children:"Network Update Strategy"}),"\n",(0,r.jsx)(n.p,{children:"The self-play network isn't updated after every training step. Instead:"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsx)(n.li,{children:"After training for a while, generate candidate network"}),"\n",(0,r.jsx)(n.li,{children:"Have candidate network play against current network (400 games)"}),"\n",(0,r.jsx)(n.li,{children:"If candidate win rate > 55%, update"}),"\n",(0,r.jsx)(n.li,{children:"Otherwise continue training"}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This ensures self-play always uses a ",(0,r.jsx)(n.strong,{children:"sufficiently strong"})," network."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"analysis-of-learning-speed",children:"Analysis of Learning Speed"}),"\n",(0,r.jsx)(n.h3,{id:"why-so-fast",children:"Why So Fast?"}),"\n",(0,r.jsx)(n.p,{children:"Reasons for AlphaGo Zero's stunning learning speed:"}),"\n",(0,r.jsx)(n.h4,{id:"1-computational-resources",children:"1. Computational Resources"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"4 TPUs, tens of thousands of inferences per second"}),"\n",(0,r.jsx)(n.li,{children:"Hundreds of thousands of self-play games per day"}),"\n",(0,r.jsx)(n.li,{children:"Equivalent to thousands of years of human games"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"2-perfect-opponent",children:"2. Perfect Opponent"}),"\n",(0,r.jsx)(n.p,{children:"Self-play means:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Opponent level is always comparable to self"}),"\n",(0,r.jsx)(n.li,{children:"Not too weak (nothing to learn) or too strong (can't win)"}),"\n",(0,r.jsx)(n.li,{children:"These are ideal learning conditions"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"3-direct-objective",children:"3. Direct Objective"}),"\n",(0,r.jsx)(n.p,{children:"Only one goal: win. No:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Teacher preferences"}),"\n",(0,r.jsx)(n.li,{children:"Style pursuits"}),"\n",(0,r.jsx)(n.li,{children:"Aesthetic considerations"}),"\n"]}),"\n",(0,r.jsx)(n.h4,{id:"4-efficient-representation-learning",children:"4. Efficient Representation Learning"}),"\n",(0,r.jsx)(n.p,{children:"Residual networks can learn very abstract board features, more effective than hand-designed features."}),"\n",(0,r.jsx)(n.h3,{id:"comparison-with-humans",children:"Comparison with Humans"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Aspect"}),(0,r.jsx)(n.th,{children:"Human"}),(0,r.jsx)(n.th,{children:"AlphaGo Zero"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Learning speed"}),(0,r.jsx)(n.td,{children:"~10 games/day"}),(0,r.jsx)(n.td,{children:"~100,000 games/day"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Memory retention"}),(0,r.jsx)(n.td,{children:"Has forgetting"}),(0,r.jsx)(n.td,{children:"Perfect retention"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Energy limits"}),(0,r.jsx)(n.td,{children:"Needs rest"}),(0,r.jsx)(n.td,{children:"Runs 24/7"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Innovation ability"}),(0,r.jsx)(n.td,{children:"Influenced by tradition"}),(0,r.jsx)(n.td,{children:"No preset limitations"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"interesting-phenomena-during-training",children:"Interesting Phenomena During Training"}),"\n",(0,r.jsx)(n.h3,{id:"periodic-stagnation",children:"Periodic Stagnation"}),"\n",(0,r.jsxs)(n.p,{children:["The training curve isn't completely smooth; sometimes ",(0,r.jsx)(n.strong,{children:"plateau periods"})," appear:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"ELO: 2000 -----\x3e 2000 -----\x3e 2500 ----\x3e\n          (stagnation)  (breakthrough)\n"})}),"\n",(0,r.jsx)(n.p,{children:'This might be because the network is learning some new concept and needs time to "digest."'}),"\n",(0,r.jsx)(n.h3,{id:"emergence-and-disappearance-of-strategies",children:"Emergence and Disappearance of Strategies"}),"\n",(0,r.jsx)(n.p,{children:"Certain strategies emerge during training, then disappear:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Stage 1: Discover some attack technique\nStage 2: Opponent learns to defend\nStage 3: That technique's usage decreases\nStage 4: Discover new attack technique\n"})}),"\n",(0,r.jsx)(n.p,{children:"This is an arms race in miniature."}),"\n",(0,r.jsx)(n.h3,{id:"reinventing-the-wheel",children:'"Reinventing the Wheel"'}),"\n",(0,r.jsx)(n.p,{children:'During training, Zero "reinvents" concepts humans already knew:'}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ladder"}),": Discovers continuous atari can capture stones"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Snapback"}),": Discovers sacrificing first then counter-killing"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Ko"}),": Discovers how to use the superko rule"]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The order of these discoveries is similar to how humans learn Go."}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"animation-reference",children:"Animation Reference"}),"\n",(0,r.jsx)(n.p,{children:"Core concepts covered in this article with animation numbers:"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Number"}),(0,r.jsx)(n.th,{children:"Concept"}),(0,r.jsx)(n.th,{children:"Physics/Math Correspondence"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Animation E12"}),(0,r.jsx)(n.td,{children:"Strength growth curve"}),(0,r.jsx)(n.td,{children:"S-curve growth (logistic)"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Animation E7"}),(0,r.jsx)(n.td,{children:"From scratch"}),(0,r.jsx)(n.td,{children:"Self-organization"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Animation E5"}),(0,r.jsx)(n.td,{children:"Self-play"}),(0,r.jsx)(n.td,{children:"Fixed-point convergence"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"Animation F8"}),(0,r.jsx)(n.td,{children:"Emergent abilities"}),(0,r.jsx)(n.td,{children:"Phase transition"})]})]})]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Previous"}),": ",(0,r.jsx)(n.a,{href:"../dual-head-resnet",children:"Dual-Head Network and Residual Network"})," - The neural network architecture supporting all this"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Next"}),": ",(0,r.jsx)(n.a,{href:"../distributed-systems",children:"Distributed Systems and TPU"})," - The hardware making this possible"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Related Article"}),": ",(0,r.jsx)(n.a,{href:"../self-play",children:"Self-Play"})," - Why self-play is so effective"]}),"\n"]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"references",children:"References"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:['Silver, D., et al. (2017). "Mastering the game of Go without human knowledge." ',(0,r.jsx)(n.em,{children:"Nature"}),", 550, 354-359."]}),"\n",(0,r.jsxs)(n.li,{children:['Silver, D., et al. (2017). "AlphaGo Zero: Starting from scratch." ',(0,r.jsx)(n.em,{children:"DeepMind Blog"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:['DeepMind. (2017). "AlphaGo Zero: Learning from scratch." ',(0,r.jsx)(n.em,{children:"YouTube"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:['Wang, F., et al. (2019). "A Survey on the Evolution of AlphaGo." ',(0,r.jsx)(n.em,{children:"arXiv:1907.11180"}),"."]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(h,{...e})}):h(e)}},42948(e,n,t){t.d(n,{A:()=>i});t(59471);var s=t(61785),r=t(62615);function i({children:e,fallback:n}){return(0,s.A)()?(0,r.jsx)(r.Fragment,{children:e?.()}):n??null}},45695(e,n,t){t.d(n,{$W:()=>w,tO:()=>o,u8:()=>j,dW:()=>u});var s=t(59471),r=t(90989),i=t(62615);const a=19,l=[[3,3],[3,9],[3,15],[9,3],[9,9],[9,15],[15,3],[15,9],[15,15]];function o({size:e=400,stones:n=[],highlights:t=[],labels:o=[],onCellClick:d=null,showCoordinates:c=!0}){const h=(0,s.useRef)(null),p=c?30:15,x=e-2*p,u=x/18;return(0,s.useEffect)(()=>{if(!h.current)return;const e=r.Ltv(h.current);e.selectAll("*").remove();const s=e.append("g").attr("transform",`translate(${p}, ${p})`);s.append("rect").attr("x",-u/2).attr("y",-u/2).attr("width",x+u).attr("height",x+u).attr("fill","#dcb35c").attr("rx",4);const i=s.append("g").attr("class","grid");for(let n=0;n<a;n++)i.append("line").attr("class","grid-line").attr("x1",0).attr("y1",n*u).attr("x2",18*u).attr("y2",n*u);for(let n=0;n<a;n++)i.append("line").attr("class","grid-line").attr("x1",n*u).attr("y1",0).attr("x2",n*u).attr("y2",18*u);const g=s.append("g").attr("class","star-points");if(l.forEach(([e,n])=>{g.append("circle").attr("class","star-point").attr("cx",e*u).attr("cy",n*u).attr("r",u/8)}),t.length>0){const e=s.append("g").attr("class","highlights");t.forEach(({x:n,y:t,intensity:s})=>{e.append("rect").attr("class","heatmap-cell").attr("x",n*u-u/2).attr("y",t*u-u/2).attr("width",u).attr("height",u).attr("fill",r.Q3(s)).attr("opacity",.7*s)})}const m=s.append("g").attr("class","stones");if(n.forEach(({x:e,y:n,color:t})=>{const s="black"===t?"stone-black":"stone-white";m.append("circle").attr("cx",e*u+2).attr("cy",n*u+2).attr("r",.45*u).attr("fill","rgba(0,0,0,0.2)"),m.append("circle").attr("class",s).attr("cx",e*u).attr("cy",n*u).attr("r",.45*u)}),o.length>0){const e=s.append("g").attr("class","labels");o.forEach(({x:t,y:s,text:r})=>{const i=n.find(e=>e.x===t&&e.y===s),a="black"===i?.color?"#fff":"#000";e.append("text").attr("x",t*u).attr("y",s*u).attr("dy","0.35em").attr("text-anchor","middle").attr("fill",a).attr("font-size",.5*u).attr("font-weight","bold").text(r)})}if(c){const n=e.append("g").attr("class","coordinates"),t="ABCDEFGHJKLMNOPQRST";for(let e=0;e<a;e++)n.append("text").attr("x",p+e*u).attr("y",p/2).attr("text-anchor","middle").attr("fill","#666").attr("font-size",10).text(t[e]);for(let e=0;e<a;e++)n.append("text").attr("x",p/2).attr("y",p+e*u).attr("dy","0.35em").attr("text-anchor","middle").attr("fill","#666").attr("font-size",10).text(a-e)}d&&s.append("g").attr("class","click-targets").selectAll("rect").data(r.y17(361)).enter().append("rect").attr("x",e=>e%a*u-u/2).attr("y",e=>Math.floor(e/a)*u-u/2).attr("width",u).attr("height",u).attr("fill","transparent").attr("cursor","pointer").on("click",(e,n)=>{const t=n%a,s=Math.floor(n/a);d({x:t,y:s})})},[e,n,t,o,c,d,u,p,x]),(0,i.jsx)("div",{className:"go-board-container",children:(0,i.jsx)("svg",{ref:h,width:e,height:e,className:"go-board"})})}var d=t(42948);const c=19,h={empty:function(){const e=[];for(let n=0;n<c;n++)for(let t=0;t<c;t++)e.push({x:t,y:n,prob:1/361});return e}(),corner:function(){const e=[],n=[[3,3],[3,15],[15,3],[15,15]],t=[[2,4],[4,2],[2,14],[4,16],[14,2],[16,4],[14,16],[16,14]];for(let s=0;s<c;s++)for(let r=0;r<c;r++){let i=.001;n.some(([e,n])=>e===r&&n===s)?i=.15:t.some(([e,n])=>e===r&&n===s)?i=.05:0!==r&&18!==r&&0!==s&&18!==s||(i=5e-4),e.push({x:r,y:s,prob:i})}return p(e)}(),move37:function(){const e=[],n={x:9,y:4},t=[[3,2],[15,2],[10,10],[8,6]];for(let s=0;s<c;s++)for(let r=0;r<c;r++){let i=.001;r===n.x&&s===n.y?i=.08:t.some(([e,n])=>e===r&&n===s)?i=.12:r>=5&&r<=13&&s>=5&&s<=13&&(i=.005+.01*Math.random()),e.push({x:r,y:s,prob:i})}return p(e)}()};function p(e){const n=e.reduce((e,n)=>e+n.prob,0);return e.map(e=>({...e,prob:e.prob/n}))}function x({initialPosition:e="corner",stones:n=[],highlightMoves:t=[],size:a=450,showTopN:l=5,interactive:o=!0}){const d=(0,s.useRef)(null),p=(0,s.useRef)(null),[x,u]=(0,s.useState)(h[e]||h.corner),[g,m]=(0,s.useState)(null),j=35,f=a-70,v=f/18;(0,s.useEffect)(()=>{if(!d.current)return;const e=r.Ltv(d.current);e.selectAll("*").remove();const t=e.append("g").attr("transform","translate(35, 35)");t.append("rect").attr("x",-v/2).attr("y",-v/2).attr("width",f+v).attr("height",f+v).attr("fill","#dcb35c").attr("rx",4);const s=Math.max(...x.map(e=>e.prob)),i=r.exT(r.oKI).domain([0,s]);t.append("g").attr("class","heatmap").selectAll("rect").data(x).enter().append("rect").attr("class","heatmap-cell").attr("x",e=>e.x*v-v/2).attr("y",e=>e.y*v-v/2).attr("width",v).attr("height",v).attr("fill",e=>i(e.prob)).attr("opacity",e=>.3+e.prob/s*.6).attr("cursor",o?"pointer":"default").on("mouseover",function(e,n){if(!o)return;r.Ltv(this).attr("stroke","#333").attr("stroke-width",2);r.Ltv(p.current).style("display","block").style("left",`${e.pageX+10}px`).style("top",e.pageY-10+"px").html(`\u4f4d\u7f6e: ${String.fromCharCode(65+n.x)}${19-n.y}<br>\u6a5f\u7387: ${(100*n.prob).toFixed(2)}%`)}).on("mouseout",function(){r.Ltv(this).attr("stroke","none"),r.Ltv(p.current).style("display","none")}).on("click",function(e,n){o&&m(n)});const a=t.append("g").attr("class","grid");for(let n=0;n<c;n++)a.append("line").attr("class","grid-line").attr("x1",0).attr("y1",n*v).attr("x2",18*v).attr("y2",n*v).attr("stroke","#333").attr("stroke-width",.5).attr("opacity",.5),a.append("line").attr("class","grid-line").attr("x1",n*v).attr("y1",0).attr("x2",n*v).attr("y2",18*v).attr("stroke","#333").attr("stroke-width",.5).attr("opacity",.5);const h=t.append("g").attr("class","stones");n.forEach(({x:e,y:n,color:t})=>{h.append("circle").attr("cx",e*v).attr("cy",n*v).attr("r",.45*v).attr("fill","black"===t?"#1a1a1a":"#f5f5f5").attr("stroke","black"===t?"#000":"#333").attr("stroke-width",1)});const u=[...x].sort((e,n)=>n.prob-e.prob).slice(0,l),g=t.append("g").attr("class","top-labels");u.forEach((e,t)=>{n.some(n=>n.x===e.x&&n.y===e.y)||(g.append("circle").attr("cx",e.x*v).attr("cy",e.y*v).attr("r",.3*v).attr("fill","rgba(255,255,255,0.8)").attr("stroke","#e74c3c").attr("stroke-width",2),g.append("text").attr("x",e.x*v).attr("y",e.y*v).attr("dy","0.35em").attr("text-anchor","middle").attr("fill","#e74c3c").attr("font-size",.4*v).attr("font-weight","bold").text(t+1))});const y=e.append("g").attr("class","coordinates");for(let n=0;n<c;n++)y.append("text").attr("x",j+n*v).attr("y",17.5).attr("text-anchor","middle").attr("fill","#666").attr("font-size",10).text("ABCDEFGHJKLMNOPQRST"[n]),y.append("text").attr("x",17.5).attr("y",j+n*v).attr("dy","0.35em").attr("text-anchor","middle").attr("fill","#666").attr("font-size",10).text(c-n)},[x,n,l,o,v,j,f]);const y=e=>{u(h[e]||h.corner)};return(0,i.jsxs)("div",{children:[o&&(0,i.jsxs)("div",{className:"d3-controls",children:[(0,i.jsx)("button",{className:"empty"===e?"active":"",onClick:()=>y("empty"),children:"\u5747\u52fb\u5206\u5e03"}),(0,i.jsx)("button",{className:"corner"===e?"active":"",onClick:()=>y("corner"),children:"\u958b\u5c40\u661f\u4f4d"}),(0,i.jsx)("button",{className:"move37"===e?"active":"",onClick:()=>y("move37"),children:"\u7b2c 37 \u624b"})]}),(0,i.jsx)("div",{className:"go-board-container",children:(0,i.jsx)("svg",{ref:d,width:a,height:a,className:"go-board"})}),(0,i.jsx)("div",{ref:p,className:"d3-tooltip",style:{display:"none",position:"fixed"}}),g&&(0,i.jsx)("div",{className:"d3-legend",children:(0,i.jsxs)("div",{className:"d3-legend-item",children:["\u5df2\u9078\u64c7: ",String.fromCharCode(65+g.x),19-g.y,"\u2014 \u6a5f\u7387: ",(100*g.prob).toFixed(2),"%"]})}),(0,i.jsxs)("div",{className:"d3-legend",children:[(0,i.jsxs)("div",{className:"d3-legend-item",children:[(0,i.jsx)("div",{className:"d3-legend-color",style:{background:"#ffffb2"}}),"\u4f4e\u6a5f\u7387"]}),(0,i.jsxs)("div",{className:"d3-legend-item",children:[(0,i.jsx)("div",{className:"d3-legend-color",style:{background:"#fd8d3c"}}),"\u4e2d\u6a5f\u7387"]}),(0,i.jsxs)("div",{className:"d3-legend-item",children:[(0,i.jsx)("div",{className:"d3-legend-color",style:{background:"#bd0026"}}),"\u9ad8\u6a5f\u7387"]})]})]})}function u(e){return(0,i.jsx)(d.A,{fallback:(0,i.jsx)("div",{children:"\u8f09\u5165\u4e2d..."}),children:()=>(0,i.jsx)(x,{...e})})}const g={name:"Root",visits:1600,value:.55,prior:1,children:[{name:"D4",visits:800,value:.62,prior:.35,selected:!0,children:[{name:"Q16",visits:400,value:.58,prior:.3},{name:"R4",visits:300,value:.65,prior:.25,selected:!0},{name:"C16",visits:100,value:.55,prior:.2}]},{name:"Q4",visits:500,value:.52,prior:.3,children:[{name:"D16",visits:300,value:.5,prior:.28},{name:"Q16",visits:200,value:.54,prior:.22}]},{name:"D16",visits:200,value:.48,prior:.2},{name:"Q16",visits:100,value:.45,prior:.15}]};function m({data:e=g,width:n=700,height:t=450,showPUCT:a=!0,cPuct:l=1.5,interactive:o=!0}){const d=(0,s.useRef)(null),c=(0,s.useRef)(null),[h,p]=(0,s.useState)(null),[x,u]=(0,s.useState)(l),m=40,j=40,f=n-j-40,v=t-m-40;return(0,s.useEffect)(()=>{if(!d.current)return;const s=r.Ltv(d.current);s.selectAll("*").remove();const i=r.B22().size([f,v-50]),l=r.Sk5(e);i(l);const h=s.append("g").attr("transform",`translate(${j}, ${m})`);h.append("g").attr("class","links").selectAll("path").data(l.links()).enter().append("path").attr("class",e=>"link "+(e.target.data.selected?"selected":"")).attr("fill","none").attr("stroke",e=>e.target.data.selected?"#4a90d9":"#999").attr("stroke-width",e=>e.target.data.selected?3:1.5).attr("d",r.vu().x(e=>e.x).y(e=>e.y));const u=h.append("g").attr("class","nodes").selectAll("g").data(l.descendants()).enter().append("g").attr("class","node").attr("transform",e=>`translate(${e.x}, ${e.y})`).attr("cursor",o?"pointer":"default").on("mouseover",function(e,n){if(!o)return;r.Ltv(this).select("circle").transition().duration(200).attr("r",30);const t=n.parent?n.parent.data.visits:n.data.visits,s=((e,n)=>{if(!n)return 0;const t=e.value,s=e.prior,r=e.visits;return t+x*s*Math.sqrt(n)/(1+r)})(n.data,t);r.Ltv(c.current).style("display","block").style("left",`${e.pageX+15}px`).style("top",e.pageY-10+"px").html(`\n            <strong>${n.data.name}</strong><br>\n            \u8a2a\u554f\u6b21\u6578 (N): ${n.data.visits}<br>\n            \u5e73\u5747\u50f9\u503c (Q): ${n.data.value.toFixed(3)}<br>\n            \u5148\u9a57\u6a5f\u7387 (P): ${(100*n.data.prior).toFixed(1)}%<br>\n            ${a?`PUCT \u5206\u6578: ${s.toFixed(3)}`:""}\n          `)}).on("mouseout",function(){r.Ltv(this).select("circle").transition().duration(200).attr("r",25),r.Ltv(c.current).style("display","none")}).on("click",function(e,n){o&&p(n.data)});u.append("circle").attr("r",25).attr("fill",e=>e.data.selected?"#4a90d9":"#fff").attr("stroke",n=>{if(n.data.selected)return"#2c5282";const t=n.data.visits/e.visits;return r.dM(.3+.5*t)}).attr("stroke-width",e=>e.data.selected?3:2),u.append("text").attr("dy",-5).attr("text-anchor","middle").attr("fill",e=>e.data.selected?"#fff":"#333").attr("font-size",11).attr("font-weight","bold").text(e=>e.data.name),u.append("text").attr("dy",10).attr("text-anchor","middle").attr("fill",e=>e.data.selected?"#fff":"#666").attr("font-size",9).text(e=>`N=${e.data.visits}`),s.append("text").attr("x",n/2).attr("y",20).attr("text-anchor","middle").attr("font-size",14).attr("font-weight","bold").attr("fill","#333").text("MCTS \u641c\u7d22\u6a39"),a&&s.append("text").attr("x",n/2).attr("y",t-10).attr("text-anchor","middle").attr("font-size",11).attr("fill","#666").text("\u85cd\u8272\u8def\u5f91\uff1aPUCT \u9078\u64c7\u7684\u6700\u4f73\u8def\u5f91")},[e,n,t,a,x,o,f,v]),(0,i.jsxs)("div",{children:[a&&o&&(0,i.jsx)("div",{className:"d3-controls",children:(0,i.jsxs)("div",{className:"d3-slider",children:[(0,i.jsxs)("label",{children:["c_puct: ",x.toFixed(1)]}),(0,i.jsx)("input",{type:"range",min:"0.5",max:"3",step:"0.1",value:x,onChange:e=>u(parseFloat(e.target.value))})]})}),(0,i.jsx)("div",{className:"mcts-tree-container",children:(0,i.jsx)("svg",{ref:d,width:n,height:t,className:"mcts-tree"})}),(0,i.jsx)("div",{ref:c,className:"d3-tooltip",style:{display:"none",position:"fixed"}}),h&&(0,i.jsxs)("div",{className:"d3-legend",style:{background:"#f5f5f5",padding:"1rem",borderRadius:"4px"},children:[(0,i.jsxs)("strong",{children:["\u5df2\u9078\u64c7\u7bc0\u9ede: ",h.name]}),(0,i.jsxs)("div",{children:["\u8a2a\u554f\u6b21\u6578: ",h.visits]}),(0,i.jsxs)("div",{children:["\u5e73\u5747\u50f9\u503c: ",h.value.toFixed(3)]}),(0,i.jsxs)("div",{children:["\u5148\u9a57\u6a5f\u7387: ",(100*h.prior).toFixed(1),"%"]})]}),(0,i.jsxs)("div",{className:"d3-legend",children:[(0,i.jsxs)("div",{className:"d3-legend-item",children:[(0,i.jsx)("div",{className:"d3-legend-color",style:{background:"#4a90d9"}}),"\u9078\u4e2d\u8def\u5f91"]}),(0,i.jsxs)("div",{className:"d3-legend-item",children:[(0,i.jsx)("div",{className:"d3-legend-color",style:{background:"#fff",border:"2px solid #999"}}),"\u5176\u4ed6\u7bc0\u9ede"]}),(0,i.jsx)("div",{className:"d3-legend-item",children:(0,i.jsx)("span",{style:{fontSize:"12px"},children:"\u7bc0\u9ede\u5927\u5c0f \u221d \u8a2a\u554f\u6b21\u6578"})})]})]})}function j(e){return(0,i.jsx)(d.A,{fallback:(0,i.jsx)("div",{children:"\u8f09\u5165\u4e2d..."}),children:()=>(0,i.jsx)(m,{...e})})}const f=[{hours:0,elo:0,label:"\u96a8\u6a5f"},{hours:3,elo:1e3,label:"\u767c\u73fe\u898f\u5247"},{hours:6,elo:2e3},{hours:12,elo:3e3,label:"\u767c\u73fe\u5b9a\u5f0f"},{hours:24,elo:4e3},{hours:36,elo:4500,label:"\u8d85\u8d8a Fan Hui"},{hours:48,elo:5e3},{hours:60,elo:5200,label:"\u8d85\u8d8a Lee Sedol"},{hours:72,elo:5400,label:"\u8d85\u8d8a\u539f\u7248 AlphaGo"}],v=[{elo:2700,label:"\u696d\u9918\u5f37\u8c6a"},{elo:3500,label:"Fan Hui (\u8077\u696d\u4e8c\u6bb5)"},{elo:4500,label:"Lee Sedol (\u4e16\u754c\u51a0\u8ecd)"},{elo:5e3,label:"\u539f\u7248 AlphaGo"}],y=[{epochs:0,elo:0},{epochs:10,elo:1500},{epochs:20,elo:2500},{epochs:30,elo:3e3},{epochs:40,elo:3200},{epochs:50,elo:3300}],b=[{games:0,elo:3300},{games:1e3,elo:3800},{games:5e3,elo:4200},{games:1e4,elo:4500},{games:5e4,elo:4800},{games:1e5,elo:5e3}];function k({mode:e="zero",width:n=600,height:t=400,animated:a=!0,showMilestones:l=!0}){const o=(0,s.useRef)(null),[d,c]=(0,s.useState)(e),h=40,p=70,x=n-p-100,u=t-h-60;return(0,s.useEffect)(()=>{if(!o.current)return;const e=r.Ltv(o.current);let t,s,i;e.selectAll("*").remove(),"zero"===d?(t=f,s="\u8a13\u7df4\u6642\u9593\uff08\u5c0f\u6642\uff09",i=[0,80]):"sl"===d?(t=y,s="\u8a13\u7df4\u8f2a\u6578\uff08Epochs\uff09",i=[0,60]):(t=b,s="\u81ea\u6211\u5c0d\u5f08\u5c40\u6578",i=[0,12e4]);const c="selfplay"===d?r.ZEH().domain([1,i[1]]).range([0,x]):r.m4Y().domain(i).range([0,x]),g=r.m4Y().domain([0,6e3]).range([u,0]),m=e.append("g").attr("transform",`translate(${p}, ${h})`);if(m.append("g").attr("class","grid").selectAll(".grid-line-y").data(g.ticks(6)).enter().append("line").attr("class","grid-line-y").attr("x1",0).attr("x2",x).attr("y1",e=>g(e)).attr("y2",e=>g(e)).attr("stroke","#ddd").attr("stroke-dasharray","3,3"),l&&"zero"===d){const e=m.append("g").attr("class","human-levels");v.forEach(n=>{e.append("line").attr("x1",0).attr("x2",x).attr("y1",g(n.elo)).attr("y2",g(n.elo)).attr("stroke","#e74c3c").attr("stroke-dasharray","5,5").attr("opacity",.6),e.append("text").attr("x",x+5).attr("y",g(n.elo)).attr("dy","0.35em").attr("fill","#e74c3c").attr("font-size",10).text(n.label)})}const j=r.n8j().x(e=>c("zero"===d?e.hours:"sl"===d?e.epochs:Math.max(1,e.games))).y(e=>g(e.elo)).curve(r.nVG),k=r.Wcw().x(e=>c("zero"===d?e.hours:"sl"===d?e.epochs:Math.max(1,e.games))).y0(u).y1(e=>g(e.elo)).curve(r.nVG);m.append("path").datum(t).attr("class","area").attr("fill","#4a90d9").attr("opacity",.1).attr("d",k);const w=m.append("path").datum(t).attr("class","line").attr("fill","none").attr("stroke","#4a90d9").attr("stroke-width",3).attr("d",j);if(a){const e=w.node().getTotalLength();w.attr("stroke-dasharray",`${e} ${e}`).attr("stroke-dashoffset",e).transition().duration(2e3).ease(r.yfw).attr("stroke-dashoffset",0)}if(l&&"zero"===d){const e=t.filter(e=>e.label),n=m.append("g").attr("class","milestones");n.selectAll("circle").data(e).enter().append("circle").attr("cx",e=>c(e.hours)).attr("cy",e=>g(e.elo)).attr("r",6).attr("fill","#e74c3c").attr("stroke","#fff").attr("stroke-width",2),n.selectAll("text").data(e).enter().append("text").attr("x",e=>c(e.hours)).attr("y",e=>g(e.elo)-15).attr("text-anchor","middle").attr("fill","#333").attr("font-size",10).text(e=>e.label)}const T="selfplay"===d?r.l78(c).ticks(5,"~s"):r.l78(c);m.append("g").attr("class","x-axis").attr("transform",`translate(0, ${u})`).call(T),m.append("text").attr("class","axis-label").attr("x",x/2).attr("y",u+45).attr("text-anchor","middle").attr("fill","#666").text(s),m.append("g").attr("class","y-axis").call(r.V4s(g).ticks(6)),m.append("text").attr("class","axis-label").attr("transform","rotate(-90)").attr("x",-u/2).attr("y",-50).attr("text-anchor","middle").attr("fill","#666").text("ELO \u8a55\u5206"),e.append("text").attr("x",n/2).attr("y",20).attr("text-anchor","middle").attr("font-size",14).attr("font-weight","bold").attr("fill","#333").text("zero"===d?"AlphaGo Zero \u8a13\u7df4\u66f2\u7dda":"sl"===d?"\u76e3\u7763\u5b78\u7fd2\u68cb\u529b\u6210\u9577":"\u81ea\u6211\u5c0d\u5f08\u68cb\u529b\u6210\u9577")},[d,n,t,a,l,x,u]),(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:"d3-controls",children:[(0,i.jsx)("button",{className:"zero"===d?"active":"",onClick:()=>c("zero"),children:"AlphaGo Zero"}),(0,i.jsx)("button",{className:"sl"===d?"active":"",onClick:()=>c("sl"),children:"\u76e3\u7763\u5b78\u7fd2"}),(0,i.jsx)("button",{className:"selfplay"===d?"active":"",onClick:()=>c("selfplay"),children:"\u81ea\u6211\u5c0d\u5f08"})]}),(0,i.jsx)("div",{className:"elo-chart-container",children:(0,i.jsx)("svg",{ref:o,width:n,height:t,className:"elo-chart"})}),(0,i.jsxs)("div",{className:"d3-legend",children:[(0,i.jsxs)("div",{className:"d3-legend-item",children:[(0,i.jsx)("div",{className:"d3-legend-color",style:{background:"#4a90d9"}}),"ELO \u8a55\u5206"]}),l&&"zero"===d&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)("div",{className:"d3-legend-item",children:[(0,i.jsx)("div",{className:"d3-legend-color",style:{background:"#e74c3c"}}),"\u91cc\u7a0b\u7891"]}),(0,i.jsxs)("div",{className:"d3-legend-item",children:[(0,i.jsx)("div",{className:"d3-legend-color",style:{background:"#e74c3c",opacity:.3}}),"\u4eba\u985e\u6c34\u5e73\u53c3\u8003\u7dda"]})]})]})]})}function w(e){return(0,i.jsx)(d.A,{fallback:(0,i.jsx)("div",{children:"\u8f09\u5165\u4e2d..."}),children:()=>(0,i.jsx)(k,{...e})})}},30416(e,n,t){t.d(n,{R:()=>a,x:()=>l});var s=t(59471);const r={},i=s.createContext(r);function a(e){const n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);