"use strict";(globalThis.webpackChunktemp_docusaurus=globalThis.webpackChunktemp_docusaurus||[]).push([[9946],{82228(e,n,i){i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>c,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"for-engineers/deep-dive/gpu-optimization","title":"GPU Backend & Optimization","description":"KataGo\'s CUDA, OpenCL, Metal backend comparison and performance tuning guide","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/for-engineers/deep-dive/gpu-optimization.md","sourceDirName":"for-engineers/deep-dive","slug":"/for-engineers/deep-dive/gpu-optimization","permalink":"/en/docs/for-engineers/deep-dive/gpu-optimization","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/for-engineers/deep-dive/gpu-optimization.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"title":"GPU Backend & Optimization","description":"KataGo\'s CUDA, OpenCL, Metal backend comparison and performance tuning guide"},"sidebar":"tutorialSidebar","previous":{"title":"MCTS Implementation Details","permalink":"/en/docs/for-engineers/deep-dive/mcts-implementation"},"next":{"title":"Distributed Training Architecture","permalink":"/en/docs/for-engineers/deep-dive/distributed-training"}}');var s=i(62615),l=i(30416);const c={sidebar_position:6,title:"GPU Backend & Optimization",description:"KataGo's CUDA, OpenCL, Metal backend comparison and performance tuning guide"},a="GPU Backend & Optimization",d={},t=[{value:"Backend Overview",id:"backend-overview",level:2},{value:"CUDA Backend",id:"cuda-backend",level:2},{value:"Use Cases",id:"use-cases",level:3},{value:"Installation Requirements",id:"installation-requirements",level:3},{value:"Compilation",id:"compilation",level:3},{value:"Performance Characteristics",id:"performance-characteristics",level:3},{value:"OpenCL Backend",id:"opencl-backend",level:2},{value:"Use Cases",id:"use-cases-1",level:3},{value:"Installation Requirements",id:"installation-requirements-1",level:3},{value:"Compilation",id:"compilation-1",level:3},{value:"Driver Selection",id:"driver-selection",level:3},{value:"Performance Tuning",id:"performance-tuning",level:3},{value:"Metal Backend",id:"metal-backend",level:2},{value:"Use Cases",id:"use-cases-2",level:3},{value:"Compilation",id:"compilation-2",level:3},{value:"Apple Silicon Optimization",id:"apple-silicon-optimization",level:3},{value:"Performance Comparison",id:"performance-comparison",level:3},{value:"Eigen Backend (CPU Only)",id:"eigen-backend-cpu-only",level:2},{value:"Use Cases",id:"use-cases-3",level:3},{value:"Compilation",id:"compilation-3",level:3},{value:"Performance Expectations",id:"performance-expectations",level:3},{value:"Performance Tuning Parameters",id:"performance-tuning-parameters",level:2},{value:"Core Parameters",id:"core-parameters",level:3},{value:"Parameter Tuning Guide",id:"parameter-tuning-guide",level:3},{value:"nnMaxBatchSize",id:"nnmaxbatchsize",level:4},{value:"numSearchThreads",id:"numsearchthreads",level:4},{value:"numNNServerThreadsPerModel",id:"numnnserverthreadspermodel",level:4},{value:"Memory Tuning",id:"memory-tuning",level:3},{value:"Multi-GPU Configuration",id:"multi-gpu-configuration",level:2},{value:"Single Machine Multi-GPU",id:"single-machine-multi-gpu",level:3},{value:"Load Balancing",id:"load-balancing",level:3},{value:"Benchmarking",id:"benchmarking",level:2},{value:"Run Benchmark",id:"run-benchmark",level:3},{value:"Output Interpretation",id:"output-interpretation",level:3},{value:"Common Performance Data",id:"common-performance-data",level:3},{value:"TensorRT Acceleration",id:"tensorrt-acceleration",level:2},{value:"Use Cases",id:"use-cases-4",level:3},{value:"Enabling",id:"enabling",level:3},{value:"Performance Improvement",id:"performance-improvement",level:3},{value:"Notes",id:"notes",level:3},{value:"Common Issues",id:"common-issues",level:2},{value:"GPU Not Detected",id:"gpu-not-detected",level:3},{value:"VRAM Insufficient",id:"vram-insufficient",level:3},{value:"Performance Below Expectations",id:"performance-below-expectations",level:3},{value:"Performance Optimization Checklist",id:"performance-optimization-checklist",level:2},{value:"Further Reading",id:"further-reading",level:2}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",hr:"hr",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"gpu-backend--optimization",children:"GPU Backend & Optimization"})}),"\n",(0,s.jsx)(n.p,{children:"This article introduces the various GPU backends supported by KataGo, performance differences, and how to tune for optimal performance."}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"backend-overview",children:"Backend Overview"}),"\n",(0,s.jsx)(n.p,{children:"KataGo supports four compute backends:"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Backend"}),(0,s.jsx)(n.th,{children:"Hardware Support"}),(0,s.jsx)(n.th,{children:"Performance"}),(0,s.jsx)(n.th,{children:"Installation Difficulty"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"CUDA"})}),(0,s.jsx)(n.td,{children:"NVIDIA GPU"}),(0,s.jsx)(n.td,{children:"Best"}),(0,s.jsx)(n.td,{children:"Medium"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"OpenCL"})}),(0,s.jsx)(n.td,{children:"NVIDIA/AMD/Intel GPU"}),(0,s.jsx)(n.td,{children:"Good"}),(0,s.jsx)(n.td,{children:"Easy"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Metal"})}),(0,s.jsx)(n.td,{children:"Apple Silicon"}),(0,s.jsx)(n.td,{children:"Good"}),(0,s.jsx)(n.td,{children:"Easy"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.strong,{children:"Eigen"})}),(0,s.jsx)(n.td,{children:"CPU only"}),(0,s.jsx)(n.td,{children:"Slower"}),(0,s.jsx)(n.td,{children:"Easiest"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"cuda-backend",children:"CUDA Backend"}),"\n",(0,s.jsx)(n.h3,{id:"use-cases",children:"Use Cases"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"NVIDIA GPU (GTX 10 series and above)"}),"\n",(0,s.jsx)(n.li,{children:"Need maximum performance"}),"\n",(0,s.jsx)(n.li,{children:"Have CUDA development environment"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"installation-requirements",children:"Installation Requirements"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check CUDA version\nnvcc --version\n\n# Check cuDNN\ncat /usr/local/cuda/include/cudnn_version.h | grep CUDNN_MAJOR\n"})}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Component"}),(0,s.jsx)(n.th,{children:"Recommended Version"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"CUDA"}),(0,s.jsx)(n.td,{children:"11.x or 12.x"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"cuDNN"}),(0,s.jsx)(n.td,{children:"8.x"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Driver"}),(0,s.jsx)(n.td,{children:"470+"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"compilation",children:"Compilation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cd KataGo/cpp\nmkdir build && cd build\n\ncmake .. -DUSE_BACKEND=CUDA \\\n         -DCUDNN_INCLUDE_DIR=/usr/local/cuda/include \\\n         -DCUDNN_LIBRARY=/usr/local/cuda/lib64/libcudnn.so\n\nmake -j$(nproc)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"performance-characteristics",children:"Performance Characteristics"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Tensor Cores"}),": Support FP16 acceleration (RTX series)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Batch inference"}),": Best GPU utilization"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Memory management"}),": Fine-grained VRAM control"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"opencl-backend",children:"OpenCL Backend"}),"\n",(0,s.jsx)(n.h3,{id:"use-cases-1",children:"Use Cases"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"AMD GPU"}),"\n",(0,s.jsx)(n.li,{children:"Intel integrated graphics"}),"\n",(0,s.jsx)(n.li,{children:"NVIDIA GPU (no CUDA environment)"}),"\n",(0,s.jsx)(n.li,{children:"Cross-platform deployment"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"installation-requirements-1",children:"Installation Requirements"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Linux - Install OpenCL development kit\nsudo apt install ocl-icd-opencl-dev\n\n# Check available OpenCL devices\nclinfo\n"})}),"\n",(0,s.jsx)(n.h3,{id:"compilation-1",children:"Compilation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cmake .. -DUSE_BACKEND=OPENCL\nmake -j$(nproc)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"driver-selection",children:"Driver Selection"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"GPU Type"}),(0,s.jsx)(n.th,{children:"Recommended Driver"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"AMD"}),(0,s.jsx)(n.td,{children:"ROCm or AMDGPU-PRO"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"Intel"}),(0,s.jsx)(n.td,{children:"intel-opencl-icd"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"NVIDIA"}),(0,s.jsx)(n.td,{children:"nvidia-opencl-icd"})]})]})]}),"\n",(0,s.jsx)(n.h3,{id:"performance-tuning",children:"Performance Tuning"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"# config.cfg\nopenclDeviceToUse = 0          # GPU number\nopenclUseFP16 = auto           # Half precision (when supported)\nopenclUseFP16Storage = true    # FP16 storage\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"metal-backend",children:"Metal Backend"}),"\n",(0,s.jsx)(n.h3,{id:"use-cases-2",children:"Use Cases"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Apple Silicon (M1/M2/M3)"}),"\n",(0,s.jsx)(n.li,{children:"macOS system"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"compilation-2",children:"Compilation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"cmake .. -DUSE_BACKEND=METAL\nmake -j$(sysctl -n hw.ncpu)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"apple-silicon-optimization",children:"Apple Silicon Optimization"}),"\n",(0,s.jsx)(n.p,{children:"Apple Silicon's unified memory architecture has unique advantages:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"# Apple Silicon recommended settings\nnumNNServerThreadsPerModel = 1\nnnMaxBatchSize = 16\nnumSearchThreads = 4\n"})}),"\n",(0,s.jsx)(n.h3,{id:"performance-comparison",children:"Performance Comparison"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Chip"}),(0,s.jsx)(n.th,{children:"Relative Performance"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"M1"}),(0,s.jsx)(n.td,{children:"~RTX 2060"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"M1 Pro/Max"}),(0,s.jsx)(n.td,{children:"~RTX 3060"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"M2"}),(0,s.jsx)(n.td,{children:"~RTX 2070"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"M3 Pro/Max"}),(0,s.jsx)(n.td,{children:"~RTX 3070"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"eigen-backend-cpu-only",children:"Eigen Backend (CPU Only)"}),"\n",(0,s.jsx)(n.h3,{id:"use-cases-3",children:"Use Cases"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"No GPU environment"}),"\n",(0,s.jsx)(n.li,{children:"Quick testing"}),"\n",(0,s.jsx)(n.li,{children:"Light usage"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"compilation-3",children:"Compilation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"sudo apt install libeigen3-dev\ncmake .. -DUSE_BACKEND=EIGEN\nmake -j$(nproc)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"performance-expectations",children:"Performance Expectations"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"CPU single core: ~10-30 playouts/sec\nCPU multi-core: ~50-150 playouts/sec\nGPU (mid-range): ~1000-3000 playouts/sec\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"performance-tuning-parameters",children:"Performance Tuning Parameters"}),"\n",(0,s.jsx)(n.h3,{id:"core-parameters",children:"Core Parameters"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"# config.cfg\n\n# === Neural Network Settings ===\n# GPU number (for multi-GPU)\nnnDeviceIdxs = 0\n\n# Inference threads per model\nnumNNServerThreadsPerModel = 2\n\n# Maximum batch size\nnnMaxBatchSize = 16\n\n# Cache size (2^N positions)\nnnCacheSizePowerOfTwo = 20\n\n# === Search Settings ===\n# Search threads\nnumSearchThreads = 8\n\n# Max visits per move\nmaxVisits = 800\n"})}),"\n",(0,s.jsx)(n.h3,{id:"parameter-tuning-guide",children:"Parameter Tuning Guide"}),"\n",(0,s.jsx)(n.h4,{id:"nnmaxbatchsize",children:"nnMaxBatchSize"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Too small: Low GPU utilization, high inference latency\nToo large: VRAM insufficient, long wait times\n\nRecommended values:\n- 4GB VRAM: 8-12\n- 8GB VRAM: 16-24\n- 16GB+ VRAM: 32-64\n"})}),"\n",(0,s.jsx)(n.h4,{id:"numsearchthreads",children:"numSearchThreads"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Too few: Cannot feed GPU enough work\nToo many: CPU bottleneck, memory pressure\n\nRecommended values:\n- 1-2x CPU core count\n- Close to nnMaxBatchSize\n"})}),"\n",(0,s.jsx)(n.h4,{id:"numnnserverthreadspermodel",children:"numNNServerThreadsPerModel"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"CUDA: 1-2\nOpenCL: 1-2\nEigen: CPU core count\n"})}),"\n",(0,s.jsx)(n.h3,{id:"memory-tuning",children:"Memory Tuning"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"# Reduce VRAM usage\nnnMaxBatchSize = 8\nnnCacheSizePowerOfTwo = 18\n\n# Increase VRAM usage (better performance)\nnnMaxBatchSize = 32\nnnCacheSizePowerOfTwo = 22\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"multi-gpu-configuration",children:"Multi-GPU Configuration"}),"\n",(0,s.jsx)(n.h3,{id:"single-machine-multi-gpu",children:"Single Machine Multi-GPU"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"# Use GPU 0 and GPU 1\nnnDeviceIdxs = 0,1\n\n# Threads per GPU\nnumNNServerThreadsPerModel = 2\n"})}),"\n",(0,s.jsx)(n.h3,{id:"load-balancing",children:"Load Balancing"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"# Allocate weights based on GPU performance\n# GPU 0 is stronger, assign more work\nnnDeviceIdxs = 0,0,1\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"benchmarking",children:"Benchmarking"}),"\n",(0,s.jsx)(n.h3,{id:"run-benchmark",children:"Run Benchmark"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"katago benchmark -model model.bin.gz -config config.cfg\n"})}),"\n",(0,s.jsx)(n.h3,{id:"output-interpretation",children:"Output Interpretation"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"GPU 0: NVIDIA GeForce RTX 3080\nThreads: 8, Batch Size: 16\n\nBenchmark results:\n- Neural net evals/second: 2847.3\n- Playouts/second: 4521.8\n- Time per move (1000 visits): 0.221 sec\n\nMemory usage:\n- Peak GPU memory: 2.1 GB\n- Peak system memory: 1.3 GB\n"})}),"\n",(0,s.jsx)(n.h3,{id:"common-performance-data",children:"Common Performance Data"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"GPU"}),(0,s.jsx)(n.th,{children:"Model"}),(0,s.jsx)(n.th,{children:"Playouts/sec"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"RTX 3060"}),(0,s.jsx)(n.td,{children:"b18c384"}),(0,s.jsx)(n.td,{children:"~2500"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"RTX 3080"}),(0,s.jsx)(n.td,{children:"b18c384"}),(0,s.jsx)(n.td,{children:"~4500"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"RTX 4090"}),(0,s.jsx)(n.td,{children:"b18c384"}),(0,s.jsx)(n.td,{children:"~8000"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"M1 Pro"}),(0,s.jsx)(n.td,{children:"b18c384"}),(0,s.jsx)(n.td,{children:"~1500"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:"M2 Max"}),(0,s.jsx)(n.td,{children:"b18c384"}),(0,s.jsx)(n.td,{children:"~2200"})]})]})]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"tensorrt-acceleration",children:"TensorRT Acceleration"}),"\n",(0,s.jsx)(n.h3,{id:"use-cases-4",children:"Use Cases"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"NVIDIA GPU"}),"\n",(0,s.jsx)(n.li,{children:"Pursuing maximum performance"}),"\n",(0,s.jsx)(n.li,{children:"Can accept longer initialization time"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"enabling",children:"Enabling"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Enable during compilation\ncmake .. -DUSE_BACKEND=CUDA -DUSE_TENSORRT=ON\n\n# Or use precompiled version\nkatago-tensorrt\n"})}),"\n",(0,s.jsx)(n.h3,{id:"performance-improvement",children:"Performance Improvement"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Standard CUDA: 100%\nTensorRT FP32: +20-30%\nTensorRT FP16: +50-80% (RTX series)\nTensorRT INT8: +100-150% (requires calibration)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"notes",children:"Notes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"First launch needs to compile TensorRT engine (several minutes)"}),"\n",(0,s.jsx)(n.li,{children:"Different GPUs need recompilation"}),"\n",(0,s.jsx)(n.li,{children:"FP16/INT8 may slightly reduce accuracy"}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"common-issues",children:"Common Issues"}),"\n",(0,s.jsx)(n.h3,{id:"gpu-not-detected",children:"GPU Not Detected"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Check GPU status\nnvidia-smi  # NVIDIA\nrocm-smi    # AMD\nclinfo      # OpenCL\n\n# KataGo list available GPUs\nkatago gpuinfo\n"})}),"\n",(0,s.jsx)(n.h3,{id:"vram-insufficient",children:"VRAM Insufficient"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-ini",children:"# Use smaller model\n# b18c384 \u2192 b10c128\n\n# Reduce batch size\nnnMaxBatchSize = 4\n\n# Reduce cache\nnnCacheSizePowerOfTwo = 16\n"})}),"\n",(0,s.jsx)(n.h3,{id:"performance-below-expectations",children:"Performance Below Expectations"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Confirm using correct backend (CUDA > OpenCL > Eigen)"}),"\n",(0,s.jsxs)(n.li,{children:["Check if ",(0,s.jsx)(n.code,{children:"numSearchThreads"})," is sufficient"]}),"\n",(0,s.jsx)(n.li,{children:"Confirm GPU is not occupied by other programs"}),"\n",(0,s.jsxs)(n.li,{children:["Use ",(0,s.jsx)(n.code,{children:"benchmark"})," command to verify performance"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"performance-optimization-checklist",children:"Performance Optimization Checklist"}),"\n",(0,s.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Select correct backend (CUDA/OpenCL/Metal)"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Install latest GPU drivers"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Adjust ",(0,s.jsx)(n.code,{children:"nnMaxBatchSize"})," to match VRAM"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Adjust ",(0,s.jsx)(n.code,{children:"numSearchThreads"})," to match CPU"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Run ",(0,s.jsx)(n.code,{children:"benchmark"})," to verify performance"]}),"\n",(0,s.jsxs)(n.li,{className:"task-list-item",children:[(0,s.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Monitor GPU utilization (should be > 80%)"]}),"\n"]}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"further-reading",children:"Further Reading"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../mcts-implementation",children:"MCTS Implementation Details"})," \u2014 Source of batch inference needs"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../quantization-deploy",children:"Model Quantization & Deployment"})," \u2014 Further performance optimization"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"../../hands-on/setup",children:"Complete Installation Guide"})," \u2014 Platform-specific installation steps"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},30416(e,n,i){i.d(n,{R:()=>c,x:()=>a});var r=i(59471);const s={},l=r.createContext(s);function c(e){const n=r.useContext(l);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),r.createElement(l.Provider,{value:n},e.children)}}}]);