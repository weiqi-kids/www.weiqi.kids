---
sidebar_position: 7
title: ç›¤é¢çŠ¶æ…‹ã®è¡¨ç¾
description: äºŒæ¬¡å…ƒé…åˆ—ã‹ã‚‰ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³ã¾ã§ã€å›²ç¢AIãŒã©ã®ã‚ˆã†ã«ç›¤é¢ã‚’ã€Œè¦‹ã‚‹ã€ã‹ã‚’æ·±ãç†è§£ã™ã‚‹
keywords: [ç›¤é¢è¡¨ç¾, Zobrist Hashing, Union-Find, ç‰¹å¾´é‡ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°, AlphaGoç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³]
---

import { GoBoard } from '@site/src/components/D3Charts';

# ç›¤é¢çŠ¶æ…‹ã®è¡¨ç¾

å›²ç¢AIã‚’è¨­è¨ˆã™ã‚‹å‰ã«ã€ã¾ãšåŸºæœ¬çš„ãªå•é¡Œã‚’è§£æ±ºã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š**ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«ã©ã†ã‚„ã£ã¦ç›¤é¢ã‚’ã€Œç†è§£ã€ã•ã›ã‚‹ã‹ï¼Ÿ**

ã“ã®å•é¡Œã¯ä¸€è¦‹å˜ç´”ã«è¦‹ãˆã¾ã™ãŒã€ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã€ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã€ãã—ã¦ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å…¥åŠ›è¨­è¨ˆãªã©ã€è¤‡æ•°ã®ãƒ¬ã‚¤ãƒ¤ãƒ¼ã«é–¢ã‚ã‚Šã¾ã™ã€‚æœ¬è¨˜äº‹ã§ã¯ã€æœ€ã‚‚åŸºæœ¬çš„ãªäºŒæ¬¡å…ƒé…åˆ—ã‹ã‚‰å§‹ã‚ã¦ã€å›²ç¢AIãŒä½¿ç”¨ã™ã‚‹æ§˜ã€…ãªç›¤é¢è¡¨ç¾æ–¹æ³•ã‚’æ®µéšçš„ã«ç´¹ä»‹ã—ã€æœ€çµ‚çš„ã«AlphaGoãŒã©ã®ã‚ˆã†ã«ç›¤é¢ã‚’ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ãŒå‡¦ç†ã§ãã‚‹å½¢å¼ã«ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦ã„ã‚‹ã‹ã‚’èª¬æ˜ã—ã¾ã™ã€‚

---

## äºŒæ¬¡å…ƒé…åˆ—è¡¨ç¾ï¼šæœ€ã‚‚ç›´æ„Ÿçš„ãªæ–¹æ³•

### åŸºæœ¬æ¦‚å¿µ

å›²ç¢ç›¤ã¯19Ã—19ã®ã‚°ãƒªãƒƒãƒ‰ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§ã‚ã‚Šã€æœ€ã‚‚ç›´æ„Ÿçš„ãªè¡¨ç¾æ–¹æ³•ã¯**äºŒæ¬¡å…ƒé…åˆ—**ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã™ï¼š

```python
import numpy as np

# ç›¤é¢å®šæ•°
BOARD_SIZE = 19
EMPTY = 0
BLACK = 1
WHITE = 2

# ç©ºã®ç›¤é¢ã‚’åˆæœŸåŒ–
board = np.zeros((BOARD_SIZE, BOARD_SIZE), dtype=np.int8)

# ç€æ‰‹ï¼šé»’çŸ³ã‚’ D4 (3, 3) ã«
board[3, 3] = BLACK

# ç€æ‰‹ï¼šç™½çŸ³ã‚’ Q16 (15, 3) ã«
board[15, 3] = WHITE
```

### åº§æ¨™ç³»

å›²ç¢ã§ã¯2ç¨®é¡ã®ä¸€èˆ¬çš„ãªåº§æ¨™ç³»ãŒä½¿ç”¨ã•ã‚Œã¾ã™ï¼š

#### 1. æ•°å€¤åº§æ¨™ï¼ˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ç”¨ï¼‰

```
    0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18
0   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .
1   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .
2   .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .
3   .  .  .  â—  .  .  .  .  .  +  .  .  .  .  .  â—‹  .  .  .
...
```

#### 2. è‹±æ•°å­—åº§æ¨™ï¼ˆæ£‹è­œç”¨ï¼‰

```
    A  B  C  D  E  F  G  H  J  K  L  M  N  O  P  Q  R  S  T
19  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .
18  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .
17  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .  .
16  .  .  .  â—  .  .  .  .  .  +  .  .  .  .  .  â—‹  .  .  .
...
```

æ³¨æ„ï¼šè‹±å­—åº§æ¨™ã§ã¯ã€ŒIã€ã‚’ã‚¹ã‚­ãƒƒãƒ—ã—ã¦ã„ã¾ã™ï¼ˆæ•°å­—ã®1ã¨ã®æ··åŒã‚’é¿ã‘ã‚‹ãŸã‚ï¼‰ã€‚

### åº§æ¨™å¤‰æ›é–¢æ•°

```python
def coord_to_index(coord):
    """
    æ£‹è­œåº§æ¨™ã‚’é…åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã«å¤‰æ›
    ä¾‹ï¼š'D4' -> (3, 15)
    """
    letters = 'ABCDEFGHJKLMNOPQRST'  # Iã‚’ã‚¹ã‚­ãƒƒãƒ—
    col = letters.index(coord[0].upper())
    row = BOARD_SIZE - int(coord[1:])
    return row, col


def index_to_coord(row, col):
    """
    é…åˆ—ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’æ£‹è­œåº§æ¨™ã«å¤‰æ›
    ä¾‹ï¼š(3, 15) -> 'Q16'
    """
    letters = 'ABCDEFGHJKLMNOPQRST'
    return f"{letters[col]}{BOARD_SIZE - row}"
```

### ç©ºé–“è¨ˆç®—é‡åˆ†æ

äºŒæ¬¡å…ƒé…åˆ—è¡¨ç¾ã®ç©ºé–“è¨ˆç®—é‡ï¼š

| è¡¨ç¾æ–¹æ³• | 1ãƒã‚¹ã‚ãŸã‚Š | ç·ç©ºé–“ |
|---------|---------|--------|
| `int8` | 1 byte | 361 bytes |
| `int32` | 4 bytes | 1.4 KB |
| `float64` | 8 bytes | 2.9 KB |

ç¾ä»£ã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«ã¨ã£ã¦ã€ã“ã®ãƒ¡ãƒ¢ãƒªé‡ã¯å…¨ãå•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚ã—ã‹ã—ã€å¤§é‡ã®ç›¤é¢çŠ¶æ…‹ã‚’ä¿å­˜ã™ã‚‹å¿…è¦ãŒã‚ã‚‹å ´åˆï¼ˆMCTSæ¢ç´¢æœ¨ãªã©ï¼‰ã€`int8` ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡ã‚’å¤§å¹…ã«å‰Šæ¸›ã§ãã¾ã™ã€‚

### åŸºæœ¬æ“ä½œ

```python
class Board:
    def __init__(self, size=19):
        self.size = size
        self.board = np.zeros((size, size), dtype=np.int8)
        self.current_player = BLACK
        self.ko_point = None  # ã‚³ã‚¦ã®ç¦æ­¢ç‚¹
        self.move_history = []

    def is_valid_move(self, row, col):
        """ç€æ‰‹ãŒåˆæ³•ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯"""
        # 1. ä½ç½®ãŒç›¤é¢å†…ã«ã‚ã‚‹
        if not (0 <= row < self.size and 0 <= col < self.size):
            return False

        # 2. ä½ç½®ãŒç©ºã§ã‚ã‚‹
        if self.board[row, col] != EMPTY:
            return False

        # 3. ã‚³ã‚¦ã®ç¦æ­¢ç‚¹ã§ãªã„
        if self.ko_point == (row, col):
            return False

        # 4. è‡ªæ®ºæ‰‹ã§ãªã„ï¼ˆå–ã‚Œã‚‹å ´åˆã‚’é™¤ãï¼‰
        # ... ã‚ˆã‚Šè¤‡é›‘ãªãƒã‚§ãƒƒã‚¯ãŒå¿…è¦

        return True

    def place_stone(self, row, col):
        """ç€æ‰‹ã™ã‚‹"""
        if not self.is_valid_move(row, col):
            return False

        self.board[row, col] = self.current_player
        self.move_history.append((row, col))

        # å–ã‚Šä¸Šã’å‡¦ç†
        captures = self._remove_captured_stones(row, col)

        # ã‚³ã‚¦ã®ç¦æ­¢ç‚¹ã‚’æ›´æ–°
        self._update_ko(row, col, captures)

        # ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’äº¤ä»£
        self.current_player = WHITE if self.current_player == BLACK else BLACK

        return True
```

---

## Zobrist Hashingï¼šå±€é¢ã®é«˜é€Ÿè­˜åˆ¥

### å•é¡ŒèƒŒæ™¯

å›²ç¢AIã§ã¯ã€ã€Œ2ã¤ã®å±€é¢ãŒåŒã˜ã‹ã©ã†ã‹ã€ã‚’é »ç¹ã«åˆ¤æ–­ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ï¼š

1. **ã‚³ã‚¦ãƒ«ãƒ¼ãƒ«**ï¼šå‰ã®æ‰‹ã®çŠ¶æ…‹ã«æˆ»ã‚‹ã“ã¨ã¯ã§ããªã„
2. **ä¸‰ã‚³ã‚¦ãƒ«ãƒ¼ãƒ—**ï¼šç‰¹æ®Šãƒ«ãƒ¼ãƒ«ã®å‡¦ç†
3. **Transposition Table**ï¼šæ—¢ã«æ¢ç´¢ã—ãŸå±€é¢ã‚’è¨˜æ†¶
4. **ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥**ï¼šé‡è¤‡è¨ˆç®—ã‚’é¿ã‘ã‚‹

æ¯å›ãƒã‚¹ç›®ã”ã¨ã«æ¯”è¼ƒã™ã‚‹ã¨ã€O(361) ã®æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™ã€‚ã‚‚ã£ã¨é€Ÿã„æ–¹æ³•ã¯ãªã„ã§ã—ã‚‡ã†ã‹ï¼Ÿ

### Zobrist Hashingã®åŸç†

**Zobrist Hashing**ï¼ˆZobrist Keysã¨ã‚‚å‘¼ã°ã‚Œã‚‹ï¼‰ã¯ã€1970å¹´ã«Albert Zobristã«ã‚ˆã£ã¦ææ¡ˆã•ã‚ŒãŸå·§å¦™ãªãƒãƒƒã‚·ãƒ¥æ–¹æ³•ã§ã™ã€‚ãã®æ ¸å¿ƒçš„ãªã‚¢ã‚¤ãƒ‡ã‚¢ã¯ï¼š

1. å„ã€Œä½ç½® Ã— è‰²ã€ã®çµ„ã¿åˆã‚ã›ã«å¯¾ã—ã¦ã€äº‹å‰ã«**ä¹±æ•°**ã‚’ç”Ÿæˆ
2. ç›¤é¢ã®ãƒãƒƒã‚·ãƒ¥å€¤ = ã™ã¹ã¦ã®çŸ³ãŒã‚ã‚‹ä½ç½®ã®ä¹±æ•°ã® **XOR**
3. ç€æ‰‹/å–ã‚Šä¸Šã’ã¯1å›ã®XORæ¼”ç®—ã§ãƒãƒƒã‚·ãƒ¥å€¤ã‚’æ›´æ–°ã§ãã‚‹

### ä¹±æ•°ãƒ†ãƒ¼ãƒ–ãƒ«

```python
import numpy as np

# ä¹±æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ç”Ÿæˆ
# å›ºå®šã‚·ãƒ¼ãƒ‰ã§å†ç¾æ€§ã‚’ç¢ºä¿
np.random.seed(42)

# å„ä½ç½®ã€å„è‰²ã«1ã¤ã®ä¹±æ•°
# zobrist[color][row][col]
zobrist_table = np.random.randint(
    0, 2**64,
    size=(3, BOARD_SIZE, BOARD_SIZE),  # 3: EMPTY, BLACK, WHITE
    dtype=np.uint64
)

# æ‰‹ç•ªã®ä¹±æ•°
zobrist_player = np.random.randint(0, 2**64, dtype=np.uint64)
```

### XORæ¼”ç®—ã®ç‰¹æ€§

XORï¼ˆæ’ä»–çš„è«–ç†å’Œï¼‰æ¼”ç®—ã«ã¯ã€ã“ã®ç”¨é€”ã«éå¸¸ã«é©ã—ãŸã„ãã¤ã‹ã®é‡è¦ãªç‰¹æ€§ãŒã‚ã‚Šã¾ã™ï¼š

1. **è‡ªå·±åè»¢æ€§**ï¼šA âŠ• A = 0ï¼ˆåŒã˜æ•°ã‚’XORã™ã‚‹ã¨0ã«ãªã‚‹ï¼‰
2. **å¯é€†æ€§**ï¼šA âŠ• B âŠ• B = Aï¼ˆ2å›XORã™ã‚‹ã¨å…ƒã«æˆ»ã‚‹ï¼‰
3. **äº¤æ›æ³•å‰‡**ï¼šA âŠ• B = B âŠ• A
4. **çµåˆæ³•å‰‡**ï¼š(A âŠ• B) âŠ• C = A âŠ• (B âŠ• C)

ã“ã‚Œã¯ä»¥ä¸‹ã‚’æ„å‘³ã—ã¾ã™ï¼š
- ç€æ‰‹ï¼š`hash ^= zobrist[color][row][col]`
- å–ã‚Šä¸Šã’ï¼š`hash ^= zobrist[color][row][col]`ï¼ˆåŒã˜æ“ä½œï¼ï¼‰

### å®Ÿè£…

```python
class ZobristBoard:
    def __init__(self, size=19):
        self.size = size
        self.board = np.zeros((size, size), dtype=np.int8)
        self.current_player = BLACK
        self.hash = np.uint64(0)

        # ä¹±æ•°ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’åˆæœŸåŒ–
        self._init_zobrist_table()

    def _init_zobrist_table(self):
        np.random.seed(12345)
        self.zobrist = np.random.randint(
            0, 2**64,
            size=(3, self.size, self.size),
            dtype=np.uint64
        )
        self.zobrist_player = np.random.randint(0, 2**64, dtype=np.uint64)

    def place_stone(self, row, col, color):
        """ç€æ‰‹ã—ã¦ãƒãƒƒã‚·ãƒ¥å€¤ã‚’æ›´æ–°"""
        # å¤ã„çŠ¶æ…‹ã‚’å‰Šé™¤ï¼ˆçŸ³ãŒã‚ã‚‹å ´åˆï¼‰
        old_color = self.board[row, col]
        if old_color != EMPTY:
            self.hash ^= self.zobrist[old_color, row, col]

        # æ–°ã—ã„çŸ³ã‚’è¿½åŠ 
        self.board[row, col] = color
        self.hash ^= self.zobrist[color, row, col]

    def remove_stone(self, row, col):
        """å–ã‚Šä¸Šã’ã¦ãƒãƒƒã‚·ãƒ¥å€¤ã‚’æ›´æ–°"""
        color = self.board[row, col]
        if color != EMPTY:
            self.hash ^= self.zobrist[color, row, col]
            self.board[row, col] = EMPTY

    def switch_player(self):
        """ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã‚’äº¤ä»£ã—ã¦ãƒãƒƒã‚·ãƒ¥å€¤ã‚’æ›´æ–°"""
        self.hash ^= self.zobrist_player
        self.current_player = WHITE if self.current_player == BLACK else BLACK

    def get_hash(self):
        """ç¾åœ¨ã®å±€é¢ã®ãƒãƒƒã‚·ãƒ¥å€¤ã‚’å–å¾—"""
        return self.hash
```

### å¢—åˆ†æ›´æ–°ã®åˆ©ç‚¹

Zobrist Hashingã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ãƒãƒƒã‚·ãƒ¥å€¤ã®æ›´æ–°ã¯O(1)æ™‚é–“ã§æ¸ˆã¿ã¾ã™ï¼š

| æ“ä½œ | å¾“æ¥ã®æ¯”è¼ƒ | Zobrist |
|------|---------|---------|
| 2ã¤ã®å±€é¢ã‚’æ¯”è¼ƒ | O(361) | O(1) |
| ç€æ‰‹å¾Œã®æ›´æ–° | O(361) | O(1) |
| å–ã‚Šä¸Šã’å¾Œã®æ›´æ–° | O(361) | O(k)ã€kã¯å–ã‚Šä¸Šã’æ•° |

### è¡çªç¢ºç‡

64ãƒ“ãƒƒãƒˆãƒãƒƒã‚·ãƒ¥ã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€è¡çªç¢ºç‡ã¯æ¥µã‚ã¦ä½ããªã‚Šã¾ã™ï¼š

**P(è¡çª) â‰ˆ nÂ² / 2^65**

ã“ã“ã§nã¯ç•°ãªã‚‹å±€é¢ã®æ•°ã§ã™ã€‚10å„„å€‹ã®å±€é¢ãŒã‚ã£ã¦ã‚‚ã€è¡çªç¢ºç‡ã¯ç´„10^-3ç¨‹åº¦ã§ã™ã€‚

å®Ÿéš›ã«ã¯ã€å¤šãã®å›²ç¢ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯64ãƒ“ãƒƒãƒˆZobrist Hashingã‚’ä½¿ç”¨ã—ã€è¡çªãƒã‚§ãƒƒã‚¯ã‚’è¡Œã„ã¾ã›ã‚“ã€‚è¡çªç¢ºç‡ãŒç„¡è¦–ã§ãã‚‹ã»ã©ä½ã„ãŸã‚ã§ã™ã€‚

---

## çŸ³ã®é€£ï¼ˆUnion-Findï¼‰ï¼šé€£çµæ€§ã®å•é¡Œ

### çŸ³ã®é€£ã®æ¦‚å¿µ

å›²ç¢ã«ãŠã„ã¦ã€**çŸ³ã®é€£**ï¼ˆStringã¾ãŸã¯Chainï¼‰ã¯ã€é€£çµã—ãŸåŒè‰²ã®çŸ³ã®ã‚°ãƒ«ãƒ¼ãƒ—ã‚’æŒ‡ã—ã¾ã™ã€‚çŸ³ã®é€£ã®ã€Œãƒ€ãƒ¡ã€ãŒãã®ç”Ÿæ­»ã‚’æ±ºå®šã—ã¾ã™ã€‚

<GoBoard
  size={200}
  stones={[
    {x: 3, y: 3, color: 'black'},
    {x: 4, y: 3, color: 'black'},
    {x: 5, y: 3, color: 'black'},
    {x: 4, y: 4, color: 'black'},
    {x: 6, y: 3, color: 'white'},
    {x: 6, y: 4, color: 'white'},
  ]}
  labels={[
    {x: 4, y: 3, text: 'A'},
  ]}
/>

ä¸Šã®å›³ã§ã¯ã€4ã¤ã®é»’çŸ³ãŒ1ã¤ã®é€£ã‚’å½¢æˆã—ã¦ãŠã‚Šã€ã“ã®é€£ã®ãƒ€ãƒ¡ã®æ•°ãŒãã®ç”Ÿæ­»ã‚’æ±ºå®šã—ã¾ã™ã€‚

### ãªãœåŠ¹ç‡çš„ãªçŸ³ã®é€£ç®¡ç†ãŒå¿…è¦ãªã®ã‹ï¼Ÿ

ç€æ‰‹ã™ã‚‹ãŸã³ã«ä»¥ä¸‹ã®ã“ã¨ãŒèµ·ã“ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ï¼š
1. æ–°ã—ã„é€£ã‚’**ä½œæˆ**
2. è¤‡æ•°ã®é€£ã‚’**ãƒãƒ¼ã‚¸**
3. æ•µã®é€£ã®ãƒ€ãƒ¡ã‚’**æ¸›ã‚‰ã™**
4. ãƒ€ãƒ¡ã®ãªã„é€£ã‚’**å–ã‚Šä¸Šã’ã‚‹**

MCTSã§ã¯1ç§’é–“ã«æ•°ä¸‡å›ã®ç€æ‰‹ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãŒå¿…è¦ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ãŸã‚ã€ã“ã‚Œã‚‰ã®æ“ä½œã‚’åŠ¹ç‡çš„ã«å®Ÿè¡Œã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

### Union-Findãƒ‡ãƒ¼ã‚¿æ§‹é€ 

**Union-Find**ï¼ˆDisjoint Set Union, DSUã¨ã‚‚å‘¼ã°ã‚Œã‚‹ï¼‰ã¯ã€ã€Œé€£çµæ€§ã€å•é¡Œã‚’å‡¦ç†ã™ã‚‹å¤å…¸çš„ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã™ï¼š

```python
class UnionFind:
    def __init__(self, size):
        # parent[i] ã¯ i ã®è¦ªãƒãƒ¼ãƒ‰ã‚’æŒ‡ã™
        # parent[i] = i ã®å ´åˆã€i ã¯ãƒ«ãƒ¼ãƒˆãƒãƒ¼ãƒ‰
        self.parent = list(range(size))
        self.rank = [0] * size

    def find(self, x):
        """
        xãŒå±ã™ã‚‹é›†åˆã®ãƒ«ãƒ¼ãƒˆãƒãƒ¼ãƒ‰ã‚’è¦‹ã¤ã‘ã‚‹ï¼ˆãƒ‘ã‚¹åœ§ç¸®ä»˜ãï¼‰
        """
        if self.parent[x] != x:
            self.parent[x] = self.find(self.parent[x])  # ãƒ‘ã‚¹åœ§ç¸®
        return self.parent[x]

    def union(self, x, y):
        """
        xã¨yãŒå±ã™ã‚‹é›†åˆã‚’ãƒãƒ¼ã‚¸ã™ã‚‹ï¼ˆãƒ©ãƒ³ã‚¯ã«ã‚ˆã‚‹ãƒãƒ¼ã‚¸ï¼‰
        """
        root_x = self.find(x)
        root_y = self.find(y)

        if root_x == root_y:
            return  # æ—¢ã«åŒã˜é›†åˆ

        # ãƒ©ãƒ³ã‚¯ã«ã‚ˆã‚‹ãƒãƒ¼ã‚¸ï¼šå°ã•ã„æœ¨ã‚’å¤§ãã„æœ¨ã«æ¥ç¶š
        if self.rank[root_x] < self.rank[root_y]:
            self.parent[root_x] = root_y
        elif self.rank[root_x] > self.rank[root_y]:
            self.parent[root_y] = root_x
        else:
            self.parent[root_y] = root_x
            self.rank[root_x] += 1
```

### æ™‚é–“è¨ˆç®—é‡

Union-Findã®æ™‚é–“è¨ˆç®—é‡ã¯**é€†ã‚¢ãƒƒã‚«ãƒ¼ãƒãƒ³é–¢æ•°** Î±(n) ã§è¡¨ã•ã‚Œã¾ã™ï¼š

| æ“ä½œ | æ™‚é–“è¨ˆç®—é‡ |
|------|-----------|
| find | O(Î±(n)) â‰ˆ O(1) |
| union | O(Î±(n)) â‰ˆ O(1) |

Î±(n) ã®å¢—åŠ ã¯æ¥µã‚ã¦é…ãã€å®Ÿç”¨çš„ãªã©ã‚“ãªnã«å¯¾ã—ã¦ã‚‚ Î±(n) â‰¤ 4 ã§ã™ã€‚ã—ãŸãŒã£ã¦ã€å®šæ•°æ™‚é–“ã¨è¦‹ãªã›ã¾ã™ã€‚

### å›²ç¢ã§ã®Union-Findã®å¿œç”¨

```python
class GoStringManager:
    def __init__(self, size=19):
        self.size = size
        num_points = size * size

        # Union-Findæ§‹é€ 
        self.parent = list(range(num_points))
        self.rank = [0] * num_points

        # å„é€£ã®ãƒ€ãƒ¡ï¼ˆãƒ«ãƒ¼ãƒˆãƒãƒ¼ãƒ‰ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ç®¡ç†ï¼‰
        self.liberties = [set() for _ in range(num_points)]

        # å„é€£ã®çŸ³ï¼ˆãƒ«ãƒ¼ãƒˆãƒãƒ¼ãƒ‰ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã§ç®¡ç†ï¼‰
        self.stones = [set() for _ in range(num_points)]

    def _index(self, row, col):
        return row * self.size + col

    def _neighbors(self, row, col):
        """å››æ–¹ã®éš£æ¥ç‚¹ã‚’å–å¾—"""
        neighbors = []
        if row > 0: neighbors.append((row - 1, col))
        if row < self.size - 1: neighbors.append((row + 1, col))
        if col > 0: neighbors.append((row, col - 1))
        if col < self.size - 1: neighbors.append((row, col + 1))
        return neighbors

    def find(self, idx):
        if self.parent[idx] != idx:
            self.parent[idx] = self.find(self.parent[idx])
        return self.parent[idx]

    def add_stone(self, row, col, color, board):
        """
        çŸ³ã‚’1ã¤è¿½åŠ ã—ã€é€£çµã¨å–ã‚Šä¸Šã’ã‚’å‡¦ç†
        """
        idx = self._index(row, col)

        # æ–°ã—ã„é€£ã‚’ä½œæˆ
        self.stones[idx] = {idx}
        self.liberties[idx] = set()

        # ã“ã®çŸ³ã®ãƒ€ãƒ¡ã‚’è¨ˆç®—
        for nr, nc in self._neighbors(row, col):
            nidx = self._index(nr, nc)
            if board[nr, nc] == 0:  # ç©ºç‚¹ã¯ãƒ€ãƒ¡
                self.liberties[idx].add(nidx)

        # åŒè‰²ã®éš£æ¥çŸ³ã¨ãƒãƒ¼ã‚¸
        for nr, nc in self._neighbors(row, col):
            nidx = self._index(nr, nc)
            if board[nr, nc] == color:
                self._merge_strings(idx, nidx)

        # æ•µã®é€£ã®ãƒ€ãƒ¡ã‚’æ¸›ã‚‰ã™
        opponent = 3 - color  # BLACK=1, WHITE=2
        captured = []
        for nr, nc in self._neighbors(row, col):
            nidx = self._index(nr, nc)
            if board[nr, nc] == opponent:
                root = self.find(nidx)
                self.liberties[root].discard(idx)
                if len(self.liberties[root]) == 0:
                    captured.append(root)

        return captured

    def _merge_strings(self, idx1, idx2):
        """2ã¤ã®é€£ã‚’ãƒãƒ¼ã‚¸"""
        root1 = self.find(idx1)
        root2 = self.find(idx2)

        if root1 == root2:
            return

        # ãƒ©ãƒ³ã‚¯ã«ã‚ˆã‚‹ãƒãƒ¼ã‚¸
        if self.rank[root1] < self.rank[root2]:
            root1, root2 = root2, root1

        self.parent[root2] = root1
        if self.rank[root1] == self.rank[root2]:
            self.rank[root1] += 1

        # ãƒ€ãƒ¡ã¨çŸ³ã®é›†åˆã‚’ãƒãƒ¼ã‚¸
        self.liberties[root1] |= self.liberties[root2]
        self.stones[root1] |= self.stones[root2]

        # è‡ªåˆ†ã®ä½ç½®ã®ãƒ€ãƒ¡ã‚’å‰Šé™¤ï¼ˆè‡ªåˆ†ã¯è‡ªåˆ†ã®ãƒ€ãƒ¡ã§ã¯ãªã„ï¼‰
        for stone_idx in self.stones[root2]:
            self.liberties[root1].discard(stone_idx)
```

### ãƒ€ãƒ¡ã®è¨ˆç®—

çŸ³ã®é€£ã®ãƒ€ãƒ¡æ•°ã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ã¯ã€å›²ç¢ã§æœ€ã‚‚ä¸€èˆ¬çš„ãªæ“ä½œã®1ã¤ã§ã™ï¼š

```python
def count_liberties(self, row, col, board):
    """ã‚ã‚‹çŸ³ãŒå±ã™ã‚‹é€£ã®ãƒ€ãƒ¡æ•°ã‚’è¨ˆç®—"""
    idx = self._index(row, col)
    root = self.find(idx)
    return len(self.liberties[root])
```

Union-Findã‚’ä½¿ç”¨ã™ã‚‹ã¨ã€ã“ã®æ“ä½œã¯O(1)ã§ã™ï¼ˆfindãŒO(1)ã¨ä»®å®šï¼‰ã€‚

---

## ç‰¹å¾´é‡ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã®é€²åŒ–

å¾“æ¥ã®æ‰‹ä½œã‚Šç‰¹å¾´é‡ã‹ã‚‰AlphaGo Zeroã®ç°¡æ½”ãªç‰¹å¾´é‡ã¾ã§ã€å›²ç¢AIã®ç‰¹å¾´é‡ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã¯å¤§ããªé€²åŒ–ã‚’é‚ã’ã¾ã—ãŸã€‚

### GNU Goã®æ‰‹ä½œã‚Šç‰¹å¾´é‡

åˆæœŸã®å›²ç¢ãƒ—ãƒ­ã‚°ãƒ©ãƒ ï¼ˆGNU Goãªã©ï¼‰ã¯ã€å¤§é‡ã®æ‰‹ä½œã‚Šç‰¹å¾´é‡ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã—ãŸï¼š

```python
def extract_features_gnugo(board, point):
    """
    GNU Goã‚¹ã‚¿ã‚¤ãƒ«ã®æ‰‹ä½œã‚Šç‰¹å¾´é‡æŠ½å‡º
    """
    features = {}

    # 1. çŸ³ã®å½¢ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆäº‹å‰å®šç¾©ã•ã‚ŒãŸå±€æ‰€å½¢çŠ¶ï¼‰
    features['pattern'] = match_pattern(board, point)

    # 2. æˆ¦è¡“ç‰¹å¾´é‡
    features['can_capture'] = check_capture(board, point)
    features['can_connect'] = check_connect(board, point)
    features['creates_eye'] = check_eye_creation(board, point)

    # 3. å±€æ‰€ç‰¹å¾´é‡
    features['liberties_after'] = count_liberties_after_move(board, point)
    features['enemy_liberties'] = count_enemy_liberties(board, point)

    # 4. å¤§åŸŸç‰¹å¾´é‡
    features['distance_to_edge'] = min(
        point[0], point[1],
        18 - point[0], 18 - point[1]
    )

    # ... ã•ã‚‰ã«å¤šãã®ç‰¹å¾´é‡

    return features
```

ã“ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã®å•é¡Œç‚¹ï¼š
- å¤§é‡ã®äººé–“ã®å°‚é–€çŸ¥è­˜ãŒå¿…è¦
- ç‰¹å¾´é‡ãŒä¸å®Œå…¨ãªå¯èƒ½æ€§
- æ–°ã—ã„ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’ç™ºè¦‹ã™ã‚‹ã®ãŒå›°é›£

### AlphaGoã®48ç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³

AlphaGoï¼ˆ2016å¹´Natureç‰ˆï¼‰ã¯ã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®å…¥åŠ›ã¨ã—ã¦**48å€‹ã®ç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³**ã‚’ä½¿ç”¨ã—ã¾ã—ãŸï¼š

```python
def encode_alphago_features(board, player, history):
    """
    AlphaGo 2016ã®48ç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³

    Returns:
        (19, 19, 48) ã®ãƒ†ãƒ³ã‚½ãƒ«
    """
    features = np.zeros((19, 19, 48), dtype=np.float32)

    # ãƒ—ãƒ¬ãƒ¼ãƒ³1: é»’çŸ³ã®ä½ç½®
    features[:, :, 0] = (board == BLACK)

    # ãƒ—ãƒ¬ãƒ¼ãƒ³2: ç™½çŸ³ã®ä½ç½®
    features[:, :, 1] = (board == WHITE)

    # ãƒ—ãƒ¬ãƒ¼ãƒ³3: ç©ºç‚¹
    features[:, :, 2] = (board == EMPTY)

    # ãƒ—ãƒ¬ãƒ¼ãƒ³4: å…¨ã¦1ï¼ˆãƒã‚¤ã‚¢ã‚¹é …ï¼‰
    features[:, :, 3] = 1

    # ãƒ—ãƒ¬ãƒ¼ãƒ³5-12: ãƒ€ãƒ¡æ•°ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ï¼ˆ1-8ãƒ€ãƒ¡å„1ãƒ—ãƒ¬ãƒ¼ãƒ³ï¼‰
    for i, num_libs in enumerate(range(1, 9)):
        for r in range(19):
            for c in range(19):
                if board[r, c] != EMPTY:
                    libs = count_liberties(board, r, c)
                    if libs == num_libs:
                        features[r, c, 4 + i] = 1

    # ãƒ—ãƒ¬ãƒ¼ãƒ³13-20: å–ã‚Šä¸Šã’å¾Œã®ç›¸æ‰‹ã®ãƒ€ãƒ¡æ•°
    # ...

    # ãƒ—ãƒ¬ãƒ¼ãƒ³21-28: è‡ªåˆ†ãŒç€æ‰‹ã—ãŸå¾Œã®ãƒ€ãƒ¡æ•°
    # ...

    # ãƒ—ãƒ¬ãƒ¼ãƒ³29-36: éå»8æ‰‹ã®å±¥æ­´ï¼ˆå„æ‰‹1ãƒ—ãƒ¬ãƒ¼ãƒ³ï¼‰
    for i, (r, c) in enumerate(history[-8:]):
        features[r, c, 28 + i] = 1

    # ãƒ—ãƒ¬ãƒ¼ãƒ³37-44: ã‚·ãƒãƒ§ã‚¦åˆ¤æ–­
    # ...

    # ãƒ—ãƒ¬ãƒ¼ãƒ³45-48: å¯¾ç§°æ€§é–¢é€£
    # ...

    # ãƒ—ãƒ¬ãƒ¼ãƒ³49: æ‰‹ç•ªï¼ˆå…¨ã¦1ã¯é»’ç•ªã€å…¨ã¦0ã¯ç™½ç•ªï¼‰
    if player == BLACK:
        features[:, :, 47] = 1

    return features
```

### 48ãƒ—ãƒ¬ãƒ¼ãƒ³ã®åˆ†é¡

| ã‚«ãƒ†ã‚´ãƒª | ãƒ—ãƒ¬ãƒ¼ãƒ³æ•° | èª¬æ˜ |
|------|--------|------|
| çŸ³ã®ä½ç½® | 3 | é»’çŸ³ã€ç™½çŸ³ã€ç©ºç‚¹ |
| å®šæ•° | 1 | å…¨ã¦1 |
| ãƒ€ãƒ¡æ•° | 8 | 1-8ãƒ€ãƒ¡ |
| å–ã‚Šä¸Šã’å¾Œã®ãƒ€ãƒ¡æ•° | 8 | ç€æ‰‹å¾Œã®ãƒ€ãƒ¡æ•°ã‚’ä»®å®š |
| ç€æ‰‹å¾Œã®ãƒ€ãƒ¡æ•° | 8 | ç€æ‰‹å¾Œã®ãƒ€ãƒ¡æ•°ã‚’ä»®å®š |
| å±¥æ­´ | 8 | éå»8æ‰‹ |
| ã‚·ãƒãƒ§ã‚¦ | 8 | è¤‡é›‘ãªã‚·ãƒãƒ§ã‚¦åˆ†æ |
| ãã®ä»– | 4 | æ‰‹ç•ªã€å¯¾ç§°æ€§ãªã© |

### AlphaGo Zeroã®17ç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³

AlphaGo Zeroï¼ˆ2017å¹´ï¼‰ã¯ç‰¹å¾´é‡ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã‚’å¤§å¹…ã«ç°¡ç•¥åŒ–ã—ã€**17å€‹ã®ãƒ—ãƒ¬ãƒ¼ãƒ³**ã®ã¿ã‚’ä½¿ç”¨ã—ã¾ã—ãŸï¼š

```python
def encode_alphago_zero_features(board_history, player):
    """
    AlphaGo Zeroã®17ç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³

    Args:
        board_history: éå»8å±€é¢ï¼ˆç¾åœ¨ã‚’å«ã‚€ï¼‰
        player: ç¾åœ¨ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼

    Returns:
        (19, 19, 17) ã®ãƒ†ãƒ³ã‚½ãƒ«
    """
    features = np.zeros((19, 19, 17), dtype=np.float32)

    # ãƒ—ãƒ¬ãƒ¼ãƒ³1-8: é»’çŸ³ã®å±¥æ­´ï¼ˆç›´è¿‘8æ‰‹ï¼‰
    for i, board in enumerate(board_history[-8:]):
        features[:, :, i] = (board == BLACK)

    # ãƒ—ãƒ¬ãƒ¼ãƒ³9-16: ç™½çŸ³ã®å±¥æ­´ï¼ˆç›´è¿‘8æ‰‹ï¼‰
    for i, board in enumerate(board_history[-8:]):
        features[:, :, 8 + i] = (board == WHITE)

    # ãƒ—ãƒ¬ãƒ¼ãƒ³17: æ‰‹ç•ªï¼ˆå…¨ã¦1ã¯é»’ç•ªã€å…¨ã¦0ã¯ç™½ç•ªï¼‰
    if player == BLACK:
        features[:, :, 16] = 1

    return features
```

### 17ãƒ—ãƒ¬ãƒ¼ãƒ³ã®ç°¡æ½”ã•

| ã‚«ãƒ†ã‚´ãƒª | ãƒ—ãƒ¬ãƒ¼ãƒ³æ•° | èª¬æ˜ |
|------|--------|------|
| é»’çŸ³ã®å±¥æ­´ | 8 | éå»8ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—ã®é»’çŸ³ä½ç½® |
| ç™½çŸ³ã®å±¥æ­´ | 8 | éå»8ã‚¿ã‚¤ãƒ ã‚¹ãƒ†ãƒƒãƒ—ã®ç™½çŸ³ä½ç½® |
| ç¾åœ¨ã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ | 1 | å…¨ã¦1ã¾ãŸã¯å…¨ã¦0 |

ãªãœã“ã‚Œã»ã©ç°¡æ½”ã«ã§ãã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ

> **é‡è¦ãªæ´å¯Ÿï¼šãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ç‰¹å¾´é‡ã‚’è‡ªåˆ†ã§å­¦ç¿’ã•ã›ã‚‹ã€‚**

AlphaGo Zeroã¯ä»¥ä¸‹ã‚’è¨¼æ˜ã—ã¾ã—ãŸï¼š
- ãƒ€ãƒ¡æ•°ã‚’æ‰‹å‹•ã§è¨ˆç®—ã™ã‚‹å¿…è¦ã¯ãªã„ï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯çŸ³ã®ä½ç½®ã‹ã‚‰æ¨è«–ã§ãã‚‹ï¼‰
- ã‚·ãƒãƒ§ã‚¦åˆ†æã¯ä¸è¦ï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ã‚·ãƒãƒ§ã‚¦ã‚’èªè­˜ã™ã‚‹ã“ã¨ã‚’å­¦ç¿’ã§ãã‚‹ï¼‰
- è¤‡é›‘ãªå–ã‚Šä¸Šã’äºˆæ¸¬ã¯ä¸è¦ï¼ˆãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ç€æ‰‹ã®çµæœã‚’ç†è§£ã§ãã‚‹ï¼‰

ã“ã‚Œã¯ãƒ‡ã‚£ãƒ¼ãƒ—ãƒ©ãƒ¼ãƒ‹ãƒ³ã‚°ã®æ ¸å¿ƒçš„ãªå¼·ã¿ã‚’ä½“ç¾ã—ã¦ã„ã¾ã™ï¼š**ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰å­¦ç¿’**ã€‚

### ç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³ã®å¯è¦–åŒ–

ã“ã‚Œã‚‰ã®ç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³ãŒå®Ÿéš›ã«ã©ã®ã‚ˆã†ã«è¦‹ãˆã‚‹ã‹è¦‹ã¦ã¿ã¾ã—ã‚‡ã†ï¼š

```
å…ƒã®ç›¤é¢ï¼š              é»’çŸ³ãƒ—ãƒ¬ãƒ¼ãƒ³ï¼š          ç™½çŸ³ãƒ—ãƒ¬ãƒ¼ãƒ³ï¼š
. . . . . .            0 0 0 0 0 0            0 0 0 0 0 0
. â— â—‹ . . .            0 1 0 0 0 0            0 0 1 0 0 0
. . â— â—‹ . .    ->      0 0 1 0 0 0     +      0 0 0 1 0 0
. . . â— . .            0 0 0 1 0 0            0 0 0 0 0 0
. . . . . .            0 0 0 0 0 0            0 0 0 0 0 0
```

å„ãƒ—ãƒ¬ãƒ¼ãƒ³ã¯äºŒå€¤è¡Œåˆ—ï¼ˆ0ã¾ãŸã¯1ï¼‰ã§ã‚ã‚Šã€ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¯ç•³ã¿è¾¼ã¿æ“ä½œã‚’é€šã˜ã¦ã“ã‚Œã‚‰ã®ãƒ—ãƒ¬ãƒ¼ãƒ³å†…ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æŠ½å‡ºã§ãã¾ã™ã€‚

---

## å¯¾ç§°æ€§å‡¦ç†ï¼š8ç¨®é¡ã®å¤‰æ›

### å›²ç¢ã®å¯¾ç§°æ€§

å›²ç¢ç›¤ã«ã¯ **8ç¨®é¡ã®å¯¾ç§°æ€§** ãŒã‚ã‚Šã¾ã™ï¼š

1. **4ç¨®é¡ã®å›è»¢**ï¼š0Â°ã€90Â°ã€180Â°ã€270Â°
2. **4ç¨®é¡ã®åè»¢å¾Œå›è»¢**ï¼šæ°´å¹³åè»¢ + 4ç¨®é¡ã®å›è»¢

ã“ã‚Œã¯ **äºŒé¢ä½“ç¾¤ D4** ã‚’å½¢æˆã—ã¾ã™ã€‚

### æ•°å­¦çš„è¡¨ç¾

(x, y) ã‚’ç›¤é¢ä¸Šã®åº§æ¨™ï¼ˆä¸­å¿ƒã‚’ (9, 9) ã¨ã™ã‚‹ï¼‰ã¨ã™ã‚‹ã¨ã€8ç¨®é¡ã®å¤‰æ›ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã¾ã™ï¼š

| å¤‰æ› | å…¬å¼ |
|------|------|
| æ’ç­‰ | (x, y) |
| 90Â°å›è»¢ | (-y, x) |
| 180Â°å›è»¢ | (-x, -y) |
| 270Â°å›è»¢ | (y, -x) |
| æ°´å¹³åè»¢ | (-x, y) |
| å‚ç›´åè»¢ | (x, -y) |
| å¯¾è§’åè»¢ | (y, x) |
| åå¯¾è§’åè»¢ | (-y, -x) |

### ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè£…

```python
def get_symmetries(board):
    """
    ç›¤é¢ã®8ç¨®é¡ã®å¯¾ç§°å¤‰æ›ã‚’å–å¾—

    Returns:
        8ã¤ã®ç›¤é¢ã®ãƒªã‚¹ãƒˆ
    """
    symmetries = []

    # å…ƒã®ç›¤é¢
    symmetries.append(board.copy())

    # 90Â°å›è»¢
    symmetries.append(np.rot90(board, k=1))

    # 180Â°å›è»¢
    symmetries.append(np.rot90(board, k=2))

    # 270Â°å›è»¢
    symmetries.append(np.rot90(board, k=3))

    # æ°´å¹³åè»¢
    symmetries.append(np.fliplr(board))

    # å‚ç›´åè»¢
    symmetries.append(np.flipud(board))

    # å¯¾è§’åè»¢
    symmetries.append(board.T)

    # åå¯¾è§’åè»¢
    symmetries.append(np.rot90(board.T, k=2))

    return symmetries


def apply_symmetry(board, sym_index):
    """
    sym_indexç•ªç›®ã®å¯¾ç§°å¤‰æ›ã‚’é©ç”¨
    """
    return get_symmetries(board)[sym_index]


def inverse_symmetry(move, sym_index, board_size=19):
    """
    å¤‰æ›å¾Œã®ç€æ‰‹åº§æ¨™ã‚’å…ƒã®åº§æ¨™ã«æˆ»ã™
    """
    row, col = move

    if sym_index == 0:  # æ’ç­‰
        return row, col
    elif sym_index == 1:  # 90Â°å›è»¢
        return col, board_size - 1 - row
    elif sym_index == 2:  # 180Â°å›è»¢
        return board_size - 1 - row, board_size - 1 - col
    elif sym_index == 3:  # 270Â°å›è»¢
        return board_size - 1 - col, row
    elif sym_index == 4:  # æ°´å¹³åè»¢
        return row, board_size - 1 - col
    elif sym_index == 5:  # å‚ç›´åè»¢
        return board_size - 1 - row, col
    elif sym_index == 6:  # å¯¾è§’åè»¢
        return col, row
    elif sym_index == 7:  # åå¯¾è§’åè»¢
        return board_size - 1 - col, board_size - 1 - row
```

### ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µ

ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚’è¨“ç·´ã™ã‚‹éš›ã€å¯¾ç§°æ€§ã‚’åˆ©ç”¨ã—ã¦**ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µ**ãŒã§ãã¾ã™ï¼š

```python
def augment_training_data(board, policy, value):
    """
    1ã¤ã®è¨“ç·´ã‚µãƒ³ãƒ—ãƒ«ã‚’8ã¤ã«æ‹¡å¼µ
    """
    augmented = []

    for sym_index in range(8):
        # ç›¤é¢ã‚’å¤‰æ›
        aug_board = apply_symmetry(board, sym_index)

        # ãƒãƒªã‚·ãƒ¼ã‚’å¤‰æ›ï¼ˆ361æ¬¡å…ƒãƒ™ã‚¯ãƒˆãƒ«ï¼‰
        policy_2d = policy.reshape(19, 19)
        aug_policy_2d = apply_symmetry(policy_2d, sym_index)
        aug_policy = aug_policy_2d.flatten()

        # ä¾¡å€¤ã¯å¤‰ã‚ã‚‰ãªã„
        aug_value = value

        augmented.append((aug_board, aug_policy, aug_value))

    return augmented
```

ã“ã‚Œã«ã‚ˆã‚Šè¨“ç·´ãƒ‡ãƒ¼ã‚¿é‡ãŒ8å€ã«å¢—åŠ ã—ã€å®Œå…¨ã«ç„¡æ–™ã§ã™ï¼ˆæ–°ã—ã„ãƒ‡ãƒ¼ã‚¿ã‚’åé›†ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã›ã‚“ï¼‰ã€‚

### æ¨è«–æ™‚ã®å¯¾ç§°æ€§åˆ©ç”¨

AlphaGoã¯å®Ÿéš›ã®å¯¾å±€ã§ã‚‚å¯¾ç§°æ€§ã‚’åˆ©ç”¨ã—ã¦ã„ã¾ã™ï¼š

```python
def predict_with_symmetry(model, board):
    """
    å¯¾ç§°æ€§ã‚’åˆ©ç”¨ã—ã¦äºˆæ¸¬ã‚’å¼·åŒ–
    """
    policies = []
    values = []

    for sym_index in range(8):
        # å…¥åŠ›ã‚’å¤‰æ›
        aug_board = apply_symmetry(board, sym_index)

        # ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã§äºˆæ¸¬
        policy, value = model.predict(aug_board)

        # ãƒãƒªã‚·ãƒ¼ã‚’å…ƒã®åº§æ¨™ç³»ã«å¤‰æ›
        policy_2d = policy.reshape(19, 19)
        original_policy = inverse_symmetry_2d(policy_2d, sym_index)
        policies.append(original_policy.flatten())

        values.append(value)

    # ã™ã¹ã¦ã®äºˆæ¸¬ã‚’å¹³å‡
    avg_policy = np.mean(policies, axis=0)
    avg_value = np.mean(values)

    return avg_policy, avg_value
```

ã“ã®æ‰‹æ³•ã«ã‚ˆã‚Šã€äºˆæ¸¬ã®ç²¾åº¦ã¨å®‰å®šæ€§ã‚’ã‚ãšã‹ã«å‘ä¸Šã•ã›ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

---

## ç›¤é¢è¡¨ç¾æ–¹æ³•ã®ã¾ã¨ã‚

| æ–¹æ³• | ç”¨é€” | è¨ˆç®—é‡ | ç‰¹å¾´ |
|------|------|--------|------|
| **äºŒæ¬¡å…ƒé…åˆ—** | åŸºæœ¬çš„ãªä¿å­˜ | O(361) ç©ºé–“ | ã‚·ãƒ³ãƒ—ãƒ«ã§ç›´æ„Ÿçš„ |
| **Zobrist Hashing** | å±€é¢è­˜åˆ¥ | O(1) ã‚¯ã‚¨ãƒª | é«˜åŠ¹ç‡ãƒãƒƒã‚·ãƒ¥ |
| **Union-Find** | çŸ³ã®é€£ç®¡ç† | O(Î±(n)) æ“ä½œ | é€£çµæ€§å‡¦ç† |
| **ç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³** | ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯å…¥åŠ› | O(361Ã—ãƒ—ãƒ¬ãƒ¼ãƒ³æ•°) | è±Šå¯Œãªæƒ…å ±ã‚’ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ |
| **å¯¾ç§°æ€§å¤‰æ›** | ãƒ‡ãƒ¼ã‚¿æ‹¡å¼µ | 8Ã— ãƒ‡ãƒ¼ã‚¿é‡ | ç„¡æ–™ã§å¢—åŠ  |

ã“ã‚Œã‚‰ã®æŠ€è¡“ã¯äº’ã„ã«é€£æºã—ã€ç¾ä»£ã®å›²ç¢AIã®åŸºç›¤ã‚¤ãƒ³ãƒ•ãƒ©ã‚’æ§‹æˆã—ã¦ã„ã¾ã™ã€‚

---

## ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³å¯¾å¿œ

æœ¬è¨˜äº‹ã§æ‰±ã†æ ¸å¿ƒæ¦‚å¿µã¨ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ç•ªå·ï¼š

| ç•ªå· | æ¦‚å¿µ | ç‰©ç†/æ•°å­¦å¯¾å¿œ |
|------|------|--------------|
| ğŸ¬ A1 | äºŒæ¬¡å…ƒé…åˆ—è¡¨ç¾ | è¡Œåˆ—ã€ç–ãƒ‡ãƒ¼ã‚¿ |
| ğŸ¬ A2 | Zobrist Hashing | ãƒãƒƒã‚·ãƒ¥é–¢æ•°ã€XORæ¼”ç®— |
| ğŸ¬ A8 | ç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚° | ãƒ†ãƒ³ã‚½ãƒ«ã€ãƒãƒ«ãƒãƒãƒ£ãƒãƒ«å…¥åŠ› |
| ğŸ¬ A5 | å¯¾ç§°æ€§å‡¦ç† | ç¾¤è«–ã€äºŒé¢ä½“ç¾¤ |

---

## é–¢é€£è¨˜äº‹

- **å‰å›**ï¼š[å¾“æ¥æ‰‹æ³•ã®é™ç•Œ](../traditional-limits) â€” Minimaxã‹ã‚‰MCTSã¾ã§
- **æ¬¡å›**ï¼š[Policy Networkè©³è§£](../policy-network) â€” ãƒ‹ãƒ¥ãƒ¼ãƒ©ãƒ«ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã«ã‚ˆã‚‹ç€æ‰‹äºˆæ¸¬
- **å®Ÿè·µç·´ç¿’**ï¼š[30åˆ†ã§å‹•ã‹ã™åˆã‚ã¦ã®å›²ç¢AI](/docs/tech/hands-on/) â€” å®Ÿéš›ã«æ‰‹ã‚’å‹•ã‹ã—ã¦ä½“é¨“

---

## å‚è€ƒæ–‡çŒ®

1. Zobrist, A. L. (1970). "A new hashing method with application for game playing." ICCA journal.
2. Tarjan, R. E. (1975). "Efficiency of a Good But Not Linear Set Union Algorithm." Journal of the ACM, 22(2), 215-225.
3. Silver, D., et al. (2016). "Mastering the game of Go with deep neural networks and tree search." Nature, 529, 484-489. â€” AlphaGo 48ç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³
4. Silver, D., et al. (2017). "Mastering the game of Go without human knowledge." Nature, 550, 354-359. â€” AlphaGo Zero 17ç‰¹å¾´é‡ãƒ—ãƒ¬ãƒ¼ãƒ³
